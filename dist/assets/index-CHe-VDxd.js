(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();var sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $x(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Km={exports:{}},Yc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NS;function Zx(){if(NS)return Yc;NS=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:c,ref:s!==void 0?s:null,props:o}}return Yc.Fragment=t,Yc.jsx=e,Yc.jsxs=e,Yc}var jS;function Jx(){return jS||(jS=1,Km.exports=Zx()),Km.exports}var Ot=Jx(),Qm={exports:{}},Qt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BS;function tA(){if(BS)return Qt;BS=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function S(N){return N===null||typeof N!="object"?null:(N=v&&N[v]||N["@@iterator"],typeof N=="function"?N:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,O={};function D(N,at,pt){this.props=N,this.context=at,this.refs=O,this.updater=pt||b}D.prototype.isReactComponent={},D.prototype.setState=function(N,at){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,at,"setState")},D.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function j(){}j.prototype=D.prototype;function G(N,at,pt){this.props=N,this.context=at,this.refs=O,this.updater=pt||b}var Z=G.prototype=new j;Z.constructor=G,E(Z,D.prototype),Z.isPureReactComponent=!0;var q=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function P(N,at,pt,mt,St,Ut){return pt=Ut.ref,{$$typeof:i,type:N,key:at,ref:pt!==void 0?pt:null,props:Ut}}function x(N,at){return P(N.type,at,void 0,void 0,void 0,N.props)}function R(N){return typeof N=="object"&&N!==null&&N.$$typeof===i}function L(N){var at={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(pt){return at[pt]})}var k=/\/+/g;function F(N,at){return typeof N=="object"&&N!==null&&N.key!=null?L(""+N.key):at.toString(36)}function M(){}function vt(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(M,M):(N.status="pending",N.then(function(at){N.status==="pending"&&(N.status="fulfilled",N.value=at)},function(at){N.status==="pending"&&(N.status="rejected",N.reason=at)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function Pt(N,at,pt,mt,St){var Ut=typeof N;(Ut==="undefined"||Ut==="boolean")&&(N=null);var Et=!1;if(N===null)Et=!0;else switch(Ut){case"bigint":case"string":case"number":Et=!0;break;case"object":switch(N.$$typeof){case i:case t:Et=!0;break;case p:return Et=N._init,Pt(Et(N._payload),at,pt,mt,St)}}if(Et)return St=St(N),Et=mt===""?"."+F(N,0):mt,q(St)?(pt="",Et!=null&&(pt=Et.replace(k,"$&/")+"/"),Pt(St,at,pt,"",function(Be){return Be})):St!=null&&(R(St)&&(St=x(St,pt+(St.key==null||N&&N.key===St.key?"":(""+St.key).replace(k,"$&/")+"/")+Et)),at.push(St)),1;Et=0;var Ht=mt===""?".":mt+":";if(q(N))for(var Wt=0;Wt<N.length;Wt++)mt=N[Wt],Ut=Ht+F(mt,Wt),Et+=Pt(mt,at,pt,Ut,St);else if(Wt=S(N),typeof Wt=="function")for(N=Wt.call(N),Wt=0;!(mt=N.next()).done;)mt=mt.value,Ut=Ht+F(mt,Wt++),Et+=Pt(mt,at,pt,Ut,St);else if(Ut==="object"){if(typeof N.then=="function")return Pt(vt(N),at,pt,mt,St);throw at=String(N),Error("Objects are not valid as a React child (found: "+(at==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":at)+"). If you meant to render a collection of children, use an array instead.")}return Et}function W(N,at,pt){if(N==null)return N;var mt=[],St=0;return Pt(N,mt,"","",function(Ut){return at.call(pt,Ut,St++)}),mt}function ft(N){if(N._status===-1){var at=N._result;at=at(),at.then(function(pt){(N._status===0||N._status===-1)&&(N._status=1,N._result=pt)},function(pt){(N._status===0||N._status===-1)&&(N._status=2,N._result=pt)}),N._status===-1&&(N._status=0,N._result=at)}if(N._status===1)return N._result.default;throw N._result}var gt=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var at=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(at))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function It(){}return Qt.Children={map:W,forEach:function(N,at,pt){W(N,function(){at.apply(this,arguments)},pt)},count:function(N){var at=0;return W(N,function(){at++}),at},toArray:function(N){return W(N,function(at){return at})||[]},only:function(N){if(!R(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Qt.Component=D,Qt.Fragment=e,Qt.Profiler=s,Qt.PureComponent=G,Qt.StrictMode=n,Qt.Suspense=f,Qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Qt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return B.H.useMemoCache(N)}},Qt.cache=function(N){return function(){return N.apply(null,arguments)}},Qt.cloneElement=function(N,at,pt){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var mt=E({},N.props),St=N.key,Ut=void 0;if(at!=null)for(Et in at.ref!==void 0&&(Ut=void 0),at.key!==void 0&&(St=""+at.key),at)!I.call(at,Et)||Et==="key"||Et==="__self"||Et==="__source"||Et==="ref"&&at.ref===void 0||(mt[Et]=at[Et]);var Et=arguments.length-2;if(Et===1)mt.children=pt;else if(1<Et){for(var Ht=Array(Et),Wt=0;Wt<Et;Wt++)Ht[Wt]=arguments[Wt+2];mt.children=Ht}return P(N.type,St,void 0,void 0,Ut,mt)},Qt.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:o,_context:N},N},Qt.createElement=function(N,at,pt){var mt,St={},Ut=null;if(at!=null)for(mt in at.key!==void 0&&(Ut=""+at.key),at)I.call(at,mt)&&mt!=="key"&&mt!=="__self"&&mt!=="__source"&&(St[mt]=at[mt]);var Et=arguments.length-2;if(Et===1)St.children=pt;else if(1<Et){for(var Ht=Array(Et),Wt=0;Wt<Et;Wt++)Ht[Wt]=arguments[Wt+2];St.children=Ht}if(N&&N.defaultProps)for(mt in Et=N.defaultProps,Et)St[mt]===void 0&&(St[mt]=Et[mt]);return P(N,Ut,void 0,void 0,null,St)},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(N){return{$$typeof:h,render:N}},Qt.isValidElement=R,Qt.lazy=function(N){return{$$typeof:p,_payload:{_status:-1,_result:N},_init:ft}},Qt.memo=function(N,at){return{$$typeof:d,type:N,compare:at===void 0?null:at}},Qt.startTransition=function(N){var at=B.T,pt={};B.T=pt;try{var mt=N(),St=B.S;St!==null&&St(pt,mt),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"&&mt.then(It,gt)}catch(Ut){gt(Ut)}finally{B.T=at}},Qt.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Qt.use=function(N){return B.H.use(N)},Qt.useActionState=function(N,at,pt){return B.H.useActionState(N,at,pt)},Qt.useCallback=function(N,at){return B.H.useCallback(N,at)},Qt.useContext=function(N){return B.H.useContext(N)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(N,at){return B.H.useDeferredValue(N,at)},Qt.useEffect=function(N,at,pt){var mt=B.H;if(typeof pt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return mt.useEffect(N,at)},Qt.useId=function(){return B.H.useId()},Qt.useImperativeHandle=function(N,at,pt){return B.H.useImperativeHandle(N,at,pt)},Qt.useInsertionEffect=function(N,at){return B.H.useInsertionEffect(N,at)},Qt.useLayoutEffect=function(N,at){return B.H.useLayoutEffect(N,at)},Qt.useMemo=function(N,at){return B.H.useMemo(N,at)},Qt.useOptimistic=function(N,at){return B.H.useOptimistic(N,at)},Qt.useReducer=function(N,at,pt){return B.H.useReducer(N,at,pt)},Qt.useRef=function(N){return B.H.useRef(N)},Qt.useState=function(N){return B.H.useState(N)},Qt.useSyncExternalStore=function(N,at,pt){return B.H.useSyncExternalStore(N,at,pt)},Qt.useTransition=function(){return B.H.useTransition()},Qt.version="19.1.1",Qt}var FS;function dy(){return FS||(FS=1,Qm.exports=tA()),Qm.exports}var it=dy(),$m={exports:{}},qc={},Zm={exports:{}},Jm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var US;function eA(){return US||(US=1,(function(i){function t(W,ft){var gt=W.length;W.push(ft);t:for(;0<gt;){var It=gt-1>>>1,N=W[It];if(0<s(N,ft))W[It]=ft,W[gt]=N,gt=It;else break t}}function e(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var ft=W[0],gt=W.pop();if(gt!==ft){W[0]=gt;t:for(var It=0,N=W.length,at=N>>>1;It<at;){var pt=2*(It+1)-1,mt=W[pt],St=pt+1,Ut=W[St];if(0>s(mt,gt))St<N&&0>s(Ut,mt)?(W[It]=Ut,W[St]=gt,It=St):(W[It]=mt,W[pt]=gt,It=pt);else if(St<N&&0>s(Ut,gt))W[It]=Ut,W[St]=gt,It=St;else break t}}return ft}function s(W,ft){var gt=W.sortIndex-ft.sortIndex;return gt!==0?gt:W.id-ft.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();i.unstable_now=function(){return c.now()-h}}var f=[],d=[],p=1,v=null,S=3,b=!1,E=!1,O=!1,D=!1,j=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function q(W){for(var ft=e(d);ft!==null;){if(ft.callback===null)n(d);else if(ft.startTime<=W)n(d),ft.sortIndex=ft.expirationTime,t(f,ft);else break;ft=e(d)}}function B(W){if(O=!1,q(W),!E)if(e(f)!==null)E=!0,I||(I=!0,F());else{var ft=e(d);ft!==null&&Pt(B,ft.startTime-W)}}var I=!1,P=-1,x=5,R=-1;function L(){return D?!0:!(i.unstable_now()-R<x)}function k(){if(D=!1,I){var W=i.unstable_now();R=W;var ft=!0;try{t:{E=!1,O&&(O=!1,G(P),P=-1),b=!0;var gt=S;try{e:{for(q(W),v=e(f);v!==null&&!(v.expirationTime>W&&L());){var It=v.callback;if(typeof It=="function"){v.callback=null,S=v.priorityLevel;var N=It(v.expirationTime<=W);if(W=i.unstable_now(),typeof N=="function"){v.callback=N,q(W),ft=!0;break e}v===e(f)&&n(f),q(W)}else n(f);v=e(f)}if(v!==null)ft=!0;else{var at=e(d);at!==null&&Pt(B,at.startTime-W),ft=!1}}break t}finally{v=null,S=gt,b=!1}ft=void 0}}finally{ft?F():I=!1}}}var F;if(typeof Z=="function")F=function(){Z(k)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,vt=M.port2;M.port1.onmessage=k,F=function(){vt.postMessage(null)}}else F=function(){j(k,0)};function Pt(W,ft){P=j(function(){W(i.unstable_now())},ft)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return S},i.unstable_next=function(W){switch(S){case 1:case 2:case 3:var ft=3;break;default:ft=S}var gt=S;S=ft;try{return W()}finally{S=gt}},i.unstable_requestPaint=function(){D=!0},i.unstable_runWithPriority=function(W,ft){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var gt=S;S=W;try{return ft()}finally{S=gt}},i.unstable_scheduleCallback=function(W,ft,gt){var It=i.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?It+gt:It):gt=It,W){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=gt+N,W={id:p++,callback:ft,priorityLevel:W,startTime:gt,expirationTime:N,sortIndex:-1},gt>It?(W.sortIndex=gt,t(d,W),e(f)===null&&W===e(d)&&(O?(G(P),P=-1):O=!0,Pt(B,gt-It))):(W.sortIndex=N,t(f,W),E||b||(E=!0,I||(I=!0,F()))),W},i.unstable_shouldYield=L,i.unstable_wrapCallback=function(W){var ft=S;return function(){var gt=S;S=ft;try{return W.apply(this,arguments)}finally{S=gt}}}})(Jm)),Jm}var zS;function nA(){return zS||(zS=1,Zm.exports=eA()),Zm.exports}var tp={exports:{}},Bn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HS;function rA(){if(HS)return Bn;HS=1;var i=dy();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(f,d,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:f,containerInfo:d,implementation:p}}var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Bn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Bn.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return o(f,d,null,p)},Bn.flushSync=function(f){var d=c.T,p=n.p;try{if(c.T=null,n.p=2,f)return f()}finally{c.T=d,n.p=p,n.d.f()}},Bn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Bn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Bn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,v=h(p,d.crossOrigin),S=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:S,fetchPriority:b}):p==="script"&&n.d.X(f,{crossOrigin:v,integrity:S,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Bn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=h(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Bn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,v=h(p,d.crossOrigin);n.d.L(f,p,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Bn.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=h(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Bn.requestFormReset=function(f){n.d.r(f)},Bn.unstable_batchedUpdates=function(f,d){return f(d)},Bn.useFormState=function(f,d,p){return c.H.useFormState(f,d,p)},Bn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Bn.version="19.1.1",Bn}var GS;function l1(){if(GS)return tp.exports;GS=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),tp.exports=rA(),tp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS;function iA(){if(YS)return qc;YS=1;var i=nA(),t=dy(),e=l1();function n(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function c(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(n(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(n(188));return a!==r?null:r}for(var l=r,u=a;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return h(m),r;if(y===u)return h(m),a;y=y.sibling}throw Error(n(188))}if(l.return!==u.return)l=m,u=y;else{for(var w=!1,C=m.child;C;){if(C===l){w=!0,l=m,u=y;break}if(C===u){w=!0,u=m,l=y;break}C=C.sibling}if(!w){for(C=y.child;C;){if(C===l){w=!0,l=y,u=m;break}if(C===u){w=!0,u=y,l=m;break}C=C.sibling}if(!w)throw Error(n(189))}}if(l.alternate!==u)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?r:a}function d(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=d(r),a!==null)return a;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),G=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=k&&r[k]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function vt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case D:return"Profiler";case O:return"StrictMode";case B:return"Suspense";case I:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case b:return"Portal";case Z:return(r.displayName||"Context")+".Provider";case G:return(r._context.displayName||"Context")+".Consumer";case q:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return a=r.displayName||null,a!==null?a:vt(r.type)||"Memo";case x:a=r._payload,r=r._init;try{return vt(r(a))}catch{}}return null}var Pt=Array.isArray,W=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ft=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt={pending:!1,data:null,method:null,action:null},It=[],N=-1;function at(r){return{current:r}}function pt(r){0>N||(r.current=It[N],It[N]=null,N--)}function mt(r,a){N++,It[N]=r.current,r.current=a}var St=at(null),Ut=at(null),Et=at(null),Ht=at(null);function Wt(r,a){switch(mt(Et,a),mt(Ut,r),mt(St,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?hS(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=hS(a),r=fS(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}pt(St),mt(St,r)}function Be(){pt(St),pt(Ut),pt(Et)}function ae(r){r.memoizedState!==null&&mt(Ht,r);var a=St.current,l=fS(a,r.type);a!==l&&(mt(Ut,r),mt(St,l))}function mr(r){Ut.current===r&&(pt(St),pt(Ut)),Ht.current===r&&(pt(Ht),Fc._currentValue=gt)}var Yi=Object.prototype.hasOwnProperty,qi=i.unstable_scheduleCallback,Jn=i.unstable_cancelCallback,Gl=i.unstable_shouldYield,Ca=i.unstable_requestPaint,En=i.unstable_now,To=i.unstable_getCurrentPriorityLevel,Xe=i.unstable_ImmediatePriority,nn=i.unstable_UserBlockingPriority,Wr=i.unstable_NormalPriority,Kr=i.unstable_LowPriority,Qr=i.unstable_IdlePriority,wo=i.log,$r=i.unstable_setDisableYieldValue,pn=null,De=null;function Gn(r){if(typeof wo=="function"&&$r(r),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(pn,r)}catch{}}var Cn=Math.clz32?Math.clz32:tr,xa=Math.log,Eo=Math.LN2;function tr(r){return r>>>=0,r===0?32:31-(xa(r)/Eo|0)|0}var pr=256,Zr=4194304;function er(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function nr(r,a,l){var u=r.pendingLanes;if(u===0)return 0;var m=0,y=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var C=u&134217727;return C!==0?(u=C&~y,u!==0?m=er(u):(w&=C,w!==0?m=er(w):l||(l=C&~r,l!==0&&(m=er(l))))):(C=u&~y,C!==0?m=er(C):w!==0?m=er(w):l||(l=u&~r,l!==0&&(m=er(l)))),m===0?0:a!==0&&a!==m&&(a&y)===0&&(y=m&-m,l=a&-a,y>=l||y===32&&(l&4194048)!==0)?a:m}function Jr(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function ti(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xs(){var r=pr;return pr<<=1,(pr&4194048)===0&&(pr=256),r}function Dr(){var r=Zr;return Zr<<=1,(Zr&62914560)===0&&(Zr=4194304),r}function As(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function Le(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Co(r,a,l,u,m,y){var w=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var C=r.entanglements,V=r.expirationTimes,J=r.hiddenUpdates;for(l=w&~l;0<l;){var ot=31-Cn(l),ct=1<<ot;C[ot]=0,V[ot]=-1;var et=J[ot];if(et!==null)for(J[ot]=null,ot=0;ot<et.length;ot++){var rt=et[ot];rt!==null&&(rt.lane&=-536870913)}l&=~ct}u!==0&&ei(r,u,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(w&~a))}function ei(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var u=31-Cn(a);r.entangledLanes|=a,r.entanglements[u]=r.entanglements[u]|1073741824|l&4194090}function yr(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var u=31-Cn(l),m=1<<u;m&a|r[u]&a&&(r[u]|=a),l&=~m}}function bi(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Aa(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ni(){var r=ft.p;return r!==0?r:(r=window.event,r===void 0?32:MS(r.type))}function U(r,a){var l=ft.p;try{return ft.p=r,a()}finally{ft.p=l}}var K=Math.random().toString(36).slice(2),tt="__reactFiber$"+K,ht="__reactProps$"+K,yt="__reactContainer$"+K,xt="__reactEvents$"+K,Dt="__reactListeners$"+K,Rt="__reactHandles$"+K,Ct="__reactResources$"+K,kt="__reactMarker$"+K;function Mt(r){delete r[tt],delete r[ht],delete r[xt],delete r[Dt],delete r[Rt]}function Tt(r){var a=r[tt];if(a)return a;for(var l=r.parentNode;l;){if(a=l[yt]||l[tt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=pS(r);r!==null;){if(l=r[tt])return l;r=pS(r)}return a}r=l,l=r.parentNode}return null}function Yt(r){if(r=r[tt]||r[yt]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function ue(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(n(33))}function xe(r){var a=r[Ct];return a||(a=r[Ct]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ee(r){r[kt]=!0}var be=new Set,he={};function yn(r,a){kn(r,a),kn(r+"Capture",a)}function kn(r,a){for(he[r]=a,r=0;r<a.length;r++)be.add(a[r])}var Vn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),We={},Ti={};function Xi(r){return Yi.call(Ti,r)?!0:Yi.call(We,r)?!1:Vn.test(r)?Ti[r]=!0:(We[r]=!0,!1)}function Yn(r,a,l){if(Xi(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function Rr(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function xn(r,a,l,u){if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+u)}}var Kt,Fe;function Ln(r){if(Kt===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Kt=a&&a[1]||"",Fe=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kt+r+Fe}var rr=!1;function Re(r,a){if(!r||rr)return"";rr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var ct=function(){throw Error()};if(Object.defineProperty(ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ct,[])}catch(rt){var et=rt}Reflect.construct(r,[],ct)}else{try{ct.call()}catch(rt){et=rt}r.call(ct.prototype)}}else{try{throw Error()}catch(rt){et=rt}(ct=r())&&typeof ct.catch=="function"&&ct.catch(function(){})}}catch(rt){if(rt&&et&&typeof rt.stack=="string")return[rt.stack,et.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),w=y[0],C=y[1];if(w&&C){var V=w.split(`
`),J=C.split(`
`);for(m=u=0;u<V.length&&!V[u].includes("DetermineComponentFrameRoot");)u++;for(;m<J.length&&!J[m].includes("DetermineComponentFrameRoot");)m++;if(u===V.length||m===J.length)for(u=V.length-1,m=J.length-1;1<=u&&0<=m&&V[u]!==J[m];)m--;for(;1<=u&&0<=m;u--,m--)if(V[u]!==J[m]){if(u!==1||m!==1)do if(u--,m--,0>m||V[u]!==J[m]){var ot=`
`+V[u].replace(" at new "," at ");return r.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",r.displayName)),ot}while(1<=u&&0<=m);break}}}finally{rr=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?Ln(l):""}function Ds(r){switch(r.tag){case 26:case 27:case 5:return Ln(r.type);case 16:return Ln("Lazy");case 13:return Ln("Suspense");case 19:return Ln("SuspenseList");case 0:case 15:return Re(r.type,!1);case 11:return Re(r.type.render,!1);case 1:return Re(r.type,!0);case 31:return Ln("Activity");default:return""}}function ir(r){try{var a="";do a+=Ds(r),r=r.return;while(r);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Ie(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Rs(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Da(r){var a=Rs(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),u=""+r[a];if(!r.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,y=l.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){u=""+w,y.call(this,w)}}),Object.defineProperty(r,a,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(w){u=""+w},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Os(r){r._valueTracker||(r._valueTracker=Da(r))}function Te(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return r&&(u=Rs(r)?r.checked?"true":"false":r.value),r=u,r!==l?(a.setValue(r),!0):!1}function Wi(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ra=/[\n"\\]/g;function vn(r){return r.replace(Ra,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Yl(r,a,l,u,m,y,w,C){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),a!=null?w==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Ie(a)):r.value!==""+Ie(a)&&(r.value=""+Ie(a)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),a!=null?Xl(r,w,Ie(a)):l!=null?Xl(r,w,Ie(l)):u!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?r.name=""+Ie(C):r.removeAttribute("name")}function ql(r,a,l,u,m,y,w,C){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),a!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||a!=null))return;l=l!=null?""+Ie(l):"",a=a!=null?""+Ie(a):l,C||a===r.value||(r.value=a),r.defaultValue=a}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=C?r.checked:!!u,r.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w)}function Xl(r,a,l){a==="number"&&Wi(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Ms(r,a,l,u){if(r=r.options,a){a={};for(var m=0;m<l.length;m++)a["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=a.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&u&&(r[l].defaultSelected=!0)}else{for(l=""+Ie(l),a=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,u&&(r[m].defaultSelected=!0);return}a!==null||r[m].disabled||(a=r[m])}a!==null&&(a.selected=!0)}}function Gu(r,a,l){if(a!=null&&(a=""+Ie(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+Ie(l):""}function Yu(r,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(n(92));if(Pt(u)){if(1<u.length)throw Error(n(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=Ie(a),r.defaultValue=l,u=r.textContent,u===l&&u!==""&&u!==null&&(r.value=u)}function Or(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var Ki=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wl(r,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":u?r.setProperty(a,l):typeof l!="number"||l===0||Ki.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function Kl(r,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(r=r.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var m in a)u=a[m],a.hasOwnProperty(m)&&l[m]!==u&&Wl(r,m,u)}else for(var y in a)a.hasOwnProperty(y)&&Wl(r,y,a[y])}function xo(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ri(r){return Xu.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Ql=null;function $l(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ps=null,qn=null;function Wu(r){var a=Yt(r);if(a&&(r=a.stateNode)){var l=r[ht]||null;t:switch(r=a.stateNode,a.type){case"input":if(Yl(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+vn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==r&&u.form===r.form){var m=u[ht]||null;if(!m)throw Error(n(90));Yl(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===r.form&&Te(u)}break t;case"textarea":Gu(r,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&Ms(r,!!l.multiple,a,!1)}}}var Oa=!1;function Ma(r,a,l){if(Oa)return r(a,l);Oa=!0;try{var u=r(a);return u}finally{if(Oa=!1,(Ps!==null||qn!==null)&&(Nh(),Ps&&(a=Ps,r=qn,qn=Ps=null,Wu(a),r)))for(a=0;a<r.length;a++)Wu(r[a])}}function Is(r,a){var l=r.stateNode;if(l===null)return null;var u=l[ht]||null;if(u===null)return null;l=u[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break t;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qi=!1;if(Xn)try{var ks={};Object.defineProperty(ks,"passive",{get:function(){Qi=!0}}),window.addEventListener("test",ks,ks),window.removeEventListener("test",ks,ks)}catch{Qi=!1}var Mr=null,Oe=null,Ao=null;function Ku(){if(Ao)return Ao;var r,a=Oe,l=a.length,u,m="value"in Mr?Mr.value:Mr.textContent,y=m.length;for(r=0;r<l&&a[r]===m[r];r++);var w=l-r;for(u=1;u<=w&&a[l-u]===m[y-u];u++);return Ao=m.slice(r,1<u?1-u:void 0)}function Pa(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Ia(){return!0}function Zl(){return!1}function cn(r){function a(l,u,m,y,w){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var C in r)r.hasOwnProperty(C)&&(l=r[C],this[C]=l?l(y):y[C]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ia:Zl,this.isPropagationStopped=Zl,this}return p(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ia)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ia)},persist:function(){},isPersistent:Ia}),a}var Nn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=cn(Nn),Va=p({},Nn,{view:0,detail:0}),La=cn(Va),Do,Na,wi,ja=p({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==wi&&(wi&&r.type==="mousemove"?(Do=r.screenX-wi.screenX,Na=r.screenY-wi.screenY):Na=Do=0,wi=r),Do)},movementY:function(r){return"movementY"in r?r.movementY:Na}}),Ba=cn(ja),ig=p({},ja,{dataTransfer:0}),Qu=cn(ig),Fa=p({},Va,{relatedTarget:0}),Ro=cn(Fa),$u=p({},Nn,{animationName:0,elapsedTime:0,pseudoElement:0}),Jl=cn($u),tc=p({},Nn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Zu=cn(tc),Oo=p({},Nn,{data:0}),ec=cn(Oo),Ju={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},th={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eh(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=th[r])?!!a[r]:!1}function Mo(){return eh}var nh=p({},Va,{key:function(r){if(r.key){var a=Ju[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Pa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?$i[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mo,charCode:function(r){return r.type==="keypress"?Pa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Pa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Po=cn(nh),Wn=p({},ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nc=cn(Wn),rh=p({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mo}),Vs=cn(rh),g=p({},Nn,{propertyName:0,elapsedTime:0,pseudoElement:0}),_=cn(g),T=p({},ja,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),A=cn(T),$=p({},Nn,{newState:0,oldState:0}),st=cn($),_t=[9,13,27,32],qt=Xn&&"CompositionEvent"in window,ke=null;Xn&&"documentMode"in document&&(ke=document.documentMode);var ve=Xn&&"TextEvent"in window&&!ke,Ke=Xn&&(!qt||ke&&8<ke&&11>=ke),vr=" ",Ei=!1;function ii(r,a){switch(r){case"keyup":return _t.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function si(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ai=!1;function rc(r,a){switch(r){case"compositionend":return si(a);case"keypress":return a.which!==32?null:(Ei=!0,vr);case"textInput":return r=a.data,r===vr&&Ei?null:r;default:return null}}function EC(r,a){if(ai)return r==="compositionend"||!qt&&ii(r,a)?(r=Ku(),Ao=Oe=Mr=null,ai=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ke&&a.locale!=="ko"?null:a.data;default:return null}}var CC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cv(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!CC[r.type]:a==="textarea"}function xv(r,a,l,u){Ps?qn?qn.push(u):qn=[u]:Ps=u,a=Hh(a,"onChange"),0<a.length&&(l=new ka("onChange","change",null,l,u),r.push({event:l,listeners:a}))}var ic=null,sc=null;function xC(r){aS(r,0)}function ih(r){var a=ue(r);if(Te(a))return r}function Av(r,a){if(r==="change")return a}var Dv=!1;if(Xn){var sg;if(Xn){var ag="oninput"in document;if(!ag){var Rv=document.createElement("div");Rv.setAttribute("oninput","return;"),ag=typeof Rv.oninput=="function"}sg=ag}else sg=!1;Dv=sg&&(!document.documentMode||9<document.documentMode)}function Ov(){ic&&(ic.detachEvent("onpropertychange",Mv),sc=ic=null)}function Mv(r){if(r.propertyName==="value"&&ih(sc)){var a=[];xv(a,sc,r,$l(r)),Ma(xC,a)}}function AC(r,a,l){r==="focusin"?(Ov(),ic=a,sc=l,ic.attachEvent("onpropertychange",Mv)):r==="focusout"&&Ov()}function DC(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ih(sc)}function RC(r,a){if(r==="click")return ih(a)}function OC(r,a){if(r==="input"||r==="change")return ih(a)}function MC(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var _r=typeof Object.is=="function"?Object.is:MC;function ac(r,a){if(_r(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Yi.call(a,m)||!_r(r[m],a[m]))return!1}return!0}function Pv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Iv(r,a){var l=Pv(r);r=0;for(var u;l;){if(l.nodeType===3){if(u=r+l.textContent.length,r<=a&&u>=a)return{node:l,offset:a-r};r=u}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=Pv(l)}}function kv(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?kv(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Vv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Wi(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=Wi(r.document)}return a}function og(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var PC=Xn&&"documentMode"in document&&11>=document.documentMode,Io=null,lg=null,oc=null,cg=!1;function Lv(r,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;cg||Io==null||Io!==Wi(u)||(u=Io,"selectionStart"in u&&og(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),oc&&ac(oc,u)||(oc=u,u=Hh(lg,"onSelect"),0<u.length&&(a=new ka("onSelect","select",null,a,l),r.push({event:a,listeners:u}),a.target=Io)))}function Ua(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var ko={animationend:Ua("Animation","AnimationEnd"),animationiteration:Ua("Animation","AnimationIteration"),animationstart:Ua("Animation","AnimationStart"),transitionrun:Ua("Transition","TransitionRun"),transitionstart:Ua("Transition","TransitionStart"),transitioncancel:Ua("Transition","TransitionCancel"),transitionend:Ua("Transition","TransitionEnd")},ug={},Nv={};Xn&&(Nv=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function za(r){if(ug[r])return ug[r];if(!ko[r])return r;var a=ko[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in Nv)return ug[r]=a[l];return r}var jv=za("animationend"),Bv=za("animationiteration"),Fv=za("animationstart"),IC=za("transitionrun"),kC=za("transitionstart"),VC=za("transitioncancel"),Uv=za("transitionend"),zv=new Map,hg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hg.push("scrollEnd");function oi(r,a){zv.set(r,a),yn(a,[r])}var Hv=new WeakMap;function Pr(r,a){if(typeof r=="object"&&r!==null){var l=Hv.get(r);return l!==void 0?l:(a={value:r,source:a,stack:ir(a)},Hv.set(r,a),a)}return{value:r,source:a,stack:ir(a)}}var Ir=[],Vo=0,fg=0;function sh(){for(var r=Vo,a=fg=Vo=0;a<r;){var l=Ir[a];Ir[a++]=null;var u=Ir[a];Ir[a++]=null;var m=Ir[a];Ir[a++]=null;var y=Ir[a];if(Ir[a++]=null,u!==null&&m!==null){var w=u.pending;w===null?m.next=m:(m.next=w.next,w.next=m),u.pending=m}y!==0&&Gv(l,m,y)}}function ah(r,a,l,u){Ir[Vo++]=r,Ir[Vo++]=a,Ir[Vo++]=l,Ir[Vo++]=u,fg|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function dg(r,a,l,u){return ah(r,a,l,u),oh(r)}function Lo(r,a){return ah(r,null,null,a),oh(r)}function Gv(r,a,l){r.lanes|=l;var u=r.alternate;u!==null&&(u.lanes|=l);for(var m=!1,y=r.return;y!==null;)y.childLanes|=l,u=y.alternate,u!==null&&(u.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&a!==null&&(m=31-Cn(l),r=y.hiddenUpdates,u=r[m],u===null?r[m]=[a]:u.push(a),a.lane=l|536870912),y):null}function oh(r){if(50<Pc)throw Pc=0,_m=null,Error(n(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var No={};function LC(r,a,l,u){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(r,a,l,u){return new LC(r,a,l,u)}function gg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Zi(r,a){var l=r.alternate;return l===null?(l=Sr(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function Yv(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function lh(r,a,l,u,m,y){var w=0;if(u=r,typeof r=="function")gg(r)&&(w=1);else if(typeof r=="string")w=jx(r,l,St.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case R:return r=Sr(31,l,a,m),r.elementType=R,r.lanes=y,r;case E:return Ha(l.children,m,y,a);case O:w=8,m|=24;break;case D:return r=Sr(12,l,a,m|2),r.elementType=D,r.lanes=y,r;case B:return r=Sr(13,l,a,m),r.elementType=B,r.lanes=y,r;case I:return r=Sr(19,l,a,m),r.elementType=I,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case j:case Z:w=10;break t;case G:w=9;break t;case q:w=11;break t;case P:w=14;break t;case x:w=16,u=null;break t}w=29,l=Error(n(130,r===null?"null":typeof r,"")),u=null}return a=Sr(w,l,a,m),a.elementType=r,a.type=u,a.lanes=y,a}function Ha(r,a,l,u){return r=Sr(7,r,u,a),r.lanes=l,r}function mg(r,a,l){return r=Sr(6,r,null,a),r.lanes=l,r}function pg(r,a,l){return a=Sr(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var jo=[],Bo=0,ch=null,uh=0,kr=[],Vr=0,Ga=null,Ji=1,ts="";function Ya(r,a){jo[Bo++]=uh,jo[Bo++]=ch,ch=r,uh=a}function qv(r,a,l){kr[Vr++]=Ji,kr[Vr++]=ts,kr[Vr++]=Ga,Ga=r;var u=Ji;r=ts;var m=32-Cn(u)-1;u&=~(1<<m),l+=1;var y=32-Cn(a)+m;if(30<y){var w=m-m%5;y=(u&(1<<w)-1).toString(32),u>>=w,m-=w,Ji=1<<32-Cn(a)+m|l<<m|u,ts=y+r}else Ji=1<<y|l<<m|u,ts=r}function yg(r){r.return!==null&&(Ya(r,1),qv(r,1,0))}function vg(r){for(;r===ch;)ch=jo[--Bo],jo[Bo]=null,uh=jo[--Bo],jo[Bo]=null;for(;r===Ga;)Ga=kr[--Vr],kr[Vr]=null,ts=kr[--Vr],kr[Vr]=null,Ji=kr[--Vr],kr[Vr]=null}var Kn=null,Ye=null,ge=!1,qa=null,Ci=!1,_g=Error(n(519));function Xa(r){var a=Error(n(418,""));throw uc(Pr(a,r)),_g}function Xv(r){var a=r.stateNode,l=r.type,u=r.memoizedProps;switch(a[tt]=r,a[ht]=u,l){case"dialog":re("cancel",a),re("close",a);break;case"iframe":case"object":case"embed":re("load",a);break;case"video":case"audio":for(l=0;l<kc.length;l++)re(kc[l],a);break;case"source":re("error",a);break;case"img":case"image":case"link":re("error",a),re("load",a);break;case"details":re("toggle",a);break;case"input":re("invalid",a),ql(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Os(a);break;case"select":re("invalid",a);break;case"textarea":re("invalid",a),Yu(a,u.value,u.defaultValue,u.children),Os(a)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||uS(a.textContent,l)?(u.popover!=null&&(re("beforetoggle",a),re("toggle",a)),u.onScroll!=null&&re("scroll",a),u.onScrollEnd!=null&&re("scrollend",a),u.onClick!=null&&(a.onclick=Gh),a=!0):a=!1,a||Xa(r)}function Wv(r){for(Kn=r.return;Kn;)switch(Kn.tag){case 5:case 13:Ci=!1;return;case 27:case 3:Ci=!0;return;default:Kn=Kn.return}}function lc(r){if(r!==Kn)return!1;if(!ge)return Wv(r),ge=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Vm(r.type,r.memoizedProps)),l=!l),l&&Ye&&Xa(r),Wv(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));t:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(l=r.data,l==="/$"){if(a===0){Ye=ci(r.nextSibling);break t}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;r=r.nextSibling}Ye=null}}else a===27?(a=Ye,$s(r.type)?(r=Bm,Bm=null,Ye=r):Ye=a):Ye=Kn?ci(r.stateNode.nextSibling):null;return!0}function cc(){Ye=Kn=null,ge=!1}function Kv(){var r=qa;return r!==null&&(or===null?or=r:or.push.apply(or,r),qa=null),r}function uc(r){qa===null?qa=[r]:qa.push(r)}var Sg=at(null),Wa=null,es=null;function Ls(r,a,l){mt(Sg,a._currentValue),a._currentValue=l}function ns(r){r._currentValue=Sg.current,pt(Sg)}function bg(r,a,l){for(;r!==null;){var u=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),r===l)break;r=r.return}}function Tg(r,a,l,u){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var w=m.child;y=y.firstContext;t:for(;y!==null;){var C=y;y=m;for(var V=0;V<a.length;V++)if(C.context===a[V]){y.lanes|=l,C=y.alternate,C!==null&&(C.lanes|=l),bg(y.return,l,r),u||(w=null);break t}y=C.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(n(341));w.lanes|=l,y=w.alternate,y!==null&&(y.lanes|=l),bg(w,l,r),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===r){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function hc(r,a,l,u){r=null;for(var m=a,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(n(387));if(w=w.memoizedProps,w!==null){var C=m.type;_r(m.pendingProps.value,w.value)||(r!==null?r.push(C):r=[C])}}else if(m===Ht.current){if(w=m.alternate,w===null)throw Error(n(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Fc):r=[Fc])}m=m.return}r!==null&&Tg(a,r,l,u),a.flags|=262144}function hh(r){for(r=r.firstContext;r!==null;){if(!_r(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ka(r){Wa=r,es=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function jn(r){return Qv(Wa,r)}function fh(r,a){return Wa===null&&Ka(r),Qv(r,a)}function Qv(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},es===null){if(r===null)throw Error(n(308));es=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else es=es.next=a;return l}var NC=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,u){r.push(u)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},jC=i.unstable_scheduleCallback,BC=i.unstable_NormalPriority,un={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wg(){return{controller:new NC,data:new Map,refCount:0}}function fc(r){r.refCount--,r.refCount===0&&jC(BC,function(){r.controller.abort()})}var dc=null,Eg=0,Fo=0,Uo=null;function FC(r,a){if(dc===null){var l=dc=[];Eg=0,Fo=xm(),Uo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Eg++,a.then($v,$v),a}function $v(){if(--Eg===0&&dc!==null){Uo!==null&&(Uo.status="fulfilled");var r=dc;dc=null,Fo=0,Uo=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function UC(r,a){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){u.status="fulfilled",u.value=a;for(var m=0;m<l.length;m++)(0,l[m])(a)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Zv=W.S;W.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&FC(r,a),Zv!==null&&Zv(r,a)};var Qa=at(null);function Cg(){var r=Qa.current;return r!==null?r:Me.pooledCache}function dh(r,a){a===null?mt(Qa,Qa.current):mt(Qa,a.pool)}function Jv(){var r=Cg();return r===null?null:{parent:un._currentValue,pool:r}}var gc=Error(n(460)),t0=Error(n(474)),gh=Error(n(542)),xg={then:function(){}};function e0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function mh(){}function n0(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(mh,mh),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,i0(r),r;default:if(typeof a.status=="string")a.then(mh,mh);else{if(r=Me,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=a,r.status="pending",r.then(function(u){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=u}},function(u){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,i0(r),r}throw mc=a,gc}}var mc=null;function r0(){if(mc===null)throw Error(n(459));var r=mc;return mc=null,r}function i0(r){if(r===gc||r===gh)throw Error(n(483))}var Ns=!1;function Ag(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dg(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function js(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Bs(r,a,l){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(_e&2)!==0){var m=u.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),u.pending=a,a=oh(r),Gv(r,null,l),a}return ah(r,u,a,l),oh(r)}function pc(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,yr(r,l)}}function Rg(r,a){var l=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?m=y=w:y=y.next=w,l=l.next}while(l!==null);y===null?m=y=a:y=y.next=a}else m=y=a;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var Og=!1;function yc(){if(Og){var r=Uo;if(r!==null)throw r}}function vc(r,a,l,u){Og=!1;var m=r.updateQueue;Ns=!1;var y=m.firstBaseUpdate,w=m.lastBaseUpdate,C=m.shared.pending;if(C!==null){m.shared.pending=null;var V=C,J=V.next;V.next=null,w===null?y=J:w.next=J,w=V;var ot=r.alternate;ot!==null&&(ot=ot.updateQueue,C=ot.lastBaseUpdate,C!==w&&(C===null?ot.firstBaseUpdate=J:C.next=J,ot.lastBaseUpdate=V))}if(y!==null){var ct=m.baseState;w=0,ot=J=V=null,C=y;do{var et=C.lane&-536870913,rt=et!==C.lane;if(rt?(oe&et)===et:(u&et)===et){et!==0&&et===Fo&&(Og=!0),ot!==null&&(ot=ot.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});t:{var zt=r,jt=C;et=a;var Ce=l;switch(jt.tag){case 1:if(zt=jt.payload,typeof zt=="function"){ct=zt.call(Ce,ct,et);break t}ct=zt;break t;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=jt.payload,et=typeof zt=="function"?zt.call(Ce,ct,et):zt,et==null)break t;ct=p({},ct,et);break t;case 2:Ns=!0}}et=C.callback,et!==null&&(r.flags|=64,rt&&(r.flags|=8192),rt=m.callbacks,rt===null?m.callbacks=[et]:rt.push(et))}else rt={lane:et,tag:C.tag,payload:C.payload,callback:C.callback,next:null},ot===null?(J=ot=rt,V=ct):ot=ot.next=rt,w|=et;if(C=C.next,C===null){if(C=m.shared.pending,C===null)break;rt=C,C=rt.next,rt.next=null,m.lastBaseUpdate=rt,m.shared.pending=null}}while(!0);ot===null&&(V=ct),m.baseState=V,m.firstBaseUpdate=J,m.lastBaseUpdate=ot,y===null&&(m.shared.lanes=0),Xs|=w,r.lanes=w,r.memoizedState=ct}}function s0(r,a){if(typeof r!="function")throw Error(n(191,r));r.call(a)}function a0(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)s0(l[r],a)}var zo=at(null),ph=at(0);function o0(r,a){r=cs,mt(ph,r),mt(zo,a),cs=r|a.baseLanes}function Mg(){mt(ph,cs),mt(zo,zo.current)}function Pg(){cs=ph.current,pt(zo),pt(ph)}var Fs=0,$t=null,we=null,rn=null,yh=!1,Ho=!1,$a=!1,vh=0,_c=0,Go=null,zC=0;function Qe(){throw Error(n(321))}function Ig(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!_r(r[l],a[l]))return!1;return!0}function kg(r,a,l,u,m,y){return Fs=y,$t=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=r===null||r.memoizedState===null?G0:Y0,$a=!1,y=l(u,m),$a=!1,Ho&&(y=c0(a,l,u,m)),l0(r),y}function l0(r){W.H=Eh;var a=we!==null&&we.next!==null;if(Fs=0,rn=we=$t=null,yh=!1,_c=0,Go=null,a)throw Error(n(300));r===null||_n||(r=r.dependencies,r!==null&&hh(r)&&(_n=!0))}function c0(r,a,l,u){$t=r;var m=0;do{if(Ho&&(Go=null),_c=0,Ho=!1,25<=m)throw Error(n(301));if(m+=1,rn=we=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}W.H=KC,y=a(l,u)}while(Ho);return y}function HC(){var r=W.H,a=r.useState()[0];return a=typeof a.then=="function"?Sc(a):a,r=r.useState()[0],(we!==null?we.memoizedState:null)!==r&&($t.flags|=1024),a}function Vg(){var r=vh!==0;return vh=0,r}function Lg(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function Ng(r){if(yh){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}yh=!1}Fs=0,rn=we=$t=null,Ho=!1,_c=vh=0,Go=null}function sr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?$t.memoizedState=rn=r:rn=rn.next=r,rn}function sn(){if(we===null){var r=$t.alternate;r=r!==null?r.memoizedState:null}else r=we.next;var a=rn===null?$t.memoizedState:rn.next;if(a!==null)rn=a,we=r;else{if(r===null)throw $t.alternate===null?Error(n(467)):Error(n(310));we=r,r={memoizedState:we.memoizedState,baseState:we.baseState,baseQueue:we.baseQueue,queue:we.queue,next:null},rn===null?$t.memoizedState=rn=r:rn=rn.next=r}return rn}function jg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sc(r){var a=_c;return _c+=1,Go===null&&(Go=[]),r=n0(Go,r,a),a=$t,(rn===null?a.memoizedState:rn.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?G0:Y0),r}function _h(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Sc(r);if(r.$$typeof===Z)return jn(r)}throw Error(n(438,String(r)))}function Bg(r){var a=null,l=$t.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=$t.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=jg(),$t.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),u=0;u<r;u++)l[u]=L;return a.index++,l}function rs(r,a){return typeof a=="function"?a(r):a}function Sh(r){var a=sn();return Fg(a,we,r)}function Fg(r,a,l){var u=r.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=l;var m=r.baseQueue,y=u.pending;if(y!==null){if(m!==null){var w=m.next;m.next=y.next,y.next=w}a.baseQueue=m=y,u.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{a=m.next;var C=w=null,V=null,J=a,ot=!1;do{var ct=J.lane&-536870913;if(ct!==J.lane?(oe&ct)===ct:(Fs&ct)===ct){var et=J.revertLane;if(et===0)V!==null&&(V=V.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ct===Fo&&(ot=!0);else if((Fs&et)===et){J=J.next,et===Fo&&(ot=!0);continue}else ct={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(C=V=ct,w=y):V=V.next=ct,$t.lanes|=et,Xs|=et;ct=J.action,$a&&l(y,ct),y=J.hasEagerState?J.eagerState:l(y,ct)}else et={lane:ct,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},V===null?(C=V=et,w=y):V=V.next=et,$t.lanes|=ct,Xs|=ct;J=J.next}while(J!==null&&J!==a);if(V===null?w=y:V.next=C,!_r(y,r.memoizedState)&&(_n=!0,ot&&(l=Uo,l!==null)))throw l;r.memoizedState=y,r.baseState=w,r.baseQueue=V,u.lastRenderedState=y}return m===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Ug(r){var a=sn(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=r;var u=l.dispatch,m=l.pending,y=a.memoizedState;if(m!==null){l.pending=null;var w=m=m.next;do y=r(y,w.action),w=w.next;while(w!==m);_r(y,a.memoizedState)||(_n=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),l.lastRenderedState=y}return[y,u]}function u0(r,a,l){var u=$t,m=sn(),y=ge;if(y){if(l===void 0)throw Error(n(407));l=l()}else l=a();var w=!_r((we||m).memoizedState,l);w&&(m.memoizedState=l,_n=!0),m=m.queue;var C=d0.bind(null,u,m,r);if(bc(2048,8,C,[r]),m.getSnapshot!==a||w||rn!==null&&rn.memoizedState.tag&1){if(u.flags|=2048,Yo(9,bh(),f0.bind(null,u,m,l,a),null),Me===null)throw Error(n(349));y||(Fs&124)!==0||h0(u,a,l)}return l}function h0(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=$t.updateQueue,a===null?(a=jg(),$t.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function f0(r,a,l,u){a.value=l,a.getSnapshot=u,g0(a)&&m0(r)}function d0(r,a,l){return l(function(){g0(a)&&m0(r)})}function g0(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!_r(r,l)}catch{return!0}}function m0(r){var a=Lo(r,2);a!==null&&Cr(a,r,2)}function zg(r){var a=sr();if(typeof r=="function"){var l=r;if(r=l(),$a){Gn(!0);try{l()}finally{Gn(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:r},a}function p0(r,a,l,u){return r.baseState=l,Fg(r,we,typeof u=="function"?u:rs)}function GC(r,a,l,u,m){if(wh(r))throw Error(n(485));if(r=a.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};W.T!==null?l(!0):y.isTransition=!1,u(y),l=a.pending,l===null?(y.next=a.pending=y,y0(a,y)):(y.next=l.next,a.pending=l.next=y)}}function y0(r,a){var l=a.action,u=a.payload,m=r.state;if(a.isTransition){var y=W.T,w={};W.T=w;try{var C=l(m,u),V=W.S;V!==null&&V(w,C),v0(r,a,C)}catch(J){Hg(r,a,J)}finally{W.T=y}}else try{y=l(m,u),v0(r,a,y)}catch(J){Hg(r,a,J)}}function v0(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){_0(r,a,u)},function(u){return Hg(r,a,u)}):_0(r,a,l)}function _0(r,a,l){a.status="fulfilled",a.value=l,S0(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,y0(r,l)))}function Hg(r,a,l){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,S0(a),a=a.next;while(a!==u)}r.action=null}function S0(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function b0(r,a){return a}function T0(r,a){if(ge){var l=Me.formState;if(l!==null){t:{var u=$t;if(ge){if(Ye){e:{for(var m=Ye,y=Ci;m.nodeType!==8;){if(!y){m=null;break e}if(m=ci(m.nextSibling),m===null){m=null;break e}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){Ye=ci(m.nextSibling),u=m.data==="F!";break t}}Xa(u)}u=!1}u&&(a=l[0])}}return l=sr(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:b0,lastRenderedState:a},l.queue=u,l=U0.bind(null,$t,u),u.dispatch=l,u=zg(!1),y=Wg.bind(null,$t,!1,u.queue),u=sr(),m={state:a,dispatch:null,action:r,pending:null},u.queue=m,l=GC.bind(null,$t,m,y,l),m.dispatch=l,u.memoizedState=r,[a,l,!1]}function w0(r){var a=sn();return E0(a,we,r)}function E0(r,a,l){if(a=Fg(r,a,b0)[0],r=Sh(rs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Sc(a)}catch(w){throw w===gc?gh:w}else u=a;a=sn();var m=a.queue,y=m.dispatch;return l!==a.memoizedState&&($t.flags|=2048,Yo(9,bh(),YC.bind(null,m,l),null)),[u,y,r]}function YC(r,a){r.action=a}function C0(r){var a=sn(),l=we;if(l!==null)return E0(a,l,r);sn(),a=a.memoizedState,l=sn();var u=l.queue.dispatch;return l.memoizedState=r,[a,u,!1]}function Yo(r,a,l,u){return r={tag:r,create:l,deps:u,inst:a,next:null},a=$t.updateQueue,a===null&&(a=jg(),$t.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(u=l.next,l.next=r,r.next=u,a.lastEffect=r),r}function bh(){return{destroy:void 0,resource:void 0}}function x0(){return sn().memoizedState}function Th(r,a,l,u){var m=sr();u=u===void 0?null:u,$t.flags|=r,m.memoizedState=Yo(1|a,bh(),l,u)}function bc(r,a,l,u){var m=sn();u=u===void 0?null:u;var y=m.memoizedState.inst;we!==null&&u!==null&&Ig(u,we.memoizedState.deps)?m.memoizedState=Yo(a,y,l,u):($t.flags|=r,m.memoizedState=Yo(1|a,y,l,u))}function A0(r,a){Th(8390656,8,r,a)}function D0(r,a){bc(2048,8,r,a)}function R0(r,a){return bc(4,2,r,a)}function O0(r,a){return bc(4,4,r,a)}function M0(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function P0(r,a,l){l=l!=null?l.concat([r]):null,bc(4,4,M0.bind(null,a,r),l)}function Gg(){}function I0(r,a){var l=sn();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Ig(a,u[1])?u[0]:(l.memoizedState=[r,a],r)}function k0(r,a){var l=sn();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Ig(a,u[1]))return u[0];if(u=r(),$a){Gn(!0);try{r()}finally{Gn(!1)}}return l.memoizedState=[u,a],u}function Yg(r,a,l){return l===void 0||(Fs&1073741824)!==0?r.memoizedState=a:(r.memoizedState=l,r=N_(),$t.lanes|=r,Xs|=r,l)}function V0(r,a,l,u){return _r(l,a)?l:zo.current!==null?(r=Yg(r,l,u),_r(r,a)||(_n=!0),r):(Fs&42)===0?(_n=!0,r.memoizedState=l):(r=N_(),$t.lanes|=r,Xs|=r,a)}function L0(r,a,l,u,m){var y=ft.p;ft.p=y!==0&&8>y?y:8;var w=W.T,C={};W.T=C,Wg(r,!1,a,l);try{var V=m(),J=W.S;if(J!==null&&J(C,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var ot=UC(V,u);Tc(r,a,ot,Er(r))}else Tc(r,a,u,Er(r))}catch(ct){Tc(r,a,{then:function(){},status:"rejected",reason:ct},Er())}finally{ft.p=y,W.T=w}}function qC(){}function qg(r,a,l,u){if(r.tag!==5)throw Error(n(476));var m=N0(r).queue;L0(r,m,a,gt,l===null?qC:function(){return j0(r),l(u)})}function N0(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:gt,baseState:gt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:gt},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function j0(r){var a=N0(r).next.queue;Tc(r,a,{},Er())}function Xg(){return jn(Fc)}function B0(){return sn().memoizedState}function F0(){return sn().memoizedState}function XC(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=Er();r=js(l);var u=Bs(a,r,l);u!==null&&(Cr(u,a,l),pc(u,a,l)),a={cache:wg()},r.payload=a;return}a=a.return}}function WC(r,a,l){var u=Er();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},wh(r)?z0(a,l):(l=dg(r,a,l,u),l!==null&&(Cr(l,r,u),H0(l,a,u)))}function U0(r,a,l){var u=Er();Tc(r,a,l,u)}function Tc(r,a,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(wh(r))z0(a,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var w=a.lastRenderedState,C=y(w,l);if(m.hasEagerState=!0,m.eagerState=C,_r(C,w))return ah(r,a,m,0),Me===null&&sh(),!1}catch{}finally{}if(l=dg(r,a,m,u),l!==null)return Cr(l,r,u),H0(l,a,u),!0}return!1}function Wg(r,a,l,u){if(u={lane:2,revertLane:xm(),action:u,hasEagerState:!1,eagerState:null,next:null},wh(r)){if(a)throw Error(n(479))}else a=dg(r,l,u,2),a!==null&&Cr(a,r,2)}function wh(r){var a=r.alternate;return r===$t||a!==null&&a===$t}function z0(r,a){Ho=yh=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function H0(r,a,l){if((l&4194048)!==0){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,yr(r,l)}}var Eh={readContext:jn,use:_h,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useLayoutEffect:Qe,useInsertionEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useSyncExternalStore:Qe,useId:Qe,useHostTransitionStatus:Qe,useFormState:Qe,useActionState:Qe,useOptimistic:Qe,useMemoCache:Qe,useCacheRefresh:Qe},G0={readContext:jn,use:_h,useCallback:function(r,a){return sr().memoizedState=[r,a===void 0?null:a],r},useContext:jn,useEffect:A0,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,Th(4194308,4,M0.bind(null,a,r),l)},useLayoutEffect:function(r,a){return Th(4194308,4,r,a)},useInsertionEffect:function(r,a){Th(4,2,r,a)},useMemo:function(r,a){var l=sr();a=a===void 0?null:a;var u=r();if($a){Gn(!0);try{r()}finally{Gn(!1)}}return l.memoizedState=[u,a],u},useReducer:function(r,a,l){var u=sr();if(l!==void 0){var m=l(a);if($a){Gn(!0);try{l(a)}finally{Gn(!1)}}}else m=a;return u.memoizedState=u.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},u.queue=r,r=r.dispatch=WC.bind(null,$t,r),[u.memoizedState,r]},useRef:function(r){var a=sr();return r={current:r},a.memoizedState=r},useState:function(r){r=zg(r);var a=r.queue,l=U0.bind(null,$t,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:Gg,useDeferredValue:function(r,a){var l=sr();return Yg(l,r,a)},useTransition:function(){var r=zg(!1);return r=L0.bind(null,$t,r.queue,!0,!1),sr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var u=$t,m=sr();if(ge){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),Me===null)throw Error(n(349));(oe&124)!==0||h0(u,a,l)}m.memoizedState=l;var y={value:l,getSnapshot:a};return m.queue=y,A0(d0.bind(null,u,y,r),[r]),u.flags|=2048,Yo(9,bh(),f0.bind(null,u,y,l,a),null),l},useId:function(){var r=sr(),a=Me.identifierPrefix;if(ge){var l=ts,u=Ji;l=(u&~(1<<32-Cn(u)-1)).toString(32)+l,a="«"+a+"R"+l,l=vh++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=zC++,a="«"+a+"r"+l.toString(32)+"»";return r.memoizedState=a},useHostTransitionStatus:Xg,useFormState:T0,useActionState:T0,useOptimistic:function(r){var a=sr();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Wg.bind(null,$t,!0,l),l.dispatch=a,[r,a]},useMemoCache:Bg,useCacheRefresh:function(){return sr().memoizedState=XC.bind(null,$t)}},Y0={readContext:jn,use:_h,useCallback:I0,useContext:jn,useEffect:D0,useImperativeHandle:P0,useInsertionEffect:R0,useLayoutEffect:O0,useMemo:k0,useReducer:Sh,useRef:x0,useState:function(){return Sh(rs)},useDebugValue:Gg,useDeferredValue:function(r,a){var l=sn();return V0(l,we.memoizedState,r,a)},useTransition:function(){var r=Sh(rs)[0],a=sn().memoizedState;return[typeof r=="boolean"?r:Sc(r),a]},useSyncExternalStore:u0,useId:B0,useHostTransitionStatus:Xg,useFormState:w0,useActionState:w0,useOptimistic:function(r,a){var l=sn();return p0(l,we,r,a)},useMemoCache:Bg,useCacheRefresh:F0},KC={readContext:jn,use:_h,useCallback:I0,useContext:jn,useEffect:D0,useImperativeHandle:P0,useInsertionEffect:R0,useLayoutEffect:O0,useMemo:k0,useReducer:Ug,useRef:x0,useState:function(){return Ug(rs)},useDebugValue:Gg,useDeferredValue:function(r,a){var l=sn();return we===null?Yg(l,r,a):V0(l,we.memoizedState,r,a)},useTransition:function(){var r=Ug(rs)[0],a=sn().memoizedState;return[typeof r=="boolean"?r:Sc(r),a]},useSyncExternalStore:u0,useId:B0,useHostTransitionStatus:Xg,useFormState:C0,useActionState:C0,useOptimistic:function(r,a){var l=sn();return we!==null?p0(l,we,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Bg,useCacheRefresh:F0},qo=null,wc=0;function Ch(r){var a=wc;return wc+=1,qo===null&&(qo=[]),n0(qo,r,a)}function Ec(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function xh(r,a){throw a.$$typeof===v?Error(n(525)):(r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function q0(r){var a=r._init;return a(r._payload)}function X0(r){function a(X,H){if(r){var Q=X.deletions;Q===null?(X.deletions=[H],X.flags|=16):Q.push(H)}}function l(X,H){if(!r)return null;for(;H!==null;)a(X,H),H=H.sibling;return null}function u(X){for(var H=new Map;X!==null;)X.key!==null?H.set(X.key,X):H.set(X.index,X),X=X.sibling;return H}function m(X,H){return X=Zi(X,H),X.index=0,X.sibling=null,X}function y(X,H,Q){return X.index=Q,r?(Q=X.alternate,Q!==null?(Q=Q.index,Q<H?(X.flags|=67108866,H):Q):(X.flags|=67108866,H)):(X.flags|=1048576,H)}function w(X){return r&&X.alternate===null&&(X.flags|=67108866),X}function C(X,H,Q,lt){return H===null||H.tag!==6?(H=mg(Q,X.mode,lt),H.return=X,H):(H=m(H,Q),H.return=X,H)}function V(X,H,Q,lt){var At=Q.type;return At===E?ot(X,H,Q.props.children,lt,Q.key):H!==null&&(H.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===x&&q0(At)===H.type)?(H=m(H,Q.props),Ec(H,Q),H.return=X,H):(H=lh(Q.type,Q.key,Q.props,null,X.mode,lt),Ec(H,Q),H.return=X,H)}function J(X,H,Q,lt){return H===null||H.tag!==4||H.stateNode.containerInfo!==Q.containerInfo||H.stateNode.implementation!==Q.implementation?(H=pg(Q,X.mode,lt),H.return=X,H):(H=m(H,Q.children||[]),H.return=X,H)}function ot(X,H,Q,lt,At){return H===null||H.tag!==7?(H=Ha(Q,X.mode,lt,At),H.return=X,H):(H=m(H,Q),H.return=X,H)}function ct(X,H,Q){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=mg(""+H,X.mode,Q),H.return=X,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case S:return Q=lh(H.type,H.key,H.props,null,X.mode,Q),Ec(Q,H),Q.return=X,Q;case b:return H=pg(H,X.mode,Q),H.return=X,H;case x:var lt=H._init;return H=lt(H._payload),ct(X,H,Q)}if(Pt(H)||F(H))return H=Ha(H,X.mode,Q,null),H.return=X,H;if(typeof H.then=="function")return ct(X,Ch(H),Q);if(H.$$typeof===Z)return ct(X,fh(X,H),Q);xh(X,H)}return null}function et(X,H,Q,lt){var At=H!==null?H.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return At!==null?null:C(X,H,""+Q,lt);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:return Q.key===At?V(X,H,Q,lt):null;case b:return Q.key===At?J(X,H,Q,lt):null;case x:return At=Q._init,Q=At(Q._payload),et(X,H,Q,lt)}if(Pt(Q)||F(Q))return At!==null?null:ot(X,H,Q,lt,null);if(typeof Q.then=="function")return et(X,H,Ch(Q),lt);if(Q.$$typeof===Z)return et(X,H,fh(X,Q),lt);xh(X,Q)}return null}function rt(X,H,Q,lt,At){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return X=X.get(Q)||null,C(H,X,""+lt,At);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case S:return X=X.get(lt.key===null?Q:lt.key)||null,V(H,X,lt,At);case b:return X=X.get(lt.key===null?Q:lt.key)||null,J(H,X,lt,At);case x:var Jt=lt._init;return lt=Jt(lt._payload),rt(X,H,Q,lt,At)}if(Pt(lt)||F(lt))return X=X.get(Q)||null,ot(H,X,lt,At,null);if(typeof lt.then=="function")return rt(X,H,Q,Ch(lt),At);if(lt.$$typeof===Z)return rt(X,H,Q,fh(H,lt),At);xh(H,lt)}return null}function zt(X,H,Q,lt){for(var At=null,Jt=null,Vt=H,Bt=H=0,bn=null;Vt!==null&&Bt<Q.length;Bt++){Vt.index>Bt?(bn=Vt,Vt=null):bn=Vt.sibling;var de=et(X,Vt,Q[Bt],lt);if(de===null){Vt===null&&(Vt=bn);break}r&&Vt&&de.alternate===null&&a(X,Vt),H=y(de,H,Bt),Jt===null?At=de:Jt.sibling=de,Jt=de,Vt=bn}if(Bt===Q.length)return l(X,Vt),ge&&Ya(X,Bt),At;if(Vt===null){for(;Bt<Q.length;Bt++)Vt=ct(X,Q[Bt],lt),Vt!==null&&(H=y(Vt,H,Bt),Jt===null?At=Vt:Jt.sibling=Vt,Jt=Vt);return ge&&Ya(X,Bt),At}for(Vt=u(Vt);Bt<Q.length;Bt++)bn=rt(Vt,X,Bt,Q[Bt],lt),bn!==null&&(r&&bn.alternate!==null&&Vt.delete(bn.key===null?Bt:bn.key),H=y(bn,H,Bt),Jt===null?At=bn:Jt.sibling=bn,Jt=bn);return r&&Vt.forEach(function(na){return a(X,na)}),ge&&Ya(X,Bt),At}function jt(X,H,Q,lt){if(Q==null)throw Error(n(151));for(var At=null,Jt=null,Vt=H,Bt=H=0,bn=null,de=Q.next();Vt!==null&&!de.done;Bt++,de=Q.next()){Vt.index>Bt?(bn=Vt,Vt=null):bn=Vt.sibling;var na=et(X,Vt,de.value,lt);if(na===null){Vt===null&&(Vt=bn);break}r&&Vt&&na.alternate===null&&a(X,Vt),H=y(na,H,Bt),Jt===null?At=na:Jt.sibling=na,Jt=na,Vt=bn}if(de.done)return l(X,Vt),ge&&Ya(X,Bt),At;if(Vt===null){for(;!de.done;Bt++,de=Q.next())de=ct(X,de.value,lt),de!==null&&(H=y(de,H,Bt),Jt===null?At=de:Jt.sibling=de,Jt=de);return ge&&Ya(X,Bt),At}for(Vt=u(Vt);!de.done;Bt++,de=Q.next())de=rt(Vt,X,Bt,de.value,lt),de!==null&&(r&&de.alternate!==null&&Vt.delete(de.key===null?Bt:de.key),H=y(de,H,Bt),Jt===null?At=de:Jt.sibling=de,Jt=de);return r&&Vt.forEach(function(Qx){return a(X,Qx)}),ge&&Ya(X,Bt),At}function Ce(X,H,Q,lt){if(typeof Q=="object"&&Q!==null&&Q.type===E&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:t:{for(var At=Q.key;H!==null;){if(H.key===At){if(At=Q.type,At===E){if(H.tag===7){l(X,H.sibling),lt=m(H,Q.props.children),lt.return=X,X=lt;break t}}else if(H.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===x&&q0(At)===H.type){l(X,H.sibling),lt=m(H,Q.props),Ec(lt,Q),lt.return=X,X=lt;break t}l(X,H);break}else a(X,H);H=H.sibling}Q.type===E?(lt=Ha(Q.props.children,X.mode,lt,Q.key),lt.return=X,X=lt):(lt=lh(Q.type,Q.key,Q.props,null,X.mode,lt),Ec(lt,Q),lt.return=X,X=lt)}return w(X);case b:t:{for(At=Q.key;H!==null;){if(H.key===At)if(H.tag===4&&H.stateNode.containerInfo===Q.containerInfo&&H.stateNode.implementation===Q.implementation){l(X,H.sibling),lt=m(H,Q.children||[]),lt.return=X,X=lt;break t}else{l(X,H);break}else a(X,H);H=H.sibling}lt=pg(Q,X.mode,lt),lt.return=X,X=lt}return w(X);case x:return At=Q._init,Q=At(Q._payload),Ce(X,H,Q,lt)}if(Pt(Q))return zt(X,H,Q,lt);if(F(Q)){if(At=F(Q),typeof At!="function")throw Error(n(150));return Q=At.call(Q),jt(X,H,Q,lt)}if(typeof Q.then=="function")return Ce(X,H,Ch(Q),lt);if(Q.$$typeof===Z)return Ce(X,H,fh(X,Q),lt);xh(X,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,H!==null&&H.tag===6?(l(X,H.sibling),lt=m(H,Q),lt.return=X,X=lt):(l(X,H),lt=mg(Q,X.mode,lt),lt.return=X,X=lt),w(X)):l(X,H)}return function(X,H,Q,lt){try{wc=0;var At=Ce(X,H,Q,lt);return qo=null,At}catch(Vt){if(Vt===gc||Vt===gh)throw Vt;var Jt=Sr(29,Vt,null,X.mode);return Jt.lanes=lt,Jt.return=X,Jt}finally{}}}var Xo=X0(!0),W0=X0(!1),Lr=at(null),xi=null;function Us(r){var a=r.alternate;mt(hn,hn.current&1),mt(Lr,r),xi===null&&(a===null||zo.current!==null||a.memoizedState!==null)&&(xi=r)}function K0(r){if(r.tag===22){if(mt(hn,hn.current),mt(Lr,r),xi===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(xi=r)}}else zs()}function zs(){mt(hn,hn.current),mt(Lr,Lr.current)}function is(r){pt(Lr),xi===r&&(xi=null),pt(hn)}var hn=at(0);function Ah(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||jm(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Kg(r,a,l,u){a=r.memoizedState,l=l(u,a),l=l==null?a:p({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Qg={enqueueSetState:function(r,a,l){r=r._reactInternals;var u=Er(),m=js(u);m.payload=a,l!=null&&(m.callback=l),a=Bs(r,m,u),a!==null&&(Cr(a,r,u),pc(a,r,u))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var u=Er(),m=js(u);m.tag=1,m.payload=a,l!=null&&(m.callback=l),a=Bs(r,m,u),a!==null&&(Cr(a,r,u),pc(a,r,u))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=Er(),u=js(l);u.tag=2,a!=null&&(u.callback=a),a=Bs(r,u,l),a!==null&&(Cr(a,r,l),pc(a,r,l))}};function Q0(r,a,l,u,m,y,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,w):a.prototype&&a.prototype.isPureReactComponent?!ac(l,u)||!ac(m,y):!0}function $0(r,a,l,u){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==r&&Qg.enqueueReplaceState(a,a.state,null)}function Za(r,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(r=r.defaultProps){l===a&&(l=p({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}var Dh=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Z0(r){Dh(r)}function J0(r){console.error(r)}function t_(r){Dh(r)}function Rh(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function e_(r,a,l){try{var u=r.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function $g(r,a,l){return l=js(l),l.tag=3,l.payload={element:null},l.callback=function(){Rh(r,a)},l}function n_(r){return r=js(r),r.tag=3,r}function r_(r,a,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=u.value;r.payload=function(){return m(y)},r.callback=function(){e_(a,l,u)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){e_(a,l,u),typeof m!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var C=u.stack;this.componentDidCatch(u.value,{componentStack:C!==null?C:""})})}function QC(r,a,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&hc(a,l,m,!0),l=Lr.current,l!==null){switch(l.tag){case 13:return xi===null?bm():l.alternate===null&&qe===0&&(qe=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===xg?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),wm(r,u,m)),!1;case 22:return l.flags|=65536,u===xg?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),wm(r,u,m)),!1}throw Error(n(435,l.tag))}return wm(r,u,m),bm(),!1}if(ge)return a=Lr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,u!==_g&&(r=Error(n(422),{cause:u}),uc(Pr(r,l)))):(u!==_g&&(a=Error(n(423),{cause:u}),uc(Pr(a,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,u=Pr(u,l),m=$g(r.stateNode,u,m),Rg(r,m),qe!==4&&(qe=2)),!1;var y=Error(n(520),{cause:u});if(y=Pr(y,l),Mc===null?Mc=[y]:Mc.push(y),qe!==4&&(qe=2),a===null)return!0;u=Pr(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=$g(l.stateNode,u,r),Rg(l,r),!1;case 1:if(a=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ws===null||!Ws.has(y))))return l.flags|=65536,m&=-m,l.lanes|=m,m=n_(m),r_(m,r,l,u),Rg(l,m),!1}l=l.return}while(l!==null);return!1}var i_=Error(n(461)),_n=!1;function An(r,a,l,u){a.child=r===null?W0(a,null,l,u):Xo(a,r.child,l,u)}function s_(r,a,l,u,m){l=l.render;var y=a.ref;if("ref"in u){var w={};for(var C in u)C!=="ref"&&(w[C]=u[C])}else w=u;return Ka(a),u=kg(r,a,l,w,y,m),C=Vg(),r!==null&&!_n?(Lg(r,a,m),ss(r,a,m)):(ge&&C&&yg(a),a.flags|=1,An(r,a,u,m),a.child)}function a_(r,a,l,u,m){if(r===null){var y=l.type;return typeof y=="function"&&!gg(y)&&y.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=y,o_(r,a,y,u,m)):(r=lh(l.type,null,u,a,a.mode,m),r.ref=a.ref,r.return=a,a.child=r)}if(y=r.child,!sm(r,m)){var w=y.memoizedProps;if(l=l.compare,l=l!==null?l:ac,l(w,u)&&r.ref===a.ref)return ss(r,a,m)}return a.flags|=1,r=Zi(y,u),r.ref=a.ref,r.return=a,a.child=r}function o_(r,a,l,u,m){if(r!==null){var y=r.memoizedProps;if(ac(y,u)&&r.ref===a.ref)if(_n=!1,a.pendingProps=u=y,sm(r,m))(r.flags&131072)!==0&&(_n=!0);else return a.lanes=r.lanes,ss(r,a,m)}return Zg(r,a,l,u,m)}function l_(r,a,l){var u=a.pendingProps,m=u.children,y=r!==null?r.memoizedState:null;if(u.mode==="hidden"){if((a.flags&128)!==0){if(u=y!==null?y.baseLanes|l:l,r!==null){for(m=a.child=r.child,y=0;m!==null;)y=y|m.lanes|m.childLanes,m=m.sibling;a.childLanes=y&~u}else a.childLanes=0,a.child=null;return c_(r,a,u,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&dh(a,y!==null?y.cachePool:null),y!==null?o0(a,y):Mg(),K0(a);else return a.lanes=a.childLanes=536870912,c_(r,a,y!==null?y.baseLanes|l:l,l)}else y!==null?(dh(a,y.cachePool),o0(a,y),zs(),a.memoizedState=null):(r!==null&&dh(a,null),Mg(),zs());return An(r,a,m,l),a.child}function c_(r,a,l,u){var m=Cg();return m=m===null?null:{parent:un._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},r!==null&&dh(a,null),Mg(),K0(a),r!==null&&hc(r,a,u,!0),null}function Oh(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function Zg(r,a,l,u,m){return Ka(a),l=kg(r,a,l,u,void 0,m),u=Vg(),r!==null&&!_n?(Lg(r,a,m),ss(r,a,m)):(ge&&u&&yg(a),a.flags|=1,An(r,a,l,m),a.child)}function u_(r,a,l,u,m,y){return Ka(a),a.updateQueue=null,l=c0(a,u,l,m),l0(r),u=Vg(),r!==null&&!_n?(Lg(r,a,y),ss(r,a,y)):(ge&&u&&yg(a),a.flags|=1,An(r,a,l,y),a.child)}function h_(r,a,l,u,m){if(Ka(a),a.stateNode===null){var y=No,w=l.contextType;typeof w=="object"&&w!==null&&(y=jn(w)),y=new l(u,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Qg,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=u,y.state=a.memoizedState,y.refs={},Ag(a),w=l.contextType,y.context=typeof w=="object"&&w!==null?jn(w):No,y.state=a.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Kg(a,l,w,u),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Qg.enqueueReplaceState(y,y.state,null),vc(a,u,y,m),yc(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(r===null){y=a.stateNode;var C=a.memoizedProps,V=Za(l,C);y.props=V;var J=y.context,ot=l.contextType;w=No,typeof ot=="object"&&ot!==null&&(w=jn(ot));var ct=l.getDerivedStateFromProps;ot=typeof ct=="function"||typeof y.getSnapshotBeforeUpdate=="function",C=a.pendingProps!==C,ot||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C||J!==w)&&$0(a,y,u,w),Ns=!1;var et=a.memoizedState;y.state=et,vc(a,u,y,m),yc(),J=a.memoizedState,C||et!==J||Ns?(typeof ct=="function"&&(Kg(a,l,ct,u),J=a.memoizedState),(V=Ns||Q0(a,l,V,u,et,J,w))?(ot||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=J),y.props=u,y.state=J,y.context=w,u=V):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{y=a.stateNode,Dg(r,a),w=a.memoizedProps,ot=Za(l,w),y.props=ot,ct=a.pendingProps,et=y.context,J=l.contextType,V=No,typeof J=="object"&&J!==null&&(V=jn(J)),C=l.getDerivedStateFromProps,(J=typeof C=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==ct||et!==V)&&$0(a,y,u,V),Ns=!1,et=a.memoizedState,y.state=et,vc(a,u,y,m),yc();var rt=a.memoizedState;w!==ct||et!==rt||Ns||r!==null&&r.dependencies!==null&&hh(r.dependencies)?(typeof C=="function"&&(Kg(a,l,C,u),rt=a.memoizedState),(ot=Ns||Q0(a,l,ot,u,et,rt,V)||r!==null&&r.dependencies!==null&&hh(r.dependencies))?(J||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,rt,V),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,rt,V)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&et===r.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&et===r.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=rt),y.props=u,y.state=rt,y.context=V,u=ot):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&et===r.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&et===r.memoizedState||(a.flags|=1024),u=!1)}return y=u,Oh(r,a),u=(a.flags&128)!==0,y||u?(y=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,r!==null&&u?(a.child=Xo(a,r.child,null,m),a.child=Xo(a,null,l,m)):An(r,a,l,m),a.memoizedState=y.state,r=a.child):r=ss(r,a,m),r}function f_(r,a,l,u){return cc(),a.flags|=256,An(r,a,l,u),a.child}var Jg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tm(r){return{baseLanes:r,cachePool:Jv()}}function em(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=Nr),r}function d_(r,a,l){var u=a.pendingProps,m=!1,y=(a.flags&128)!==0,w;if((w=y)||(w=r!==null&&r.memoizedState===null?!1:(hn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,r===null){if(ge){if(m?Us(a):zs(),ge){var C=Ye,V;if(V=C){t:{for(V=C,C=Ci;V.nodeType!==8;){if(!C){C=null;break t}if(V=ci(V.nextSibling),V===null){C=null;break t}}C=V}C!==null?(a.memoizedState={dehydrated:C,treeContext:Ga!==null?{id:Ji,overflow:ts}:null,retryLane:536870912,hydrationErrors:null},V=Sr(18,null,null,0),V.stateNode=C,V.return=a,a.child=V,Kn=a,Ye=null,V=!0):V=!1}V||Xa(a)}if(C=a.memoizedState,C!==null&&(C=C.dehydrated,C!==null))return jm(C)?a.lanes=32:a.lanes=536870912,null;is(a)}return C=u.children,u=u.fallback,m?(zs(),m=a.mode,C=Mh({mode:"hidden",children:C},m),u=Ha(u,m,l,null),C.return=a,u.return=a,C.sibling=u,a.child=C,m=a.child,m.memoizedState=tm(l),m.childLanes=em(r,w,l),a.memoizedState=Jg,u):(Us(a),nm(a,C))}if(V=r.memoizedState,V!==null&&(C=V.dehydrated,C!==null)){if(y)a.flags&256?(Us(a),a.flags&=-257,a=rm(r,a,l)):a.memoizedState!==null?(zs(),a.child=r.child,a.flags|=128,a=null):(zs(),m=u.fallback,C=a.mode,u=Mh({mode:"visible",children:u.children},C),m=Ha(m,C,l,null),m.flags|=2,u.return=a,m.return=a,u.sibling=m,a.child=u,Xo(a,r.child,null,l),u=a.child,u.memoizedState=tm(l),u.childLanes=em(r,w,l),a.memoizedState=Jg,a=m);else if(Us(a),jm(C)){if(w=C.nextSibling&&C.nextSibling.dataset,w)var J=w.dgst;w=J,u=Error(n(419)),u.stack="",u.digest=w,uc({value:u,source:null,stack:null}),a=rm(r,a,l)}else if(_n||hc(r,a,l,!1),w=(l&r.childLanes)!==0,_n||w){if(w=Me,w!==null&&(u=l&-l,u=(u&42)!==0?1:bi(u),u=(u&(w.suspendedLanes|l))!==0?0:u,u!==0&&u!==V.retryLane))throw V.retryLane=u,Lo(r,u),Cr(w,r,u),i_;C.data==="$?"||bm(),a=rm(r,a,l)}else C.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=V.treeContext,Ye=ci(C.nextSibling),Kn=a,ge=!0,qa=null,Ci=!1,r!==null&&(kr[Vr++]=Ji,kr[Vr++]=ts,kr[Vr++]=Ga,Ji=r.id,ts=r.overflow,Ga=a),a=nm(a,u.children),a.flags|=4096);return a}return m?(zs(),m=u.fallback,C=a.mode,V=r.child,J=V.sibling,u=Zi(V,{mode:"hidden",children:u.children}),u.subtreeFlags=V.subtreeFlags&65011712,J!==null?m=Zi(J,m):(m=Ha(m,C,l,null),m.flags|=2),m.return=a,u.return=a,u.sibling=m,a.child=u,u=m,m=a.child,C=r.child.memoizedState,C===null?C=tm(l):(V=C.cachePool,V!==null?(J=un._currentValue,V=V.parent!==J?{parent:J,pool:J}:V):V=Jv(),C={baseLanes:C.baseLanes|l,cachePool:V}),m.memoizedState=C,m.childLanes=em(r,w,l),a.memoizedState=Jg,u):(Us(a),l=r.child,r=l.sibling,l=Zi(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,r!==null&&(w=a.deletions,w===null?(a.deletions=[r],a.flags|=16):w.push(r)),a.child=l,a.memoizedState=null,l)}function nm(r,a){return a=Mh({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Mh(r,a){return r=Sr(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function rm(r,a,l){return Xo(a,r.child,null,l),r=nm(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function g_(r,a,l){r.lanes|=a;var u=r.alternate;u!==null&&(u.lanes|=a),bg(r.return,a,l)}function im(r,a,l,u,m){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(y.isBackwards=a,y.rendering=null,y.renderingStartTime=0,y.last=u,y.tail=l,y.tailMode=m)}function m_(r,a,l){var u=a.pendingProps,m=u.revealOrder,y=u.tail;if(An(r,a,u.children,l),u=hn.current,(u&2)!==0)u=u&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)t:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&g_(r,l,a);else if(r.tag===19)g_(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break t;for(;r.sibling===null;){if(r.return===null||r.return===a)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}u&=1}switch(mt(hn,u),m){case"forwards":for(l=a.child,m=null;l!==null;)r=l.alternate,r!==null&&Ah(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=a.child,a.child=null):(m=l.sibling,l.sibling=null),im(a,!1,m,l,y);break;case"backwards":for(l=null,m=a.child,a.child=null;m!==null;){if(r=m.alternate,r!==null&&Ah(r)===null){a.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}im(a,!0,l,null,y);break;case"together":im(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ss(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),Xs|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(hc(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,l=Zi(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=Zi(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function sm(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&hh(r)))}function $C(r,a,l){switch(a.tag){case 3:Wt(a,a.stateNode.containerInfo),Ls(a,un,r.memoizedState.cache),cc();break;case 27:case 5:ae(a);break;case 4:Wt(a,a.stateNode.containerInfo);break;case 10:Ls(a,a.type,a.memoizedProps.value);break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Us(a),a.flags|=128,null):(l&a.child.childLanes)!==0?d_(r,a,l):(Us(a),r=ss(r,a,l),r!==null?r.sibling:null);Us(a);break;case 19:var m=(r.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(hc(r,a,l,!1),u=(l&a.childLanes)!==0),m){if(u)return m_(r,a,l);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),mt(hn,hn.current),u)break;return null;case 22:case 23:return a.lanes=0,l_(r,a,l);case 24:Ls(a,un,r.memoizedState.cache)}return ss(r,a,l)}function p_(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)_n=!0;else{if(!sm(r,l)&&(a.flags&128)===0)return _n=!1,$C(r,a,l);_n=(r.flags&131072)!==0}else _n=!1,ge&&(a.flags&1048576)!==0&&qv(a,uh,a.index);switch(a.lanes=0,a.tag){case 16:t:{r=a.pendingProps;var u=a.elementType,m=u._init;if(u=m(u._payload),a.type=u,typeof u=="function")gg(u)?(r=Za(u,r),a.tag=1,a=h_(null,a,u,r,l)):(a.tag=0,a=Zg(null,a,u,r,l));else{if(u!=null){if(m=u.$$typeof,m===q){a.tag=11,a=s_(null,a,u,r,l);break t}else if(m===P){a.tag=14,a=a_(null,a,u,r,l);break t}}throw a=vt(u)||u,Error(n(306,a,""))}}return a;case 0:return Zg(r,a,a.type,a.pendingProps,l);case 1:return u=a.type,m=Za(u,a.pendingProps),h_(r,a,u,m,l);case 3:t:{if(Wt(a,a.stateNode.containerInfo),r===null)throw Error(n(387));u=a.pendingProps;var y=a.memoizedState;m=y.element,Dg(r,a),vc(a,u,null,l);var w=a.memoizedState;if(u=w.cache,Ls(a,un,u),u!==y.cache&&Tg(a,[un],l,!0),yc(),u=w.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=f_(r,a,u,l);break t}else if(u!==m){m=Pr(Error(n(424)),a),uc(m),a=f_(r,a,u,l);break t}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ye=ci(r.firstChild),Kn=a,ge=!0,qa=null,Ci=!0,l=W0(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(cc(),u===m){a=ss(r,a,l);break t}An(r,a,u,l)}a=a.child}return a;case 26:return Oh(r,a),r===null?(l=SS(a.type,null,a.pendingProps,null))?a.memoizedState=l:ge||(l=a.type,r=a.pendingProps,u=Yh(Et.current).createElement(l),u[tt]=a,u[ht]=r,Rn(u,l,r),ee(u),a.stateNode=u):a.memoizedState=SS(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return ae(a),r===null&&ge&&(u=a.stateNode=yS(a.type,a.pendingProps,Et.current),Kn=a,Ci=!0,m=Ye,$s(a.type)?(Bm=m,Ye=ci(u.firstChild)):Ye=m),An(r,a,a.pendingProps.children,l),Oh(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&ge&&((m=u=Ye)&&(u=Cx(u,a.type,a.pendingProps,Ci),u!==null?(a.stateNode=u,Kn=a,Ye=ci(u.firstChild),Ci=!1,m=!0):m=!1),m||Xa(a)),ae(a),m=a.type,y=a.pendingProps,w=r!==null?r.memoizedProps:null,u=y.children,Vm(m,y)?u=null:w!==null&&Vm(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=kg(r,a,HC,null,null,l),Fc._currentValue=m),Oh(r,a),An(r,a,u,l),a.child;case 6:return r===null&&ge&&((r=l=Ye)&&(l=xx(l,a.pendingProps,Ci),l!==null?(a.stateNode=l,Kn=a,Ye=null,r=!0):r=!1),r||Xa(a)),null;case 13:return d_(r,a,l);case 4:return Wt(a,a.stateNode.containerInfo),u=a.pendingProps,r===null?a.child=Xo(a,null,u,l):An(r,a,u,l),a.child;case 11:return s_(r,a,a.type,a.pendingProps,l);case 7:return An(r,a,a.pendingProps,l),a.child;case 8:return An(r,a,a.pendingProps.children,l),a.child;case 12:return An(r,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,Ls(a,a.type,u.value),An(r,a,u.children,l),a.child;case 9:return m=a.type._context,u=a.pendingProps.children,Ka(a),m=jn(m),u=u(m),a.flags|=1,An(r,a,u,l),a.child;case 14:return a_(r,a,a.type,a.pendingProps,l);case 15:return o_(r,a,a.type,a.pendingProps,l);case 19:return m_(r,a,l);case 31:return u=a.pendingProps,l=a.mode,u={mode:u.mode,children:u.children},r===null?(l=Mh(u,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=Zi(r.child,u),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return l_(r,a,l);case 24:return Ka(a),u=jn(un),r===null?(m=Cg(),m===null&&(m=Me,y=wg(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=l),m=y),a.memoizedState={parent:u,cache:m},Ag(a),Ls(a,un,m)):((r.lanes&l)!==0&&(Dg(r,a),vc(a,null,null,l),yc()),m=r.memoizedState,y=a.memoizedState,m.parent!==u?(m={parent:u,cache:u},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ls(a,un,u)):(u=y.cache,Ls(a,un,u),u!==m.cache&&Tg(a,[un],l,!0))),An(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function as(r){r.flags|=4}function y_(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!CS(a)){if(a=Lr.current,a!==null&&((oe&4194048)===oe?xi!==null:(oe&62914560)!==oe&&(oe&536870912)===0||a!==xi))throw mc=xg,t0;r.flags|=8192}}function Ph(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Dr():536870912,r.lanes|=a,$o|=a)}function Cc(r,a){if(!ge)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function Ue(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,u=0;if(a)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=u,r.childLanes=l,a}function ZC(r,a,l){var u=a.pendingProps;switch(vg(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(a),null;case 1:return Ue(a),null;case 3:return l=a.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),ns(un),Be(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(lc(a)?as(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Kv())),Ue(a),null;case 26:return l=a.memoizedState,r===null?(as(a),l!==null?(Ue(a),y_(a,l)):(Ue(a),a.flags&=-16777217)):l?l!==r.memoizedState?(as(a),Ue(a),y_(a,l)):(Ue(a),a.flags&=-16777217):(r.memoizedProps!==u&&as(a),Ue(a),a.flags&=-16777217),null;case 27:mr(a),l=Et.current;var m=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==u&&as(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return Ue(a),null}r=St.current,lc(a)?Xv(a):(r=yS(m,u,l),a.stateNode=r,as(a))}return Ue(a),null;case 5:if(mr(a),l=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&as(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return Ue(a),null}if(r=St.current,lc(a))Xv(a);else{switch(m=Yh(Et.current),r){case 1:r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":r=m.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?r.multiple=!0:u.size&&(r.size=u.size);break;default:r=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}r[tt]=a,r[ht]=u;t:for(m=a.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break t;for(;m.sibling===null;){if(m.return===null||m.return===a)break t;m=m.return}m.sibling.return=m.return,m=m.sibling}a.stateNode=r;t:switch(Rn(r,l,u),l){case"button":case"input":case"select":case"textarea":r=!!u.autoFocus;break t;case"img":r=!0;break t;default:r=!1}r&&as(a)}}return Ue(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==u&&as(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(n(166));if(r=Et.current,lc(a)){if(r=a.stateNode,l=a.memoizedProps,u=null,m=Kn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}r[tt]=a,r=!!(r.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||uS(r.nodeValue,l)),r||Xa(a)}else r=Yh(r).createTextNode(u),r[tt]=a,a.stateNode=r}return Ue(a),null;case 13:if(u=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=lc(a),u!==null&&u.dehydrated!==null){if(r===null){if(!m)throw Error(n(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[tt]=a}else cc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ue(a),m=!1}else m=Kv(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(is(a),a):(is(a),null)}if(is(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=u!==null,r=r!==null&&r.memoizedState!==null,l){u=a.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var y=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==m&&(u.flags|=2048)}return l!==r&&l&&(a.child.flags|=8192),Ph(a,a.updateQueue),Ue(a),null;case 4:return Be(),r===null&&Om(a.stateNode.containerInfo),Ue(a),null;case 10:return ns(a.type),Ue(a),null;case 19:if(pt(hn),m=a.memoizedState,m===null)return Ue(a),null;if(u=(a.flags&128)!==0,y=m.rendering,y===null)if(u)Cc(m,!1);else{if(qe!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(y=Ah(r),y!==null){for(a.flags|=128,Cc(m,!1),r=y.updateQueue,a.updateQueue=r,Ph(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)Yv(l,r),l=l.sibling;return mt(hn,hn.current&1|2),a.child}r=r.sibling}m.tail!==null&&En()>Vh&&(a.flags|=128,u=!0,Cc(m,!1),a.lanes=4194304)}else{if(!u)if(r=Ah(y),r!==null){if(a.flags|=128,u=!0,r=r.updateQueue,a.updateQueue=r,Ph(a,r),Cc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!y.alternate&&!ge)return Ue(a),null}else 2*En()-m.renderingStartTime>Vh&&l!==536870912&&(a.flags|=128,u=!0,Cc(m,!1),a.lanes=4194304);m.isBackwards?(y.sibling=a.child,a.child=y):(r=m.last,r!==null?r.sibling=y:a.child=y,m.last=y)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=En(),a.sibling=null,r=hn.current,mt(hn,u?r&1|2:r&1),a):(Ue(a),null);case 22:case 23:return is(a),Pg(),u=a.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Ue(a),a.subtreeFlags&6&&(a.flags|=8192)):Ue(a),l=a.updateQueue,l!==null&&Ph(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),r!==null&&pt(Qa),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),ns(un),Ue(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function JC(r,a){switch(vg(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return ns(un),Be(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return mr(a),null;case 13:if(is(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));cc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return pt(hn),null;case 4:return Be(),null;case 10:return ns(a.type),null;case 22:case 23:return is(a),Pg(),r!==null&&pt(Qa),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return ns(un),null;case 25:return null;default:return null}}function v_(r,a){switch(vg(a),a.tag){case 3:ns(un),Be();break;case 26:case 27:case 5:mr(a);break;case 4:Be();break;case 13:is(a);break;case 19:pt(hn);break;case 10:ns(a.type);break;case 22:case 23:is(a),Pg(),r!==null&&pt(Qa);break;case 24:ns(un)}}function xc(r,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&r)===r){u=void 0;var y=l.create,w=l.inst;u=y(),w.destroy=u}l=l.next}while(l!==m)}}catch(C){Ae(a,a.return,C)}}function Hs(r,a,l){try{var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var y=m.next;u=y;do{if((u.tag&r)===r){var w=u.inst,C=w.destroy;if(C!==void 0){w.destroy=void 0,m=a;var V=l,J=C;try{J()}catch(ot){Ae(m,V,ot)}}}u=u.next}while(u!==y)}}catch(ot){Ae(a,a.return,ot)}}function __(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{a0(a,l)}catch(u){Ae(r,r.return,u)}}}function S_(r,a,l){l.props=Za(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(u){Ae(r,a,u)}}function Ac(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof l=="function"?r.refCleanup=l(u):l.current=u}}catch(m){Ae(r,a,m)}}function Ai(r,a){var l=r.ref,u=r.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){Ae(r,a,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Ae(r,a,m)}else l.current=null}function b_(r){var a=r.type,l=r.memoizedProps,u=r.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break t;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){Ae(r,r.return,m)}}function am(r,a,l){try{var u=r.stateNode;Sx(u,r.type,l,a),u[ht]=a}catch(m){Ae(r,r.return,m)}}function T_(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&$s(r.type)||r.tag===4}function om(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||T_(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&$s(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function lm(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Gh));else if(u!==4&&(u===27&&$s(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(lm(r,a,l),r=r.sibling;r!==null;)lm(r,a,l),r=r.sibling}function Ih(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(u!==4&&(u===27&&$s(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(Ih(r,a,l),r=r.sibling;r!==null;)Ih(r,a,l),r=r.sibling}function w_(r){var a=r.stateNode,l=r.memoizedProps;try{for(var u=r.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Rn(a,u,l),a[tt]=r,a[ht]=l}catch(y){Ae(r,r.return,y)}}var os=!1,$e=!1,cm=!1,E_=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function tx(r,a){if(r=r.containerInfo,Im=$h,r=Vv(r),og(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else t:{l=(l=r.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break t}var w=0,C=-1,V=-1,J=0,ot=0,ct=r,et=null;e:for(;;){for(var rt;ct!==l||m!==0&&ct.nodeType!==3||(C=w+m),ct!==y||u!==0&&ct.nodeType!==3||(V=w+u),ct.nodeType===3&&(w+=ct.nodeValue.length),(rt=ct.firstChild)!==null;)et=ct,ct=rt;for(;;){if(ct===r)break e;if(et===l&&++J===m&&(C=w),et===y&&++ot===u&&(V=w),(rt=ct.nextSibling)!==null)break;ct=et,et=ct.parentNode}ct=rt}l=C===-1||V===-1?null:{start:C,end:V}}else l=null}l=l||{start:0,end:0}}else l=null;for(km={focusedElem:r,selectionRange:l},$h=!1,Sn=a;Sn!==null;)if(a=Sn,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,Sn=r;else for(;Sn!==null;){switch(a=Sn,y=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=a,m=y.memoizedProps,y=y.memoizedState,u=l.stateNode;try{var zt=Za(l.type,m,l.elementType===l.type);r=u.getSnapshotBeforeUpdate(zt,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(jt){Ae(l,l.return,jt)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)Nm(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Nm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=a.sibling,r!==null){r.return=a.return,Sn=r;break}Sn=a.return}}function C_(r,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Gs(r,l),u&4&&xc(5,l);break;case 1:if(Gs(r,l),u&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(w){Ae(l,l.return,w)}else{var m=Za(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(m,a,r.__reactInternalSnapshotBeforeUpdate)}catch(w){Ae(l,l.return,w)}}u&64&&__(l),u&512&&Ac(l,l.return);break;case 3:if(Gs(r,l),u&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{a0(r,a)}catch(w){Ae(l,l.return,w)}}break;case 27:a===null&&u&4&&w_(l);case 26:case 5:Gs(r,l),a===null&&u&4&&b_(l),u&512&&Ac(l,l.return);break;case 12:Gs(r,l);break;case 13:Gs(r,l),u&4&&D_(r,l),u&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=cx.bind(null,l),Ax(r,l))));break;case 22:if(u=l.memoizedState!==null||os,!u){a=a!==null&&a.memoizedState!==null||$e,m=os;var y=$e;os=u,($e=a)&&!y?Ys(r,l,(l.subtreeFlags&8772)!==0):Gs(r,l),os=m,$e=y}break;case 30:break;default:Gs(r,l)}}function x_(r){var a=r.alternate;a!==null&&(r.alternate=null,x_(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&Mt(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ne=null,ar=!1;function ls(r,a,l){for(l=l.child;l!==null;)A_(r,a,l),l=l.sibling}function A_(r,a,l){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(pn,l)}catch{}switch(l.tag){case 26:$e||Ai(l,a),ls(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:$e||Ai(l,a);var u=Ne,m=ar;$s(l.type)&&(Ne=l.stateNode,ar=!1),ls(r,a,l),Lc(l.stateNode),Ne=u,ar=m;break;case 5:$e||Ai(l,a);case 6:if(u=Ne,m=ar,Ne=null,ls(r,a,l),Ne=u,ar=m,Ne!==null)if(ar)try{(Ne.nodeType===9?Ne.body:Ne.nodeName==="HTML"?Ne.ownerDocument.body:Ne).removeChild(l.stateNode)}catch(y){Ae(l,a,y)}else try{Ne.removeChild(l.stateNode)}catch(y){Ae(l,a,y)}break;case 18:Ne!==null&&(ar?(r=Ne,mS(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Gc(r)):mS(Ne,l.stateNode));break;case 4:u=Ne,m=ar,Ne=l.stateNode.containerInfo,ar=!0,ls(r,a,l),Ne=u,ar=m;break;case 0:case 11:case 14:case 15:$e||Hs(2,l,a),$e||Hs(4,l,a),ls(r,a,l);break;case 1:$e||(Ai(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&S_(l,a,u)),ls(r,a,l);break;case 21:ls(r,a,l);break;case 22:$e=(u=$e)||l.memoizedState!==null,ls(r,a,l),$e=u;break;default:ls(r,a,l)}}function D_(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Gc(r)}catch(l){Ae(a,a.return,l)}}function ex(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new E_),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new E_),a;default:throw Error(n(435,r.tag))}}function um(r,a){var l=ex(r);a.forEach(function(u){var m=ux.bind(null,r,u);l.has(u)||(l.add(u),u.then(m,m))})}function br(r,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],y=r,w=a,C=w;t:for(;C!==null;){switch(C.tag){case 27:if($s(C.type)){Ne=C.stateNode,ar=!1;break t}break;case 5:Ne=C.stateNode,ar=!1;break t;case 3:case 4:Ne=C.stateNode.containerInfo,ar=!0;break t}C=C.return}if(Ne===null)throw Error(n(160));A_(y,w,m),Ne=null,ar=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)R_(a,r),a=a.sibling}var li=null;function R_(r,a){var l=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:br(a,r),Tr(r),u&4&&(Hs(3,r,r.return),xc(3,r),Hs(5,r,r.return));break;case 1:br(a,r),Tr(r),u&512&&($e||l===null||Ai(l,l.return)),u&64&&os&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=li;if(br(a,r),Tr(r),u&512&&($e||l===null||Ai(l,l.return)),u&4){var y=l!==null?l.memoizedState:null;if(u=r.memoizedState,l===null)if(u===null)if(r.stateNode===null){t:{u=r.type,l=r.memoizedProps,m=m.ownerDocument||m;e:switch(u){case"title":y=m.getElementsByTagName("title")[0],(!y||y[kt]||y[tt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(u),m.head.insertBefore(y,m.querySelector("head > title"))),Rn(y,u,l),y[tt]=r,ee(y),u=y;break t;case"link":var w=wS("link","href",m).get(u+(l.href||""));if(w){for(var C=0;C<w.length;C++)if(y=w[C],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(C,1);break e}}y=m.createElement(u),Rn(y,u,l),m.head.appendChild(y);break;case"meta":if(w=wS("meta","content",m).get(u+(l.content||""))){for(C=0;C<w.length;C++)if(y=w[C],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(C,1);break e}}y=m.createElement(u),Rn(y,u,l),m.head.appendChild(y);break;default:throw Error(n(468,u))}y[tt]=r,ee(y),u=y}r.stateNode=u}else ES(m,r.type,r.stateNode);else r.stateNode=TS(m,u,r.memoizedProps);else y!==u?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,u===null?ES(m,r.type,r.stateNode):TS(m,u,r.memoizedProps)):u===null&&r.stateNode!==null&&am(r,r.memoizedProps,l.memoizedProps)}break;case 27:br(a,r),Tr(r),u&512&&($e||l===null||Ai(l,l.return)),l!==null&&u&4&&am(r,r.memoizedProps,l.memoizedProps);break;case 5:if(br(a,r),Tr(r),u&512&&($e||l===null||Ai(l,l.return)),r.flags&32){m=r.stateNode;try{Or(m,"")}catch(rt){Ae(r,r.return,rt)}}u&4&&r.stateNode!=null&&(m=r.memoizedProps,am(r,m,l!==null?l.memoizedProps:m)),u&1024&&(cm=!0);break;case 6:if(br(a,r),Tr(r),u&4){if(r.stateNode===null)throw Error(n(162));u=r.memoizedProps,l=r.stateNode;try{l.nodeValue=u}catch(rt){Ae(r,r.return,rt)}}break;case 3:if(Wh=null,m=li,li=qh(a.containerInfo),br(a,r),li=m,Tr(r),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Gc(a.containerInfo)}catch(rt){Ae(r,r.return,rt)}cm&&(cm=!1,O_(r));break;case 4:u=li,li=qh(r.stateNode.containerInfo),br(a,r),Tr(r),li=u;break;case 12:br(a,r),Tr(r);break;case 13:br(a,r),Tr(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(pm=En()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,um(r,u)));break;case 22:m=r.memoizedState!==null;var V=l!==null&&l.memoizedState!==null,J=os,ot=$e;if(os=J||m,$e=ot||V,br(a,r),$e=ot,os=J,Tr(r),u&8192)t:for(a=r.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(l===null||V||os||$e||Ja(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){V=l=a;try{if(y=V.stateNode,m)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{C=V.stateNode;var ct=V.memoizedProps.style,et=ct!=null&&ct.hasOwnProperty("display")?ct.display:null;C.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(rt){Ae(V,V.return,rt)}}}else if(a.tag===6){if(l===null){V=a;try{V.stateNode.nodeValue=m?"":V.memoizedProps}catch(rt){Ae(V,V.return,rt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break t;for(;a.sibling===null;){if(a.return===null||a.return===r)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=r.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,um(r,l))));break;case 19:br(a,r),Tr(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,um(r,u)));break;case 30:break;case 21:break;default:br(a,r),Tr(r)}}function Tr(r){var a=r.flags;if(a&2){try{for(var l,u=r.return;u!==null;){if(T_(u)){l=u;break}u=u.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var m=l.stateNode,y=om(r);Ih(r,y,m);break;case 5:var w=l.stateNode;l.flags&32&&(Or(w,""),l.flags&=-33);var C=om(r);Ih(r,C,w);break;case 3:case 4:var V=l.stateNode.containerInfo,J=om(r);lm(r,J,V);break;default:throw Error(n(161))}}catch(ot){Ae(r,r.return,ot)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function O_(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;O_(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Gs(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)C_(r,a.alternate,a),a=a.sibling}function Ja(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Hs(4,a,a.return),Ja(a);break;case 1:Ai(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&S_(a,a.return,l),Ja(a);break;case 27:Lc(a.stateNode);case 26:case 5:Ai(a,a.return),Ja(a);break;case 22:a.memoizedState===null&&Ja(a);break;case 30:Ja(a);break;default:Ja(a)}r=r.sibling}}function Ys(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,m=r,y=a,w=y.flags;switch(y.tag){case 0:case 11:case 15:Ys(m,y,l),xc(4,y);break;case 1:if(Ys(m,y,l),u=y,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(J){Ae(u,u.return,J)}if(u=y,m=u.updateQueue,m!==null){var C=u.stateNode;try{var V=m.shared.hiddenCallbacks;if(V!==null)for(m.shared.hiddenCallbacks=null,m=0;m<V.length;m++)s0(V[m],C)}catch(J){Ae(u,u.return,J)}}l&&w&64&&__(y),Ac(y,y.return);break;case 27:w_(y);case 26:case 5:Ys(m,y,l),l&&u===null&&w&4&&b_(y),Ac(y,y.return);break;case 12:Ys(m,y,l);break;case 13:Ys(m,y,l),l&&w&4&&D_(m,y);break;case 22:y.memoizedState===null&&Ys(m,y,l),Ac(y,y.return);break;case 30:break;default:Ys(m,y,l)}a=a.sibling}}function hm(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&fc(l))}function fm(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&fc(r))}function Di(r,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)M_(r,a,l,u),a=a.sibling}function M_(r,a,l,u){var m=a.flags;switch(a.tag){case 0:case 11:case 15:Di(r,a,l,u),m&2048&&xc(9,a);break;case 1:Di(r,a,l,u);break;case 3:Di(r,a,l,u),m&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&fc(r)));break;case 12:if(m&2048){Di(r,a,l,u),r=a.stateNode;try{var y=a.memoizedProps,w=y.id,C=y.onPostCommit;typeof C=="function"&&C(w,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(V){Ae(a,a.return,V)}}else Di(r,a,l,u);break;case 13:Di(r,a,l,u);break;case 23:break;case 22:y=a.stateNode,w=a.alternate,a.memoizedState!==null?y._visibility&2?Di(r,a,l,u):Dc(r,a):y._visibility&2?Di(r,a,l,u):(y._visibility|=2,Wo(r,a,l,u,(a.subtreeFlags&10256)!==0)),m&2048&&hm(w,a);break;case 24:Di(r,a,l,u),m&2048&&fm(a.alternate,a);break;default:Di(r,a,l,u)}}function Wo(r,a,l,u,m){for(m=m&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var y=r,w=a,C=l,V=u,J=w.flags;switch(w.tag){case 0:case 11:case 15:Wo(y,w,C,V,m),xc(8,w);break;case 23:break;case 22:var ot=w.stateNode;w.memoizedState!==null?ot._visibility&2?Wo(y,w,C,V,m):Dc(y,w):(ot._visibility|=2,Wo(y,w,C,V,m)),m&&J&2048&&hm(w.alternate,w);break;case 24:Wo(y,w,C,V,m),m&&J&2048&&fm(w.alternate,w);break;default:Wo(y,w,C,V,m)}a=a.sibling}}function Dc(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,u=a,m=u.flags;switch(u.tag){case 22:Dc(l,u),m&2048&&hm(u.alternate,u);break;case 24:Dc(l,u),m&2048&&fm(u.alternate,u);break;default:Dc(l,u)}a=a.sibling}}var Rc=8192;function Ko(r){if(r.subtreeFlags&Rc)for(r=r.child;r!==null;)P_(r),r=r.sibling}function P_(r){switch(r.tag){case 26:Ko(r),r.flags&Rc&&r.memoizedState!==null&&Fx(li,r.memoizedState,r.memoizedProps);break;case 5:Ko(r);break;case 3:case 4:var a=li;li=qh(r.stateNode.containerInfo),Ko(r),li=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=Rc,Rc=16777216,Ko(r),Rc=a):Ko(r));break;default:Ko(r)}}function I_(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Oc(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Sn=u,V_(u,r)}I_(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)k_(r),r=r.sibling}function k_(r){switch(r.tag){case 0:case 11:case 15:Oc(r),r.flags&2048&&Hs(9,r,r.return);break;case 3:Oc(r);break;case 12:Oc(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,kh(r)):Oc(r);break;default:Oc(r)}}function kh(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Sn=u,V_(u,r)}I_(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Hs(8,a,a.return),kh(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,kh(a));break;default:kh(a)}r=r.sibling}}function V_(r,a){for(;Sn!==null;){var l=Sn;switch(l.tag){case 0:case 11:case 15:Hs(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:fc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Sn=u;else t:for(l=r;Sn!==null;){u=Sn;var m=u.sibling,y=u.return;if(x_(u),u===l){Sn=null;break t}if(m!==null){m.return=y,Sn=m;break t}Sn=y}}}var nx={getCacheForType:function(r){var a=jn(un),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l}},rx=typeof WeakMap=="function"?WeakMap:Map,_e=0,Me=null,ne=null,oe=0,Se=0,wr=null,qs=!1,Qo=!1,dm=!1,cs=0,qe=0,Xs=0,to=0,gm=0,Nr=0,$o=0,Mc=null,or=null,mm=!1,pm=0,Vh=1/0,Lh=null,Ws=null,Dn=0,Ks=null,Zo=null,Jo=0,ym=0,vm=null,L_=null,Pc=0,_m=null;function Er(){if((_e&2)!==0&&oe!==0)return oe&-oe;if(W.T!==null){var r=Fo;return r!==0?r:xm()}return ni()}function N_(){Nr===0&&(Nr=(oe&536870912)===0||ge?xs():536870912);var r=Lr.current;return r!==null&&(r.flags|=32),Nr}function Cr(r,a,l){(r===Me&&(Se===2||Se===9)||r.cancelPendingCommit!==null)&&(tl(r,0),Qs(r,oe,Nr,!1)),Le(r,l),((_e&2)===0||r!==Me)&&(r===Me&&((_e&2)===0&&(to|=l),qe===4&&Qs(r,oe,Nr,!1)),Ri(r))}function j_(r,a,l){if((_e&6)!==0)throw Error(n(327));var u=!l&&(a&124)===0&&(a&r.expiredLanes)===0||Jr(r,a),m=u?ax(r,a):Tm(r,a,!0),y=u;do{if(m===0){Qo&&!u&&Qs(r,a,0,!1);break}else{if(l=r.current.alternate,y&&!ix(l)){m=Tm(r,a,!1),y=!1;continue}if(m===2){if(y=a,r.errorRecoveryDisabledLanes&y)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;t:{var C=r;m=Mc;var V=C.current.memoizedState.isDehydrated;if(V&&(tl(C,w).flags|=256),w=Tm(C,w,!1),w!==2){if(dm&&!V){C.errorRecoveryDisabledLanes|=y,to|=y,m=4;break t}y=or,or=m,y!==null&&(or===null?or=y:or.push.apply(or,y))}m=w}if(y=!1,m!==2)continue}}if(m===1){tl(r,0),Qs(r,a,0,!0);break}t:{switch(u=r,y=m,y){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Qs(u,a,Nr,!qs);break t;case 2:or=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(m=pm+300-En(),10<m)){if(Qs(u,a,Nr,!qs),nr(u,0,!0)!==0)break t;u.timeoutHandle=dS(B_.bind(null,u,l,or,Lh,mm,a,Nr,to,$o,qs,y,2,-0,0),m);break t}B_(u,l,or,Lh,mm,a,Nr,to,$o,qs,y,0,-0,0)}}break}while(!0);Ri(r)}function B_(r,a,l,u,m,y,w,C,V,J,ot,ct,et,rt){if(r.timeoutHandle=-1,ct=a.subtreeFlags,(ct&8192||(ct&16785408)===16785408)&&(Bc={stylesheets:null,count:0,unsuspend:Bx},P_(a),ct=Ux(),ct!==null)){r.cancelPendingCommit=ct(q_.bind(null,r,a,y,l,u,m,w,C,V,ot,1,et,rt)),Qs(r,y,w,!J);return}q_(r,a,y,l,u,m,w,C,V)}function ix(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],y=m.getSnapshot;m=m.value;try{if(!_r(y(),m))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Qs(r,a,l,u){a&=~gm,a&=~to,r.suspendedLanes|=a,r.pingedLanes&=~a,u&&(r.warmLanes|=a),u=r.expirationTimes;for(var m=a;0<m;){var y=31-Cn(m),w=1<<y;u[y]=-1,m&=~w}l!==0&&ei(r,l,a)}function Nh(){return(_e&6)===0?(Ic(0),!1):!0}function Sm(){if(ne!==null){if(Se===0)var r=ne.return;else r=ne,es=Wa=null,Ng(r),qo=null,wc=0,r=ne;for(;r!==null;)v_(r.alternate,r),r=r.return;ne=null}}function tl(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,Tx(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Sm(),Me=r,ne=l=Zi(r.current,null),oe=a,Se=0,wr=null,qs=!1,Qo=Jr(r,a),dm=!1,$o=Nr=gm=to=Xs=qe=0,or=Mc=null,mm=!1,(a&8)!==0&&(a|=a&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=a;0<u;){var m=31-Cn(u),y=1<<m;a|=r[m],u&=~y}return cs=a,sh(),l}function F_(r,a){$t=null,W.H=Eh,a===gc||a===gh?(a=r0(),Se=3):a===t0?(a=r0(),Se=4):Se=a===i_?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,wr=a,ne===null&&(qe=1,Rh(r,Pr(a,r.current)))}function U_(){var r=W.H;return W.H=Eh,r===null?Eh:r}function z_(){var r=W.A;return W.A=nx,r}function bm(){qe=4,qs||(oe&4194048)!==oe&&Lr.current!==null||(Qo=!0),(Xs&134217727)===0&&(to&134217727)===0||Me===null||Qs(Me,oe,Nr,!1)}function Tm(r,a,l){var u=_e;_e|=2;var m=U_(),y=z_();(Me!==r||oe!==a)&&(Lh=null,tl(r,a)),a=!1;var w=qe;t:do try{if(Se!==0&&ne!==null){var C=ne,V=wr;switch(Se){case 8:Sm(),w=6;break t;case 3:case 2:case 9:case 6:Lr.current===null&&(a=!0);var J=Se;if(Se=0,wr=null,el(r,C,V,J),l&&Qo){w=0;break t}break;default:J=Se,Se=0,wr=null,el(r,C,V,J)}}sx(),w=qe;break}catch(ot){F_(r,ot)}while(!0);return a&&r.shellSuspendCounter++,es=Wa=null,_e=u,W.H=m,W.A=y,ne===null&&(Me=null,oe=0,sh()),w}function sx(){for(;ne!==null;)H_(ne)}function ax(r,a){var l=_e;_e|=2;var u=U_(),m=z_();Me!==r||oe!==a?(Lh=null,Vh=En()+500,tl(r,a)):Qo=Jr(r,a);t:do try{if(Se!==0&&ne!==null){a=ne;var y=wr;e:switch(Se){case 1:Se=0,wr=null,el(r,a,y,1);break;case 2:case 9:if(e0(y)){Se=0,wr=null,G_(a);break}a=function(){Se!==2&&Se!==9||Me!==r||(Se=7),Ri(r)},y.then(a,a);break t;case 3:Se=7;break t;case 4:Se=5;break t;case 7:e0(y)?(Se=0,wr=null,G_(a)):(Se=0,wr=null,el(r,a,y,7));break;case 5:var w=null;switch(ne.tag){case 26:w=ne.memoizedState;case 5:case 27:var C=ne;if(!w||CS(w)){Se=0,wr=null;var V=C.sibling;if(V!==null)ne=V;else{var J=C.return;J!==null?(ne=J,jh(J)):ne=null}break e}}Se=0,wr=null,el(r,a,y,5);break;case 6:Se=0,wr=null,el(r,a,y,6);break;case 8:Sm(),qe=6;break t;default:throw Error(n(462))}}ox();break}catch(ot){F_(r,ot)}while(!0);return es=Wa=null,W.H=u,W.A=m,_e=l,ne!==null?0:(Me=null,oe=0,sh(),qe)}function ox(){for(;ne!==null&&!Gl();)H_(ne)}function H_(r){var a=p_(r.alternate,r,cs);r.memoizedProps=r.pendingProps,a===null?jh(r):ne=a}function G_(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=u_(l,a,a.pendingProps,a.type,void 0,oe);break;case 11:a=u_(l,a,a.pendingProps,a.type.render,a.ref,oe);break;case 5:Ng(a);default:v_(l,a),a=ne=Yv(a,cs),a=p_(l,a,cs)}r.memoizedProps=r.pendingProps,a===null?jh(r):ne=a}function el(r,a,l,u){es=Wa=null,Ng(a),qo=null,wc=0;var m=a.return;try{if(QC(r,m,a,l,oe)){qe=1,Rh(r,Pr(l,r.current)),ne=null;return}}catch(y){if(m!==null)throw ne=m,y;qe=1,Rh(r,Pr(l,r.current)),ne=null;return}a.flags&32768?(ge||u===1?r=!0:Qo||(oe&536870912)!==0?r=!1:(qs=r=!0,(u===2||u===9||u===3||u===6)&&(u=Lr.current,u!==null&&u.tag===13&&(u.flags|=16384))),Y_(a,r)):jh(a)}function jh(r){var a=r;do{if((a.flags&32768)!==0){Y_(a,qs);return}r=a.return;var l=ZC(a.alternate,a,cs);if(l!==null){ne=l;return}if(a=a.sibling,a!==null){ne=a;return}ne=a=r}while(a!==null);qe===0&&(qe=5)}function Y_(r,a){do{var l=JC(r.alternate,r);if(l!==null){l.flags&=32767,ne=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){ne=r;return}ne=r=l}while(r!==null);qe=6,ne=null}function q_(r,a,l,u,m,y,w,C,V){r.cancelPendingCommit=null;do Bh();while(Dn!==0);if((_e&6)!==0)throw Error(n(327));if(a!==null){if(a===r.current)throw Error(n(177));if(y=a.lanes|a.childLanes,y|=fg,Co(r,l,y,w,C,V),r===Me&&(ne=Me=null,oe=0),Zo=a,Ks=r,Jo=l,ym=y,vm=m,L_=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,hx(Wr,function(){return $_(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=W.T,W.T=null,m=ft.p,ft.p=2,w=_e,_e|=4;try{tx(r,a,l)}finally{_e=w,ft.p=m,W.T=u}}Dn=1,X_(),W_(),K_()}}function X_(){if(Dn===1){Dn=0;var r=Ks,a=Zo,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var u=ft.p;ft.p=2;var m=_e;_e|=4;try{R_(a,r);var y=km,w=Vv(r.containerInfo),C=y.focusedElem,V=y.selectionRange;if(w!==C&&C&&C.ownerDocument&&kv(C.ownerDocument.documentElement,C)){if(V!==null&&og(C)){var J=V.start,ot=V.end;if(ot===void 0&&(ot=J),"selectionStart"in C)C.selectionStart=J,C.selectionEnd=Math.min(ot,C.value.length);else{var ct=C.ownerDocument||document,et=ct&&ct.defaultView||window;if(et.getSelection){var rt=et.getSelection(),zt=C.textContent.length,jt=Math.min(V.start,zt),Ce=V.end===void 0?jt:Math.min(V.end,zt);!rt.extend&&jt>Ce&&(w=Ce,Ce=jt,jt=w);var X=Iv(C,jt),H=Iv(C,Ce);if(X&&H&&(rt.rangeCount!==1||rt.anchorNode!==X.node||rt.anchorOffset!==X.offset||rt.focusNode!==H.node||rt.focusOffset!==H.offset)){var Q=ct.createRange();Q.setStart(X.node,X.offset),rt.removeAllRanges(),jt>Ce?(rt.addRange(Q),rt.extend(H.node,H.offset)):(Q.setEnd(H.node,H.offset),rt.addRange(Q))}}}}for(ct=[],rt=C;rt=rt.parentNode;)rt.nodeType===1&&ct.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<ct.length;C++){var lt=ct[C];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}$h=!!Im,km=Im=null}finally{_e=m,ft.p=u,W.T=l}}r.current=a,Dn=2}}function W_(){if(Dn===2){Dn=0;var r=Ks,a=Zo,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var u=ft.p;ft.p=2;var m=_e;_e|=4;try{C_(r,a.alternate,a)}finally{_e=m,ft.p=u,W.T=l}}Dn=3}}function K_(){if(Dn===4||Dn===3){Dn=0,Ca();var r=Ks,a=Zo,l=Jo,u=L_;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Dn=5:(Dn=0,Zo=Ks=null,Q_(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(Ws=null),Aa(l),a=a.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(pn,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=W.T,m=ft.p,ft.p=2,W.T=null;try{for(var y=r.onRecoverableError,w=0;w<u.length;w++){var C=u[w];y(C.value,{componentStack:C.stack})}}finally{W.T=a,ft.p=m}}(Jo&3)!==0&&Bh(),Ri(r),m=r.pendingLanes,(l&4194090)!==0&&(m&42)!==0?r===_m?Pc++:(Pc=0,_m=r):Pc=0,Ic(0)}}function Q_(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,fc(a)))}function Bh(r){return X_(),W_(),K_(),$_()}function $_(){if(Dn!==5)return!1;var r=Ks,a=ym;ym=0;var l=Aa(Jo),u=W.T,m=ft.p;try{ft.p=32>l?32:l,W.T=null,l=vm,vm=null;var y=Ks,w=Jo;if(Dn=0,Zo=Ks=null,Jo=0,(_e&6)!==0)throw Error(n(331));var C=_e;if(_e|=4,k_(y.current),M_(y,y.current,w,l),_e=C,Ic(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(pn,y)}catch{}return!0}finally{ft.p=m,W.T=u,Q_(r,a)}}function Z_(r,a,l){a=Pr(l,a),a=$g(r.stateNode,a,2),r=Bs(r,a,2),r!==null&&(Le(r,2),Ri(r))}function Ae(r,a,l){if(r.tag===3)Z_(r,r,l);else for(;a!==null;){if(a.tag===3){Z_(a,r,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ws===null||!Ws.has(u))){r=Pr(l,r),l=n_(2),u=Bs(a,l,2),u!==null&&(r_(l,u,a,r),Le(u,2),Ri(u));break}}a=a.return}}function wm(r,a,l){var u=r.pingCache;if(u===null){u=r.pingCache=new rx;var m=new Set;u.set(a,m)}else m=u.get(a),m===void 0&&(m=new Set,u.set(a,m));m.has(l)||(dm=!0,m.add(l),r=lx.bind(null,r,a,l),a.then(r,r))}function lx(r,a,l){var u=r.pingCache;u!==null&&u.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,Me===r&&(oe&l)===l&&(qe===4||qe===3&&(oe&62914560)===oe&&300>En()-pm?(_e&2)===0&&tl(r,0):gm|=l,$o===oe&&($o=0)),Ri(r)}function J_(r,a){a===0&&(a=Dr()),r=Lo(r,a),r!==null&&(Le(r,a),Ri(r))}function cx(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),J_(r,l)}function ux(r,a){var l=0;switch(r.tag){case 13:var u=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(a),J_(r,l)}function hx(r,a){return qi(r,a)}var Fh=null,nl=null,Em=!1,Uh=!1,Cm=!1,eo=0;function Ri(r){r!==nl&&r.next===null&&(nl===null?Fh=nl=r:nl=nl.next=r),Uh=!0,Em||(Em=!0,dx())}function Ic(r,a){if(!Cm&&Uh){Cm=!0;do for(var l=!1,u=Fh;u!==null;){if(r!==0){var m=u.pendingLanes;if(m===0)var y=0;else{var w=u.suspendedLanes,C=u.pingedLanes;y=(1<<31-Cn(42|r)+1)-1,y&=m&~(w&~C),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,rS(u,y))}else y=oe,y=nr(u,u===Me?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||Jr(u,y)||(l=!0,rS(u,y));u=u.next}while(l);Cm=!1}}function fx(){tS()}function tS(){Uh=Em=!1;var r=0;eo!==0&&(bx()&&(r=eo),eo=0);for(var a=En(),l=null,u=Fh;u!==null;){var m=u.next,y=eS(u,a);y===0?(u.next=null,l===null?Fh=m:l.next=m,m===null&&(nl=l)):(l=u,(r!==0||(y&3)!==0)&&(Uh=!0)),u=m}Ic(r)}function eS(r,a){for(var l=r.suspendedLanes,u=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var w=31-Cn(y),C=1<<w,V=m[w];V===-1?((C&l)===0||(C&u)!==0)&&(m[w]=ti(C,a)):V<=a&&(r.expiredLanes|=C),y&=~C}if(a=Me,l=oe,l=nr(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,l===0||r===a&&(Se===2||Se===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Jn(u),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Jr(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(u!==null&&Jn(u),Aa(l)){case 2:case 8:l=nn;break;case 32:l=Wr;break;case 268435456:l=Qr;break;default:l=Wr}return u=nS.bind(null,r),l=qi(l,u),r.callbackPriority=a,r.callbackNode=l,a}return u!==null&&u!==null&&Jn(u),r.callbackPriority=2,r.callbackNode=null,2}function nS(r,a){if(Dn!==0&&Dn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Bh()&&r.callbackNode!==l)return null;var u=oe;return u=nr(r,r===Me?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(j_(r,u,a),eS(r,En()),r.callbackNode!=null&&r.callbackNode===l?nS.bind(null,r):null)}function rS(r,a){if(Bh())return null;j_(r,a,!0)}function dx(){wx(function(){(_e&6)!==0?qi(Xe,fx):tS()})}function xm(){return eo===0&&(eo=xs()),eo}function iS(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:ri(""+r)}function sS(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function gx(r,a,l,u,m){if(a==="submit"&&l&&l.stateNode===m){var y=iS((m[ht]||null).action),w=u.submitter;w&&(a=(a=w[ht]||null)?iS(a.formAction):w.getAttribute("formAction"),a!==null&&(y=a,w=null));var C=new ka("action","action",null,u,m);r.push({event:C,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(eo!==0){var V=w?sS(m,w):new FormData(m);qg(l,{pending:!0,data:V,method:m.method,action:y},null,V)}}else typeof y=="function"&&(C.preventDefault(),V=w?sS(m,w):new FormData(m),qg(l,{pending:!0,data:V,method:m.method,action:y},y,V))},currentTarget:m}]})}}for(var Am=0;Am<hg.length;Am++){var Dm=hg[Am],mx=Dm.toLowerCase(),px=Dm[0].toUpperCase()+Dm.slice(1);oi(mx,"on"+px)}oi(jv,"onAnimationEnd"),oi(Bv,"onAnimationIteration"),oi(Fv,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(IC,"onTransitionRun"),oi(kC,"onTransitionStart"),oi(VC,"onTransitionCancel"),oi(Uv,"onTransitionEnd"),kn("onMouseEnter",["mouseout","mouseover"]),kn("onMouseLeave",["mouseout","mouseover"]),kn("onPointerEnter",["pointerout","pointerover"]),kn("onPointerLeave",["pointerout","pointerover"]),yn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yn("onBeforeInput",["compositionend","keypress","textInput","paste"]),yn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kc));function aS(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var u=r[l],m=u.event;u=u.listeners;t:{var y=void 0;if(a)for(var w=u.length-1;0<=w;w--){var C=u[w],V=C.instance,J=C.currentTarget;if(C=C.listener,V!==y&&m.isPropagationStopped())break t;y=C,m.currentTarget=J;try{y(m)}catch(ot){Dh(ot)}m.currentTarget=null,y=V}else for(w=0;w<u.length;w++){if(C=u[w],V=C.instance,J=C.currentTarget,C=C.listener,V!==y&&m.isPropagationStopped())break t;y=C,m.currentTarget=J;try{y(m)}catch(ot){Dh(ot)}m.currentTarget=null,y=V}}}}function re(r,a){var l=a[xt];l===void 0&&(l=a[xt]=new Set);var u=r+"__bubble";l.has(u)||(oS(a,r,2,!1),l.add(u))}function Rm(r,a,l){var u=0;a&&(u|=4),oS(l,r,u,a)}var zh="_reactListening"+Math.random().toString(36).slice(2);function Om(r){if(!r[zh]){r[zh]=!0,be.forEach(function(l){l!=="selectionchange"&&(yx.has(l)||Rm(l,!1,r),Rm(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[zh]||(a[zh]=!0,Rm("selectionchange",!1,a))}}function oS(r,a,l,u){switch(MS(a)){case 2:var m=Gx;break;case 8:m=Yx;break;default:m=Gm}l=m.bind(null,a,l,r),m=void 0,!Qi||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),u?m!==void 0?r.addEventListener(a,l,{capture:!0,passive:m}):r.addEventListener(a,l,!0):m!==void 0?r.addEventListener(a,l,{passive:m}):r.addEventListener(a,l,!1)}function Mm(r,a,l,u,m){var y=u;if((a&1)===0&&(a&2)===0&&u!==null)t:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var C=u.stateNode.containerInfo;if(C===m)break;if(w===4)for(w=u.return;w!==null;){var V=w.tag;if((V===3||V===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;C!==null;){if(w=Tt(C),w===null)return;if(V=w.tag,V===5||V===6||V===26||V===27){u=y=w;continue t}C=C.parentNode}}u=u.return}Ma(function(){var J=y,ot=$l(l),ct=[];t:{var et=zv.get(r);if(et!==void 0){var rt=ka,zt=r;switch(r){case"keypress":if(Pa(l)===0)break t;case"keydown":case"keyup":rt=Po;break;case"focusin":zt="focus",rt=Ro;break;case"focusout":zt="blur",rt=Ro;break;case"beforeblur":case"afterblur":rt=Ro;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Ba;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Qu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=Vs;break;case jv:case Bv:case Fv:rt=Jl;break;case Uv:rt=_;break;case"scroll":case"scrollend":rt=La;break;case"wheel":rt=A;break;case"copy":case"cut":case"paste":rt=Zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=nc;break;case"toggle":case"beforetoggle":rt=st}var jt=(a&4)!==0,Ce=!jt&&(r==="scroll"||r==="scrollend"),X=jt?et!==null?et+"Capture":null:et;jt=[];for(var H=J,Q;H!==null;){var lt=H;if(Q=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||Q===null||X===null||(lt=Is(H,X),lt!=null&&jt.push(Vc(H,lt,Q))),Ce)break;H=H.return}0<jt.length&&(et=new rt(et,zt,null,l,ot),ct.push({event:et,listeners:jt}))}}if((a&7)===0){t:{if(et=r==="mouseover"||r==="pointerover",rt=r==="mouseout"||r==="pointerout",et&&l!==Ql&&(zt=l.relatedTarget||l.fromElement)&&(Tt(zt)||zt[yt]))break t;if((rt||et)&&(et=ot.window===ot?ot:(et=ot.ownerDocument)?et.defaultView||et.parentWindow:window,rt?(zt=l.relatedTarget||l.toElement,rt=J,zt=zt?Tt(zt):null,zt!==null&&(Ce=o(zt),jt=zt.tag,zt!==Ce||jt!==5&&jt!==27&&jt!==6)&&(zt=null)):(rt=null,zt=J),rt!==zt)){if(jt=Ba,lt="onMouseLeave",X="onMouseEnter",H="mouse",(r==="pointerout"||r==="pointerover")&&(jt=nc,lt="onPointerLeave",X="onPointerEnter",H="pointer"),Ce=rt==null?et:ue(rt),Q=zt==null?et:ue(zt),et=new jt(lt,H+"leave",rt,l,ot),et.target=Ce,et.relatedTarget=Q,lt=null,Tt(ot)===J&&(jt=new jt(X,H+"enter",zt,l,ot),jt.target=Q,jt.relatedTarget=Ce,lt=jt),Ce=lt,rt&&zt)e:{for(jt=rt,X=zt,H=0,Q=jt;Q;Q=rl(Q))H++;for(Q=0,lt=X;lt;lt=rl(lt))Q++;for(;0<H-Q;)jt=rl(jt),H--;for(;0<Q-H;)X=rl(X),Q--;for(;H--;){if(jt===X||X!==null&&jt===X.alternate)break e;jt=rl(jt),X=rl(X)}jt=null}else jt=null;rt!==null&&lS(ct,et,rt,jt,!1),zt!==null&&Ce!==null&&lS(ct,Ce,zt,jt,!0)}}t:{if(et=J?ue(J):window,rt=et.nodeName&&et.nodeName.toLowerCase(),rt==="select"||rt==="input"&&et.type==="file")var At=Av;else if(Cv(et))if(Dv)At=OC;else{At=DC;var Jt=AC}else rt=et.nodeName,!rt||rt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?J&&xo(J.elementType)&&(At=Av):At=RC;if(At&&(At=At(r,J))){xv(ct,At,l,ot);break t}Jt&&Jt(r,et,J),r==="focusout"&&J&&et.type==="number"&&J.memoizedProps.value!=null&&Xl(et,"number",et.value)}switch(Jt=J?ue(J):window,r){case"focusin":(Cv(Jt)||Jt.contentEditable==="true")&&(Io=Jt,lg=J,oc=null);break;case"focusout":oc=lg=Io=null;break;case"mousedown":cg=!0;break;case"contextmenu":case"mouseup":case"dragend":cg=!1,Lv(ct,l,ot);break;case"selectionchange":if(PC)break;case"keydown":case"keyup":Lv(ct,l,ot)}var Vt;if(qt)t:{switch(r){case"compositionstart":var Bt="onCompositionStart";break t;case"compositionend":Bt="onCompositionEnd";break t;case"compositionupdate":Bt="onCompositionUpdate";break t}Bt=void 0}else ai?ii(r,l)&&(Bt="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Bt="onCompositionStart");Bt&&(Ke&&l.locale!=="ko"&&(ai||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&ai&&(Vt=Ku()):(Mr=ot,Oe="value"in Mr?Mr.value:Mr.textContent,ai=!0)),Jt=Hh(J,Bt),0<Jt.length&&(Bt=new ec(Bt,r,null,l,ot),ct.push({event:Bt,listeners:Jt}),Vt?Bt.data=Vt:(Vt=si(l),Vt!==null&&(Bt.data=Vt)))),(Vt=ve?rc(r,l):EC(r,l))&&(Bt=Hh(J,"onBeforeInput"),0<Bt.length&&(Jt=new ec("onBeforeInput","beforeinput",null,l,ot),ct.push({event:Jt,listeners:Bt}),Jt.data=Vt)),gx(ct,r,J,l,ot)}aS(ct,a)})}function Vc(r,a,l){return{instance:r,listener:a,currentTarget:l}}function Hh(r,a){for(var l=a+"Capture",u=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Is(r,l),m!=null&&u.unshift(Vc(r,m,y)),m=Is(r,a),m!=null&&u.push(Vc(r,m,y))),r.tag===3)return u;r=r.return}return[]}function rl(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function lS(r,a,l,u,m){for(var y=a._reactName,w=[];l!==null&&l!==u;){var C=l,V=C.alternate,J=C.stateNode;if(C=C.tag,V!==null&&V===u)break;C!==5&&C!==26&&C!==27||J===null||(V=J,m?(J=Is(l,y),J!=null&&w.unshift(Vc(l,J,V))):m||(J=Is(l,y),J!=null&&w.push(Vc(l,J,V)))),l=l.return}w.length!==0&&r.push({event:a,listeners:w})}var vx=/\r\n?/g,_x=/\u0000|\uFFFD/g;function cS(r){return(typeof r=="string"?r:""+r).replace(vx,`
`).replace(_x,"")}function uS(r,a){return a=cS(a),cS(r)===a}function Gh(){}function Ee(r,a,l,u,m,y){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Or(r,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Or(r,""+u);break;case"className":Rr(r,"class",u);break;case"tabIndex":Rr(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Rr(r,l,u);break;case"style":Kl(r,u,y);break;case"data":if(a!=="object"){Rr(r,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=ri(""+u),r.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(a!=="input"&&Ee(r,a,"name",m.name,m,null),Ee(r,a,"formEncType",m.formEncType,m,null),Ee(r,a,"formMethod",m.formMethod,m,null),Ee(r,a,"formTarget",m.formTarget,m,null)):(Ee(r,a,"encType",m.encType,m,null),Ee(r,a,"method",m.method,m,null),Ee(r,a,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=ri(""+u),r.setAttribute(l,u);break;case"onClick":u!=null&&(r.onclick=Gh);break;case"onScroll":u!=null&&re("scroll",r);break;case"onScrollEnd":u!=null&&re("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=l}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}l=ri(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""+u):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":u===!0?r.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,u):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(l,u):r.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(l):r.setAttribute(l,u);break;case"popover":re("beforetoggle",r),re("toggle",r),Yn(r,"popover",u);break;case"xlinkActuate":xn(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":xn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":xn(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":xn(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":xn(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":xn(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":xn(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":xn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":xn(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Yn(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=qu.get(l)||l,Yn(r,l,u))}}function Pm(r,a,l,u,m,y){switch(l){case"style":Kl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=l}}break;case"children":typeof u=="string"?Or(r,u):(typeof u=="number"||typeof u=="bigint")&&Or(r,""+u);break;case"onScroll":u!=null&&re("scroll",r);break;case"onScrollEnd":u!=null&&re("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Gh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!he.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),a=l.slice(2,m?l.length-7:void 0),y=r[ht]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(a,y,m),typeof u=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,u,m);break t}l in r?r[l]=u:u===!0?r.setAttribute(l,""):Yn(r,l,u)}}}function Rn(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":re("error",r),re("load",r);var u=!1,m=!1,y;for(y in l)if(l.hasOwnProperty(y)){var w=l[y];if(w!=null)switch(y){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Ee(r,a,y,w,l,null)}}m&&Ee(r,a,"srcSet",l.srcSet,l,null),u&&Ee(r,a,"src",l.src,l,null);return;case"input":re("invalid",r);var C=y=w=m=null,V=null,J=null;for(u in l)if(l.hasOwnProperty(u)){var ot=l[u];if(ot!=null)switch(u){case"name":m=ot;break;case"type":w=ot;break;case"checked":V=ot;break;case"defaultChecked":J=ot;break;case"value":y=ot;break;case"defaultValue":C=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,a));break;default:Ee(r,a,u,ot,l,null)}}ql(r,y,C,V,J,w,m,!1),Os(r);return;case"select":re("invalid",r),u=w=y=null;for(m in l)if(l.hasOwnProperty(m)&&(C=l[m],C!=null))switch(m){case"value":y=C;break;case"defaultValue":w=C;break;case"multiple":u=C;default:Ee(r,a,m,C,l,null)}a=y,l=w,r.multiple=!!u,a!=null?Ms(r,!!u,a,!1):l!=null&&Ms(r,!!u,l,!0);return;case"textarea":re("invalid",r),y=m=u=null;for(w in l)if(l.hasOwnProperty(w)&&(C=l[w],C!=null))switch(w){case"value":u=C;break;case"defaultValue":m=C;break;case"children":y=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(n(91));break;default:Ee(r,a,w,C,l,null)}Yu(r,u,m,y),Os(r);return;case"option":for(V in l)if(l.hasOwnProperty(V)&&(u=l[V],u!=null))switch(V){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ee(r,a,V,u,l,null)}return;case"dialog":re("beforetoggle",r),re("toggle",r),re("cancel",r),re("close",r);break;case"iframe":case"object":re("load",r);break;case"video":case"audio":for(u=0;u<kc.length;u++)re(kc[u],r);break;case"image":re("error",r),re("load",r);break;case"details":re("toggle",r);break;case"embed":case"source":case"link":re("error",r),re("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in l)if(l.hasOwnProperty(J)&&(u=l[J],u!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Ee(r,a,J,u,l,null)}return;default:if(xo(a)){for(ot in l)l.hasOwnProperty(ot)&&(u=l[ot],u!==void 0&&Pm(r,a,ot,u,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(u=l[C],u!=null&&Ee(r,a,C,u,l,null))}function Sx(r,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,w=null,C=null,V=null,J=null,ot=null;for(rt in l){var ct=l[rt];if(l.hasOwnProperty(rt)&&ct!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":V=ct;default:u.hasOwnProperty(rt)||Ee(r,a,rt,null,u,ct)}}for(var et in u){var rt=u[et];if(ct=l[et],u.hasOwnProperty(et)&&(rt!=null||ct!=null))switch(et){case"type":y=rt;break;case"name":m=rt;break;case"checked":J=rt;break;case"defaultChecked":ot=rt;break;case"value":w=rt;break;case"defaultValue":C=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,a));break;default:rt!==ct&&Ee(r,a,et,rt,u,ct)}}Yl(r,w,C,V,J,ot,y,m);return;case"select":rt=w=C=et=null;for(y in l)if(V=l[y],l.hasOwnProperty(y)&&V!=null)switch(y){case"value":break;case"multiple":rt=V;default:u.hasOwnProperty(y)||Ee(r,a,y,null,u,V)}for(m in u)if(y=u[m],V=l[m],u.hasOwnProperty(m)&&(y!=null||V!=null))switch(m){case"value":et=y;break;case"defaultValue":C=y;break;case"multiple":w=y;default:y!==V&&Ee(r,a,m,y,u,V)}a=C,l=w,u=rt,et!=null?Ms(r,!!l,et,!1):!!u!=!!l&&(a!=null?Ms(r,!!l,a,!0):Ms(r,!!l,l?[]:"",!1));return;case"textarea":rt=et=null;for(C in l)if(m=l[C],l.hasOwnProperty(C)&&m!=null&&!u.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Ee(r,a,C,null,u,m)}for(w in u)if(m=u[w],y=l[w],u.hasOwnProperty(w)&&(m!=null||y!=null))switch(w){case"value":et=m;break;case"defaultValue":rt=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==y&&Ee(r,a,w,m,u,y)}Gu(r,et,rt);return;case"option":for(var zt in l)if(et=l[zt],l.hasOwnProperty(zt)&&et!=null&&!u.hasOwnProperty(zt))switch(zt){case"selected":r.selected=!1;break;default:Ee(r,a,zt,null,u,et)}for(V in u)if(et=u[V],rt=l[V],u.hasOwnProperty(V)&&et!==rt&&(et!=null||rt!=null))switch(V){case"selected":r.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:Ee(r,a,V,et,u,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var jt in l)et=l[jt],l.hasOwnProperty(jt)&&et!=null&&!u.hasOwnProperty(jt)&&Ee(r,a,jt,null,u,et);for(J in u)if(et=u[J],rt=l[J],u.hasOwnProperty(J)&&et!==rt&&(et!=null||rt!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(n(137,a));break;default:Ee(r,a,J,et,u,rt)}return;default:if(xo(a)){for(var Ce in l)et=l[Ce],l.hasOwnProperty(Ce)&&et!==void 0&&!u.hasOwnProperty(Ce)&&Pm(r,a,Ce,void 0,u,et);for(ot in u)et=u[ot],rt=l[ot],!u.hasOwnProperty(ot)||et===rt||et===void 0&&rt===void 0||Pm(r,a,ot,et,u,rt);return}}for(var X in l)et=l[X],l.hasOwnProperty(X)&&et!=null&&!u.hasOwnProperty(X)&&Ee(r,a,X,null,u,et);for(ct in u)et=u[ct],rt=l[ct],!u.hasOwnProperty(ct)||et===rt||et==null&&rt==null||Ee(r,a,ct,et,u,rt)}var Im=null,km=null;function Yh(r){return r.nodeType===9?r:r.ownerDocument}function hS(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fS(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Vm(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Lm=null;function bx(){var r=window.event;return r&&r.type==="popstate"?r===Lm?!1:(Lm=r,!0):(Lm=null,!1)}var dS=typeof setTimeout=="function"?setTimeout:void 0,Tx=typeof clearTimeout=="function"?clearTimeout:void 0,gS=typeof Promise=="function"?Promise:void 0,wx=typeof queueMicrotask=="function"?queueMicrotask:typeof gS<"u"?function(r){return gS.resolve(null).then(r).catch(Ex)}:dS;function Ex(r){setTimeout(function(){throw r})}function $s(r){return r==="head"}function mS(r,a){var l=a,u=0,m=0;do{var y=l.nextSibling;if(r.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"){if(0<u&&8>u){l=u;var w=r.ownerDocument;if(l&1&&Lc(w.documentElement),l&2&&Lc(w.body),l&4)for(l=w.head,Lc(l),w=l.firstChild;w;){var C=w.nextSibling,V=w.nodeName;w[kt]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=C}}if(m===0){r.removeChild(y),Gc(a);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=y}while(l);Gc(a)}function Nm(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Nm(l),Mt(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function Cx(r,a,l,u){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[kt])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=ci(r.nextSibling),r===null)break}return null}function xx(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=ci(r.nextSibling),r===null))return null;return r}function jm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function Ax(r,a){var l=r.ownerDocument;if(r.data!=="$?"||l.readyState==="complete")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function ci(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var Bm=null;function pS(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return r;a--}else l==="/$"&&a++}r=r.previousSibling}return null}function yS(r,a,l){switch(a=Yh(l),r){case"html":if(r=a.documentElement,!r)throw Error(n(452));return r;case"head":if(r=a.head,!r)throw Error(n(453));return r;case"body":if(r=a.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Lc(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);Mt(r)}var jr=new Map,vS=new Set;function qh(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var us=ft.d;ft.d={f:Dx,r:Rx,D:Ox,C:Mx,L:Px,m:Ix,X:Vx,S:kx,M:Lx};function Dx(){var r=us.f(),a=Nh();return r||a}function Rx(r){var a=Yt(r);a!==null&&a.tag===5&&a.type==="form"?j0(a):us.r(r)}var il=typeof document>"u"?null:document;function _S(r,a,l){var u=il;if(u&&typeof a=="string"&&a){var m=vn(a);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),vS.has(m)||(vS.add(m),r={rel:r,crossOrigin:l,href:a},u.querySelector(m)===null&&(a=u.createElement("link"),Rn(a,"link",r),ee(a),u.head.appendChild(a)))}}function Ox(r){us.D(r),_S("dns-prefetch",r,null)}function Mx(r,a){us.C(r,a),_S("preconnect",r,a)}function Px(r,a,l){us.L(r,a,l);var u=il;if(u&&r&&a){var m='link[rel="preload"][as="'+vn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+vn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+vn(l.imageSizes)+'"]')):m+='[href="'+vn(r)+'"]';var y=m;switch(a){case"style":y=sl(r);break;case"script":y=al(r)}jr.has(y)||(r=p({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),jr.set(y,r),u.querySelector(m)!==null||a==="style"&&u.querySelector(Nc(y))||a==="script"&&u.querySelector(jc(y))||(a=u.createElement("link"),Rn(a,"link",r),ee(a),u.head.appendChild(a)))}}function Ix(r,a){us.m(r,a);var l=il;if(l&&r){var u=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+vn(u)+'"][href="'+vn(r)+'"]',y=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=al(r)}if(!jr.has(y)&&(r=p({rel:"modulepreload",href:r},a),jr.set(y,r),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(jc(y)))return}u=l.createElement("link"),Rn(u,"link",r),ee(u),l.head.appendChild(u)}}}function kx(r,a,l){us.S(r,a,l);var u=il;if(u&&r){var m=xe(u).hoistableStyles,y=sl(r);a=a||"default";var w=m.get(y);if(!w){var C={loading:0,preload:null};if(w=u.querySelector(Nc(y)))C.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":a},l),(l=jr.get(y))&&Fm(r,l);var V=w=u.createElement("link");ee(V),Rn(V,"link",r),V._p=new Promise(function(J,ot){V.onload=J,V.onerror=ot}),V.addEventListener("load",function(){C.loading|=1}),V.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Xh(w,a,u)}w={type:"stylesheet",instance:w,count:1,state:C},m.set(y,w)}}}function Vx(r,a){us.X(r,a);var l=il;if(l&&r){var u=xe(l).hoistableScripts,m=al(r),y=u.get(m);y||(y=l.querySelector(jc(m)),y||(r=p({src:r,async:!0},a),(a=jr.get(m))&&Um(r,a),y=l.createElement("script"),ee(y),Rn(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function Lx(r,a){us.M(r,a);var l=il;if(l&&r){var u=xe(l).hoistableScripts,m=al(r),y=u.get(m);y||(y=l.querySelector(jc(m)),y||(r=p({src:r,async:!0,type:"module"},a),(a=jr.get(m))&&Um(r,a),y=l.createElement("script"),ee(y),Rn(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function SS(r,a,l,u){var m=(m=Et.current)?qh(m):null;if(!m)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=sl(l.href),l=xe(m).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=sl(l.href);var y=xe(m).hoistableStyles,w=y.get(r);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,w),(y=m.querySelector(Nc(r)))&&!y._p&&(w.instance=y,w.state.loading=5),jr.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},jr.set(r,l),y||Nx(m,r,l,w.state))),a&&u===null)throw Error(n(528,""));return w}if(a&&u!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=al(l),l=xe(m).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function sl(r){return'href="'+vn(r)+'"'}function Nc(r){return'link[rel="stylesheet"]['+r+"]"}function bS(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function Nx(r,a,l,u){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=r.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Rn(a,"link",l),ee(a),r.head.appendChild(a))}function al(r){return'[src="'+vn(r)+'"]'}function jc(r){return"script[async]"+r}function TS(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=r.querySelector('style[data-href~="'+vn(l.href)+'"]');if(u)return a.instance=u,ee(u),u;var m=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),ee(u),Rn(u,"style",m),Xh(u,l.precedence,r),a.instance=u;case"stylesheet":m=sl(l.href);var y=r.querySelector(Nc(m));if(y)return a.state.loading|=4,a.instance=y,ee(y),y;u=bS(l),(m=jr.get(m))&&Fm(u,m),y=(r.ownerDocument||r).createElement("link"),ee(y);var w=y;return w._p=new Promise(function(C,V){w.onload=C,w.onerror=V}),Rn(y,"link",u),a.state.loading|=4,Xh(y,l.precedence,r),a.instance=y;case"script":return y=al(l.src),(m=r.querySelector(jc(y)))?(a.instance=m,ee(m),m):(u=l,(m=jr.get(y))&&(u=p({},l),Um(u,m)),r=r.ownerDocument||r,m=r.createElement("script"),ee(m),Rn(m,"link",u),r.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Xh(u,l.precedence,r));return a.instance}function Xh(r,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,y=m,w=0;w<u.length;w++){var C=u[w];if(C.dataset.precedence===a)y=C;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function Fm(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function Um(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var Wh=null;function wS(r,a,l){if(Wh===null){var u=new Map,m=Wh=new Map;m.set(l,u)}else m=Wh,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(r))return u;for(u.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var y=l[m];if(!(y[kt]||y[tt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(a)||"";w=r+w;var C=u.get(w);C?C.push(y):u.set(w,[y])}}return u}function ES(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function jx(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function CS(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Bc=null;function Bx(){}function Fx(r,a,l){if(Bc===null)throw Error(n(475));var u=Bc;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var m=sl(l.href),y=r.querySelector(Nc(m));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(u.count++,u=Kh.bind(u),r.then(u,u)),a.state.loading|=4,a.instance=y,ee(y);return}y=r.ownerDocument||r,l=bS(l),(m=jr.get(m))&&Fm(l,m),y=y.createElement("link"),ee(y);var w=y;w._p=new Promise(function(C,V){w.onload=C,w.onerror=V}),Rn(y,"link",l),a.instance=y}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(u.count++,a=Kh.bind(u),r.addEventListener("load",a),r.addEventListener("error",a))}}function Ux(){if(Bc===null)throw Error(n(475));var r=Bc;return r.stylesheets&&r.count===0&&zm(r,r.stylesheets),0<r.count?function(a){var l=setTimeout(function(){if(r.stylesheets&&zm(r,r.stylesheets),r.unsuspend){var u=r.unsuspend;r.unsuspend=null,u()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(l)}}:null}function Kh(){if(this.count--,this.count===0){if(this.stylesheets)zm(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Qh=null;function zm(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Qh=new Map,a.forEach(zx,r),Qh=null,Kh.call(r))}function zx(r,a){if(!(a.state.loading&4)){var l=Qh.get(r);if(l)var u=l.get(null);else{l=new Map,Qh.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var w=m[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),u=w)}u&&l.set(null,u)}m=a.instance,w=m.getAttribute("data-precedence"),y=l.get(w)||u,y===u&&l.set(null,m),l.set(w,m),this.count++,u=Kh.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),a.state.loading|=4}}var Fc={$$typeof:Z,Provider:null,Consumer:null,_currentValue:gt,_currentValue2:gt,_threadCount:0};function Hx(r,a,l,u,m,y,w,C){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=As(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=As(0),this.hiddenUpdates=As(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function xS(r,a,l,u,m,y,w,C,V,J,ot,ct){return r=new Hx(r,a,l,w,C,V,J,ct),a=1,y===!0&&(a|=24),y=Sr(3,null,null,a),r.current=y,y.stateNode=r,a=wg(),a.refCount++,r.pooledCache=a,a.refCount++,y.memoizedState={element:u,isDehydrated:l,cache:a},Ag(y),r}function AS(r){return r?(r=No,r):No}function DS(r,a,l,u,m,y){m=AS(m),u.context===null?u.context=m:u.pendingContext=m,u=js(a),u.payload={element:l},y=y===void 0?null:y,y!==null&&(u.callback=y),l=Bs(r,u,a),l!==null&&(Cr(l,r,a),pc(l,r,a))}function RS(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function Hm(r,a){RS(r,a),(r=r.alternate)&&RS(r,a)}function OS(r){if(r.tag===13){var a=Lo(r,67108864);a!==null&&Cr(a,r,67108864),Hm(r,67108864)}}var $h=!0;function Gx(r,a,l,u){var m=W.T;W.T=null;var y=ft.p;try{ft.p=2,Gm(r,a,l,u)}finally{ft.p=y,W.T=m}}function Yx(r,a,l,u){var m=W.T;W.T=null;var y=ft.p;try{ft.p=8,Gm(r,a,l,u)}finally{ft.p=y,W.T=m}}function Gm(r,a,l,u){if($h){var m=Ym(u);if(m===null)Mm(r,a,u,Zh,l),PS(r,u);else if(Xx(m,r,a,l,u))u.stopPropagation();else if(PS(r,u),a&4&&-1<qx.indexOf(r)){for(;m!==null;){var y=Yt(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=er(y.pendingLanes);if(w!==0){var C=y;for(C.pendingLanes|=2,C.entangledLanes|=2;w;){var V=1<<31-Cn(w);C.entanglements[1]|=V,w&=~V}Ri(y),(_e&6)===0&&(Vh=En()+500,Ic(0))}}break;case 13:C=Lo(y,2),C!==null&&Cr(C,y,2),Nh(),Hm(y,2)}if(y=Ym(u),y===null&&Mm(r,a,u,Zh,l),y===m)break;m=y}m!==null&&u.stopPropagation()}else Mm(r,a,u,null,l)}}function Ym(r){return r=$l(r),qm(r)}var Zh=null;function qm(r){if(Zh=null,r=Tt(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=c(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Zh=r,null}function MS(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(To()){case Xe:return 2;case nn:return 8;case Wr:case Kr:return 32;case Qr:return 268435456;default:return 32}default:return 32}}var Xm=!1,Zs=null,Js=null,ta=null,Uc=new Map,zc=new Map,ea=[],qx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function PS(r,a){switch(r){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Uc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":zc.delete(a.pointerId)}}function Hc(r,a,l,u,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:y,targetContainers:[m]},a!==null&&(a=Yt(a),a!==null&&OS(a)),r):(r.eventSystemFlags|=u,a=r.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),r)}function Xx(r,a,l,u,m){switch(a){case"focusin":return Zs=Hc(Zs,r,a,l,u,m),!0;case"dragenter":return Js=Hc(Js,r,a,l,u,m),!0;case"mouseover":return ta=Hc(ta,r,a,l,u,m),!0;case"pointerover":var y=m.pointerId;return Uc.set(y,Hc(Uc.get(y)||null,r,a,l,u,m)),!0;case"gotpointercapture":return y=m.pointerId,zc.set(y,Hc(zc.get(y)||null,r,a,l,u,m)),!0}return!1}function IS(r){var a=Tt(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){r.blockedOn=a,U(r.priority,function(){if(l.tag===13){var u=Er();u=bi(u);var m=Lo(l,u);m!==null&&Cr(m,l,u),Hm(l,u)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Jh(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=Ym(r.nativeEvent);if(l===null){l=r.nativeEvent;var u=new l.constructor(l.type,l);Ql=u,l.target.dispatchEvent(u),Ql=null}else return a=Yt(l),a!==null&&OS(a),r.blockedOn=l,!1;a.shift()}return!0}function kS(r,a,l){Jh(r)&&l.delete(a)}function Wx(){Xm=!1,Zs!==null&&Jh(Zs)&&(Zs=null),Js!==null&&Jh(Js)&&(Js=null),ta!==null&&Jh(ta)&&(ta=null),Uc.forEach(kS),zc.forEach(kS)}function tf(r,a){r.blockedOn===a&&(r.blockedOn=null,Xm||(Xm=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Wx)))}var ef=null;function VS(r){ef!==r&&(ef=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){ef===r&&(ef=null);for(var a=0;a<r.length;a+=3){var l=r[a],u=r[a+1],m=r[a+2];if(typeof u!="function"){if(qm(u||l)===null)continue;break}var y=Yt(l);y!==null&&(r.splice(a,3),a-=3,qg(y,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Gc(r){function a(V){return tf(V,r)}Zs!==null&&tf(Zs,r),Js!==null&&tf(Js,r),ta!==null&&tf(ta,r),Uc.forEach(a),zc.forEach(a);for(var l=0;l<ea.length;l++){var u=ea[l];u.blockedOn===r&&(u.blockedOn=null)}for(;0<ea.length&&(l=ea[0],l.blockedOn===null);)IS(l),l.blockedOn===null&&ea.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],y=l[u+1],w=m[ht]||null;if(typeof y=="function")w||VS(l);else if(w){var C=null;if(y&&y.hasAttribute("formAction")){if(m=y,w=y[ht]||null)C=w.formAction;else if(qm(m)!==null)continue}else C=w.action;typeof C=="function"?l[u+1]=C:(l.splice(u,3),u-=3),VS(l)}}}function Wm(r){this._internalRoot=r}nf.prototype.render=Wm.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,u=Er();DS(l,u,r,a,null,null)},nf.prototype.unmount=Wm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;DS(r.current,2,null,r,null,null),Nh(),a[yt]=null}};function nf(r){this._internalRoot=r}nf.prototype.unstable_scheduleHydration=function(r){if(r){var a=ni();r={blockedOn:null,target:r,priority:a};for(var l=0;l<ea.length&&a!==0&&a<ea[l].priority;l++);ea.splice(l,0,r),l===0&&IS(r)}};var LS=t.version;if(LS!=="19.1.1")throw Error(n(527,LS,"19.1.1"));ft.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=f(a),r=r!==null?d(r):null,r=r===null?null:r.stateNode,r};var Kx={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rf.isDisabled&&rf.supportsFiber)try{pn=rf.inject(Kx),De=rf}catch{}}return qc.createRoot=function(r,a){if(!s(r))throw Error(n(299));var l=!1,u="",m=Z0,y=J0,w=t_,C=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(C=a.unstable_transitionCallbacks)),a=xS(r,1,!1,null,null,l,u,m,y,w,C,null),r[yt]=a.current,Om(r),new Wm(a)},qc.hydrateRoot=function(r,a,l){if(!s(r))throw Error(n(299));var u=!1,m="",y=Z0,w=J0,C=t_,V=null,J=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(V=l.unstable_transitionCallbacks),l.formState!==void 0&&(J=l.formState)),a=xS(r,1,!0,a,l??null,u,m,y,w,C,V,J),a.context=AS(null),l=a.current,u=Er(),u=bi(u),m=js(u),m.callback=null,Bs(l,m,u),l=u,a.current.lanes=l,Le(a,l),Ri(a),r[yt]=a.current,Om(r),new nf(a)},qc.version="19.1.1",qc}var qS;function sA(){if(qS)return $m.exports;qS=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),$m.exports=iA(),$m.exports}var aA=sA();/**
 * react-router v7.9.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var c1=i=>{throw TypeError(i)},oA=(i,t,e)=>t.has(i)||c1("Cannot "+e),ep=(i,t,e)=>(oA(i,t,"read from private field"),e?e.call(i):t.get(i)),lA=(i,t,e)=>t.has(i)?c1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),XS="popstate";function cA(i={}){function t(n,s){let{pathname:o,search:c,hash:h}=n.location;return gu("",{pathname:o,search:c,hash:h},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(n,s){return typeof s=="string"?s:da(s)}return hA(t,e,null,i)}function te(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function en(i,t){if(!i){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function uA(){return Math.random().toString(36).substring(2,10)}function WS(i,t){return{usr:i.state,key:i.key,idx:t}}function gu(i,t,e=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof t=="string"?Ta(t):t,state:e,key:t&&t.key||n||uA()}}function da({pathname:i="/",search:t="",hash:e=""}){return t&&t!=="?"&&(i+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(i+=e.charAt(0)==="#"?e:"#"+e),i}function Ta(i){let t={};if(i){let e=i.indexOf("#");e>=0&&(t.hash=i.substring(e),i=i.substring(0,e));let n=i.indexOf("?");n>=0&&(t.search=i.substring(n),i=i.substring(0,n)),i&&(t.pathname=i)}return t}function hA(i,t,e,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,c=s.history,h="POP",f=null,d=p();d==null&&(d=0,c.replaceState({...c.state,idx:d},""));function p(){return(c.state||{idx:null}).idx}function v(){h="POP";let D=p(),j=D==null?null:D-d;d=D,f&&f({action:h,location:O.location,delta:j})}function S(D,j){h="PUSH";let G=gu(O.location,D,j);d=p()+1;let Z=WS(G,d),q=O.createHref(G);try{c.pushState(Z,"",q)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;s.location.assign(q)}o&&f&&f({action:h,location:O.location,delta:1})}function b(D,j){h="REPLACE";let G=gu(O.location,D,j);d=p();let Z=WS(G,d),q=O.createHref(G);c.replaceState(Z,"",q),o&&f&&f({action:h,location:O.location,delta:0})}function E(D){return u1(D)}let O={get action(){return h},get location(){return i(s,c)},listen(D){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(XS,v),f=D,()=>{s.removeEventListener(XS,v),f=null}},createHref(D){return t(s,D)},createURL:E,encodeLocation(D){let j=E(D);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:S,replace:b,go(D){return c.go(D)}};return O}function u1(i,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),te(e,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:da(i);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}var Zc,KS=class{constructor(i){if(lA(this,Zc,new Map),i)for(let[t,e]of i)this.set(t,e)}get(i){if(ep(this,Zc).has(i))return ep(this,Zc).get(i);if(i.defaultValue!==void 0)return i.defaultValue;throw new Error("No value found for context")}set(i,t){ep(this,Zc).set(i,t)}};Zc=new WeakMap;var fA=new Set(["lazy","caseSensitive","path","id","index","children"]);function dA(i){return fA.has(i)}var gA=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function mA(i){return gA.has(i)}function pA(i){return i.index===!0}function mu(i,t,e=[],n={},s=!1){return i.map((o,c)=>{let h=[...e,String(c)],f=typeof o.id=="string"?o.id:h.join("-");if(te(o.index!==!0||!o.children,"Cannot specify children on an index route"),te(s||!n[f],`Found a route id collision on id "${f}".  Route id's must be globally unique within Data Router usages`),pA(o)){let d={...o,...t(o),id:f};return n[f]=d,d}else{let d={...o,...t(o),id:f,children:void 0};return n[f]=d,o.children&&(d.children=mu(o.children,t,h,n,s)),d}})}function sa(i,t,e="/"){return Bf(i,t,e,!1)}function Bf(i,t,e,n){let s=typeof t=="string"?Ta(t):t,o=Yr(s.pathname||"/",e);if(o==null)return null;let c=h1(i);vA(c);let h=null;for(let f=0;h==null&&f<c.length;++f){let d=RA(o);h=AA(c[f],d,n)}return h}function yA(i,t){let{route:e,pathname:n,params:s}=i;return{id:e.id,pathname:n,params:s,data:t[e.id],loaderData:t[e.id],handle:e.handle}}function h1(i,t=[],e=[],n="",s=!1){let o=(c,h,f=s,d)=>{let p={relativePath:d===void 0?c.path||"":d,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;te(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let v=Vi([n,p.relativePath]),S=e.concat(p);c.children&&c.children.length>0&&(te(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),h1(c.children,t,S,v,f)),!(c.path==null&&!c.index)&&t.push({path:v,score:CA(v,c.index),routesMeta:S})};return i.forEach((c,h)=>{if(c.path===""||!c.path?.includes("?"))o(c,h);else for(let f of f1(c.path))o(c,h,!0,f)}),t}function f1(i){let t=i.split("/");if(t.length===0)return[];let[e,...n]=t,s=e.endsWith("?"),o=e.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let c=f1(n.join("/")),h=[];return h.push(...c.map(f=>f===""?o:[o,f].join("/"))),s&&h.push(...c),h.map(f=>i.startsWith("/")&&f===""?"/":f)}function vA(i){i.sort((t,e)=>t.score!==e.score?e.score-t.score:xA(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var _A=/^:[\w-]+$/,SA=3,bA=2,TA=1,wA=10,EA=-2,QS=i=>i==="*";function CA(i,t){let e=i.split("/"),n=e.length;return e.some(QS)&&(n+=EA),t&&(n+=bA),e.filter(s=>!QS(s)).reduce((s,o)=>s+(_A.test(o)?SA:o===""?TA:wA),n)}function xA(i,t){return i.length===t.length&&i.slice(0,-1).every((n,s)=>n===t[s])?i[i.length-1]-t[t.length-1]:0}function AA(i,t,e=!1){let{routesMeta:n}=i,s={},o="/",c=[];for(let h=0;h<n.length;++h){let f=n[h],d=h===n.length-1,p=o==="/"?t:t.slice(o.length)||"/",v=td({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},p),S=f.route;if(!v&&d&&e&&!n[n.length-1].route.index&&(v=td({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(s,v.params),c.push({params:s,pathname:Vi([o,v.pathname]),pathnameBase:IA(Vi([o,v.pathnameBase])),route:S}),v.pathnameBase!=="/"&&(o=Vi([o,v.pathnameBase]))}return c}function td(i,t){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[e,n]=DA(i.path,i.caseSensitive,i.end),s=t.match(e);if(!s)return null;let o=s[0],c=o.replace(/(.)\/+$/,"$1"),h=s.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:v},S)=>{if(p==="*"){let E=h[S]||"";c=o.slice(0,o.length-E.length).replace(/(.)\/+$/,"$1")}const b=h[S];return v&&!b?d[p]=void 0:d[p]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:i}}function DA(i,t=!1,e=!0){en(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,f)=>(n.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function RA(i){try{return i.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return en(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),i}}function Yr(i,t){if(t==="/")return i;if(!i.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=i.charAt(e);return n&&n!=="/"?null:i.slice(e)||"/"}function OA({basename:i,pathname:t}){return t==="/"?i:Vi([i,t])}function MA(i,t="/"){let{pathname:e,search:n="",hash:s=""}=typeof i=="string"?Ta(i):i;return{pathname:e?e.startsWith("/")?e:PA(e,t):t,search:kA(n),hash:VA(s)}}function PA(i,t){let e=t.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function np(i,t,e,n){return`Cannot include a '${i}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function d1(i){return i.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Md(i){let t=d1(i);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Pd(i,t,e,n=!1){let s;typeof i=="string"?s=Ta(i):(s={...i},te(!s.pathname||!s.pathname.includes("?"),np("?","pathname","search",s)),te(!s.pathname||!s.pathname.includes("#"),np("#","pathname","hash",s)),te(!s.search||!s.search.includes("#"),np("#","search","hash",s)));let o=i===""||s.pathname==="",c=o?"/":s.pathname,h;if(c==null)h=e;else{let v=t.length-1;if(!n&&c.startsWith("..")){let S=c.split("/");for(;S[0]==="..";)S.shift(),v-=1;s.pathname=S.join("/")}h=v>=0?t[v]:"/"}let f=MA(s,h),d=c&&c!=="/"&&c.endsWith("/"),p=(o||c===".")&&e.endsWith("/");return!f.pathname.endsWith("/")&&(d||p)&&(f.pathname+="/"),f}var Vi=i=>i.join("/").replace(/\/\/+/g,"/"),IA=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),kA=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,VA=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,ed=class{constructor(i,t,e,n=!1){this.status=i,this.statusText=t||"",this.internal=n,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function pu(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var g1=["POST","PUT","PATCH","DELETE"],LA=new Set(g1),NA=["GET",...g1],jA=new Set(NA),BA=new Set([301,302,303,307,308]),FA=new Set([307,308]),rp={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},UA={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Xc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},zA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gy=i=>zA.test(i),HA=i=>({hasErrorBoundary:!!i.hasErrorBoundary}),m1="remix-router-transitions",p1=Symbol("ResetLoaderData");function GA(i){const t=i.window?i.window:typeof window<"u"?window:void 0,e=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";te(i.routes.length>0,"You must provide a non-empty routes array to createRouter");let n=i.hydrationRouteProperties||[],s=i.mapRouteProperties||HA,o={},c=mu(i.routes,s,void 0,o),h,f=i.basename||"/";f.startsWith("/")||(f=`/${f}`);let d=i.dataStrategy||KA,p={...i.future},v=null,S=new Set,b=null,E=null,O=null,D=i.hydrationData!=null,j=sa(c,i.history.location,f),G=!1,Z=null,q;if(j==null&&!i.patchRoutesOnNavigation){let U=Fr(404,{pathname:i.history.location.pathname}),{matches:K,route:tt}=af(c);q=!0,j=K,Z={[tt.id]:U}}else if(j&&!i.hydrationData&&yr(j,c,i.history.location.pathname).active&&(j=null),j)if(j.some(U=>U.route.lazy))q=!1;else if(!j.some(U=>my(U.route)))q=!0;else{let U=i.hydrationData?i.hydrationData.loaderData:null,K=i.hydrationData?i.hydrationData.errors:null;if(K){let tt=j.findIndex(ht=>K[ht.route.id]!==void 0);q=j.slice(0,tt+1).every(ht=>!Op(ht.route,U,K))}else q=j.every(tt=>!Op(tt.route,U,K))}else{q=!1,j=[];let U=yr(null,c,i.history.location.pathname);U.active&&U.matches&&(G=!0,j=U.matches)}let B,I={historyAction:i.history.action,location:i.history.location,matches:j,initialized:q,navigation:rp,restoreScrollPosition:i.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:i.hydrationData&&i.hydrationData.loaderData||{},actionData:i.hydrationData&&i.hydrationData.actionData||null,errors:i.hydrationData&&i.hydrationData.errors||Z,fetchers:new Map,blockers:new Map},P="POP",x=!1,R,L=!1,k=new Map,F=null,M=!1,vt=!1,Pt=new Set,W=new Map,ft=0,gt=-1,It=new Map,N=new Set,at=new Map,pt=new Map,mt=new Set,St=new Map,Ut,Et=null;function Ht(){if(v=i.history.listen(({action:U,location:K,delta:tt})=>{if(Ut){Ut(),Ut=void 0;return}en(St.size===0||tt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ht=xs({currentLocation:I.location,nextLocation:K,historyAction:U});if(ht&&tt!=null){let yt=new Promise(xt=>{Ut=xt});i.history.go(tt*-1),ti(ht,{state:"blocked",location:K,proceed(){ti(ht,{state:"proceeding",proceed:void 0,reset:void 0,location:K}),yt.then(()=>i.history.go(tt))},reset(){let xt=new Map(I.blockers);xt.set(ht,Xc),ae({blockers:xt})}});return}return Jn(U,K)}),e){u2(t,k);let U=()=>h2(t,k);t.addEventListener("pagehide",U),F=()=>t.removeEventListener("pagehide",U)}return I.initialized||Jn("POP",I.location,{initialHydration:!0}),B}function Wt(){v&&v(),F&&F(),S.clear(),R&&R.abort(),I.fetchers.forEach((U,K)=>xa(K)),I.blockers.forEach((U,K)=>Jr(K))}function Be(U){return S.add(U),()=>S.delete(U)}function ae(U,K={}){U.matches&&(U.matches=U.matches.map(yt=>{let xt=o[yt.route.id],Dt=yt.route;return Dt.element!==xt.element||Dt.errorElement!==xt.errorElement||Dt.hydrateFallbackElement!==xt.hydrateFallbackElement?{...yt,route:xt}:yt})),I={...I,...U};let tt=[],ht=[];I.fetchers.forEach((yt,xt)=>{yt.state==="idle"&&(mt.has(xt)?tt.push(xt):ht.push(xt))}),mt.forEach(yt=>{!I.fetchers.has(yt)&&!W.has(yt)&&tt.push(yt)}),[...S].forEach(yt=>yt(I,{deletedFetchers:tt,viewTransitionOpts:K.viewTransitionOpts,flushSync:K.flushSync===!0})),tt.forEach(yt=>xa(yt)),ht.forEach(yt=>I.fetchers.delete(yt))}function mr(U,K,{flushSync:tt}={}){let ht=I.actionData!=null&&I.navigation.formMethod!=null&&ur(I.navigation.formMethod)&&I.navigation.state==="loading"&&U.state?._isRedirect!==!0,yt;K.actionData?Object.keys(K.actionData).length>0?yt=K.actionData:yt=null:ht?yt=I.actionData:yt=null;let xt=K.loaderData?ab(I.loaderData,K.loaderData,K.matches||[],K.errors):I.loaderData,Dt=I.blockers;Dt.size>0&&(Dt=new Map(Dt),Dt.forEach((Mt,Tt)=>Dt.set(Tt,Xc)));let Rt=M?!1:ei(U,K.matches||I.matches),Ct=x===!0||I.navigation.formMethod!=null&&ur(I.navigation.formMethod)&&U.state?._isRedirect!==!0;h&&(c=h,h=void 0),M||P==="POP"||(P==="PUSH"?i.history.push(U,U.state):P==="REPLACE"&&i.history.replace(U,U.state));let kt;if(P==="POP"){let Mt=k.get(I.location.pathname);Mt&&Mt.has(U.pathname)?kt={currentLocation:I.location,nextLocation:U}:k.has(U.pathname)&&(kt={currentLocation:U,nextLocation:I.location})}else if(L){let Mt=k.get(I.location.pathname);Mt?Mt.add(U.pathname):(Mt=new Set([U.pathname]),k.set(I.location.pathname,Mt)),kt={currentLocation:I.location,nextLocation:U}}ae({...K,actionData:yt,loaderData:xt,historyAction:P,location:U,initialized:!0,navigation:rp,revalidation:"idle",restoreScrollPosition:Rt,preventScrollReset:Ct,blockers:Dt},{viewTransitionOpts:kt,flushSync:tt===!0}),P="POP",x=!1,L=!1,M=!1,vt=!1,Et?.resolve(),Et=null}async function Yi(U,K){if(typeof U=="number"){i.history.go(U);return}let tt=Rp(I.location,I.matches,f,U,K?.fromRouteId,K?.relative),{path:ht,submission:yt,error:xt}=$S(!1,tt,K),Dt=I.location,Rt=gu(I.location,ht,K&&K.state);Rt={...Rt,...i.history.encodeLocation(Rt)};let Ct=K&&K.replace!=null?K.replace:void 0,kt="PUSH";Ct===!0?kt="REPLACE":Ct===!1||yt!=null&&ur(yt.formMethod)&&yt.formAction===I.location.pathname+I.location.search&&(kt="REPLACE");let Mt=K&&"preventScrollReset"in K?K.preventScrollReset===!0:void 0,Tt=(K&&K.flushSync)===!0,Yt=xs({currentLocation:Dt,nextLocation:Rt,historyAction:kt});if(Yt){ti(Yt,{state:"blocked",location:Rt,proceed(){ti(Yt,{state:"proceeding",proceed:void 0,reset:void 0,location:Rt}),Yi(U,K)},reset(){let ue=new Map(I.blockers);ue.set(Yt,Xc),ae({blockers:ue})}});return}await Jn(kt,Rt,{submission:yt,pendingError:xt,preventScrollReset:Mt,replace:K&&K.replace,enableViewTransition:K&&K.viewTransition,flushSync:Tt})}function qi(){Et||(Et=f2()),$r(),ae({revalidation:"loading"});let U=Et.promise;return I.navigation.state==="submitting"?U:I.navigation.state==="idle"?(Jn(I.historyAction,I.location,{startUninterruptedRevalidation:!0}),U):(Jn(P||I.historyAction,I.navigation.location,{overrideNavigation:I.navigation,enableViewTransition:L===!0}),U)}async function Jn(U,K,tt){R&&R.abort(),R=null,P=U,M=(tt&&tt.startUninterruptedRevalidation)===!0,Co(I.location,I.matches),x=(tt&&tt.preventScrollReset)===!0,L=(tt&&tt.enableViewTransition)===!0;let ht=h||c,yt=tt&&tt.overrideNavigation,xt=tt?.initialHydration&&I.matches&&I.matches.length>0&&!G?I.matches:sa(ht,K,f),Dt=(tt&&tt.flushSync)===!0;if(xt&&I.initialized&&!vt&&r2(I.location,K)&&!(tt&&tt.submission&&ur(tt.submission.formMethod))){mr(K,{matches:xt},{flushSync:Dt});return}let Rt=yr(xt,ht,K.pathname);if(Rt.active&&Rt.matches&&(xt=Rt.matches),!xt){let{error:ee,notFoundMatches:be,route:he}=Dr(K.pathname);mr(K,{matches:be,loaderData:{},errors:{[he.id]:ee}},{flushSync:Dt});return}R=new AbortController;let Ct=cl(i.history,K,R.signal,tt&&tt.submission),kt=i.getContext?await i.getContext():new KS,Mt;if(tt&&tt.pendingError)Mt=[aa(xt).route.id,{type:"error",error:tt.pendingError}];else if(tt&&tt.submission&&ur(tt.submission.formMethod)){let ee=await Gl(Ct,K,tt.submission,xt,kt,Rt.active,tt&&tt.initialHydration===!0,{replace:tt.replace,flushSync:Dt});if(ee.shortCircuited)return;if(ee.pendingActionResult){let[be,he]=ee.pendingActionResult;if(Ar(he)&&pu(he.error)&&he.error.status===404){R=null,mr(K,{matches:ee.matches,loaderData:{},errors:{[be]:he.error}});return}}xt=ee.matches||xt,Mt=ee.pendingActionResult,yt=ip(K,tt.submission),Dt=!1,Rt.active=!1,Ct=cl(i.history,Ct.url,Ct.signal)}let{shortCircuited:Tt,matches:Yt,loaderData:ue,errors:xe}=await Ca(Ct,K,xt,kt,Rt.active,yt,tt&&tt.submission,tt&&tt.fetcherSubmission,tt&&tt.replace,tt&&tt.initialHydration===!0,Dt,Mt);Tt||(R=null,mr(K,{matches:Yt||xt,...ob(Mt),loaderData:ue,errors:xe}))}async function Gl(U,K,tt,ht,yt,xt,Dt,Rt={}){$r();let Ct=l2(K,tt);if(ae({navigation:Ct},{flushSync:Rt.flushSync===!0}),xt){let Tt=await bi(ht,K.pathname,U.signal);if(Tt.type==="aborted")return{shortCircuited:!0};if(Tt.type==="error"){if(Tt.partialMatches.length===0){let{matches:ue,route:xe}=af(c);return{matches:ue,pendingActionResult:[xe.id,{type:"error",error:Tt.error}]}}let Yt=aa(Tt.partialMatches).route.id;return{matches:Tt.partialMatches,pendingActionResult:[Yt,{type:"error",error:Tt.error}]}}else if(Tt.matches)ht=Tt.matches;else{let{notFoundMatches:Yt,error:ue,route:xe}=Dr(K.pathname);return{matches:Yt,pendingActionResult:[xe.id,{type:"error",error:ue}]}}}let kt,Mt=Ff(ht,K);if(!Mt.route.action&&!Mt.route.lazy)kt={type:"error",error:Fr(405,{method:U.method,pathname:K.pathname,routeId:Mt.route.id})};else{let Tt=vl(s,o,U,ht,Mt,Dt?[]:n,yt),Yt=await Qr(U,Tt,yt,null);if(kt=Yt[Mt.route.id],!kt){for(let ue of ht)if(Yt[ue.route.id]){kt=Yt[ue.route.id];break}}if(U.signal.aborted)return{shortCircuited:!0}}if(so(kt)){let Tt;return Rt&&Rt.replace!=null?Tt=Rt.replace:Tt=rb(kt.response.headers.get("Location"),new URL(U.url),f)===I.location.pathname+I.location.search,await Kr(U,kt,!0,{submission:tt,replace:Tt}),{shortCircuited:!0}}if(Ar(kt)){let Tt=aa(ht,Mt.route.id);return(Rt&&Rt.replace)!==!0&&(P="PUSH"),{matches:ht,pendingActionResult:[Tt.route.id,kt,Mt.route.id]}}return{matches:ht,pendingActionResult:[Mt.route.id,kt]}}async function Ca(U,K,tt,ht,yt,xt,Dt,Rt,Ct,kt,Mt,Tt){let Yt=xt||ip(K,Dt),ue=Dt||Rt||cb(Yt),xe=!M&&!kt;if(yt){if(xe){let Fe=En(Tt);ae({navigation:Yt,...Fe!==void 0?{actionData:Fe}:{}},{flushSync:Mt})}let Kt=await bi(tt,K.pathname,U.signal);if(Kt.type==="aborted")return{shortCircuited:!0};if(Kt.type==="error"){if(Kt.partialMatches.length===0){let{matches:Ln,route:rr}=af(c);return{matches:Ln,loaderData:{},errors:{[rr.id]:Kt.error}}}let Fe=aa(Kt.partialMatches).route.id;return{matches:Kt.partialMatches,loaderData:{},errors:{[Fe]:Kt.error}}}else if(Kt.matches)tt=Kt.matches;else{let{error:Fe,notFoundMatches:Ln,route:rr}=Dr(K.pathname);return{matches:Ln,loaderData:{},errors:{[rr.id]:Fe}}}}let ee=h||c,{dsMatches:be,revalidatingFetchers:he}=ZS(U,ht,s,o,i.history,I,tt,ue,K,kt?[]:n,kt===!0,vt,Pt,mt,at,N,ee,f,i.patchRoutesOnNavigation!=null,Tt);if(gt=++ft,!i.dataStrategy&&!be.some(Kt=>Kt.shouldLoad)&&!be.some(Kt=>Kt.route.middleware&&Kt.route.middleware.length>0)&&he.length===0){let Kt=Zr();return mr(K,{matches:tt,loaderData:{},errors:Tt&&Ar(Tt[1])?{[Tt[0]]:Tt[1].error}:null,...ob(Tt),...Kt?{fetchers:new Map(I.fetchers)}:{}},{flushSync:Mt}),{shortCircuited:!0}}if(xe){let Kt={};if(!yt){Kt.navigation=Yt;let Fe=En(Tt);Fe!==void 0&&(Kt.actionData=Fe)}he.length>0&&(Kt.fetchers=To(he)),ae(Kt,{flushSync:Mt})}he.forEach(Kt=>{tr(Kt.key),Kt.controller&&W.set(Kt.key,Kt.controller)});let yn=()=>he.forEach(Kt=>tr(Kt.key));R&&R.signal.addEventListener("abort",yn);let{loaderResults:kn,fetcherResults:Vn}=await wo(be,he,U,ht);if(U.signal.aborted)return{shortCircuited:!0};R&&R.signal.removeEventListener("abort",yn),he.forEach(Kt=>W.delete(Kt.key));let We=of(kn);if(We)return await Kr(U,We.result,!0,{replace:Ct}),{shortCircuited:!0};if(We=of(Vn),We)return N.add(We.key),await Kr(U,We.result,!0,{replace:Ct}),{shortCircuited:!0};let{loaderData:Ti,errors:Xi}=sb(I,tt,kn,Tt,he,Vn);kt&&I.errors&&(Xi={...I.errors,...Xi});let Yn=Zr(),Rr=er(gt),xn=Yn||Rr||he.length>0;return{matches:tt,loaderData:Ti,errors:Xi,...xn?{fetchers:new Map(I.fetchers)}:{}}}function En(U){if(U&&!Ar(U[1]))return{[U[0]]:U[1].data};if(I.actionData)return Object.keys(I.actionData).length===0?null:I.actionData}function To(U){return U.forEach(K=>{let tt=I.fetchers.get(K.key),ht=Wc(void 0,tt?tt.data:void 0);I.fetchers.set(K.key,ht)}),new Map(I.fetchers)}async function Xe(U,K,tt,ht){tr(U);let yt=(ht&&ht.flushSync)===!0,xt=h||c,Dt=Rp(I.location,I.matches,f,tt,K,ht?.relative),Rt=sa(xt,Dt,f),Ct=yr(Rt,xt,Dt);if(Ct.active&&Ct.matches&&(Rt=Ct.matches),!Rt){De(U,K,Fr(404,{pathname:Dt}),{flushSync:yt});return}let{path:kt,submission:Mt,error:Tt}=$S(!0,Dt,ht);if(Tt){De(U,K,Tt,{flushSync:yt});return}let Yt=i.getContext?await i.getContext():new KS,ue=(ht&&ht.preventScrollReset)===!0;if(Mt&&ur(Mt.formMethod)){await nn(U,K,kt,Rt,Yt,Ct.active,yt,ue,Mt);return}at.set(U,{routeId:K,path:kt}),await Wr(U,K,kt,Rt,Yt,Ct.active,yt,ue,Mt)}async function nn(U,K,tt,ht,yt,xt,Dt,Rt,Ct){$r(),at.delete(U);let kt=I.fetchers.get(U);pn(U,c2(Ct,kt),{flushSync:Dt});let Mt=new AbortController,Tt=cl(i.history,tt,Mt.signal,Ct);if(xt){let Re=await bi(ht,new URL(Tt.url).pathname,Tt.signal,U);if(Re.type==="aborted")return;if(Re.type==="error"){De(U,K,Re.error,{flushSync:Dt});return}else if(Re.matches)ht=Re.matches;else{De(U,K,Fr(404,{pathname:tt}),{flushSync:Dt});return}}let Yt=Ff(ht,tt);if(!Yt.route.action&&!Yt.route.lazy){let Re=Fr(405,{method:Ct.formMethod,pathname:tt,routeId:K});De(U,K,Re,{flushSync:Dt});return}W.set(U,Mt);let ue=ft,xe=vl(s,o,Tt,ht,Yt,n,yt),be=(await Qr(Tt,xe,yt,U))[Yt.route.id];if(Tt.signal.aborted){W.get(U)===Mt&&W.delete(U);return}if(mt.has(U)){if(so(be)||Ar(be)){pn(U,hs(void 0));return}}else{if(so(be))if(W.delete(U),gt>ue){pn(U,hs(void 0));return}else return N.add(U),pn(U,Wc(Ct)),Kr(Tt,be,!1,{fetcherSubmission:Ct,preventScrollReset:Rt});if(Ar(be)){De(U,K,be.error);return}}let he=I.navigation.location||I.location,yn=cl(i.history,he,Mt.signal),kn=h||c,Vn=I.navigation.state!=="idle"?sa(kn,I.navigation.location,f):I.matches;te(Vn,"Didn't find any matches after fetcher action");let We=++ft;It.set(U,We);let Ti=Wc(Ct,be.data);I.fetchers.set(U,Ti);let{dsMatches:Xi,revalidatingFetchers:Yn}=ZS(yn,yt,s,o,i.history,I,Vn,Ct,he,n,!1,vt,Pt,mt,at,N,kn,f,i.patchRoutesOnNavigation!=null,[Yt.route.id,be]);Yn.filter(Re=>Re.key!==U).forEach(Re=>{let Ds=Re.key,ir=I.fetchers.get(Ds),Ie=Wc(void 0,ir?ir.data:void 0);I.fetchers.set(Ds,Ie),tr(Ds),Re.controller&&W.set(Ds,Re.controller)}),ae({fetchers:new Map(I.fetchers)});let Rr=()=>Yn.forEach(Re=>tr(Re.key));Mt.signal.addEventListener("abort",Rr);let{loaderResults:xn,fetcherResults:Kt}=await wo(Xi,Yn,yn,yt);if(Mt.signal.aborted)return;if(Mt.signal.removeEventListener("abort",Rr),It.delete(U),W.delete(U),Yn.forEach(Re=>W.delete(Re.key)),I.fetchers.has(U)){let Re=hs(be.data);I.fetchers.set(U,Re)}let Fe=of(xn);if(Fe)return Kr(yn,Fe.result,!1,{preventScrollReset:Rt});if(Fe=of(Kt),Fe)return N.add(Fe.key),Kr(yn,Fe.result,!1,{preventScrollReset:Rt});let{loaderData:Ln,errors:rr}=sb(I,Vn,xn,void 0,Yn,Kt);er(We),I.navigation.state==="loading"&&We>gt?(te(P,"Expected pending action"),R&&R.abort(),mr(I.navigation.location,{matches:Vn,loaderData:Ln,errors:rr,fetchers:new Map(I.fetchers)})):(ae({errors:rr,loaderData:ab(I.loaderData,Ln,Vn,rr),fetchers:new Map(I.fetchers)}),vt=!1)}async function Wr(U,K,tt,ht,yt,xt,Dt,Rt,Ct){let kt=I.fetchers.get(U);pn(U,Wc(Ct,kt?kt.data:void 0),{flushSync:Dt});let Mt=new AbortController,Tt=cl(i.history,tt,Mt.signal);if(xt){let he=await bi(ht,new URL(Tt.url).pathname,Tt.signal,U);if(he.type==="aborted")return;if(he.type==="error"){De(U,K,he.error,{flushSync:Dt});return}else if(he.matches)ht=he.matches;else{De(U,K,Fr(404,{pathname:tt}),{flushSync:Dt});return}}let Yt=Ff(ht,tt);W.set(U,Mt);let ue=ft,xe=vl(s,o,Tt,ht,Yt,n,yt),be=(await Qr(Tt,xe,yt,U))[Yt.route.id];if(W.get(U)===Mt&&W.delete(U),!Tt.signal.aborted){if(mt.has(U)){pn(U,hs(void 0));return}if(so(be))if(gt>ue){pn(U,hs(void 0));return}else{N.add(U),await Kr(Tt,be,!1,{preventScrollReset:Rt});return}if(Ar(be)){De(U,K,be.error);return}pn(U,hs(be.data))}}async function Kr(U,K,tt,{submission:ht,fetcherSubmission:yt,preventScrollReset:xt,replace:Dt}={}){K.response.headers.has("X-Remix-Revalidate")&&(vt=!0);let Rt=K.response.headers.get("Location");te(Rt,"Expected a Location header on the redirect Response"),Rt=rb(Rt,new URL(U.url),f);let Ct=gu(I.location,Rt,{_isRedirect:!0});if(e){let xe=!1;if(K.response.headers.has("X-Remix-Reload-Document"))xe=!0;else if(gy(Rt)){const ee=u1(Rt,!0);xe=ee.origin!==t.location.origin||Yr(ee.pathname,f)==null}if(xe){Dt?t.location.replace(Rt):t.location.assign(Rt);return}}R=null;let kt=Dt===!0||K.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Mt,formAction:Tt,formEncType:Yt}=I.navigation;!ht&&!yt&&Mt&&Tt&&Yt&&(ht=cb(I.navigation));let ue=ht||yt;if(FA.has(K.response.status)&&ue&&ur(ue.formMethod))await Jn(kt,Ct,{submission:{...ue,formAction:Rt},preventScrollReset:xt||x,enableViewTransition:tt?L:void 0});else{let xe=ip(Ct,ht);await Jn(kt,Ct,{overrideNavigation:xe,fetcherSubmission:yt,preventScrollReset:xt||x,enableViewTransition:tt?L:void 0})}}async function Qr(U,K,tt,ht){let yt,xt={};try{yt=await $A(d,U,K,ht,tt,!1)}catch(Dt){return K.filter(Rt=>Rt.shouldLoad).forEach(Rt=>{xt[Rt.route.id]={type:"error",error:Dt}}),xt}if(U.signal.aborted)return xt;for(let[Dt,Rt]of Object.entries(yt))if(a2(Rt)){let Ct=Rt.result;xt[Dt]={type:"redirect",response:e2(Ct,U,Dt,K,f)}}else xt[Dt]=await t2(Rt);return xt}async function wo(U,K,tt,ht){let yt=Qr(tt,U,ht,null),xt=Promise.all(K.map(async Ct=>{if(Ct.matches&&Ct.match&&Ct.request&&Ct.controller){let Mt=(await Qr(Ct.request,Ct.matches,ht,Ct.key))[Ct.match.route.id];return{[Ct.key]:Mt}}else return Promise.resolve({[Ct.key]:{type:"error",error:Fr(404,{pathname:Ct.path})}})})),Dt=await yt,Rt=(await xt).reduce((Ct,kt)=>Object.assign(Ct,kt),{});return{loaderResults:Dt,fetcherResults:Rt}}function $r(){vt=!0,at.forEach((U,K)=>{W.has(K)&&Pt.add(K),tr(K)})}function pn(U,K,tt={}){I.fetchers.set(U,K),ae({fetchers:new Map(I.fetchers)},{flushSync:(tt&&tt.flushSync)===!0})}function De(U,K,tt,ht={}){let yt=aa(I.matches,K);xa(U),ae({errors:{[yt.route.id]:tt},fetchers:new Map(I.fetchers)},{flushSync:(ht&&ht.flushSync)===!0})}function Gn(U){return pt.set(U,(pt.get(U)||0)+1),mt.has(U)&&mt.delete(U),I.fetchers.get(U)||UA}function Cn(U,K){tr(U,K?.reason),pn(U,hs(null))}function xa(U){let K=I.fetchers.get(U);W.has(U)&&!(K&&K.state==="loading"&&It.has(U))&&tr(U),at.delete(U),It.delete(U),N.delete(U),mt.delete(U),Pt.delete(U),I.fetchers.delete(U)}function Eo(U){let K=(pt.get(U)||0)-1;K<=0?(pt.delete(U),mt.add(U)):pt.set(U,K),ae({fetchers:new Map(I.fetchers)})}function tr(U,K){let tt=W.get(U);tt&&(tt.abort(K),W.delete(U))}function pr(U){for(let K of U){let tt=Gn(K),ht=hs(tt.data);I.fetchers.set(K,ht)}}function Zr(){let U=[],K=!1;for(let tt of N){let ht=I.fetchers.get(tt);te(ht,`Expected fetcher: ${tt}`),ht.state==="loading"&&(N.delete(tt),U.push(tt),K=!0)}return pr(U),K}function er(U){let K=[];for(let[tt,ht]of It)if(ht<U){let yt=I.fetchers.get(tt);te(yt,`Expected fetcher: ${tt}`),yt.state==="loading"&&(tr(tt),It.delete(tt),K.push(tt))}return pr(K),K.length>0}function nr(U,K){let tt=I.blockers.get(U)||Xc;return St.get(U)!==K&&St.set(U,K),tt}function Jr(U){I.blockers.delete(U),St.delete(U)}function ti(U,K){let tt=I.blockers.get(U)||Xc;te(tt.state==="unblocked"&&K.state==="blocked"||tt.state==="blocked"&&K.state==="blocked"||tt.state==="blocked"&&K.state==="proceeding"||tt.state==="blocked"&&K.state==="unblocked"||tt.state==="proceeding"&&K.state==="unblocked",`Invalid blocker state transition: ${tt.state} -> ${K.state}`);let ht=new Map(I.blockers);ht.set(U,K),ae({blockers:ht})}function xs({currentLocation:U,nextLocation:K,historyAction:tt}){if(St.size===0)return;St.size>1&&en(!1,"A router only supports one blocker at a time");let ht=Array.from(St.entries()),[yt,xt]=ht[ht.length-1],Dt=I.blockers.get(yt);if(!(Dt&&Dt.state==="proceeding")&&xt({currentLocation:U,nextLocation:K,historyAction:tt}))return yt}function Dr(U){let K=Fr(404,{pathname:U}),tt=h||c,{matches:ht,route:yt}=af(tt);return{notFoundMatches:ht,route:yt,error:K}}function As(U,K,tt){if(b=U,O=K,E=tt||null,!D&&I.navigation===rp){D=!0;let ht=ei(I.location,I.matches);ht!=null&&ae({restoreScrollPosition:ht})}return()=>{b=null,O=null,E=null}}function Le(U,K){return E&&E(U,K.map(ht=>yA(ht,I.loaderData)))||U.key}function Co(U,K){if(b&&O){let tt=Le(U,K);b[tt]=O()}}function ei(U,K){if(b){let tt=Le(U,K),ht=b[tt];if(typeof ht=="number")return ht}return null}function yr(U,K,tt){if(i.patchRoutesOnNavigation)if(U){if(Object.keys(U[0].params).length>0)return{active:!0,matches:Bf(K,tt,f,!0)}}else return{active:!0,matches:Bf(K,tt,f,!0)||[]};return{active:!1,matches:null}}async function bi(U,K,tt,ht){if(!i.patchRoutesOnNavigation)return{type:"success",matches:U};let yt=U;for(;;){let xt=h==null,Dt=h||c,Rt=o;try{await i.patchRoutesOnNavigation({signal:tt,path:K,matches:yt,fetcherKey:ht,patch:(Mt,Tt)=>{tt.aborted||JS(Mt,Tt,Dt,Rt,s,!1)}})}catch(Mt){return{type:"error",error:Mt,partialMatches:yt}}finally{xt&&!tt.aborted&&(c=[...c])}if(tt.aborted)return{type:"aborted"};let Ct=sa(Dt,K,f);if(Ct)return{type:"success",matches:Ct};let kt=Bf(Dt,K,f,!0);if(!kt||yt.length===kt.length&&yt.every((Mt,Tt)=>Mt.route.id===kt[Tt].route.id))return{type:"success",matches:null};yt=kt}}function Aa(U){o={},h=mu(U,s,void 0,o)}function ni(U,K,tt=!1){let ht=h==null;JS(U,K,h||c,o,s,tt),ht&&(c=[...c],ae({}))}return B={get basename(){return f},get future(){return p},get state(){return I},get routes(){return c},get window(){return t},initialize:Ht,subscribe:Be,enableScrollRestoration:As,navigate:Yi,fetch:Xe,revalidate:qi,createHref:U=>i.history.createHref(U),encodeLocation:U=>i.history.encodeLocation(U),getFetcher:Gn,resetFetcher:Cn,deleteFetcher:Eo,dispose:Wt,getBlocker:nr,deleteBlocker:Jr,patchRoutes:ni,_internalFetchControllers:W,_internalSetRoutes:Aa,_internalSetStateDoNotUseOrYouWillBreakYourApp(U){ae(U)}},B}function YA(i){return i!=null&&("formData"in i&&i.formData!=null||"body"in i&&i.body!==void 0)}function Rp(i,t,e,n,s,o){let c,h;if(s){c=[];for(let d of t)if(c.push(d),d.route.id===s){h=d;break}}else c=t,h=t[t.length-1];let f=Pd(n||".",Md(c),Yr(i.pathname,e)||i.pathname,o==="path");if(n==null&&(f.search=i.search,f.hash=i.hash),(n==null||n===""||n===".")&&h){let d=py(f.search);if(h.route.index&&!d)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!h.route.index&&d){let p=new URLSearchParams(f.search),v=p.getAll("index");p.delete("index"),v.filter(b=>b).forEach(b=>p.append("index",b));let S=p.toString();f.search=S?`?${S}`:""}}return e!=="/"&&(f.pathname=OA({basename:e,pathname:f.pathname})),da(f)}function $S(i,t,e){if(!e||!YA(e))return{path:t};if(e.formMethod&&!o2(e.formMethod))return{path:t,error:Fr(405,{method:e.formMethod})};let n=()=>({path:t,error:Fr(400,{type:"invalid-body"})}),o=(e.formMethod||"get").toUpperCase(),c=T1(t);if(e.body!==void 0){if(e.formEncType==="text/plain"){if(!ur(o))return n();let v=typeof e.body=="string"?e.body:e.body instanceof FormData||e.body instanceof URLSearchParams?Array.from(e.body.entries()).reduce((S,[b,E])=>`${S}${b}=${E}
`,""):String(e.body);return{path:t,submission:{formMethod:o,formAction:c,formEncType:e.formEncType,formData:void 0,json:void 0,text:v}}}else if(e.formEncType==="application/json"){if(!ur(o))return n();try{let v=typeof e.body=="string"?JSON.parse(e.body):e.body;return{path:t,submission:{formMethod:o,formAction:c,formEncType:e.formEncType,formData:void 0,json:v,text:void 0}}}catch{return n()}}}te(typeof FormData=="function","FormData is not available in this environment");let h,f;if(e.formData)h=Pp(e.formData),f=e.formData;else if(e.body instanceof FormData)h=Pp(e.body),f=e.body;else if(e.body instanceof URLSearchParams)h=e.body,f=ib(h);else if(e.body==null)h=new URLSearchParams,f=new FormData;else try{h=new URLSearchParams(e.body),f=ib(h)}catch{return n()}let d={formMethod:o,formAction:c,formEncType:e&&e.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(ur(d.formMethod))return{path:t,submission:d};let p=Ta(t);return i&&p.search&&py(p.search)&&h.append("index",""),p.search=`?${h}`,{path:da(p),submission:d}}function ZS(i,t,e,n,s,o,c,h,f,d,p,v,S,b,E,O,D,j,G,Z){let q=Z?Ar(Z[1])?Z[1].error:Z[1].data:void 0,B=s.createURL(o.location),I=s.createURL(f),P;if(p&&o.errors){let M=Object.keys(o.errors)[0];P=c.findIndex(vt=>vt.route.id===M)}else if(Z&&Ar(Z[1])){let M=Z[0];P=c.findIndex(vt=>vt.route.id===M)-1}let x=Z?Z[1].statusCode:void 0,R=x&&x>=400,L={currentUrl:B,currentParams:o.matches[0]?.params||{},nextUrl:I,nextParams:c[0].params,...h,actionResult:q,actionStatus:x},k=c.map((M,vt)=>{let{route:Pt}=M,W=null;if(P!=null&&vt>P?W=!1:Pt.lazy?W=!0:my(Pt)?p?W=Op(Pt,o.loaderData,o.errors):qA(o.loaderData,o.matches[vt],M)&&(W=!0):W=!1,W!==null)return Mp(e,n,i,M,d,t,W);let ft=R?!1:v||B.pathname+B.search===I.pathname+I.search||B.search!==I.search||XA(o.matches[vt],M),gt={...L,defaultShouldRevalidate:ft},It=nd(M,gt);return Mp(e,n,i,M,d,t,It,gt)}),F=[];return E.forEach((M,vt)=>{if(p||!c.some(pt=>pt.route.id===M.routeId)||b.has(vt))return;let Pt=o.fetchers.get(vt),W=Pt&&Pt.state!=="idle"&&Pt.data===void 0,ft=sa(D,M.path,j);if(!ft){if(G&&W)return;F.push({key:vt,routeId:M.routeId,path:M.path,matches:null,match:null,request:null,controller:null});return}if(O.has(vt))return;let gt=Ff(ft,M.path),It=new AbortController,N=cl(s,M.path,It.signal),at=null;if(S.has(vt))S.delete(vt),at=vl(e,n,N,ft,gt,d,t);else if(W)v&&(at=vl(e,n,N,ft,gt,d,t));else{let pt={...L,defaultShouldRevalidate:R?!1:v};nd(gt,pt)&&(at=vl(e,n,N,ft,gt,d,t,pt))}at&&F.push({key:vt,routeId:M.routeId,path:M.path,matches:at,match:gt,request:N,controller:It})}),{dsMatches:k,revalidatingFetchers:F}}function my(i){return i.loader!=null||i.middleware!=null&&i.middleware.length>0}function Op(i,t,e){if(i.lazy)return!0;if(!my(i))return!1;let n=t!=null&&i.id in t,s=e!=null&&e[i.id]!==void 0;return!n&&s?!1:typeof i.loader=="function"&&i.loader.hydrate===!0?!0:!n&&!s}function qA(i,t,e){let n=!t||e.route.id!==t.route.id,s=!i.hasOwnProperty(e.route.id);return n||s}function XA(i,t){let e=i.route.path;return i.pathname!==t.pathname||e!=null&&e.endsWith("*")&&i.params["*"]!==t.params["*"]}function nd(i,t){if(i.route.shouldRevalidate){let e=i.route.shouldRevalidate(t);if(typeof e=="boolean")return e}return t.defaultShouldRevalidate}function JS(i,t,e,n,s,o){let c;if(i){let d=n[i];te(d,`No route found to patch children into: routeId = ${i}`),d.children||(d.children=[]),c=d.children}else c=e;let h=[],f=[];if(t.forEach(d=>{let p=c.find(v=>y1(d,v));p?f.push({existingRoute:p,newRoute:d}):h.push(d)}),h.length>0){let d=mu(h,s,[i||"_","patch",String(c?.length||"0")],n);c.push(...d)}if(o&&f.length>0)for(let d=0;d<f.length;d++){let{existingRoute:p,newRoute:v}=f[d],S=p,[b]=mu([v],s,[],{},!0);Object.assign(S,{element:b.element?b.element:S.element,errorElement:b.errorElement?b.errorElement:S.errorElement,hydrateFallbackElement:b.hydrateFallbackElement?b.hydrateFallbackElement:S.hydrateFallbackElement})}}function y1(i,t){return"id"in i&&"id"in t&&i.id===t.id?!0:i.index===t.index&&i.path===t.path&&i.caseSensitive===t.caseSensitive?(!i.children||i.children.length===0)&&(!t.children||t.children.length===0)?!0:i.children.every((e,n)=>t.children?.some(s=>y1(e,s))):!1}var tb=new WeakMap,v1=({key:i,route:t,manifest:e,mapRouteProperties:n})=>{let s=e[t.id];if(te(s,"No route found in manifest"),!s.lazy||typeof s.lazy!="object")return;let o=s.lazy[i];if(!o)return;let c=tb.get(s);c||(c={},tb.set(s,c));let h=c[i];if(h)return h;let f=(async()=>{let d=dA(i),v=s[i]!==void 0&&i!=="hasErrorBoundary";if(d)en(!d,"Route property "+i+" is not a supported lazy route property. This property will be ignored."),c[i]=Promise.resolve();else if(v)en(!1,`Route "${s.id}" has a static property "${i}" defined. The lazy property will be ignored.`);else{let S=await o();S!=null&&(Object.assign(s,{[i]:S}),Object.assign(s,n(s)))}typeof s.lazy=="object"&&(s.lazy[i]=void 0,Object.values(s.lazy).every(S=>S===void 0)&&(s.lazy=void 0))})();return c[i]=f,f},eb=new WeakMap;function WA(i,t,e,n,s){let o=e[i.id];if(te(o,"No route found in manifest"),!i.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof i.lazy=="function"){let p=eb.get(o);if(p)return{lazyRoutePromise:p,lazyHandlerPromise:p};let v=(async()=>{te(typeof i.lazy=="function","No lazy route function found");let S=await i.lazy(),b={};for(let E in S){let O=S[E];if(O===void 0)continue;let D=mA(E),G=o[E]!==void 0&&E!=="hasErrorBoundary";D?en(!D,"Route property "+E+" is not a supported property to be returned from a lazy route function. This property will be ignored."):G?en(!G,`Route "${o.id}" has a static property "${E}" defined but its lazy function is also returning a value for this property. The lazy route property "${E}" will be ignored.`):b[E]=O}Object.assign(o,b),Object.assign(o,{...n(o),lazy:void 0})})();return eb.set(o,v),v.catch(()=>{}),{lazyRoutePromise:v,lazyHandlerPromise:v}}let c=Object.keys(i.lazy),h=[],f;for(let p of c){if(s&&s.includes(p))continue;let v=v1({key:p,route:i,manifest:e,mapRouteProperties:n});v&&(h.push(v),p===t&&(f=v))}let d=h.length>0?Promise.all(h).then(()=>{}):void 0;return d?.catch(()=>{}),f?.catch(()=>{}),{lazyRoutePromise:d,lazyHandlerPromise:f}}async function nb(i){let t=i.matches.filter(s=>s.shouldLoad),e={};return(await Promise.all(t.map(s=>s.resolve()))).forEach((s,o)=>{e[t[o].route.id]=s}),e}async function KA(i){return i.matches.some(t=>t.route.middleware)?_1(i,()=>nb(i)):nb(i)}function _1(i,t){return QA(i,t,n=>n,i2,e);function e(n,s,o){if(o)return Promise.resolve(Object.assign(o.value,{[s]:{type:"error",result:n}}));{let{matches:c}=i,h=Math.min(Math.max(c.findIndex(d=>d.route.id===s),0),Math.max(c.findIndex(d=>d.unstable_shouldCallHandler()),0)),f=aa(c,c[h].route.id).route.id;return Promise.resolve({[f]:{type:"error",result:n}})}}}async function QA(i,t,e,n,s){let{matches:o,request:c,params:h,context:f}=i,d=o.flatMap(v=>v.route.middleware?v.route.middleware.map(S=>[v.route.id,S]):[]);return await S1({request:c,params:h,context:f},d,t,e,n,s)}async function S1(i,t,e,n,s,o,c=0){let{request:h}=i;if(h.signal.aborted)throw h.signal.reason??new Error(`Request aborted: ${h.method} ${h.url}`);let f=t[c];if(!f)return await e();let[d,p]=f,v,S=async()=>{if(v)throw new Error("You may only call `next()` once per middleware");try{return v={value:await S1(i,t,e,n,s,o,c+1)},v.value}catch(b){return v={value:await o(b,d,v)},v.value}};try{let b=await p(i,S),E=b!=null?n(b):void 0;return s(E)?E:v?E??v.value:(v={value:await S()},v.value)}catch(b){return await o(b,d,v)}}function b1(i,t,e,n,s){let o=v1({key:"middleware",route:n.route,manifest:t,mapRouteProperties:i}),c=WA(n.route,ur(e.method)?"action":"loader",t,i,s);return{middleware:o,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function Mp(i,t,e,n,s,o,c,h=null){let f=!1,d=b1(i,t,e,n,s);return{...n,_lazyPromises:d,shouldLoad:c,unstable_shouldRevalidateArgs:h,unstable_shouldCallHandler(p){return f=!0,h?typeof p=="boolean"?nd(n,{...h,defaultShouldRevalidate:p}):nd(n,h):c},resolve(p){return f||c||p&&!ur(e.method)&&(n.route.lazy||n.route.loader)?ZA({request:e,match:n,lazyHandlerPromise:d?.handler,lazyRoutePromise:d?.route,handlerOverride:p,scopedContext:o}):Promise.resolve({type:"data",result:void 0})}}}function vl(i,t,e,n,s,o,c,h=null){return n.map(f=>f.route.id!==s.route.id?{...f,shouldLoad:!1,unstable_shouldRevalidateArgs:h,unstable_shouldCallHandler:()=>!1,_lazyPromises:b1(i,t,e,f,o),resolve:()=>Promise.resolve({type:"data",result:void 0})}:Mp(i,t,e,f,o,c,!0,h))}async function $A(i,t,e,n,s,o){e.some(d=>d._lazyPromises?.middleware)&&await Promise.all(e.map(d=>d._lazyPromises?.middleware));let c={request:t,params:e[0].params,context:s,matches:e},f=await i({...c,fetcherKey:n,runClientMiddleware:d=>{let p=c;return _1(p,()=>d({...p,fetcherKey:n,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))}});try{await Promise.all(e.flatMap(d=>[d._lazyPromises?.handler,d._lazyPromises?.route]))}catch{}return f}async function ZA({request:i,match:t,lazyHandlerPromise:e,lazyRoutePromise:n,handlerOverride:s,scopedContext:o}){let c,h,f=ur(i.method),d=f?"action":"loader",p=v=>{let S,b=new Promise((D,j)=>S=j);h=()=>S(),i.signal.addEventListener("abort",h);let E=D=>typeof v!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${d}" [routeId: ${t.route.id}]`)):v({request:i,params:t.params,context:o},...D!==void 0?[D]:[]),O=(async()=>{try{return{type:"data",result:await(s?s(j=>E(j)):E())}}catch(D){return{type:"error",result:D}}})();return Promise.race([O,b])};try{let v=f?t.route.action:t.route.loader;if(e||n)if(v){let S,[b]=await Promise.all([p(v).catch(E=>{S=E}),e,n]);if(S!==void 0)throw S;c=b}else{await e;let S=f?t.route.action:t.route.loader;if(S)[c]=await Promise.all([p(S),n]);else if(d==="action"){let b=new URL(i.url),E=b.pathname+b.search;throw Fr(405,{method:i.method,pathname:E,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(v)c=await p(v);else{let S=new URL(i.url),b=S.pathname+S.search;throw Fr(404,{pathname:b})}}catch(v){return{type:"error",result:v}}finally{h&&i.signal.removeEventListener("abort",h)}return c}async function JA(i){let t=i.headers.get("Content-Type");return t&&/\bapplication\/json\b/.test(t)?i.body==null?null:i.json():i.text()}async function t2(i){let{result:t,type:e}=i;if(w1(t)){let n;try{n=await JA(t)}catch(s){return{type:"error",error:s}}return e==="error"?{type:"error",error:new ed(t.status,t.statusText,n),statusCode:t.status,headers:t.headers}:{type:"data",data:n,statusCode:t.status,headers:t.headers}}return e==="error"?lb(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new ed(t.init?.status||500,void 0,t.data),statusCode:pu(t)?t.status:void 0,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:pu(t)?t.status:void 0}:lb(t)?{type:"data",data:t.data,statusCode:t.init?.status,headers:t.init?.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function e2(i,t,e,n,s){let o=i.headers.get("Location");if(te(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!gy(o)){let c=n.slice(0,n.findIndex(h=>h.route.id===e)+1);o=Rp(new URL(t.url),c,s,o),i.headers.set("Location",o)}return i}function rb(i,t,e){if(gy(i)){let n=i,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),o=Yr(s.pathname,e)!=null;if(s.origin===t.origin&&o)return s.pathname+s.search+s.hash}return i}function cl(i,t,e,n){let s=i.createURL(T1(t)).toString(),o={signal:e};if(n&&ur(n.formMethod)){let{formMethod:c,formEncType:h}=n;o.method=c.toUpperCase(),h==="application/json"?(o.headers=new Headers({"Content-Type":h}),o.body=JSON.stringify(n.json)):h==="text/plain"?o.body=n.text:h==="application/x-www-form-urlencoded"&&n.formData?o.body=Pp(n.formData):o.body=n.formData}return new Request(s,o)}function Pp(i){let t=new URLSearchParams;for(let[e,n]of i.entries())t.append(e,typeof n=="string"?n:n.name);return t}function ib(i){let t=new FormData;for(let[e,n]of i.entries())t.append(e,n);return t}function n2(i,t,e,n=!1,s=!1){let o={},c=null,h,f=!1,d={},p=e&&Ar(e[1])?e[1].error:void 0;return i.forEach(v=>{if(!(v.route.id in t))return;let S=v.route.id,b=t[S];if(te(!so(b),"Cannot handle redirect results in processLoaderData"),Ar(b)){let E=b.error;if(p!==void 0&&(E=p,p=void 0),c=c||{},s)c[S]=E;else{let O=aa(i,S);c[O.route.id]==null&&(c[O.route.id]=E)}n||(o[S]=p1),f||(f=!0,h=pu(b.error)?b.error.status:500),b.headers&&(d[S]=b.headers)}else o[S]=b.data,b.statusCode&&b.statusCode!==200&&!f&&(h=b.statusCode),b.headers&&(d[S]=b.headers)}),p!==void 0&&e&&(c={[e[0]]:p},e[2]&&(o[e[2]]=void 0)),{loaderData:o,errors:c,statusCode:h||200,loaderHeaders:d}}function sb(i,t,e,n,s,o){let{loaderData:c,errors:h}=n2(t,e,n);return s.filter(f=>!f.matches||f.matches.some(d=>d.shouldLoad)).forEach(f=>{let{key:d,match:p,controller:v}=f;if(v&&v.signal.aborted)return;let S=o[d];if(te(S,"Did not find corresponding fetcher result"),Ar(S)){let b=aa(i.matches,p?.route.id);h&&h[b.route.id]||(h={...h,[b.route.id]:S.error}),i.fetchers.delete(d)}else if(so(S))te(!1,"Unhandled fetcher revalidation redirect");else{let b=hs(S.data);i.fetchers.set(d,b)}}),{loaderData:c,errors:h}}function ab(i,t,e,n){let s=Object.entries(t).filter(([,o])=>o!==p1).reduce((o,[c,h])=>(o[c]=h,o),{});for(let o of e){let c=o.route.id;if(!t.hasOwnProperty(c)&&i.hasOwnProperty(c)&&o.route.loader&&(s[c]=i[c]),n&&n.hasOwnProperty(c))break}return s}function ob(i){return i?Ar(i[1])?{actionData:{}}:{actionData:{[i[0]]:i[1].data}}:{}}function aa(i,t){return(t?i.slice(0,i.findIndex(n=>n.route.id===t)+1):[...i]).reverse().find(n=>n.route.hasErrorBoundary===!0)||i[0]}function af(i){let t=i.length===1?i[0]:i.find(e=>e.index||!e.path||e.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Fr(i,{pathname:t,routeId:e,method:n,type:s,message:o}={}){let c="Unknown Server Error",h="Unknown @remix-run/router error";return i===400?(c="Bad Request",n&&t&&e?h=`You made a ${n} request to "${t}" but did not provide a \`loader\` for route "${e}", so there is no way to handle the request.`:s==="invalid-body"&&(h="Unable to encode submission body")):i===403?(c="Forbidden",h=`Route "${e}" does not match URL "${t}"`):i===404?(c="Not Found",h=`No route matches URL "${t}"`):i===405&&(c="Method Not Allowed",n&&t&&e?h=`You made a ${n.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${e}", so there is no way to handle the request.`:n&&(h=`Invalid request method "${n.toUpperCase()}"`)),new ed(i||500,c,new Error(h),!0)}function of(i){let t=Object.entries(i);for(let e=t.length-1;e>=0;e--){let[n,s]=t[e];if(so(s))return{key:n,result:s}}}function T1(i){let t=typeof i=="string"?Ta(i):i;return da({...t,hash:""})}function r2(i,t){return i.pathname!==t.pathname||i.search!==t.search?!1:i.hash===""?t.hash!=="":i.hash===t.hash?!0:t.hash!==""}function i2(i){return i!=null&&typeof i=="object"&&Object.entries(i).every(([t,e])=>typeof t=="string"&&s2(e))}function s2(i){return i!=null&&typeof i=="object"&&"type"in i&&"result"in i&&(i.type==="data"||i.type==="error")}function a2(i){return w1(i.result)&&BA.has(i.result.status)}function Ar(i){return i.type==="error"}function so(i){return(i&&i.type)==="redirect"}function lb(i){return typeof i=="object"&&i!=null&&"type"in i&&"data"in i&&"init"in i&&i.type==="DataWithResponseInit"}function w1(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.headers=="object"&&typeof i.body<"u"}function o2(i){return jA.has(i.toUpperCase())}function ur(i){return LA.has(i.toUpperCase())}function py(i){return new URLSearchParams(i).getAll("index").some(t=>t==="")}function Ff(i,t){let e=typeof t=="string"?Ta(t).search:t.search;if(i[i.length-1].route.index&&py(e||""))return i[i.length-1];let n=d1(i);return n[n.length-1]}function cb(i){let{formMethod:t,formAction:e,formEncType:n,text:s,formData:o,json:c}=i;if(!(!t||!e||!n)){if(s!=null)return{formMethod:t,formAction:e,formEncType:n,formData:void 0,json:void 0,text:s};if(o!=null)return{formMethod:t,formAction:e,formEncType:n,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:t,formAction:e,formEncType:n,formData:void 0,json:c,text:void 0}}}function ip(i,t){return t?{state:"loading",location:i,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:i,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function l2(i,t){return{state:"submitting",location:i,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Wc(i,t){return i?{state:"loading",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function c2(i,t){return{state:"submitting",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:t?t.data:void 0}}function hs(i){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:i}}function u2(i,t){try{let e=i.sessionStorage.getItem(m1);if(e){let n=JSON.parse(e);for(let[s,o]of Object.entries(n||{}))o&&Array.isArray(o)&&t.set(s,new Set(o||[]))}}catch{}}function h2(i,t){if(t.size>0){let e={};for(let[n,s]of t)e[n]=[...s];try{i.sessionStorage.setItem(m1,JSON.stringify(e))}catch(n){en(!1,`Failed to save applied view transitions in sessionStorage (${n}).`)}}}function f2(){let i,t,e=new Promise((n,s)=>{i=async o=>{n(o);try{await e}catch{}},t=async o=>{s(o);try{await e}catch{}}});return{promise:e,resolve:i,reject:t}}var po=it.createContext(null);po.displayName="DataRouter";var ku=it.createContext(null);ku.displayName="DataRouterState";it.createContext(!1);var yy=it.createContext({isTransitioning:!1});yy.displayName="ViewTransition";var E1=it.createContext(new Map);E1.displayName="Fetchers";var d2=it.createContext(null);d2.displayName="Await";var _i=it.createContext(null);_i.displayName="Navigation";var Id=it.createContext(null);Id.displayName="Location";var Si=it.createContext({outlet:null,matches:[],isDataRoute:!1});Si.displayName="Route";var vy=it.createContext(null);vy.displayName="RouteError";function g2(i,{relative:t}={}){te(Ml(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=it.useContext(_i),{hash:s,pathname:o,search:c}=Vu(i,{relative:t}),h=o;return e!=="/"&&(h=o==="/"?e:Vi([e,o])),n.createHref({pathname:h,search:c,hash:s})}function Ml(){return it.useContext(Id)!=null}function wa(){return te(Ml(),"useLocation() may be used only in the context of a <Router> component."),it.useContext(Id).location}var C1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function x1(i){it.useContext(_i).static||it.useLayoutEffect(i)}function _y(){let{isDataRoute:i}=it.useContext(Si);return i?D2():m2()}function m2(){te(Ml(),"useNavigate() may be used only in the context of a <Router> component.");let i=it.useContext(po),{basename:t,navigator:e}=it.useContext(_i),{matches:n}=it.useContext(Si),{pathname:s}=wa(),o=JSON.stringify(Md(n)),c=it.useRef(!1);return x1(()=>{c.current=!0}),it.useCallback((f,d={})=>{if(en(c.current,C1),!c.current)return;if(typeof f=="number"){e.go(f);return}let p=Pd(f,JSON.parse(o),s,d.relative==="path");i==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Vi([t,p.pathname])),(d.replace?e.replace:e.push)(p,d.state,d)},[t,e,o,s,i])}it.createContext(null);function p2(){let{matches:i}=it.useContext(Si),t=i[i.length-1];return t?t.params:{}}function Vu(i,{relative:t}={}){let{matches:e}=it.useContext(Si),{pathname:n}=wa(),s=JSON.stringify(Md(e));return it.useMemo(()=>Pd(i,JSON.parse(s),n,t==="path"),[i,s,n,t])}function y2(i,t,e,n,s){te(Ml(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=it.useContext(_i),{matches:c}=it.useContext(Si),h=c[c.length-1],f=h?h.params:{},d=h?h.pathname:"/",p=h?h.pathnameBase:"/",v=h&&h.route;{let G=v&&v.path||"";A1(d,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let S=wa(),b;b=S;let E=b.pathname||"/",O=E;if(p!=="/"){let G=p.replace(/^\//,"").split("/");O="/"+E.replace(/^\//,"").split("/").slice(G.length).join("/")}let D=sa(i,{pathname:O});return en(v||D!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),en(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),T2(D&&D.map(G=>Object.assign({},G,{params:Object.assign({},f,G.params),pathname:Vi([p,o.encodeLocation?o.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?p:Vi([p,o.encodeLocation?o.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),c,e,n,s)}function v2(){let i=A2(),t=pu(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),e=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",i),c=it.createElement(it.Fragment,null,it.createElement("p",null,"💿 Hey developer 👋"),it.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",it.createElement("code",{style:o},"ErrorBoundary")," or"," ",it.createElement("code",{style:o},"errorElement")," prop on your route.")),it.createElement(it.Fragment,null,it.createElement("h2",null,"Unexpected Application Error!"),it.createElement("h3",{style:{fontStyle:"italic"}},t),e?it.createElement("pre",{style:s},e):null,c)}var _2=it.createElement(v2,null),S2=class extends it.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,t){return t.location!==i.location||t.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:t.error,location:t.location,revalidation:i.revalidation||t.revalidation}}componentDidCatch(i,t){this.props.unstable_onError?this.props.unstable_onError(i,t):console.error("React Router caught the following error during render",i)}render(){return this.state.error!==void 0?it.createElement(Si.Provider,{value:this.props.routeContext},it.createElement(vy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function b2({routeContext:i,match:t,children:e}){let n=it.useContext(po);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),it.createElement(Si.Provider,{value:i},e)}function T2(i,t=[],e=null,n=null,s=null){if(i==null){if(!e)return null;if(e.errors)i=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)i=e.matches;else return null}let o=i,c=e?.errors;if(c!=null){let d=o.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);te(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,d+1))}let h=!1,f=-1;if(e)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=d),p.route.id){let{loaderData:v,errors:S}=e,b=p.route.loader&&!v.hasOwnProperty(p.route.id)&&(!S||S[p.route.id]===void 0);if(p.route.lazy||b){h=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}return o.reduceRight((d,p,v)=>{let S,b=!1,E=null,O=null;e&&(S=c&&p.route.id?c[p.route.id]:void 0,E=p.route.errorElement||_2,h&&(f<0&&v===0?(A1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,O=null):f===v&&(b=!0,O=p.route.hydrateFallbackElement||null)));let D=t.concat(o.slice(0,v+1)),j=()=>{let G;return S?G=E:b?G=O:p.route.Component?G=it.createElement(p.route.Component,null):p.route.element?G=p.route.element:G=d,it.createElement(b2,{match:p,routeContext:{outlet:d,matches:D,isDataRoute:e!=null},children:G})};return e&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?it.createElement(S2,{location:e.location,revalidation:e.revalidation,component:E,error:S,children:j(),routeContext:{outlet:null,matches:D,isDataRoute:!0},unstable_onError:n}):j()},null)}function Sy(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function w2(i){let t=it.useContext(po);return te(t,Sy(i)),t}function E2(i){let t=it.useContext(ku);return te(t,Sy(i)),t}function C2(i){let t=it.useContext(Si);return te(t,Sy(i)),t}function by(i){let t=C2(i),e=t.matches[t.matches.length-1];return te(e.route.id,`${i} can only be used on routes that contain a unique "id"`),e.route.id}function x2(){return by("useRouteId")}function A2(){let i=it.useContext(vy),t=E2("useRouteError"),e=by("useRouteError");return i!==void 0?i:t.errors?.[e]}function D2(){let{router:i}=w2("useNavigate"),t=by("useNavigate"),e=it.useRef(!1);return x1(()=>{e.current=!0}),it.useCallback(async(s,o={})=>{en(e.current,C1),e.current&&(typeof s=="number"?i.navigate(s):await i.navigate(s,{fromRouteId:t,...o}))},[i,t])}var ub={};function A1(i,t,e){!t&&!ub[i]&&(ub[i]=!0,en(!1,e))}var hb={};function fb(i,t){!i&&!hb[t]&&(hb[t]=!0,console.warn(t))}function R2(i){let t={hasErrorBoundary:i.hasErrorBoundary||i.ErrorBoundary!=null||i.errorElement!=null};return i.Component&&(i.element&&en(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:it.createElement(i.Component),Component:void 0})),i.HydrateFallback&&(i.hydrateFallbackElement&&en(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:it.createElement(i.HydrateFallback),HydrateFallback:void 0})),i.ErrorBoundary&&(i.errorElement&&en(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:it.createElement(i.ErrorBoundary),ErrorBoundary:void 0})),t}var O2=["HydrateFallback","hydrateFallbackElement"],M2=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function P2({router:i,flushSync:t,unstable_onError:e}){let[n,s]=it.useState(i.state),[o,c]=it.useState(),[h,f]=it.useState({isTransitioning:!1}),[d,p]=it.useState(),[v,S]=it.useState(),[b,E]=it.useState(),O=it.useRef(new Map),D=it.useCallback(B=>{s(I=>(B.errors&&e&&Object.entries(B.errors).forEach(([P,x])=>{I.errors?.[P]!==x&&e(x)}),B))},[e]),j=it.useCallback((B,{deletedFetchers:I,flushSync:P,viewTransitionOpts:x})=>{B.fetchers.forEach((L,k)=>{L.data!==void 0&&O.current.set(k,L.data)}),I.forEach(L=>O.current.delete(L)),fb(P===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let R=i.window!=null&&i.window.document!=null&&typeof i.window.document.startViewTransition=="function";if(fb(x==null||R,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!x||!R){t&&P?t(()=>D(B)):it.startTransition(()=>D(B));return}if(t&&P){t(()=>{v&&(d&&d.resolve(),v.skipTransition()),f({isTransitioning:!0,flushSync:!0,currentLocation:x.currentLocation,nextLocation:x.nextLocation})});let L=i.window.document.startViewTransition(()=>{t(()=>D(B))});L.finished.finally(()=>{t(()=>{p(void 0),S(void 0),c(void 0),f({isTransitioning:!1})})}),t(()=>S(L));return}v?(d&&d.resolve(),v.skipTransition(),E({state:B,currentLocation:x.currentLocation,nextLocation:x.nextLocation})):(c(B),f({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}))},[i.window,t,v,d,D]);it.useLayoutEffect(()=>i.subscribe(j),[i,j]),it.useEffect(()=>{h.isTransitioning&&!h.flushSync&&p(new M2)},[h]),it.useEffect(()=>{if(d&&o&&i.window){let B=o,I=d.promise,P=i.window.document.startViewTransition(async()=>{it.startTransition(()=>D(B)),await I});P.finished.finally(()=>{p(void 0),S(void 0),c(void 0),f({isTransitioning:!1})}),S(P)}},[o,d,i.window,D]),it.useEffect(()=>{d&&o&&n.location.key===o.location.key&&d.resolve()},[d,v,n.location,o]),it.useEffect(()=>{!h.isTransitioning&&b&&(c(b.state),f({isTransitioning:!0,flushSync:!1,currentLocation:b.currentLocation,nextLocation:b.nextLocation}),E(void 0))},[h.isTransitioning,b]);let G=it.useMemo(()=>({createHref:i.createHref,encodeLocation:i.encodeLocation,go:B=>i.navigate(B),push:(B,I,P)=>i.navigate(B,{state:I,preventScrollReset:P?.preventScrollReset}),replace:(B,I,P)=>i.navigate(B,{replace:!0,state:I,preventScrollReset:P?.preventScrollReset})}),[i]),Z=i.basename||"/",q=it.useMemo(()=>({router:i,navigator:G,static:!1,basename:Z,unstable_onError:e}),[i,G,Z,e]);return it.createElement(it.Fragment,null,it.createElement(po.Provider,{value:q},it.createElement(ku.Provider,{value:n},it.createElement(E1.Provider,{value:O.current},it.createElement(yy.Provider,{value:h},it.createElement(L2,{basename:Z,location:n.location,navigationType:n.historyAction,navigator:G},it.createElement(I2,{routes:i.routes,future:i.future,state:n,unstable_onError:e})))))),null)}var I2=it.memo(k2);function k2({routes:i,future:t,state:e,unstable_onError:n}){return y2(i,void 0,e,n,t)}function V2({to:i,replace:t,state:e,relative:n}){te(Ml(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=it.useContext(_i);en(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=it.useContext(Si),{pathname:c}=wa(),h=_y(),f=Pd(i,Md(o),c,n==="path"),d=JSON.stringify(f);return it.useEffect(()=>{h(JSON.parse(d),{replace:t,state:e,relative:n})},[h,d,n,t,e]),null}function L2({basename:i="/",children:t=null,location:e,navigationType:n="POP",navigator:s,static:o=!1}){te(!Ml(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=i.replace(/^\/*/,"/"),h=it.useMemo(()=>({basename:c,navigator:s,static:o,future:{}}),[c,s,o]);typeof e=="string"&&(e=Ta(e));let{pathname:f="/",search:d="",hash:p="",state:v=null,key:S="default"}=e,b=it.useMemo(()=>{let E=Yr(f,c);return E==null?null:{location:{pathname:E,search:d,hash:p,state:v,key:S},navigationType:n}},[c,f,d,p,v,S,n]);return en(b!=null,`<Router basename="${c}"> is not able to match the URL "${f}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:it.createElement(_i.Provider,{value:h},it.createElement(Id.Provider,{children:t,value:b}))}var Uf="get",zf="application/x-www-form-urlencoded";function kd(i){return i!=null&&typeof i.tagName=="string"}function N2(i){return kd(i)&&i.tagName.toLowerCase()==="button"}function j2(i){return kd(i)&&i.tagName.toLowerCase()==="form"}function B2(i){return kd(i)&&i.tagName.toLowerCase()==="input"}function F2(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function U2(i,t){return i.button===0&&(!t||t==="_self")&&!F2(i)}var lf=null;function z2(){if(lf===null)try{new FormData(document.createElement("form"),0),lf=!1}catch{lf=!0}return lf}var H2=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sp(i){return i!=null&&!H2.has(i)?(en(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zf}"`),null):i}function G2(i,t){let e,n,s,o,c;if(j2(i)){let h=i.getAttribute("action");n=h?Yr(h,t):null,e=i.getAttribute("method")||Uf,s=sp(i.getAttribute("enctype"))||zf,o=new FormData(i)}else if(N2(i)||B2(i)&&(i.type==="submit"||i.type==="image")){let h=i.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=i.getAttribute("formaction")||h.getAttribute("action");if(n=f?Yr(f,t):null,e=i.getAttribute("formmethod")||h.getAttribute("method")||Uf,s=sp(i.getAttribute("formenctype"))||sp(h.getAttribute("enctype"))||zf,o=new FormData(h,i),!z2()){let{name:d,type:p,value:v}=i;if(p==="image"){let S=d?`${d}.`:"";o.append(`${S}x`,"0"),o.append(`${S}y`,"0")}else d&&o.append(d,v)}}else{if(kd(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Uf,n=null,s=zf,c=i}return o&&s==="text/plain"&&(c=o,o=void 0),{action:n,method:e.toLowerCase(),encType:s,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ty(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function Y2(i,t,e){let n=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return n.pathname==="/"?n.pathname=`_root.${e}`:t&&Yr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function q2(i,t){if(i.id in t)return t[i.id];try{let e=await import(i.module);return t[i.id]=e,e}catch(e){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function X2(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function W2(i,t,e){let n=await Promise.all(i.map(async s=>{let o=t.routes[s.route.id];if(o){let c=await q2(o,e);return c.links?c.links():[]}return[]}));return Z2(n.flat(1).filter(X2).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function db(i,t,e,n,s,o){let c=(f,d)=>e[d]?f.route.id!==e[d].route.id:!0,h=(f,d)=>e[d].pathname!==f.pathname||e[d].route.path?.endsWith("*")&&e[d].params["*"]!==f.params["*"];return o==="assets"?t.filter((f,d)=>c(f,d)||h(f,d)):o==="data"?t.filter((f,d)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(c(f,d)||h(f,d))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function K2(i,t,{includeHydrateFallback:e}={}){return Q2(i.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function Q2(i){return[...new Set(i)]}function $2(i){let t={},e=Object.keys(i).sort();for(let n of e)t[n]=i[n];return t}function Z2(i,t){let e=new Set;return new Set(t),i.reduce((n,s)=>{let o=JSON.stringify($2(s));return e.has(o)||(e.add(o),n.push({key:o,link:s})),n},[])}function D1(){let i=it.useContext(po);return Ty(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function J2(){let i=it.useContext(ku);return Ty(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var wy=it.createContext(void 0);wy.displayName="FrameworkContext";function R1(){let i=it.useContext(wy);return Ty(i,"You must render this element inside a <HydratedRouter> element"),i}function tD(i,t){let e=it.useContext(wy),[n,s]=it.useState(!1),[o,c]=it.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:d,onMouseLeave:p,onTouchStart:v}=t,S=it.useRef(null);it.useEffect(()=>{if(i==="render"&&c(!0),i==="viewport"){let O=j=>{j.forEach(G=>{c(G.isIntersecting)})},D=new IntersectionObserver(O,{threshold:.5});return S.current&&D.observe(S.current),()=>{D.disconnect()}}},[i]),it.useEffect(()=>{if(n){let O=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(O)}}},[n]);let b=()=>{s(!0)},E=()=>{s(!1),c(!1)};return e?i!=="intent"?[o,S,{}]:[o,S,{onFocus:Kc(h,b),onBlur:Kc(f,E),onMouseEnter:Kc(d,b),onMouseLeave:Kc(p,E),onTouchStart:Kc(v,b)}]:[!1,S,{}]}function Kc(i,t){return e=>{i&&i(e),e.defaultPrevented||t(e)}}function eD({page:i,...t}){let{router:e}=D1(),n=it.useMemo(()=>sa(e.routes,i,e.basename),[e.routes,i,e.basename]);return n?it.createElement(rD,{page:i,matches:n,...t}):null}function nD(i){let{manifest:t,routeModules:e}=R1(),[n,s]=it.useState([]);return it.useEffect(()=>{let o=!1;return W2(i,t,e).then(c=>{o||s(c)}),()=>{o=!0}},[i,t,e]),n}function rD({page:i,matches:t,...e}){let n=wa(),{manifest:s,routeModules:o}=R1(),{basename:c}=D1(),{loaderData:h,matches:f}=J2(),d=it.useMemo(()=>db(i,t,f,s,n,"data"),[i,t,f,s,n]),p=it.useMemo(()=>db(i,t,f,s,n,"assets"),[i,t,f,s,n]),v=it.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let E=new Set,O=!1;if(t.forEach(j=>{let G=s.routes[j.route.id];!G||!G.hasLoader||(!d.some(Z=>Z.route.id===j.route.id)&&j.route.id in h&&o[j.route.id]?.shouldRevalidate||G.hasClientLoader?O=!0:E.add(j.route.id))}),E.size===0)return[];let D=Y2(i,c,"data");return O&&E.size>0&&D.searchParams.set("_routes",t.filter(j=>E.has(j.route.id)).map(j=>j.route.id).join(",")),[D.pathname+D.search]},[c,h,n,s,d,t,i,o]),S=it.useMemo(()=>K2(p,s),[p,s]),b=nD(p);return it.createElement(it.Fragment,null,v.map(E=>it.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...e})),S.map(E=>it.createElement("link",{key:E,rel:"modulepreload",href:E,...e})),b.map(({key:E,link:O})=>it.createElement("link",{key:E,nonce:e.nonce,...O})))}function iD(...i){return t=>{i.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O1&&(window.__reactRouterVersion="7.9.2")}catch{}function sD(i,t){return GA({basename:t?.basename,getContext:t?.getContext,future:t?.future,history:cA({window:t?.window}),hydrationData:aD(),routes:i,mapRouteProperties:R2,hydrationRouteProperties:O2,dataStrategy:t?.dataStrategy,patchRoutesOnNavigation:t?.patchRoutesOnNavigation,window:t?.window}).initialize()}function aD(){let i=window?.__staticRouterHydrationData;return i&&i.errors&&(i={...i,errors:oD(i.errors)}),i}function oD(i){if(!i)return null;let t=Object.entries(i),e={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")e[n]=new ed(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let o=window[s.__subType];if(typeof o=="function")try{let c=new o(s.message);c.stack="",e[n]=c}catch{}}if(e[n]==null){let o=new Error(s.message);o.stack="",e[n]=o}}else e[n]=s;return e}var M1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,P1=it.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:s,reloadDocument:o,replace:c,state:h,target:f,to:d,preventScrollReset:p,viewTransition:v,...S},b){let{basename:E}=it.useContext(_i),O=typeof d=="string"&&M1.test(d),D,j=!1;if(typeof d=="string"&&O&&(D=d,O1))try{let R=new URL(window.location.href),L=d.startsWith("//")?new URL(R.protocol+d):new URL(d),k=Yr(L.pathname,E);L.origin===R.origin&&k!=null?d=k+L.search+L.hash:j=!0}catch{en(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let G=g2(d,{relative:s}),[Z,q,B]=tD(n,S),I=hD(d,{replace:c,state:h,target:f,preventScrollReset:p,relative:s,viewTransition:v});function P(R){t&&t(R),R.defaultPrevented||I(R)}let x=it.createElement("a",{...S,...B,href:D||G,onClick:j||o?t:P,ref:iD(b,q),target:f,"data-discover":!O&&e==="render"?"true":void 0});return Z&&!O?it.createElement(it.Fragment,null,x,it.createElement(eD,{page:G})):x});P1.displayName="Link";var lD=it.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:s=!1,style:o,to:c,viewTransition:h,children:f,...d},p){let v=Vu(c,{relative:d.relative}),S=wa(),b=it.useContext(ku),{navigator:E,basename:O}=it.useContext(_i),D=b!=null&&pD(v)&&h===!0,j=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,G=S.pathname,Z=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;e||(G=G.toLowerCase(),Z=Z?Z.toLowerCase():null,j=j.toLowerCase()),Z&&O&&(Z=Yr(Z,O)||Z);const q=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let B=G===j||!s&&G.startsWith(j)&&G.charAt(q)==="/",I=Z!=null&&(Z===j||!s&&Z.startsWith(j)&&Z.charAt(j.length)==="/"),P={isActive:B,isPending:I,isTransitioning:D},x=B?t:void 0,R;typeof n=="function"?R=n(P):R=[n,B?"active":null,I?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let L=typeof o=="function"?o(P):o;return it.createElement(P1,{...d,"aria-current":x,className:R,ref:p,style:L,to:c,viewTransition:h},typeof f=="function"?f(P):f)});lD.displayName="NavLink";var cD=it.forwardRef(({discover:i="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:s,state:o,method:c=Uf,action:h,onSubmit:f,relative:d,preventScrollReset:p,viewTransition:v,...S},b)=>{let E=gD(),O=mD(h,{relative:d}),D=c.toLowerCase()==="get"?"get":"post",j=typeof h=="string"&&M1.test(h),G=Z=>{if(f&&f(Z),Z.defaultPrevented)return;Z.preventDefault();let q=Z.nativeEvent.submitter,B=q?.getAttribute("formmethod")||c;E(q||Z.currentTarget,{fetcherKey:t,method:B,navigate:e,replace:s,state:o,relative:d,preventScrollReset:p,viewTransition:v})};return it.createElement("form",{ref:b,method:D,action:O,onSubmit:n?f:G,...S,"data-discover":!j&&i==="render"?"true":void 0})});cD.displayName="Form";function uD(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function I1(i){let t=it.useContext(po);return te(t,uD(i)),t}function hD(i,{target:t,replace:e,state:n,preventScrollReset:s,relative:o,viewTransition:c}={}){let h=_y(),f=wa(),d=Vu(i,{relative:o});return it.useCallback(p=>{if(U2(p,t)){p.preventDefault();let v=e!==void 0?e:da(f)===da(d);h(i,{replace:v,state:n,preventScrollReset:s,relative:o,viewTransition:c})}},[f,h,d,e,n,t,i,s,o,c])}var fD=0,dD=()=>`__${String(++fD)}__`;function gD(){let{router:i}=I1("useSubmit"),{basename:t}=it.useContext(_i),e=x2();return it.useCallback(async(n,s={})=>{let{action:o,method:c,encType:h,formData:f,body:d}=G2(n,t);if(s.navigate===!1){let p=s.fetcherKey||dD();await i.fetch(p,e,s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||c,formEncType:s.encType||h,flushSync:s.flushSync})}else await i.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||c,formEncType:s.encType||h,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[i,t,e])}function mD(i,{relative:t}={}){let{basename:e}=it.useContext(_i),n=it.useContext(Si);te(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...Vu(i||".",{relative:t})},c=wa();if(i==null){o.search=c.search;let h=new URLSearchParams(o.search),f=h.getAll("index");if(f.some(p=>p==="")){h.delete("index"),f.filter(v=>v).forEach(v=>h.append("index",v));let p=h.toString();o.search=p?`?${p}`:""}}return(!i||i===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(o.pathname=o.pathname==="/"?e:Vi([e,o.pathname])),da(o)}function pD(i,{relative:t}={}){let e=it.useContext(yy);te(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=I1("useViewTransitionState"),s=Vu(i,{relative:t});if(!e.isTransitioning)return!1;let o=Yr(e.currentLocation.pathname,n)||e.currentLocation.pathname,c=Yr(e.nextLocation.pathname,n)||e.nextLocation.pathname;return td(s.pathname,c)!=null||td(s.pathname,o)!=null}var yD=l1();function vD(i){return it.createElement(P2,{flushSync:yD.flushSync,...i})}function _D(){const i=Math.random().toString(36).slice(2,10);return`${Date.now().toString(36)}-${i}`}function SD(){const i=_y();return it.useEffect(()=>{const t=_D();i(`/canvas/${t}`,{replace:!0})},[i]),null}var ap,gb;function bD(){if(gb)return ap;gb=1;var i="Expected a function",t=NaN,e="[object Symbol]",n=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,c=/^0o[0-7]+$/i,h=parseInt,f=typeof sf=="object"&&sf&&sf.Object===Object&&sf,d=typeof self=="object"&&self&&self.Object===Object&&self,p=f||d||Function("return this")(),v=Object.prototype,S=v.toString,b=Math.max,E=Math.min,O=function(){return p.Date.now()};function D(B,I,P){var x,R,L,k,F,M,vt=0,Pt=!1,W=!1,ft=!0;if(typeof B!="function")throw new TypeError(i);I=q(I)||0,j(P)&&(Pt=!!P.leading,W="maxWait"in P,L=W?b(q(P.maxWait)||0,I):L,ft="trailing"in P?!!P.trailing:ft);function gt(Ht){var Wt=x,Be=R;return x=R=void 0,vt=Ht,k=B.apply(Be,Wt),k}function It(Ht){return vt=Ht,F=setTimeout(pt,I),Pt?gt(Ht):k}function N(Ht){var Wt=Ht-M,Be=Ht-vt,ae=I-Wt;return W?E(ae,L-Be):ae}function at(Ht){var Wt=Ht-M,Be=Ht-vt;return M===void 0||Wt>=I||Wt<0||W&&Be>=L}function pt(){var Ht=O();if(at(Ht))return mt(Ht);F=setTimeout(pt,N(Ht))}function mt(Ht){return F=void 0,ft&&x?gt(Ht):(x=R=void 0,k)}function St(){F!==void 0&&clearTimeout(F),vt=0,x=M=R=F=void 0}function Ut(){return F===void 0?k:mt(O())}function Et(){var Ht=O(),Wt=at(Ht);if(x=arguments,R=this,M=Ht,Wt){if(F===void 0)return It(M);if(W)return F=setTimeout(pt,I),gt(M)}return F===void 0&&(F=setTimeout(pt,I)),k}return Et.cancel=St,Et.flush=Ut,Et}function j(B){var I=typeof B;return!!B&&(I=="object"||I=="function")}function G(B){return!!B&&typeof B=="object"}function Z(B){return typeof B=="symbol"||G(B)&&S.call(B)==e}function q(B){if(typeof B=="number")return B;if(Z(B))return t;if(j(B)){var I=typeof B.valueOf=="function"?B.valueOf():B;B=j(I)?I+"":I}if(typeof B!="string")return B===0?B:+B;B=B.replace(n,"");var P=o.test(B);return P||c.test(B)?h(B.slice(2),P?2:8):s.test(B)?t:+B}return ap=D,ap}var TD=bD();const wD=$x(TD),ED=()=>{};var mb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=function(i){const t=[];let e=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},CD=function(i){const t=[];let e=0,n=0;for(;e<i.length;){const s=i[e++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=i[e++];t[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=i[e++],c=i[e++],h=i[e++],f=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;t[n++]=String.fromCharCode(55296+(f>>10)),t[n++]=String.fromCharCode(56320+(f&1023))}else{const o=i[e++],c=i[e++];t[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return t.join("")},V1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,t){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const o=i[s],c=s+1<i.length,h=c?i[s+1]:0,f=s+2<i.length,d=f?i[s+2]:0,p=o>>2,v=(o&3)<<4|h>>4;let S=(h&15)<<2|d>>6,b=d&63;f||(b=64,c||(S=64)),n.push(e[p],e[v],e[S],e[b])}return n.join("")},encodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(i):this.encodeByteArray(k1(i),t)},decodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(i):CD(this.decodeStringToByteArray(i,t))},decodeStringToByteArray(i,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const o=e[i.charAt(s++)],h=s<i.length?e[i.charAt(s)]:0;++s;const d=s<i.length?e[i.charAt(s)]:64;++s;const v=s<i.length?e[i.charAt(s)]:64;if(++s,o==null||h==null||d==null||v==null)throw new xD;const S=o<<2|h>>4;if(n.push(S),d!==64){const b=h<<4&240|d>>2;if(n.push(b),v!==64){const E=d<<6&192|v;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class xD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AD=function(i){const t=k1(i);return V1.encodeByteArray(t,!0)},rd=function(i){return AD(i).replace(/\./g,"")},DD=function(i){try{return V1.decodeString(i,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=()=>RD().__FIREBASE_DEFAULTS__,MD=()=>{if(typeof process>"u"||typeof mb>"u")return;const i=mb.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},PD=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=i&&DD(i[1]);return t&&JSON.parse(t)},Ey=()=>{try{return ED()||OD()||MD()||PD()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},ID=i=>Ey()?.emulatorHosts?.[i],kD=i=>{const t=ID(i);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},L1=()=>Ey()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function LD(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(i,t){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",s=i.iat||0,o=i.sub||i.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...i};return[rd(JSON.stringify(e)),rd(JSON.stringify(c)),""].join(".")}const iu={};function jD(){const i={prod:[],emulator:[]};for(const t of Object.keys(iu))iu[t]?i.emulator.push(t):i.prod.push(t);return i}function BD(i){let t=document.getElementById(i),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",i),e=!0),{created:e,element:t}}let pb=!1;function FD(i,t){if(typeof window>"u"||typeof document>"u"||!Cy(window.location.host)||iu[i]===t||iu[i]||pb)return;iu[i]=t;function e(S){return`__firebase__banner__${S}`}const n="__firebase__banner",o=jD().prod.length>0;function c(){const S=document.getElementById(n);S&&S.remove()}function h(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function f(S,b){S.setAttribute("width","24"),S.setAttribute("id",b),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function d(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{pb=!0,c()},S}function p(S,b){S.setAttribute("id",b),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function v(){const S=BD(n),b=e("text"),E=document.getElementById(b)||document.createElement("span"),O=e("learnmore"),D=document.getElementById(O)||document.createElement("a"),j=e("preprendIcon"),G=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const Z=S.element;h(Z),p(D,O);const q=d();f(G,j),Z.append(G,E,D,q),document.body.appendChild(Z)}o?(E.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UD(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zD(){const i=Ey()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HD(){return!zD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GD(){try{return typeof indexedDB=="object"}catch{return!1}}function YD(){return new Promise((i,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD="FirebaseError";class Pl extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=qD,Object.setPrototypeOf(this,Pl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N1.prototype.create)}}class N1{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],c=o?XD(o,n):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new Pl(s,h,n)}}function XD(i,t){return i.replace(WD,(e,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const WD=/\{\$([^}]+)}/g;function id(i,t){if(i===t)return!0;const e=Object.keys(i),n=Object.keys(t);for(const s of e){if(!n.includes(s))return!1;const o=i[s],c=t[s];if(yb(o)&&yb(c)){if(!id(o,c))return!1}else if(o!==c)return!1}for(const s of n)if(!e.includes(s))return!1;return!0}function yb(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sd(i){return i&&i._delegate?i._delegate:i}class yu{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new VD;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if($D(t))try{this.getOrInitializeService({instanceIdentifier:no})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(t=no){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=no){return this.instances.has(t)}getOptions(t=no){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);n===h&&c.resolve(s)}return s}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(n)??new Set;s.add(t),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&t(o,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:QD(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=no){return this.component?this.component.multipleInstances?t:no:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QD(i){return i===no?void 0:i}function $D(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new KD(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(ce||(ce={}));const JD={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},tR=ce.INFO,eR={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},nR=(i,t,...e)=>{if(t<i.logLevel)return;const n=new Date().toISOString(),s=eR[t];if(s)console[s](`[${n}]  ${i.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class j1{constructor(t){this.name=t,this._logLevel=tR,this._logHandler=nR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ce))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?JD[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...t),this._logHandler(this,ce.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...t),this._logHandler(this,ce.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...t),this._logHandler(this,ce.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...t),this._logHandler(this,ce.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...t),this._logHandler(this,ce.ERROR,...t)}}const rR=(i,t)=>t.some(e=>i instanceof e);let vb,_b;function iR(){return vb||(vb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sR(){return _b||(_b=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B1=new WeakMap,Ip=new WeakMap,F1=new WeakMap,op=new WeakMap,xy=new WeakMap;function aR(i){const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("success",o),i.removeEventListener("error",c)},o=()=>{e(ca(i.result)),s()},c=()=>{n(i.error),s()};i.addEventListener("success",o),i.addEventListener("error",c)});return t.then(e=>{e instanceof IDBCursor&&B1.set(e,i)}).catch(()=>{}),xy.set(t,i),t}function oR(i){if(Ip.has(i))return;const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",c),i.removeEventListener("abort",c)},o=()=>{e(),s()},c=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",o),i.addEventListener("error",c),i.addEventListener("abort",c)});Ip.set(i,t)}let kp={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return Ip.get(i);if(t==="objectStoreNames")return i.objectStoreNames||F1.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return ca(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function lR(i){kp=i(kp)}function cR(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=i.call(lp(this),t,...e);return F1.set(n,t.sort?t.sort():[t]),ca(n)}:sR().includes(i)?function(...t){return i.apply(lp(this),t),ca(B1.get(this))}:function(...t){return ca(i.apply(lp(this),t))}}function uR(i){return typeof i=="function"?cR(i):(i instanceof IDBTransaction&&oR(i),rR(i,iR())?new Proxy(i,kp):i)}function ca(i){if(i instanceof IDBRequest)return aR(i);if(op.has(i))return op.get(i);const t=uR(i);return t!==i&&(op.set(i,t),xy.set(t,i)),t}const lp=i=>xy.get(i);function hR(i,t,{blocked:e,upgrade:n,blocking:s,terminated:o}={}){const c=indexedDB.open(i,t),h=ca(c);return n&&c.addEventListener("upgradeneeded",f=>{n(ca(c.result),f.oldVersion,f.newVersion,ca(c.transaction),f)}),e&&c.addEventListener("blocked",f=>e(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),s&&f.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),h}const fR=["get","getKey","getAll","getAllKeys","count"],dR=["put","add","delete","clear"],cp=new Map;function Sb(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(cp.get(t))return cp.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=dR.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||fR.includes(e)))return;const o=async function(c,...h){const f=this.transaction(c,s?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(h.shift())),(await Promise.all([d[e](...h),s&&f.done]))[0]};return cp.set(t,o),o}lR(i=>({...i,get:(t,e,n)=>Sb(t,e)||i.get(t,e,n),has:(t,e)=>!!Sb(t,e)||i.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(mR(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function mR(i){return i.getComponent()?.type==="VERSION"}const Vp="@firebase/app",bb="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys=new j1("@firebase/app"),pR="@firebase/app-compat",yR="@firebase/analytics-compat",vR="@firebase/analytics",_R="@firebase/app-check-compat",SR="@firebase/app-check",bR="@firebase/auth",TR="@firebase/auth-compat",wR="@firebase/database",ER="@firebase/data-connect",CR="@firebase/database-compat",xR="@firebase/functions",AR="@firebase/functions-compat",DR="@firebase/installations",RR="@firebase/installations-compat",OR="@firebase/messaging",MR="@firebase/messaging-compat",PR="@firebase/performance",IR="@firebase/performance-compat",kR="@firebase/remote-config",VR="@firebase/remote-config-compat",LR="@firebase/storage",NR="@firebase/storage-compat",jR="@firebase/firestore",BR="@firebase/ai",FR="@firebase/firestore-compat",UR="firebase",zR="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="[DEFAULT]",HR={[Vp]:"fire-core",[pR]:"fire-core-compat",[vR]:"fire-analytics",[yR]:"fire-analytics-compat",[SR]:"fire-app-check",[_R]:"fire-app-check-compat",[bR]:"fire-auth",[TR]:"fire-auth-compat",[wR]:"fire-rtdb",[ER]:"fire-data-connect",[CR]:"fire-rtdb-compat",[xR]:"fire-fn",[AR]:"fire-fn-compat",[DR]:"fire-iid",[RR]:"fire-iid-compat",[OR]:"fire-fcm",[MR]:"fire-fcm-compat",[PR]:"fire-perf",[IR]:"fire-perf-compat",[kR]:"fire-rc",[VR]:"fire-rc-compat",[LR]:"fire-gcs",[NR]:"fire-gcs-compat",[jR]:"fire-fst",[FR]:"fire-fst-compat",[BR]:"fire-vertex","fire-js":"fire-js",[UR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad=new Map,GR=new Map,Np=new Map;function Tb(i,t){try{i.container.addComponent(t)}catch(e){ys.debug(`Component ${t.name} failed to register with FirebaseApp ${i.name}`,e)}}function od(i){const t=i.name;if(Np.has(t))return ys.debug(`There were multiple attempts to register component ${t}.`),!1;Np.set(t,i);for(const e of ad.values())Tb(e,i);for(const e of GR.values())Tb(e,i);return!0}function YR(i,t){const e=i.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),i.container.getProvider(t)}function qR(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ua=new N1("app","Firebase",XR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new yu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ua.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR=zR;function U1(i,t={}){let e=i;typeof t!="object"&&(t={name:t});const n={name:Lp,automaticDataCollectionEnabled:!0,...t},s=n.name;if(typeof s!="string"||!s)throw ua.create("bad-app-name",{appName:String(s)});if(e||(e=L1()),!e)throw ua.create("no-options");const o=ad.get(s);if(o){if(id(e,o.options)&&id(n,o.config))return o;throw ua.create("duplicate-app",{appName:s})}const c=new ZD(s);for(const f of Np.values())c.addComponent(f);const h=new WR(e,n,c);return ad.set(s,h),h}function QR(i=Lp){const t=ad.get(i);if(!t&&i===Lp&&L1())return U1();if(!t)throw ua.create("no-app",{appName:i});return t}function _l(i,t,e){let n=HR[i]??i;e&&(n+=`-${e}`);const s=n.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const c=[`Unable to register library "${n}" with version "${t}":`];s&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ys.warn(c.join(" "));return}od(new yu(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="firebase-heartbeat-database",ZR=1,vu="firebase-heartbeat-store";let up=null;function z1(){return up||(up=hR($R,ZR,{upgrade:(i,t)=>{switch(t){case 0:try{i.createObjectStore(vu)}catch(e){console.warn(e)}}}}).catch(i=>{throw ua.create("idb-open",{originalErrorMessage:i.message})})),up}async function JR(i){try{const e=(await z1()).transaction(vu),n=await e.objectStore(vu).get(H1(i));return await e.done,n}catch(t){if(t instanceof Pl)ys.warn(t.message);else{const e=ua.create("idb-get",{originalErrorMessage:t?.message});ys.warn(e.message)}}}async function wb(i,t){try{const n=(await z1()).transaction(vu,"readwrite");await n.objectStore(vu).put(t,H1(i)),await n.done}catch(e){if(e instanceof Pl)ys.warn(e.message);else{const n=ua.create("idb-set",{originalErrorMessage:e?.message});ys.warn(n.message)}}}function H1(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO=1024,eO=30;class nO{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new iO(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Eb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>eO){const s=sO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){ys.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Eb(),{heartbeatsToSend:e,unsentEntries:n}=rO(this._heartbeatsCache.heartbeats),s=rd(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ys.warn(t),""}}}function Eb(){return new Date().toISOString().substring(0,10)}function rO(i,t=tO){const e=[];let n=i.slice();for(const s of i){const o=e.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),Cb(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Cb(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class iO{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return GD()?YD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await JR(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return wb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return wb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function Cb(i){return rd(JSON.stringify({version:2,heartbeats:i})).length}function sO(i){if(i.length===0)return-1;let t=0,e=i[0].date;for(let n=1;n<i.length;n++)i[n].date<e&&(e=i[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aO(i){od(new yu("platform-logger",t=>new gR(t),"PRIVATE")),od(new yu("heartbeat",t=>new nO(t),"PRIVATE")),_l(Vp,bb,i),_l(Vp,bb,"esm2020"),_l("fire-js","")}aO("");var xb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ha,G1;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(P,x){function R(){}R.prototype=x.prototype,P.F=x.prototype,P.prototype=new R,P.prototype.constructor=P,P.D=function(L,k,F){for(var M=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)M[vt-2]=arguments[vt];return x.prototype[k].apply(L,M)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,e),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(P,x,R){R||(R=0);const L=Array(16);if(typeof x=="string")for(var k=0;k<16;++k)L[k]=x.charCodeAt(R++)|x.charCodeAt(R++)<<8|x.charCodeAt(R++)<<16|x.charCodeAt(R++)<<24;else for(k=0;k<16;++k)L[k]=x[R++]|x[R++]<<8|x[R++]<<16|x[R++]<<24;x=P.g[0],R=P.g[1],k=P.g[2];let F=P.g[3],M;M=x+(F^R&(k^F))+L[0]+3614090360&4294967295,x=R+(M<<7&4294967295|M>>>25),M=F+(k^x&(R^k))+L[1]+3905402710&4294967295,F=x+(M<<12&4294967295|M>>>20),M=k+(R^F&(x^R))+L[2]+606105819&4294967295,k=F+(M<<17&4294967295|M>>>15),M=R+(x^k&(F^x))+L[3]+3250441966&4294967295,R=k+(M<<22&4294967295|M>>>10),M=x+(F^R&(k^F))+L[4]+4118548399&4294967295,x=R+(M<<7&4294967295|M>>>25),M=F+(k^x&(R^k))+L[5]+1200080426&4294967295,F=x+(M<<12&4294967295|M>>>20),M=k+(R^F&(x^R))+L[6]+2821735955&4294967295,k=F+(M<<17&4294967295|M>>>15),M=R+(x^k&(F^x))+L[7]+4249261313&4294967295,R=k+(M<<22&4294967295|M>>>10),M=x+(F^R&(k^F))+L[8]+1770035416&4294967295,x=R+(M<<7&4294967295|M>>>25),M=F+(k^x&(R^k))+L[9]+2336552879&4294967295,F=x+(M<<12&4294967295|M>>>20),M=k+(R^F&(x^R))+L[10]+4294925233&4294967295,k=F+(M<<17&4294967295|M>>>15),M=R+(x^k&(F^x))+L[11]+2304563134&4294967295,R=k+(M<<22&4294967295|M>>>10),M=x+(F^R&(k^F))+L[12]+1804603682&4294967295,x=R+(M<<7&4294967295|M>>>25),M=F+(k^x&(R^k))+L[13]+4254626195&4294967295,F=x+(M<<12&4294967295|M>>>20),M=k+(R^F&(x^R))+L[14]+2792965006&4294967295,k=F+(M<<17&4294967295|M>>>15),M=R+(x^k&(F^x))+L[15]+1236535329&4294967295,R=k+(M<<22&4294967295|M>>>10),M=x+(k^F&(R^k))+L[1]+4129170786&4294967295,x=R+(M<<5&4294967295|M>>>27),M=F+(R^k&(x^R))+L[6]+3225465664&4294967295,F=x+(M<<9&4294967295|M>>>23),M=k+(x^R&(F^x))+L[11]+643717713&4294967295,k=F+(M<<14&4294967295|M>>>18),M=R+(F^x&(k^F))+L[0]+3921069994&4294967295,R=k+(M<<20&4294967295|M>>>12),M=x+(k^F&(R^k))+L[5]+3593408605&4294967295,x=R+(M<<5&4294967295|M>>>27),M=F+(R^k&(x^R))+L[10]+38016083&4294967295,F=x+(M<<9&4294967295|M>>>23),M=k+(x^R&(F^x))+L[15]+3634488961&4294967295,k=F+(M<<14&4294967295|M>>>18),M=R+(F^x&(k^F))+L[4]+3889429448&4294967295,R=k+(M<<20&4294967295|M>>>12),M=x+(k^F&(R^k))+L[9]+568446438&4294967295,x=R+(M<<5&4294967295|M>>>27),M=F+(R^k&(x^R))+L[14]+3275163606&4294967295,F=x+(M<<9&4294967295|M>>>23),M=k+(x^R&(F^x))+L[3]+4107603335&4294967295,k=F+(M<<14&4294967295|M>>>18),M=R+(F^x&(k^F))+L[8]+1163531501&4294967295,R=k+(M<<20&4294967295|M>>>12),M=x+(k^F&(R^k))+L[13]+2850285829&4294967295,x=R+(M<<5&4294967295|M>>>27),M=F+(R^k&(x^R))+L[2]+4243563512&4294967295,F=x+(M<<9&4294967295|M>>>23),M=k+(x^R&(F^x))+L[7]+1735328473&4294967295,k=F+(M<<14&4294967295|M>>>18),M=R+(F^x&(k^F))+L[12]+2368359562&4294967295,R=k+(M<<20&4294967295|M>>>12),M=x+(R^k^F)+L[5]+4294588738&4294967295,x=R+(M<<4&4294967295|M>>>28),M=F+(x^R^k)+L[8]+2272392833&4294967295,F=x+(M<<11&4294967295|M>>>21),M=k+(F^x^R)+L[11]+1839030562&4294967295,k=F+(M<<16&4294967295|M>>>16),M=R+(k^F^x)+L[14]+4259657740&4294967295,R=k+(M<<23&4294967295|M>>>9),M=x+(R^k^F)+L[1]+2763975236&4294967295,x=R+(M<<4&4294967295|M>>>28),M=F+(x^R^k)+L[4]+1272893353&4294967295,F=x+(M<<11&4294967295|M>>>21),M=k+(F^x^R)+L[7]+4139469664&4294967295,k=F+(M<<16&4294967295|M>>>16),M=R+(k^F^x)+L[10]+3200236656&4294967295,R=k+(M<<23&4294967295|M>>>9),M=x+(R^k^F)+L[13]+681279174&4294967295,x=R+(M<<4&4294967295|M>>>28),M=F+(x^R^k)+L[0]+3936430074&4294967295,F=x+(M<<11&4294967295|M>>>21),M=k+(F^x^R)+L[3]+3572445317&4294967295,k=F+(M<<16&4294967295|M>>>16),M=R+(k^F^x)+L[6]+76029189&4294967295,R=k+(M<<23&4294967295|M>>>9),M=x+(R^k^F)+L[9]+3654602809&4294967295,x=R+(M<<4&4294967295|M>>>28),M=F+(x^R^k)+L[12]+3873151461&4294967295,F=x+(M<<11&4294967295|M>>>21),M=k+(F^x^R)+L[15]+530742520&4294967295,k=F+(M<<16&4294967295|M>>>16),M=R+(k^F^x)+L[2]+3299628645&4294967295,R=k+(M<<23&4294967295|M>>>9),M=x+(k^(R|~F))+L[0]+4096336452&4294967295,x=R+(M<<6&4294967295|M>>>26),M=F+(R^(x|~k))+L[7]+1126891415&4294967295,F=x+(M<<10&4294967295|M>>>22),M=k+(x^(F|~R))+L[14]+2878612391&4294967295,k=F+(M<<15&4294967295|M>>>17),M=R+(F^(k|~x))+L[5]+4237533241&4294967295,R=k+(M<<21&4294967295|M>>>11),M=x+(k^(R|~F))+L[12]+1700485571&4294967295,x=R+(M<<6&4294967295|M>>>26),M=F+(R^(x|~k))+L[3]+2399980690&4294967295,F=x+(M<<10&4294967295|M>>>22),M=k+(x^(F|~R))+L[10]+4293915773&4294967295,k=F+(M<<15&4294967295|M>>>17),M=R+(F^(k|~x))+L[1]+2240044497&4294967295,R=k+(M<<21&4294967295|M>>>11),M=x+(k^(R|~F))+L[8]+1873313359&4294967295,x=R+(M<<6&4294967295|M>>>26),M=F+(R^(x|~k))+L[15]+4264355552&4294967295,F=x+(M<<10&4294967295|M>>>22),M=k+(x^(F|~R))+L[6]+2734768916&4294967295,k=F+(M<<15&4294967295|M>>>17),M=R+(F^(k|~x))+L[13]+1309151649&4294967295,R=k+(M<<21&4294967295|M>>>11),M=x+(k^(R|~F))+L[4]+4149444226&4294967295,x=R+(M<<6&4294967295|M>>>26),M=F+(R^(x|~k))+L[11]+3174756917&4294967295,F=x+(M<<10&4294967295|M>>>22),M=k+(x^(F|~R))+L[2]+718787259&4294967295,k=F+(M<<15&4294967295|M>>>17),M=R+(F^(k|~x))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+x&4294967295,P.g[1]=P.g[1]+(k+(M<<21&4294967295|M>>>11))&4294967295,P.g[2]=P.g[2]+k&4294967295,P.g[3]=P.g[3]+F&4294967295}n.prototype.v=function(P,x){x===void 0&&(x=P.length);const R=x-this.blockSize,L=this.C;let k=this.h,F=0;for(;F<x;){if(k==0)for(;F<=R;)s(this,P,F),F+=this.blockSize;if(typeof P=="string"){for(;F<x;)if(L[k++]=P.charCodeAt(F++),k==this.blockSize){s(this,L),k=0;break}}else for(;F<x;)if(L[k++]=P[F++],k==this.blockSize){s(this,L),k=0;break}}this.h=k,this.o+=x},n.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var x=1;x<P.length-8;++x)P[x]=0;x=this.o*8;for(var R=P.length-8;R<P.length;++R)P[R]=x&255,x/=256;for(this.v(P),P=Array(16),x=0,R=0;R<4;++R)for(let L=0;L<32;L+=8)P[x++]=this.g[R]>>>L&255;return P};function o(P,x){var R=h;return Object.prototype.hasOwnProperty.call(R,P)?R[P]:R[P]=x(P)}function c(P,x){this.h=x;const R=[];let L=!0;for(let k=P.length-1;k>=0;k--){const F=P[k]|0;L&&F==x||(R[k]=F,L=!1)}this.g=R}var h={};function f(P){return-128<=P&&P<128?o(P,function(x){return new c([x|0],x<0?-1:0)}):new c([P|0],P<0?-1:0)}function d(P){if(isNaN(P)||!isFinite(P))return v;if(P<0)return D(d(-P));const x=[];let R=1;for(let L=0;P>=R;L++)x[L]=P/R|0,R*=4294967296;return new c(x,0)}function p(P,x){if(P.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(P.charAt(0)=="-")return D(p(P.substring(1),x));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=d(Math.pow(x,8));let L=v;for(let F=0;F<P.length;F+=8){var k=Math.min(8,P.length-F);const M=parseInt(P.substring(F,F+k),x);k<8?(k=d(Math.pow(x,k)),L=L.j(k).add(d(M))):(L=L.j(R),L=L.add(d(M)))}return L}var v=f(0),S=f(1),b=f(16777216);i=c.prototype,i.m=function(){if(O(this))return-D(this).m();let P=0,x=1;for(let R=0;R<this.g.length;R++){const L=this.i(R);P+=(L>=0?L:4294967296+L)*x,x*=4294967296}return P},i.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(E(this))return"0";if(O(this))return"-"+D(this).toString(P);const x=d(Math.pow(P,6));var R=this;let L="";for(;;){const k=q(R,x).g;R=j(R,k.j(x));let F=((R.g.length>0?R.g[0]:R.h)>>>0).toString(P);if(R=k,E(R))return F+L;for(;F.length<6;)F="0"+F;L=F+L}},i.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function E(P){if(P.h!=0)return!1;for(let x=0;x<P.g.length;x++)if(P.g[x]!=0)return!1;return!0}function O(P){return P.h==-1}i.l=function(P){return P=j(this,P),O(P)?-1:E(P)?0:1};function D(P){const x=P.g.length,R=[];for(let L=0;L<x;L++)R[L]=~P.g[L];return new c(R,~P.h).add(S)}i.abs=function(){return O(this)?D(this):this},i.add=function(P){const x=Math.max(this.g.length,P.g.length),R=[];let L=0;for(let k=0;k<=x;k++){let F=L+(this.i(k)&65535)+(P.i(k)&65535),M=(F>>>16)+(this.i(k)>>>16)+(P.i(k)>>>16);L=M>>>16,F&=65535,M&=65535,R[k]=M<<16|F}return new c(R,R[R.length-1]&-2147483648?-1:0)};function j(P,x){return P.add(D(x))}i.j=function(P){if(E(this)||E(P))return v;if(O(this))return O(P)?D(this).j(D(P)):D(D(this).j(P));if(O(P))return D(this.j(D(P)));if(this.l(b)<0&&P.l(b)<0)return d(this.m()*P.m());const x=this.g.length+P.g.length,R=[];for(var L=0;L<2*x;L++)R[L]=0;for(L=0;L<this.g.length;L++)for(let k=0;k<P.g.length;k++){const F=this.i(L)>>>16,M=this.i(L)&65535,vt=P.i(k)>>>16,Pt=P.i(k)&65535;R[2*L+2*k]+=M*Pt,G(R,2*L+2*k),R[2*L+2*k+1]+=F*Pt,G(R,2*L+2*k+1),R[2*L+2*k+1]+=M*vt,G(R,2*L+2*k+1),R[2*L+2*k+2]+=F*vt,G(R,2*L+2*k+2)}for(P=0;P<x;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=x;P<2*x;P++)R[P]=0;return new c(R,0)};function G(P,x){for(;(P[x]&65535)!=P[x];)P[x+1]+=P[x]>>>16,P[x]&=65535,x++}function Z(P,x){this.g=P,this.h=x}function q(P,x){if(E(x))throw Error("division by zero");if(E(P))return new Z(v,v);if(O(P))return x=q(D(P),x),new Z(D(x.g),D(x.h));if(O(x))return x=q(P,D(x)),new Z(D(x.g),x.h);if(P.g.length>30){if(O(P)||O(x))throw Error("slowDivide_ only works with positive integers.");for(var R=S,L=x;L.l(P)<=0;)R=B(R),L=B(L);var k=I(R,1),F=I(L,1);for(L=I(L,2),R=I(R,2);!E(L);){var M=F.add(L);M.l(P)<=0&&(k=k.add(R),F=M),L=I(L,1),R=I(R,1)}return x=j(P,k.j(x)),new Z(k,x)}for(k=v;P.l(x)>=0;){for(R=Math.max(1,Math.floor(P.m()/x.m())),L=Math.ceil(Math.log(R)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),F=d(R),M=F.j(x);O(M)||M.l(P)>0;)R-=L,F=d(R),M=F.j(x);E(F)&&(F=S),k=k.add(F),P=j(P,M)}return new Z(k,P)}i.B=function(P){return q(this,P).h},i.and=function(P){const x=Math.max(this.g.length,P.g.length),R=[];for(let L=0;L<x;L++)R[L]=this.i(L)&P.i(L);return new c(R,this.h&P.h)},i.or=function(P){const x=Math.max(this.g.length,P.g.length),R=[];for(let L=0;L<x;L++)R[L]=this.i(L)|P.i(L);return new c(R,this.h|P.h)},i.xor=function(P){const x=Math.max(this.g.length,P.g.length),R=[];for(let L=0;L<x;L++)R[L]=this.i(L)^P.i(L);return new c(R,this.h^P.h)};function B(P){const x=P.g.length+1,R=[];for(let L=0;L<x;L++)R[L]=P.i(L)<<1|P.i(L-1)>>>31;return new c(R,P.h)}function I(P,x){const R=x>>5;x%=32;const L=P.g.length-R,k=[];for(let F=0;F<L;F++)k[F]=x>0?P.i(F+R)>>>x|P.i(F+R+1)<<32-x:P.i(F+R);return new c(k,P.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,G1=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=d,c.fromString=p,ha=c}).apply(typeof xb<"u"?xb:typeof self<"u"?self:typeof window<"u"?window:{});var cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Y1,Jc,q1,Hf,jp,X1,W1,K1;(function(){var i,t=Object.defineProperty;function e(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof cf=="object"&&cf];for(var _=0;_<g.length;++_){var T=g[_];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=e(this);function s(g,_){if(_)t:{var T=n;g=g.split(".");for(var A=0;A<g.length-1;A++){var $=g[A];if(!($ in T))break t;T=T[$]}g=g[g.length-1],A=T[g],_=_(A),_!=A&&_!=null&&t(T,g,{configurable:!0,writable:!0,value:_})}}s("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(g){return g||function(_){var T=[],A;for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&T.push([A,_[A]]);return T}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function h(g){var _=typeof g;return _=="object"&&g!=null||_=="function"}function f(g,_,T){return g.call.apply(g.bind,arguments)}function d(g,_,T){return d=f,d.apply(null,arguments)}function p(g,_){var T=Array.prototype.slice.call(arguments,1);return function(){var A=T.slice();return A.push.apply(A,arguments),g.apply(this,A)}}function v(g,_){function T(){}T.prototype=_.prototype,g.Z=_.prototype,g.prototype=new T,g.prototype.constructor=g,g.Ob=function(A,$,st){for(var _t=Array(arguments.length-2),qt=2;qt<arguments.length;qt++)_t[qt-2]=arguments[qt];return _.prototype[$].apply(A,_t)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function b(g){const _=g.length;if(_>0){const T=Array(_);for(let A=0;A<_;A++)T[A]=g[A];return T}return[]}function E(g,_){for(let A=1;A<arguments.length;A++){const $=arguments[A];var T=typeof $;if(T=T!="object"?T:$?Array.isArray($)?"array":T:"null",T=="array"||T=="object"&&typeof $.length=="number"){T=g.length||0;const st=$.length||0;g.length=T+st;for(let _t=0;_t<st;_t++)g[T+_t]=$[_t]}else g.push($)}}class O{constructor(_,T){this.i=_,this.j=T,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function D(g){c.setTimeout(()=>{throw g},0)}function j(){var g=P;let _=null;return g.g&&(_=g.g,g.g=g.g.next,g.g||(g.h=null),_.next=null),_}class G{constructor(){this.h=this.g=null}add(_,T){const A=Z.get();A.set(_,T),this.h?this.h.next=A:this.g=A,this.h=A}}var Z=new O(()=>new q,g=>g.reset());class q{constructor(){this.next=this.g=this.h=null}set(_,T){this.h=_,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let B,I=!1,P=new G,x=()=>{const g=Promise.resolve(void 0);B=()=>{g.then(R)}};function R(){for(var g;g=j();){try{g.h.call(g.g)}catch(T){D(T)}var _=Z;_.j(g),_.h<100&&(_.h++,g.next=_.g,_.g=g)}I=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(g,_){this.type=g,this.g=this.target=_,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var g=!1,_=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const T=()=>{};c.addEventListener("test",T,_),c.removeEventListener("test",T,_)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function vt(g,_){k.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,_)}v(vt,k),vt.prototype.init=function(g,_){const T=this.type=g.type,A=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=_,_=g.relatedTarget,_||(T=="mouseover"?_=g.fromElement:T=="mouseout"&&(_=g.toElement)),this.relatedTarget=_,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&vt.Z.h.call(this)},vt.prototype.h=function(){vt.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Pt="closure_listenable_"+(Math.random()*1e6|0),W=0;function ft(g,_,T,A,$){this.listener=g,this.proxy=null,this.src=_,this.type=T,this.capture=!!A,this.ha=$,this.key=++W,this.da=this.fa=!1}function gt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function It(g,_,T){for(const A in g)_.call(T,g[A],A,g)}function N(g,_){for(const T in g)_.call(void 0,g[T],T,g)}function at(g){const _={};for(const T in g)_[T]=g[T];return _}const pt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(g,_){let T,A;for(let $=1;$<arguments.length;$++){A=arguments[$];for(T in A)g[T]=A[T];for(let st=0;st<pt.length;st++)T=pt[st],Object.prototype.hasOwnProperty.call(A,T)&&(g[T]=A[T])}}function St(g){this.src=g,this.g={},this.h=0}St.prototype.add=function(g,_,T,A,$){const st=g.toString();g=this.g[st],g||(g=this.g[st]=[],this.h++);const _t=Et(g,_,A,$);return _t>-1?(_=g[_t],T||(_.fa=!1)):(_=new ft(_,this.src,st,!!A,$),_.fa=T,g.push(_)),_};function Ut(g,_){const T=_.type;if(T in g.g){var A=g.g[T],$=Array.prototype.indexOf.call(A,_,void 0),st;(st=$>=0)&&Array.prototype.splice.call(A,$,1),st&&(gt(_),g.g[T].length==0&&(delete g.g[T],g.h--))}}function Et(g,_,T,A){for(let $=0;$<g.length;++$){const st=g[$];if(!st.da&&st.listener==_&&st.capture==!!T&&st.ha==A)return $}return-1}var Ht="closure_lm_"+(Math.random()*1e6|0),Wt={};function Be(g,_,T,A,$){if(Array.isArray(_)){for(let st=0;st<_.length;st++)Be(g,_[st],T,A,$);return null}return T=To(T),g&&g[Pt]?g.J(_,T,h(A)?!!A.capture:!1,$):ae(g,_,T,!1,A,$)}function ae(g,_,T,A,$,st){if(!_)throw Error("Invalid event type");const _t=h($)?!!$.capture:!!$;let qt=Ca(g);if(qt||(g[Ht]=qt=new St(g)),T=qt.add(_,T,A,_t,st),T.proxy)return T;if(A=mr(),T.proxy=A,A.src=g,A.listener=T,g.addEventListener)F||($=_t),$===void 0&&($=!1),g.addEventListener(_.toString(),A,$);else if(g.attachEvent)g.attachEvent(Jn(_.toString()),A);else if(g.addListener&&g.removeListener)g.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return T}function mr(){function g(T){return _.call(g.src,g.listener,T)}const _=Gl;return g}function Yi(g,_,T,A,$){if(Array.isArray(_))for(var st=0;st<_.length;st++)Yi(g,_[st],T,A,$);else A=h(A)?!!A.capture:!!A,T=To(T),g&&g[Pt]?(g=g.i,st=String(_).toString(),st in g.g&&(_=g.g[st],T=Et(_,T,A,$),T>-1&&(gt(_[T]),Array.prototype.splice.call(_,T,1),_.length==0&&(delete g.g[st],g.h--)))):g&&(g=Ca(g))&&(_=g.g[_.toString()],g=-1,_&&(g=Et(_,T,A,$)),(T=g>-1?_[g]:null)&&qi(T))}function qi(g){if(typeof g!="number"&&g&&!g.da){var _=g.src;if(_&&_[Pt])Ut(_.i,g);else{var T=g.type,A=g.proxy;_.removeEventListener?_.removeEventListener(T,A,g.capture):_.detachEvent?_.detachEvent(Jn(T),A):_.addListener&&_.removeListener&&_.removeListener(A),(T=Ca(_))?(Ut(T,g),T.h==0&&(T.src=null,_[Ht]=null)):gt(g)}}}function Jn(g){return g in Wt?Wt[g]:Wt[g]="on"+g}function Gl(g,_){if(g.da)g=!0;else{_=new vt(_,this);const T=g.listener,A=g.ha||g.src;g.fa&&qi(g),g=T.call(A,_)}return g}function Ca(g){return g=g[Ht],g instanceof St?g:null}var En="__closure_events_fn_"+(Math.random()*1e9>>>0);function To(g){return typeof g=="function"?g:(g[En]||(g[En]=function(_){return g.handleEvent(_)}),g[En])}function Xe(){L.call(this),this.i=new St(this),this.M=this,this.G=null}v(Xe,L),Xe.prototype[Pt]=!0,Xe.prototype.removeEventListener=function(g,_,T,A){Yi(this,g,_,T,A)};function nn(g,_){var T,A=g.G;if(A)for(T=[];A;A=A.G)T.push(A);if(g=g.M,A=_.type||_,typeof _=="string")_=new k(_,g);else if(_ instanceof k)_.target=_.target||g;else{var $=_;_=new k(A,g),mt(_,$)}$=!0;let st,_t;if(T)for(_t=T.length-1;_t>=0;_t--)st=_.g=T[_t],$=Wr(st,A,!0,_)&&$;if(st=_.g=g,$=Wr(st,A,!0,_)&&$,$=Wr(st,A,!1,_)&&$,T)for(_t=0;_t<T.length;_t++)st=_.g=T[_t],$=Wr(st,A,!1,_)&&$}Xe.prototype.N=function(){if(Xe.Z.N.call(this),this.i){var g=this.i;for(const _ in g.g){const T=g.g[_];for(let A=0;A<T.length;A++)gt(T[A]);delete g.g[_],g.h--}}this.G=null},Xe.prototype.J=function(g,_,T,A){return this.i.add(String(g),_,!1,T,A)},Xe.prototype.K=function(g,_,T,A){return this.i.add(String(g),_,!0,T,A)};function Wr(g,_,T,A){if(_=g.i.g[String(_)],!_)return!0;_=_.concat();let $=!0;for(let st=0;st<_.length;++st){const _t=_[st];if(_t&&!_t.da&&_t.capture==T){const qt=_t.listener,ke=_t.ha||_t.src;_t.fa&&Ut(g.i,_t),$=qt.call(ke,A)!==!1&&$}}return $&&!A.defaultPrevented}function Kr(g,_){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:c.setTimeout(g,_||0)}function Qr(g){g.g=Kr(()=>{g.g=null,g.i&&(g.i=!1,Qr(g))},g.l);const _=g.h;g.h=null,g.m.apply(null,_)}class wo extends L{constructor(_,T){super(),this.m=_,this.l=T,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Qr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $r(g){L.call(this),this.h=g,this.g={}}v($r,L);var pn=[];function De(g){It(g.g,function(_,T){this.g.hasOwnProperty(T)&&qi(_)},g),g.g={}}$r.prototype.N=function(){$r.Z.N.call(this),De(this)},$r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gn=c.JSON.stringify,Cn=c.JSON.parse,xa=class{stringify(g){return c.JSON.stringify(g,void 0)}parse(g){return c.JSON.parse(g,void 0)}};function Eo(){}function tr(){}var pr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Zr(){k.call(this,"d")}v(Zr,k);function er(){k.call(this,"c")}v(er,k);var nr={},Jr=null;function ti(){return Jr=Jr||new Xe}nr.Ia="serverreachability";function xs(g){k.call(this,nr.Ia,g)}v(xs,k);function Dr(g){const _=ti();nn(_,new xs(_))}nr.STAT_EVENT="statevent";function As(g,_){k.call(this,nr.STAT_EVENT,g),this.stat=_}v(As,k);function Le(g){const _=ti();nn(_,new As(_,g))}nr.Ja="timingevent";function Co(g,_){k.call(this,nr.Ja,g),this.size=_}v(Co,k);function ei(g,_){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){g()},_)}function yr(){this.g=!0}yr.prototype.ua=function(){this.g=!1};function bi(g,_,T,A,$,st){g.info(function(){if(g.g)if(st){var _t="",qt=st.split("&");for(let ve=0;ve<qt.length;ve++){var ke=qt[ve].split("=");if(ke.length>1){const Ke=ke[0];ke=ke[1];const vr=Ke.split("_");_t=vr.length>=2&&vr[1]=="type"?_t+(Ke+"="+ke+"&"):_t+(Ke+"=redacted&")}}}else _t=null;else _t=st;return"XMLHTTP REQ ("+A+") [attempt "+$+"]: "+_+`
`+T+`
`+_t})}function Aa(g,_,T,A,$,st,_t){g.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+$+"]: "+_+`
`+T+`
`+st+" "+_t})}function ni(g,_,T,A){g.info(function(){return"XMLHTTP TEXT ("+_+"): "+K(g,T)+(A?" "+A:"")})}function U(g,_){g.info(function(){return"TIMEOUT: "+_})}yr.prototype.info=function(){};function K(g,_){if(!g.g)return _;if(!_)return null;try{const st=JSON.parse(_);if(st){for(g=0;g<st.length;g++)if(Array.isArray(st[g])){var T=st[g];if(!(T.length<2)){var A=T[1];if(Array.isArray(A)&&!(A.length<1)){var $=A[0];if($!="noop"&&$!="stop"&&$!="close")for(let _t=1;_t<A.length;_t++)A[_t]=""}}}}return Gn(st)}catch{return _}}var tt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ht={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},yt;function xt(){}v(xt,Eo),xt.prototype.g=function(){return new XMLHttpRequest},yt=new xt;function Dt(g){return encodeURIComponent(String(g))}function Rt(g){var _=1;g=g.split(":");const T=[];for(;_>0&&g.length;)T.push(g.shift()),_--;return g.length&&T.push(g.join(":")),T}function Ct(g,_,T,A){this.j=g,this.i=_,this.l=T,this.S=A||1,this.V=new $r(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new kt}function kt(){this.i=null,this.g="",this.h=!1}var Mt={},Tt={};function Yt(g,_,T){g.M=1,g.A=Wi(Ie(_)),g.u=T,g.R=!0,ue(g,null)}function ue(g,_){g.F=Date.now(),he(g),g.B=Ie(g.A);var T=g.B,A=g.S;Array.isArray(A)||(A=[String(A)]),qu(T.i,"t",A),g.C=0,T=g.j.L,g.h=new kt,g.g=Mo(g.j,T?_:null,!g.u),g.P>0&&(g.O=new wo(d(g.Y,g,g.g),g.P)),_=g.V,T=g.g,A=g.ba;var $="readystatechange";Array.isArray($)||($&&(pn[0]=$.toString()),$=pn);for(let st=0;st<$.length;st++){const _t=Be(T,$[st],A||_.handleEvent,!1,_.h||_);if(!_t)break;_.g[_t.key]=_t}_=g.J?at(g.J):{},g.u?(g.v||(g.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,_)):(g.v="GET",g.g.ea(g.B,g.v,null,_)),Dr(),bi(g.i,g.v,g.B,g.l,g.S,g.u)}Ct.prototype.ba=function(g){g=g.target;const _=this.O;_&&Nn(g)==3?_.j():this.Y(g)},Ct.prototype.Y=function(g){try{if(g==this.g)t:{const qt=Nn(this.g),ke=this.g.ya(),ve=this.g.ca();if(!(qt<3)&&(qt!=3||this.g&&(this.h.h||this.g.la()||ka(this.g)))){this.K||qt!=4||ke==7||(ke==8||ve<=0?Dr(3):Dr(2)),kn(this);var _=this.g.ca();this.X=_;var T=xe(this);if(this.o=_==200,Aa(this.i,this.v,this.B,this.l,this.S,qt,_),this.o){if(this.U&&!this.L){e:{if(this.g){var A,$=this.g;if((A=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(A)){var st=A;break e}}st=null}if(g=st)ni(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ti(this,g);else{this.o=!1,this.m=3,Le(12),We(this),Vn(this);break t}}if(this.R){g=!0;let Ke;for(;!this.K&&this.C<T.length;)if(Ke=be(this,T),Ke==Tt){qt==4&&(this.m=4,Le(14),g=!1),ni(this.i,this.l,null,"[Incomplete Response]");break}else if(Ke==Mt){this.m=4,Le(15),ni(this.i,this.l,T,"[Invalid Chunk]"),g=!1;break}else ni(this.i,this.l,Ke,null),Ti(this,Ke);if(ee(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qt!=4||T.length!=0||this.h.h||(this.m=1,Le(16),g=!1),this.o=this.o&&g,!g)ni(this.i,this.l,T,"[Invalid Chunked Response]"),We(this),Vn(this);else if(T.length>0&&!this.W){this.W=!0;var _t=this.j;_t.g==this&&_t.aa&&!_t.P&&(_t.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),tc(_t),_t.P=!0,Le(11))}}else ni(this.i,this.l,T,null),Ti(this,T);qt==4&&We(this),this.o&&!this.K&&(qt==4?ec(this.j,this):(this.o=!1,he(this)))}else Va(this.g),_==400&&T.indexOf("Unknown SID")>0?(this.m=3,Le(12)):(this.m=0,Le(13)),We(this),Vn(this)}}}catch{}finally{}};function xe(g){if(!ee(g))return g.g.la();const _=ka(g.g);if(_==="")return"";let T="";const A=_.length,$=Nn(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return We(g),Vn(g),"";g.h.i=new c.TextDecoder}for(let st=0;st<A;st++)g.h.h=!0,T+=g.h.i.decode(_[st],{stream:!($&&st==A-1)});return _.length=0,g.h.g+=T,g.C=0,g.h.g}function ee(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function be(g,_){var T=g.C,A=_.indexOf(`
`,T);return A==-1?Tt:(T=Number(_.substring(T,A)),isNaN(T)?Mt:(A+=1,A+T>_.length?Tt:(_=_.slice(A,A+T),g.C=A+T,_)))}Ct.prototype.cancel=function(){this.K=!0,We(this)};function he(g){g.T=Date.now()+g.H,yn(g,g.H)}function yn(g,_){if(g.D!=null)throw Error("WatchDog timer not null");g.D=ei(d(g.aa,g),_)}function kn(g){g.D&&(c.clearTimeout(g.D),g.D=null)}Ct.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(U(this.i,this.B),this.M!=2&&(Dr(),Le(17)),We(this),this.m=2,Vn(this)):yn(this,this.T-g)};function Vn(g){g.j.I==0||g.K||ec(g.j,g)}function We(g){kn(g);var _=g.O;_&&typeof _.dispose=="function"&&_.dispose(),g.O=null,De(g.V),g.g&&(_=g.g,g.g=null,_.abort(),_.dispose())}function Ti(g,_){try{var T=g.j;if(T.I!=0&&(T.g==g||Kt(T.h,g))){if(!g.L&&Kt(T.h,g)&&T.I==3){try{var A=T.Ba.g.parse(_)}catch{A=null}if(Array.isArray(A)&&A.length==3){var $=A;if($[0]==0){t:if(!T.v){if(T.g)if(T.g.F+3e3<g.F)Oo(T),wi(T);else break t;Jl(T),Le(18)}}else T.xa=$[1],0<T.xa-T.K&&$[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=ei(d(T.Va,T),6e3));xn(T.h)<=1&&T.ta&&(T.ta=void 0)}else $i(T,11)}else if((g.L||T.g==g)&&Oo(T),!M(_))for($=T.Ba.g.parse(_),_=0;_<$.length;_++){let ve=$[_];const Ke=ve[0];if(!(Ke<=T.K))if(T.K=Ke,ve=ve[1],T.I==2)if(ve[0]=="c"){T.M=ve[1],T.ba=ve[2];const vr=ve[3];vr!=null&&(T.ka=vr,T.j.info("VER="+T.ka));const Ei=ve[4];Ei!=null&&(T.za=Ei,T.j.info("SVER="+T.za));const ii=ve[5];ii!=null&&typeof ii=="number"&&ii>0&&(A=1.5*ii,T.O=A,T.j.info("backChannelRequestTimeoutMs_="+A)),A=T;const si=g.g;if(si){const ai=si.g?si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ai){var st=A.h;st.g||ai.indexOf("spdy")==-1&&ai.indexOf("quic")==-1&&ai.indexOf("h2")==-1||(st.j=st.l,st.g=new Set,st.h&&(Fe(st,st.h),st.h=null))}if(A.G){const rc=si.g?si.g.getResponseHeader("X-HTTP-Session-Id"):null;rc&&(A.wa=rc,Te(A.J,A.G,rc))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-g.F,T.j.info("Handshake RTT: "+T.T+"ms")),A=T;var _t=g;if(A.na=eh(A,A.L?A.ba:null,A.W),_t.L){Ln(A.h,_t);var qt=_t,ke=A.O;ke&&(qt.H=ke),qt.D&&(kn(qt),he(qt)),A.g=_t}else $u(A);T.i.length>0&&Ba(T)}else ve[0]!="stop"&&ve[0]!="close"||$i(T,7);else T.I==3&&(ve[0]=="stop"||ve[0]=="close"?ve[0]=="stop"?$i(T,7):Na(T):ve[0]!="noop"&&T.l&&T.l.qa(ve),T.A=0)}}Dr(4)}catch{}}var Xi=class{constructor(g,_){this.g=g,this.map=_}};function Yn(g){this.l=g||10,c.PerformanceNavigationTiming?(g=c.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Rr(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function xn(g){return g.h?1:g.g?g.g.size:0}function Kt(g,_){return g.h?g.h==_:g.g?g.g.has(_):!1}function Fe(g,_){g.g?g.g.add(_):g.h=_}function Ln(g,_){g.h&&g.h==_?g.h=null:g.g&&g.g.has(_)&&g.g.delete(_)}Yn.prototype.cancel=function(){if(this.i=rr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function rr(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let _=g.i;for(const T of g.g.values())_=_.concat(T.G);return _}return b(g.i)}var Re=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ds(g,_){if(g){g=g.split("&");for(let T=0;T<g.length;T++){const A=g[T].indexOf("=");let $,st=null;A>=0?($=g[T].substring(0,A),st=g[T].substring(A+1)):$=g[T],_($,st?decodeURIComponent(st.replace(/\+/g," ")):"")}}}function ir(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;g instanceof ir?(this.l=g.l,Rs(this,g.j),this.o=g.o,this.g=g.g,Da(this,g.u),this.h=g.h,Os(this,Xu(g.i)),this.m=g.m):g&&(_=String(g).match(Re))?(this.l=!1,Rs(this,_[1]||"",!0),this.o=Ra(_[2]||""),this.g=Ra(_[3]||"",!0),Da(this,_[4]),this.h=Ra(_[5]||"",!0),Os(this,_[6]||"",!0),this.m=Ra(_[7]||"")):(this.l=!1,this.i=new Or(null,this.l))}ir.prototype.toString=function(){const g=[];var _=this.j;_&&g.push(vn(_,ql,!0),":");var T=this.g;return(T||_=="file")&&(g.push("//"),(_=this.o)&&g.push(vn(_,ql,!0),"@"),g.push(Dt(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&g.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&g.push("/"),g.push(vn(T,T.charAt(0)=="/"?Ms:Xl,!0))),(T=this.i.toString())&&g.push("?",T),(T=this.m)&&g.push("#",vn(T,Yu)),g.join("")},ir.prototype.resolve=function(g){const _=Ie(this);let T=!!g.j;T?Rs(_,g.j):T=!!g.o,T?_.o=g.o:T=!!g.g,T?_.g=g.g:T=g.u!=null;var A=g.h;if(T)Da(_,g.u);else if(T=!!g.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var $=_.h.lastIndexOf("/");$!=-1&&(A=_.h.slice(0,$+1)+A)}if($=A,$==".."||$==".")A="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){A=$.lastIndexOf("/",0)==0,$=$.split("/");const st=[];for(let _t=0;_t<$.length;){const qt=$[_t++];qt=="."?A&&_t==$.length&&st.push(""):qt==".."?((st.length>1||st.length==1&&st[0]!="")&&st.pop(),A&&_t==$.length&&st.push("")):(st.push(qt),A=!0)}A=st.join("/")}else A=$}return T?_.h=A:T=g.i.toString()!=="",T?Os(_,Xu(g.i)):T=!!g.m,T&&(_.m=g.m),_};function Ie(g){return new ir(g)}function Rs(g,_,T){g.j=T?Ra(_,!0):_,g.j&&(g.j=g.j.replace(/:$/,""))}function Da(g,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);g.u=_}else g.u=null}function Os(g,_,T){_ instanceof Or?(g.i=_,Ql(g.i,g.l)):(T||(_=vn(_,Gu)),g.i=new Or(_,g.l))}function Te(g,_,T){g.i.set(_,T)}function Wi(g){return Te(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Ra(g,_){return g?_?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function vn(g,_,T){return typeof g=="string"?(g=encodeURI(g).replace(_,Yl),T&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Yl(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var ql=/[#\/\?@]/g,Xl=/[#\?:]/g,Ms=/[#\?]/g,Gu=/[#\?@]/g,Yu=/#/g;function Or(g,_){this.h=this.g=null,this.i=g||null,this.j=!!_}function Ki(g){g.g||(g.g=new Map,g.h=0,g.i&&Ds(g.i,function(_,T){g.add(decodeURIComponent(_.replace(/\+/g," ")),T)}))}i=Or.prototype,i.add=function(g,_){Ki(this),this.i=null,g=ri(this,g);let T=this.g.get(g);return T||this.g.set(g,T=[]),T.push(_),this.h+=1,this};function Wl(g,_){Ki(g),_=ri(g,_),g.g.has(_)&&(g.i=null,g.h-=g.g.get(_).length,g.g.delete(_))}function Kl(g,_){return Ki(g),_=ri(g,_),g.g.has(_)}i.forEach=function(g,_){Ki(this),this.g.forEach(function(T,A){T.forEach(function($){g.call(_,$,A,this)},this)},this)};function xo(g,_){Ki(g);let T=[];if(typeof _=="string")Kl(g,_)&&(T=T.concat(g.g.get(ri(g,_))));else for(g=Array.from(g.g.values()),_=0;_<g.length;_++)T=T.concat(g[_]);return T}i.set=function(g,_){return Ki(this),this.i=null,g=ri(this,g),Kl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[_]),this.h+=1,this},i.get=function(g,_){return g?(g=xo(this,g),g.length>0?String(g[0]):_):_};function qu(g,_,T){Wl(g,_),T.length>0&&(g.i=null,g.g.set(ri(g,_),b(T)),g.h+=T.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],_=Array.from(this.g.keys());for(let A=0;A<_.length;A++){var T=_[A];const $=Dt(T);T=xo(this,T);for(let st=0;st<T.length;st++){let _t=$;T[st]!==""&&(_t+="="+Dt(T[st])),g.push(_t)}}return this.i=g.join("&")};function Xu(g){const _=new Or;return _.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),_}function ri(g,_){return _=String(_),g.j&&(_=_.toLowerCase()),_}function Ql(g,_){_&&!g.j&&(Ki(g),g.i=null,g.g.forEach(function(T,A){const $=A.toLowerCase();A!=$&&(Wl(this,A),qu(this,$,T))},g)),g.j=_}function $l(g,_){const T=new yr;if(c.Image){const A=new Image;A.onload=p(qn,T,"TestLoadImage: loaded",!0,_,A),A.onerror=p(qn,T,"TestLoadImage: error",!1,_,A),A.onabort=p(qn,T,"TestLoadImage: abort",!1,_,A),A.ontimeout=p(qn,T,"TestLoadImage: timeout",!1,_,A),c.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=g}else _(!1)}function Ps(g,_){const T=new yr,A=new AbortController,$=setTimeout(()=>{A.abort(),qn(T,"TestPingServer: timeout",!1,_)},1e4);fetch(g,{signal:A.signal}).then(st=>{clearTimeout($),st.ok?qn(T,"TestPingServer: ok",!0,_):qn(T,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout($),qn(T,"TestPingServer: error",!1,_)})}function qn(g,_,T,A,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),A(T)}catch{}}function Wu(){this.g=new xa}function Oa(g){this.i=g.Sb||null,this.h=g.ab||!1}v(Oa,Eo),Oa.prototype.g=function(){return new Ma(this.i,this.h)};function Ma(g,_){Xe.call(this),this.H=g,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Ma,Xe),i=Ma.prototype,i.open=function(g,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=_,this.readyState=1,Qi(this)},i.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(_.body=g),(this.H||c).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xn(this)),this.readyState=0},i.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Is(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Is(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}i.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var _=g.value?g.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!g.done}))&&(this.response=this.responseText+=_)}g.done?Xn(this):Qi(this),this.readyState==3&&Is(this)}},i.Oa=function(g){this.g&&(this.response=this.responseText=g,Xn(this))},i.Na=function(g){this.g&&(this.response=g,Xn(this))},i.ga=function(){this.g&&Xn(this)};function Xn(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Qi(g)}i.setRequestHeader=function(g,_){this.A.append(g,_)},i.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],_=this.h.entries();for(var T=_.next();!T.done;)T=T.value,g.push(T[0]+": "+T[1]),T=_.next();return g.join(`\r
`)};function Qi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function ks(g){let _="";return It(g,function(T,A){_+=A,_+=":",_+=T,_+=`\r
`}),_}function Mr(g,_,T){t:{for(A in T){var A=!1;break t}A=!0}A||(T=ks(T),typeof g=="string"?T!=null&&Dt(T):Te(g,_,T))}function Oe(g){Xe.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Oe,Xe);var Ao=/^https?$/i,Ku=["POST","PUT"];i=Oe.prototype,i.Fa=function(g){this.H=g},i.ea=function(g,_,T,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);_=_?_.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():yt.g(),this.g.onreadystatechange=S(d(this.Ca,this));try{this.B=!0,this.g.open(_,String(g),!0),this.B=!1}catch(st){Pa(this,st);return}if(g=T||"",T=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var $ in A)T.set($,A[$]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const st of A.keys())T.set(st,A.get(st));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(T.keys()).find(st=>st.toLowerCase()=="content-type"),$=c.FormData&&g instanceof c.FormData,!(Array.prototype.indexOf.call(Ku,_,void 0)>=0)||A||$||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[st,_t]of T)this.g.setRequestHeader(st,_t);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(st){Pa(this,st)}};function Pa(g,_){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=_,g.o=5,Ia(g),cn(g)}function Ia(g){g.A||(g.A=!0,nn(g,"complete"),nn(g,"error"))}i.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,nn(this,"complete"),nn(this,"abort"),cn(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cn(this,!0)),Oe.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Zl(this):this.Xa())},i.Xa=function(){Zl(this)};function Zl(g){if(g.h&&typeof o<"u"){if(g.v&&Nn(g)==4)setTimeout(g.Ca.bind(g),0);else if(nn(g,"readystatechange"),Nn(g)==4){g.h=!1;try{const st=g.ca();t:switch(st){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break t;default:_=!1}var T;if(!(T=_)){var A;if(A=st===0){let _t=String(g.D).match(Re)[1]||null;!_t&&c.self&&c.self.location&&(_t=c.self.location.protocol.slice(0,-1)),A=!Ao.test(_t?_t.toLowerCase():"")}T=A}if(T)nn(g,"complete"),nn(g,"success");else{g.o=6;try{var $=Nn(g)>2?g.g.statusText:""}catch{$=""}g.l=$+" ["+g.ca()+"]",Ia(g)}}finally{cn(g)}}}}function cn(g,_){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const T=g.g;g.g=null,_||nn(g,"ready");try{T.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Nn(g){return g.g?g.g.readyState:0}i.ca=function(){try{return Nn(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(g){if(this.g){var _=this.g.responseText;return g&&_.indexOf(g)==0&&(_=_.substring(g.length)),Cn(_)}};function ka(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Va(g){const _={};g=(g.g&&Nn(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<g.length;A++){if(M(g[A]))continue;var T=Rt(g[A]);const $=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const st=_[$]||[];_[$]=st,st.push(T)}N(_,function(A){return A.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function La(g,_,T){return T&&T.internalChannelParams&&T.internalChannelParams[g]||_}function Do(g){this.za=0,this.i=[],this.j=new yr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=La("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=La("baseRetryDelayMs",5e3,g),this.Za=La("retryDelaySeedMs",1e4,g),this.Ta=La("forwardChannelMaxRetries",2,g),this.va=La("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Yn(g&&g.concurrentRequestLimit),this.Ba=new Wu,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Do.prototype,i.ka=8,i.I=1,i.connect=function(g,_,T,A){Le(0),this.W=g,this.H=_||{},T&&A!==void 0&&(this.H.OSID=T,this.H.OAID=A),this.F=this.X,this.J=eh(this,null,this.W),Ba(this)};function Na(g){if(ja(g),g.I==3){var _=g.V++,T=Ie(g.J);if(Te(T,"SID",g.M),Te(T,"RID",_),Te(T,"TYPE","terminate"),Fa(g,T),_=new Ct(g,g.j,_),_.M=2,_.A=Wi(Ie(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(_.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=_.A,T=!0),T||(_.g=Mo(_.j,null),_.g.ea(_.A)),_.F=Date.now(),he(_)}th(g)}function wi(g){g.g&&(tc(g),g.g.cancel(),g.g=null)}function ja(g){wi(g),g.v&&(c.clearTimeout(g.v),g.v=null),Oo(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&c.clearTimeout(g.m),g.m=null)}function Ba(g){if(!Rr(g.h)&&!g.m){g.m=!0;var _=g.Ea;B||x(),I||(B(),I=!0),P.add(_,g),g.D=0}}function ig(g,_){return xn(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=_.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=ei(d(g.Ea,g,_),Ju(g,g.D)),g.D++,!0)}i.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const $=new Ct(this,this.j,g);let st=this.o;if(this.U&&(st?(st=at(st),mt(st,this.U)):st=this.U),this.u!==null||this.R||($.J=st,st=null),this.S)t:{for(var _=0,T=0;T<this.i.length;T++){e:{var A=this.i[T];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break e}A=void 0}if(A===void 0)break;if(_+=A,_>4096){_=T;break t}if(_===4096||T===this.i.length-1){_=T+1;break t}}_=1e3}else _=1e3;_=Ro(this,$,_),T=Ie(this.J),Te(T,"RID",g),Te(T,"CVER",22),this.G&&Te(T,"X-HTTP-Session-Id",this.G),Fa(this,T),st&&(this.R?_="headers="+Dt(ks(st))+"&"+_:this.u&&Mr(T,this.u,st)),Fe(this.h,$),this.Ra&&Te(T,"TYPE","init"),this.S?(Te(T,"$req",_),Te(T,"SID","null"),$.U=!0,Yt($,T,null)):Yt($,T,_),this.I=2}}else this.I==3&&(g?Qu(this,g):this.i.length==0||Rr(this.h)||Qu(this))};function Qu(g,_){var T;_?T=_.l:T=g.V++;const A=Ie(g.J);Te(A,"SID",g.M),Te(A,"RID",T),Te(A,"AID",g.K),Fa(g,A),g.u&&g.o&&Mr(A,g.u,g.o),T=new Ct(g,g.j,T,g.D+1),g.u===null&&(T.J=g.o),_&&(g.i=_.G.concat(g.i)),_=Ro(g,T,1e3),T.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Fe(g.h,T),Yt(T,A,_)}function Fa(g,_){g.H&&It(g.H,function(T,A){Te(_,A,T)}),g.l&&It({},function(T,A){Te(_,A,T)})}function Ro(g,_,T){T=Math.min(g.i.length,T);const A=g.l?d(g.l.Ka,g.l,g):null;t:{var $=g.i;let qt=-1;for(;;){const ke=["count="+T];qt==-1?T>0?(qt=$[0].g,ke.push("ofs="+qt)):qt=0:ke.push("ofs="+qt);let ve=!0;for(let Ke=0;Ke<T;Ke++){var st=$[Ke].g;const vr=$[Ke].map;if(st-=qt,st<0)qt=Math.max(0,$[Ke].g-100),ve=!1;else try{st="req"+st+"_"||"";try{var _t=vr instanceof Map?vr:Object.entries(vr);for(const[Ei,ii]of _t){let si=ii;h(ii)&&(si=Gn(ii)),ke.push(st+Ei+"="+encodeURIComponent(si))}}catch(Ei){throw ke.push(st+"type="+encodeURIComponent("_badmap")),Ei}}catch{A&&A(vr)}}if(ve){_t=ke.join("&");break t}}_t=void 0}return g=g.i.splice(0,T),_.G=g,_t}function $u(g){if(!g.g&&!g.v){g.Y=1;var _=g.Da;B||x(),I||(B(),I=!0),P.add(_,g),g.A=0}}function Jl(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=ei(d(g.Da,g),Ju(g,g.A)),g.A++,!0)}i.Da=function(){if(this.v=null,Zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=ei(d(this.Wa,this),g)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Le(10),wi(this),Zu(this))};function tc(g){g.B!=null&&(c.clearTimeout(g.B),g.B=null)}function Zu(g){g.g=new Ct(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var _=Ie(g.na);Te(_,"RID","rpc"),Te(_,"SID",g.M),Te(_,"AID",g.K),Te(_,"CI",g.F?"0":"1"),!g.F&&g.ia&&Te(_,"TO",g.ia),Te(_,"TYPE","xmlhttp"),Fa(g,_),g.u&&g.o&&Mr(_,g.u,g.o),g.O&&(g.g.H=g.O);var T=g.g;g=g.ba,T.M=1,T.A=Wi(Ie(_)),T.u=null,T.R=!0,ue(T,g)}i.Va=function(){this.C!=null&&(this.C=null,wi(this),Jl(this),Le(19))};function Oo(g){g.C!=null&&(c.clearTimeout(g.C),g.C=null)}function ec(g,_){var T=null;if(g.g==_){Oo(g),tc(g),g.g=null;var A=2}else if(Kt(g.h,_))T=_.G,Ln(g.h,_),A=1;else return;if(g.I!=0){if(_.o)if(A==1){T=_.u?_.u.length:0,_=Date.now()-_.F;var $=g.D;A=ti(),nn(A,new Co(A,T)),Ba(g)}else $u(g);else if($=_.m,$==3||$==0&&_.X>0||!(A==1&&ig(g,_)||A==2&&Jl(g)))switch(T&&T.length>0&&(_=g.h,_.i=_.i.concat(T)),$){case 1:$i(g,5);break;case 4:$i(g,10);break;case 3:$i(g,6);break;default:$i(g,2)}}}function Ju(g,_){let T=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(T*=2),T*_}function $i(g,_){if(g.j.info("Error code "+_),_==2){var T=d(g.bb,g),A=g.Ua;const $=!A;A=new ir(A||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Rs(A,"https"),Wi(A),$?$l(A.toString(),T):Ps(A.toString(),T)}else Le(2);g.I=0,g.l&&g.l.pa(_),th(g),ja(g)}i.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function th(g){if(g.I=0,g.ja=[],g.l){const _=rr(g.h);(_.length!=0||g.i.length!=0)&&(E(g.ja,_),E(g.ja,g.i),g.h.i.length=0,b(g.i),g.i.length=0),g.l.oa()}}function eh(g,_,T){var A=T instanceof ir?Ie(T):new ir(T);if(A.g!="")_&&(A.g=_+"."+A.g),Da(A,A.u);else{var $=c.location;A=$.protocol,_=_?_+"."+$.hostname:$.hostname,$=+$.port;const st=new ir(null);A&&Rs(st,A),_&&(st.g=_),$&&Da(st,$),T&&(st.h=T),A=st}return T=g.G,_=g.wa,T&&_&&Te(A,T,_),Te(A,"VER",g.ka),Fa(g,A),A}function Mo(g,_,T){if(_&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=g.Aa&&!g.ma?new Oe(new Oa({ab:T})):new Oe(g.ma),_.Fa(g.L),_}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function nh(){}i=nh.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Po(){}Po.prototype.g=function(g,_){return new Wn(g,_)};function Wn(g,_){Xe.call(this),this.g=new Do(_),this.l=g,this.h=_&&_.messageUrlParams||null,g=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(g?g["X-WebChannel-Content-Type"]=_.messageContentType:g={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(g?g["X-WebChannel-Client-Profile"]=_.sa:g={"X-WebChannel-Client-Profile":_.sa}),this.g.U=g,(g=_&&_.Qb)&&!M(g)&&(this.g.u=g),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!M(_)&&(this.g.G=_,g=this.h,g!==null&&_ in g&&(g=this.h,_ in g&&delete g[_])),this.j=new Vs(this)}v(Wn,Xe),Wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Wn.prototype.close=function(){Na(this.g)},Wn.prototype.o=function(g){var _=this.g;if(typeof g=="string"){var T={};T.__data__=g,g=T}else this.v&&(T={},T.__data__=Gn(g),g=T);_.i.push(new Xi(_.Ya++,g)),_.I==3&&Ba(_)},Wn.prototype.N=function(){this.g.l=null,delete this.j,Na(this.g),delete this.g,Wn.Z.N.call(this)};function nc(g){Zr.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var _=g.__sm__;if(_){t:{for(const T in _){g=T;break t}g=void 0}(this.i=g)&&(g=this.i,_=_!==null&&g in _?_[g]:void 0),this.data=_}else this.data=g}v(nc,Zr);function rh(){er.call(this),this.status=1}v(rh,er);function Vs(g){this.g=g}v(Vs,nh),Vs.prototype.ra=function(){nn(this.g,"a")},Vs.prototype.qa=function(g){nn(this.g,new nc(g))},Vs.prototype.pa=function(g){nn(this.g,new rh)},Vs.prototype.oa=function(){nn(this.g,"b")},Po.prototype.createWebChannel=Po.prototype.g,Wn.prototype.send=Wn.prototype.o,Wn.prototype.open=Wn.prototype.m,Wn.prototype.close=Wn.prototype.close,K1=function(){return new Po},W1=function(){return ti()},X1=nr,jp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},tt.NO_ERROR=0,tt.TIMEOUT=8,tt.HTTP_ERROR=6,Hf=tt,ht.COMPLETE="complete",q1=ht,tr.EventType=pr,pr.OPEN="a",pr.CLOSE="b",pr.ERROR="c",pr.MESSAGE="d",Xe.prototype.listen=Xe.prototype.J,Jc=tr,Oe.prototype.listenOnce=Oe.prototype.K,Oe.prototype.getLastError=Oe.prototype.Ha,Oe.prototype.getLastErrorCode=Oe.prototype.ya,Oe.prototype.getStatus=Oe.prototype.ca,Oe.prototype.getResponseJson=Oe.prototype.La,Oe.prototype.getResponseText=Oe.prototype.la,Oe.prototype.send=Oe.prototype.ea,Oe.prototype.setWithCredentials=Oe.prototype.Fa,Y1=Oe}).apply(typeof cf<"u"?cf:typeof self<"u"?self:typeof window<"u"?window:{});const Ab="@firebase/firestore",Db="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Un.UNAUTHENTICATED=new Un(null),Un.GOOGLE_CREDENTIALS=new Un("google-credentials-uid"),Un.FIRST_PARTY=new Un("first-party-uid"),Un.MOCK_USER=new Un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Il="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=new j1("@firebase/firestore");function ul(){return fo.logLevel}function bt(i,...t){if(fo.logLevel<=ce.DEBUG){const e=t.map(Ay);fo.debug(`Firestore (${Il}): ${i}`,...e)}}function vs(i,...t){if(fo.logLevel<=ce.ERROR){const e=t.map(Ay);fo.error(`Firestore (${Il}): ${i}`,...e)}}function El(i,...t){if(fo.logLevel<=ce.WARN){const e=t.map(Ay);fo.warn(`Firestore (${Il}): ${i}`,...e)}}function Ay(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(e){return JSON.stringify(e)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ft(i,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,Q1(i,n,e)}function Q1(i,t,e){let n=`FIRESTORE (${Il}) INTERNAL ASSERTION FAILED: ${t} (ID: ${i.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw vs(n),new Error(n)}function ye(i,t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,i||Q1(t,s,n)}function Xt(i,t){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Lt extends Pl{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class oO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Un.UNAUTHENTICATED)))}shutdown(){}}class lO{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class cO{constructor(t){this.t=t,this.currentUser=Un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){ye(this.o===void 0,42304);let n=this.i;const s=f=>this.i!==n?(n=this.i,e(f)):Promise.resolve();let o=new fa;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new fa,t.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const f=o;t.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},h=f=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new fa)}}),0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ye(typeof n.accessToken=="string",31837,{l:n}),new $1(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ye(t===null||typeof t=="string",2055,{h:t}),new Un(t)}}class uO{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=Un.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hO{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new uO(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Un.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Rb{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fO{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qR(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){ye(this.o===void 0,3512);const n=o=>{o.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,bt("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable((()=>n(o)))};const s=o=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Rb(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(ye(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new Rb(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(i){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(i);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<i;n++)e[n]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=dO(40);for(let o=0;o<s.length;++o)n.length<20&&s[o]<e&&(n+=t.charAt(s[o]%62))}return n}}function ie(i,t){return i<t?-1:i>t?1:0}function Bp(i,t){const e=Math.min(i.length,t.length);for(let n=0;n<e;n++){const s=i.charAt(n),o=t.charAt(n);if(s!==o)return hp(s)===hp(o)?ie(s,o):hp(s)?1:-1}return ie(i.length,t.length)}const gO=55296,mO=57343;function hp(i){const t=i.charCodeAt(0);return t>=gO&&t<=mO}function Cl(i,t,e){return i.length===t.length&&i.every(((n,s)=>e(n,t[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob="__name__";class Oi{constructor(t,e,n){e===void 0?e=0:e>t.length&&Ft(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&Ft(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return Oi.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Oi?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const o=Oi.compareSegments(t.get(s),e.get(s));if(o!==0)return o}return ie(t.length,e.length)}static compareSegments(t,e){const n=Oi.isNumericId(t),s=Oi.isNumericId(e);return n&&!s?-1:!n&&s?1:n&&s?Oi.extractNumericId(t).compare(Oi.extractNumericId(e)):Bp(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return ha.fromString(t.substring(4,t.length-2))}}class He extends Oi{construct(t,e,n){return new He(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Lt(dt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((s=>s.length>0)))}return new He(e)}static emptyPath(){return new He([])}}const pO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mn extends Oi{construct(t,e,n){return new Mn(t,e,n)}static isValidIdentifier(t){return pO.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ob}static keyField(){return new Mn([Ob])}static fromServerFormat(t){const e=[];let n="",s=0;const o=()=>{if(n.length===0)throw new Lt(dt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let c=!1;for(;s<t.length;){const h=t[s];if(h==="\\"){if(s+1===t.length)throw new Lt(dt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const f=t[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Lt(dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=f,s+=2}else h==="`"?(c=!c,s++):h!=="."||c?(n+=h,s++):(o(),s++)}if(o(),c)throw new Lt(dt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Mn(e)}static emptyPath(){return new Mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(t){this.path=t}static fromPath(t){return new Nt(He.fromString(t))}static fromName(t){return new Nt(He.fromString(t).popFirst(5))}static empty(){return new Nt(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&He.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return He.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Nt(new He(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(i,t,e){if(!e)throw new Lt(dt.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${t}.`)}function vO(i,t,e,n){if(t===!0&&n===!0)throw new Lt(dt.INVALID_ARGUMENT,`${i} and ${e} cannot be used together.`)}function Mb(i){if(!Nt.isDocumentKey(i))throw new Lt(dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Z1(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Ry(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(i);return t?`a custom ${t} object`:"an object"}}return typeof i=="function"?"a function":Ft(12329,{type:typeof i})}function _u(i,t){if("_delegate"in i&&(i=i._delegate),!(i instanceof t)){if(t.name===i.constructor.name)throw new Lt(dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Ry(i);throw new Lt(dt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(i,t){const e={typeString:i};return t&&(e.value=t),e}function Lu(i,t){if(!Z1(i))throw new Lt(dt.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const s=t[n].typeString,o="value"in t[n]?{value:t[n].value}:void 0;if(!(n in i)){e=`JSON missing required field: '${n}'`;break}const c=i[n];if(s&&typeof c!==s){e=`JSON field '${n}' must be a ${s}.`;break}if(o!==void 0&&c!==o.value){e=`Expected '${n}' field to equal '${o.value}'`;break}}if(e)throw new Lt(dt.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb=-62135596800,Ib=1e6;class Ve{static now(){return Ve.fromMillis(Date.now())}static fromDate(t){return Ve.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*Ib);return new Ve(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Lt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Lt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Pb)throw new Lt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Lt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ib}_compareTo(t){return this.seconds===t.seconds?ie(this.nanoseconds,t.nanoseconds):ie(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ve._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Lu(t,Ve._jsonSchema))return new Ve(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Pb;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ve._jsonSchemaVersion="firestore/timestamp/1.0",Ve._jsonSchema={type:ln("string",Ve._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{static fromTimestamp(t){return new Gt(t)}static min(){return new Gt(new Ve(0,0))}static max(){return new Gt(new Ve(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=-1;function _O(i,t){const e=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=Gt.fromTimestamp(n===1e9?new Ve(e+1,0):new Ve(e,n));return new ga(s,Nt.empty(),t)}function SO(i){return new ga(i.readTime,i.key,Su)}class ga{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new ga(Gt.min(),Nt.empty(),Su)}static max(){return new ga(Gt.max(),Nt.empty(),Su)}}function bO(i,t){let e=i.readTime.compareTo(t.readTime);return e!==0?e:(e=Nt.comparator(i.documentKey,t.documentKey),e!==0?e:ie(i.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(i){if(i.code!==dt.FAILED_PRECONDITION||i.message!==TO)throw i;bt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ft(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ut(((n,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(n,s)},this.catchCallback=o=>{this.wrapFailure(e,o).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof ut?e:ut.resolve(e)}catch(e){return ut.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):ut.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):ut.reject(e)}static resolve(t){return new ut(((e,n)=>{e(t)}))}static reject(t){return new ut(((e,n)=>{n(t)}))}static waitFor(t){return new ut(((e,n)=>{let s=0,o=0,c=!1;t.forEach((h=>{++s,h.next((()=>{++o,c&&o===s&&e()}),(f=>n(f)))})),c=!0,o===s&&e()}))}static or(t){let e=ut.resolve(!1);for(const n of t)e=e.next((s=>s?ut.resolve(s):n()));return e}static forEach(t,e){const n=[];return t.forEach(((s,o)=>{n.push(e.call(this,s,o))})),this.waitFor(n)}static mapArray(t,e){return new ut(((n,s)=>{const o=t.length,c=new Array(o);let h=0;for(let f=0;f<o;f++){const d=f;e(t[d]).next((p=>{c[d]=p,++h,h===o&&n(c)}),(p=>s(p)))}}))}static doWhile(t,e){return new ut(((n,s)=>{const o=()=>{t()===!0?e().next((()=>{o()}),s):n()};o()}))}}function EO(i){const t=i.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Vl(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Vd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy=-1;function Ld(i){return i==null}function ld(i){return i===0&&1/i==-1/0}function CO(i){return typeof i=="number"&&Number.isInteger(i)&&!ld(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="";function xO(i){let t="";for(let e=0;e<i.length;e++)t.length>0&&(t=kb(t)),t=AO(i.get(e),t);return kb(t)}function AO(i,t){let e=t;const n=i.length;for(let s=0;s<n;s++){const o=i.charAt(s);switch(o){case"\0":e+="";break;case J1:e+="";break;default:e+=o}}return e}function kb(i){return i+J1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(i){let t=0;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t++;return t}function yo(i,t){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t(e,i[e])}function tw(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(t,e){this.comparator=t,this.root=e||On.EMPTY}insert(t,e){return new Ge(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,On.BLACK,null,null))}remove(t){return new Ge(this.comparator,this.root.remove(t,this.comparator).copy(null,null,On.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new uf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new uf(this.root,t,this.comparator,!1)}getReverseIterator(){return new uf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new uf(this.root,t,this.comparator,!0)}}class uf{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,e&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class On{constructor(t,e,n,s,o){this.key=t,this.value=e,this.color=n??On.RED,this.left=s??On.EMPTY,this.right=o??On.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,o){return new On(t??this.key,e??this.value,n??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const o=n(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,e,n),null):o===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return On.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return On.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,On.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,On.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ft(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ft(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Ft(27949);return t+(this.isRed()?0:1)}}On.EMPTY=null,On.RED=!0,On.BLACK=!1;On.EMPTY=new class{constructor(){this.size=0}get key(){throw Ft(57766)}get value(){throw Ft(16141)}get color(){throw Ft(16727)}get left(){throw Ft(29726)}get right(){throw Ft(36894)}copy(t,e,n,s,o){return this}insert(t,e,n){return new On(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t){this.comparator=t,this.data=new Ge(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Lb(this.data.getIterator())}getIteratorFrom(t){return new Lb(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof dn)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=n.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new dn(this.comparator);return e.data=t,e}}class Lb{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(t){this.fields=t,t.sort(Mn.comparator)}static empty(){return new mi([])}unionWith(t){let e=new dn(Mn.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new mi(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Cl(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ew("Invalid base64 string: "+o):o}})(t);return new In(e)}static fromUint8Array(t){const e=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(t);return new In(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ie(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}In.EMPTY_BYTE_STRING=new In("");const DO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ma(i){if(ye(!!i,39018),typeof i=="string"){let t=0;const e=DO.exec(i);if(ye(!!e,46558,{timestamp:i}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Ze(i.seconds),nanos:Ze(i.nanos)}}function Ze(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function pa(i){return typeof i=="string"?In.fromBase64String(i):In.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw="server_timestamp",rw="__type__",iw="__previous_value__",sw="__local_write_time__";function My(i){return(i?.mapValue?.fields||{})[rw]?.stringValue===nw}function Nd(i){const t=i.mapValue.fields[iw];return My(t)?Nd(t):t}function bu(i){const t=ma(i.mapValue.fields[sw].timestampValue);return new Ve(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(t,e,n,s,o,c,h,f,d,p){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=p}}const cd="(default)";class Tu{constructor(t,e){this.projectId=t,this.database=e||cd}static empty(){return new Tu("","")}get isDefaultDatabase(){return this.database===cd}isEqual(t){return t instanceof Tu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw="__type__",OO="__max__",hf={mapValue:{}},ow="__vector__",ud="value";function ya(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?My(i)?4:PO(i)?9007199254740991:MO(i)?10:11:Ft(28295,{value:i})}function Ui(i,t){if(i===t)return!0;const e=ya(i);if(e!==ya(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return bu(i).isEqual(bu(t));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const c=ma(s.timestampValue),h=ma(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(i,t);case 5:return i.stringValue===t.stringValue;case 6:return(function(s,o){return pa(s.bytesValue).isEqual(pa(o.bytesValue))})(i,t);case 7:return i.referenceValue===t.referenceValue;case 8:return(function(s,o){return Ze(s.geoPointValue.latitude)===Ze(o.geoPointValue.latitude)&&Ze(s.geoPointValue.longitude)===Ze(o.geoPointValue.longitude)})(i,t);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Ze(s.integerValue)===Ze(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const c=Ze(s.doubleValue),h=Ze(o.doubleValue);return c===h?ld(c)===ld(h):isNaN(c)&&isNaN(h)}return!1})(i,t);case 9:return Cl(i.arrayValue.values||[],t.arrayValue.values||[],Ui);case 10:case 11:return(function(s,o){const c=s.mapValue.fields||{},h=o.mapValue.fields||{};if(Vb(c)!==Vb(h))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(h[f]===void 0||!Ui(c[f],h[f])))return!1;return!0})(i,t);default:return Ft(52216,{left:i})}}function wu(i,t){return(i.values||[]).find((e=>Ui(e,t)))!==void 0}function xl(i,t){if(i===t)return 0;const e=ya(i),n=ya(t);if(e!==n)return ie(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return ie(i.booleanValue,t.booleanValue);case 2:return(function(o,c){const h=Ze(o.integerValue||o.doubleValue),f=Ze(c.integerValue||c.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(i,t);case 3:return Nb(i.timestampValue,t.timestampValue);case 4:return Nb(bu(i),bu(t));case 5:return Bp(i.stringValue,t.stringValue);case 6:return(function(o,c){const h=pa(o),f=pa(c);return h.compareTo(f)})(i.bytesValue,t.bytesValue);case 7:return(function(o,c){const h=o.split("/"),f=c.split("/");for(let d=0;d<h.length&&d<f.length;d++){const p=ie(h[d],f[d]);if(p!==0)return p}return ie(h.length,f.length)})(i.referenceValue,t.referenceValue);case 8:return(function(o,c){const h=ie(Ze(o.latitude),Ze(c.latitude));return h!==0?h:ie(Ze(o.longitude),Ze(c.longitude))})(i.geoPointValue,t.geoPointValue);case 9:return jb(i.arrayValue,t.arrayValue);case 10:return(function(o,c){const h=o.fields||{},f=c.fields||{},d=h[ud]?.arrayValue,p=f[ud]?.arrayValue,v=ie(d?.values?.length||0,p?.values?.length||0);return v!==0?v:jb(d,p)})(i.mapValue,t.mapValue);case 11:return(function(o,c){if(o===hf.mapValue&&c===hf.mapValue)return 0;if(o===hf.mapValue)return 1;if(c===hf.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),d=c.fields||{},p=Object.keys(d);f.sort(),p.sort();for(let v=0;v<f.length&&v<p.length;++v){const S=Bp(f[v],p[v]);if(S!==0)return S;const b=xl(h[f[v]],d[p[v]]);if(b!==0)return b}return ie(f.length,p.length)})(i.mapValue,t.mapValue);default:throw Ft(23264,{he:e})}}function Nb(i,t){if(typeof i=="string"&&typeof t=="string"&&i.length===t.length)return ie(i,t);const e=ma(i),n=ma(t),s=ie(e.seconds,n.seconds);return s!==0?s:ie(e.nanos,n.nanos)}function jb(i,t){const e=i.values||[],n=t.values||[];for(let s=0;s<e.length&&s<n.length;++s){const o=xl(e[s],n[s]);if(o)return o}return ie(e.length,n.length)}function Al(i){return Fp(i)}function Fp(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(e){const n=ma(e);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(e){return pa(e).toBase64()})(i.bytesValue):"referenceValue"in i?(function(e){return Nt.fromName(e).toString()})(i.referenceValue):"geoPointValue"in i?(function(e){return`geo(${e.latitude},${e.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(e){let n="[",s=!0;for(const o of e.values||[])s?s=!1:n+=",",n+=Fp(o);return n+"]"})(i.arrayValue):"mapValue"in i?(function(e){const n=Object.keys(e.fields||{}).sort();let s="{",o=!0;for(const c of n)o?o=!1:s+=",",s+=`${c}:${Fp(e.fields[c])}`;return s+"}"})(i.mapValue):Ft(61005,{value:i})}function Gf(i){switch(ya(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Nd(i);return t?16+Gf(t):16;case 5:return 2*i.stringValue.length;case 6:return pa(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,o)=>s+Gf(o)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return yo(n.fields,((o,c)=>{s+=o.length+Gf(c)})),s})(i.mapValue);default:throw Ft(13486,{value:i})}}function Up(i){return!!i&&"integerValue"in i}function Py(i){return!!i&&"arrayValue"in i}function Bb(i){return!!i&&"nullValue"in i}function Fb(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Yf(i){return!!i&&"mapValue"in i}function MO(i){return(i?.mapValue?.fields||{})[aw]?.stringValue===ow}function su(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const t={mapValue:{fields:{}}};return yo(i.mapValue.fields,((e,n)=>t.mapValue.fields[e]=su(n))),t}if(i.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(i.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=su(i.arrayValue.values[e]);return t}return{...i}}function PO(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===OO}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(t){this.value=t}static empty(){return new zr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Yf(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=su(e)}setAll(t){let e=Mn.emptyPath(),n={},s=[];t.forEach(((c,h)=>{if(!e.isImmediateParentOf(h)){const f=this.getFieldsMap(e);this.applyChanges(f,n,s),n={},s=[],e=h.popLast()}c?n[h.lastSegment()]=su(c):s.push(h.lastSegment())}));const o=this.getFieldsMap(e);this.applyChanges(o,n,s)}delete(t){const e=this.field(t.popLast());Yf(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ui(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];Yf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){yo(e,((s,o)=>t[s]=o));for(const s of n)delete t[s]}clone(){return new zr(su(this.value))}}function lw(i){const t=[];return yo(i.fields,((e,n)=>{const s=new Mn([e]);if(Yf(n)){const o=lw(n.mapValue).fields;if(o.length===0)t.push(s);else for(const c of o)t.push(s.child(c))}else t.push(s)})),new mi(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(t,e,n,s,o,c,h){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(t){return new zn(t,0,Gt.min(),Gt.min(),Gt.min(),zr.empty(),0)}static newFoundDocument(t,e,n,s){return new zn(t,1,e,Gt.min(),n,s,0)}static newNoDocument(t,e){return new zn(t,2,e,Gt.min(),Gt.min(),zr.empty(),0)}static newUnknownDocument(t,e){return new zn(t,3,e,Gt.min(),Gt.min(),zr.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=zr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=zr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof zn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new zn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(t,e){this.position=t,this.inclusive=e}}function Ub(i,t,e){let n=0;for(let s=0;s<i.position.length;s++){const o=t[s],c=i.position[s];if(o.field.isKeyField()?n=Nt.comparator(Nt.fromName(c.referenceValue),e.key):n=xl(c,e.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function zb(i,t){if(i===null)return t===null;if(t===null||i.inclusive!==t.inclusive||i.position.length!==t.position.length)return!1;for(let e=0;e<i.position.length;e++)if(!Ui(i.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(t,e="asc"){this.field=t,this.dir=e}}function IO(i,t){return i.dir===t.dir&&i.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{}class fn extends cw{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new VO(t,e,n):e==="array-contains"?new jO(t,n):e==="in"?new BO(t,n):e==="not-in"?new FO(t,n):e==="array-contains-any"?new UO(t,n):new fn(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new LO(t,n):new NO(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(xl(e,this.value)):e!==null&&ya(this.value)===ya(e)&&this.matchesComparison(xl(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ft(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zi extends cw{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new zi(t,e)}matches(t){return uw(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function uw(i){return i.op==="and"}function hw(i){return kO(i)&&uw(i)}function kO(i){for(const t of i.filters)if(t instanceof zi)return!1;return!0}function zp(i){if(i instanceof fn)return i.field.canonicalString()+i.op.toString()+Al(i.value);if(hw(i))return i.filters.map((t=>zp(t))).join(",");{const t=i.filters.map((e=>zp(e))).join(",");return`${i.op}(${t})`}}function fw(i,t){return i instanceof fn?(function(n,s){return s instanceof fn&&n.op===s.op&&n.field.isEqual(s.field)&&Ui(n.value,s.value)})(i,t):i instanceof zi?(function(n,s){return s instanceof zi&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((o,c,h)=>o&&fw(c,s.filters[h])),!0):!1})(i,t):void Ft(19439)}function dw(i){return i instanceof fn?(function(e){return`${e.field.canonicalString()} ${e.op} ${Al(e.value)}`})(i):i instanceof zi?(function(e){return e.op.toString()+" {"+e.getFilters().map(dw).join(" ,")+"}"})(i):"Filter"}class VO extends fn{constructor(t,e,n){super(t,e,n),this.key=Nt.fromName(n.referenceValue)}matches(t){const e=Nt.comparator(t.key,this.key);return this.matchesComparison(e)}}class LO extends fn{constructor(t,e){super(t,"in",e),this.keys=gw("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class NO extends fn{constructor(t,e){super(t,"not-in",e),this.keys=gw("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function gw(i,t){return(t.arrayValue?.values||[]).map((e=>Nt.fromName(e.referenceValue)))}class jO extends fn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Py(e)&&wu(e.arrayValue,this.value)}}class BO extends fn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&wu(this.value.arrayValue,e)}}class FO extends fn{constructor(t,e){super(t,"not-in",e)}matches(t){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!wu(this.value.arrayValue,e)}}class UO extends fn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Py(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>wu(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(t,e=null,n=[],s=[],o=null,c=null,h=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=o,this.startAt=c,this.endAt=h,this.Te=null}}function Hb(i,t=null,e=[],n=[],s=null,o=null,c=null){return new zO(i,t,e,n,s,o,c)}function Iy(i){const t=Xt(i);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>zp(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),Ld(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>Al(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>Al(n))).join(",")),t.Te=e}return t.Te}function ky(i,t){if(i.limit!==t.limit||i.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<i.orderBy.length;e++)if(!IO(i.orderBy[e],t.orderBy[e]))return!1;if(i.filters.length!==t.filters.length)return!1;for(let e=0;e<i.filters.length;e++)if(!fw(i.filters[e],t.filters[e]))return!1;return i.collectionGroup===t.collectionGroup&&!!i.path.isEqual(t.path)&&!!zb(i.startAt,t.startAt)&&zb(i.endAt,t.endAt)}function Hp(i){return Nt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(t,e=null,n=[],s=[],o=null,c="F",h=null,f=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HO(i,t,e,n,s,o,c,h){return new jd(i,t,e,n,s,o,c,h)}function Vy(i){return new jd(i)}function Gb(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function GO(i){return i.collectionGroup!==null}function au(i){const t=Xt(i);if(t.Ie===null){t.Ie=[];const e=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),e.add(o.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new dn(Mn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(h=h.add(d.field))}))})),h})(t).forEach((o=>{e.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new fd(o,n))})),e.has(Mn.keyField().canonicalString())||t.Ie.push(new fd(Mn.keyField(),n))}return t.Ie}function Li(i){const t=Xt(i);return t.Ee||(t.Ee=YO(t,au(i))),t.Ee}function YO(i,t){if(i.limitType==="F")return Hb(i.path,i.collectionGroup,t,i.filters,i.limit,i.startAt,i.endAt);{t=t.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new fd(s.field,o)}));const e=i.endAt?new hd(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new hd(i.startAt.position,i.startAt.inclusive):null;return Hb(i.path,i.collectionGroup,t,i.filters,i.limit,e,n)}}function Gp(i,t,e){return new jd(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),t,e,i.startAt,i.endAt)}function Bd(i,t){return ky(Li(i),Li(t))&&i.limitType===t.limitType}function mw(i){return`${Iy(Li(i))}|lt:${i.limitType}`}function hl(i){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((s=>dw(s))).join(", ")}]`),Ld(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>Al(s))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>Al(s))).join(",")),`Target(${n})`})(Li(i))}; limitType=${i.limitType})`}function Fd(i,t){return t.isFoundDocument()&&(function(n,s){const o=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Nt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(i,t)&&(function(n,s){for(const o of au(n))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(i,t)&&(function(n,s){for(const o of n.filters)if(!o.matches(s))return!1;return!0})(i,t)&&(function(n,s){return!(n.startAt&&!(function(c,h,f){const d=Ub(c,h,f);return c.inclusive?d<=0:d<0})(n.startAt,au(n),s)||n.endAt&&!(function(c,h,f){const d=Ub(c,h,f);return c.inclusive?d>=0:d>0})(n.endAt,au(n),s))})(i,t)}function qO(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function pw(i){return(t,e)=>{let n=!1;for(const s of au(i)){const o=XO(s,t,e);if(o!==0)return o;n=n||s.field.isKeyField()}return 0}}function XO(i,t,e){const n=i.field.isKeyField()?Nt.comparator(t.key,e.key):(function(o,c,h){const f=c.data.field(o),d=h.data.field(o);return f!==null&&d!==null?xl(f,d):Ft(42886)})(i.field,t,e);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Ft(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[s,o]of n)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){yo(this.inner,((e,n)=>{for(const[s,o]of n)t(s,o)}))}isEmpty(){return tw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=new Ge(Nt.comparator);function _s(){return WO}const yw=new Ge(Nt.comparator);function tu(...i){let t=yw;for(const e of i)t=t.insert(e.key,e);return t}function vw(i){let t=yw;return i.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ao(){return ou()}function _w(){return ou()}function ou(){return new vo((i=>i.toString()),((i,t)=>i.isEqual(t)))}const KO=new Ge(Nt.comparator),QO=new dn(Nt.comparator);function se(...i){let t=QO;for(const e of i)t=t.add(e);return t}const $O=new dn(ie);function ZO(){return $O}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(i,t){if(i.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ld(t)?"-0":t}}function Sw(i){return{integerValue:""+i}}function JO(i,t){return CO(t)?Sw(t):Ly(i,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(){this._=void 0}}function tM(i,t,e){return i instanceof Eu?(function(s,o){const c={fields:{[rw]:{stringValue:nw},[sw]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&My(o)&&(o=Nd(o)),o&&(c.fields[iw]=o),{mapValue:c}})(e,t):i instanceof Cu?Tw(i,t):i instanceof xu?ww(i,t):(function(s,o){const c=bw(s,o),h=Yb(c)+Yb(s.Ae);return Up(c)&&Up(s.Ae)?Sw(h):Ly(s.serializer,h)})(i,t)}function eM(i,t,e){return i instanceof Cu?Tw(i,t):i instanceof xu?ww(i,t):e}function bw(i,t){return i instanceof dd?(function(n){return Up(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(t)?t:{integerValue:0}:null}class Eu extends Ud{}class Cu extends Ud{constructor(t){super(),this.elements=t}}function Tw(i,t){const e=Ew(t);for(const n of i.elements)e.some((s=>Ui(s,n)))||e.push(n);return{arrayValue:{values:e}}}class xu extends Ud{constructor(t){super(),this.elements=t}}function ww(i,t){let e=Ew(t);for(const n of i.elements)e=e.filter((s=>!Ui(s,n)));return{arrayValue:{values:e}}}class dd extends Ud{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Yb(i){return Ze(i.integerValue||i.doubleValue)}function Ew(i){return Py(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(t,e){this.field=t,this.transform=e}}function rM(i,t){return i.field.isEqual(t.field)&&(function(n,s){return n instanceof Cu&&s instanceof Cu||n instanceof xu&&s instanceof xu?Cl(n.elements,s.elements,Ui):n instanceof dd&&s instanceof dd?Ui(n.Ae,s.Ae):n instanceof Eu&&s instanceof Eu})(i.transform,t.transform)}class iM{constructor(t,e){this.version=t,this.transformResults=e}}class ms{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ms}static exists(t){return new ms(void 0,t)}static updateTime(t){return new ms(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function qf(i,t){return i.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(i.updateTime):i.exists===void 0||i.exists===t.isFoundDocument()}class zd{}function Cw(i,t){if(!i.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return i.isNoDocument()?new Aw(i.key,ms.none()):new Nu(i.key,i.data,ms.none());{const e=i.data,n=zr.empty();let s=new dn(Mn.comparator);for(let o of t.fields)if(!s.has(o)){let c=e.field(o);c===null&&o.length>1&&(o=o.popLast(),c=e.field(o)),c===null?n.delete(o):n.set(o,c),s=s.add(o)}return new _o(i.key,n,new mi(s.toArray()),ms.none())}}function sM(i,t,e){i instanceof Nu?(function(s,o,c){const h=s.value.clone(),f=Xb(s.fieldTransforms,o,c.transformResults);h.setAll(f),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(i,t,e):i instanceof _o?(function(s,o,c){if(!qf(s.precondition,o))return void o.convertToUnknownDocument(c.version);const h=Xb(s.fieldTransforms,o,c.transformResults),f=o.data;f.setAll(xw(s)),f.setAll(h),o.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(i,t,e):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,t,e)}function lu(i,t,e,n){return i instanceof Nu?(function(o,c,h,f){if(!qf(o.precondition,c))return h;const d=o.value.clone(),p=Wb(o.fieldTransforms,f,c);return d.setAll(p),c.convertToFoundDocument(c.version,d).setHasLocalMutations(),null})(i,t,e,n):i instanceof _o?(function(o,c,h,f){if(!qf(o.precondition,c))return h;const d=Wb(o.fieldTransforms,f,c),p=c.data;return p.setAll(xw(o)),p.setAll(d),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(i,t,e,n):(function(o,c,h){return qf(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(i,t,e)}function aM(i,t){let e=null;for(const n of i.fieldTransforms){const s=t.data.field(n.field),o=bw(n.transform,s||null);o!=null&&(e===null&&(e=zr.empty()),e.set(n.field,o))}return e||null}function qb(i,t){return i.type===t.type&&!!i.key.isEqual(t.key)&&!!i.precondition.isEqual(t.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Cl(n,s,((o,c)=>rM(o,c)))})(i.fieldTransforms,t.fieldTransforms)&&(i.type===0?i.value.isEqual(t.value):i.type!==1||i.data.isEqual(t.data)&&i.fieldMask.isEqual(t.fieldMask))}class Nu extends zd{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class _o extends zd{constructor(t,e,n,s,o=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function xw(i){const t=new Map;return i.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=i.data.field(e);t.set(e,n)}})),t}function Xb(i,t,e){const n=new Map;ye(i.length===e.length,32656,{Re:e.length,Ve:i.length});for(let s=0;s<e.length;s++){const o=i[s],c=o.transform,h=t.data.field(o.field);n.set(o.field,eM(c,h,e[s]))}return n}function Wb(i,t,e){const n=new Map;for(const s of i){const o=s.transform,c=e.data.field(s.field);n.set(s.field,tM(o,c,t))}return n}class Aw extends zd{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oM extends zd{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&sM(o,t,n[s])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=lu(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=lu(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=_w();return this.mutations.forEach((s=>{const o=t.get(s.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=e.has(s.key)?null:h;const f=Cw(c,h);f!==null&&n.set(s.key,f),c.isValidDocument()||c.convertToNoDocument(Gt.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),se())}isEqual(t){return this.batchId===t.batchId&&Cl(this.mutations,t.mutations,((e,n)=>qb(e,n)))&&Cl(this.baseMutations,t.baseMutations,((e,n)=>qb(e,n)))}}class Ny{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){ye(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let s=(function(){return KO})();const o=t.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,n[c].version);return new Ny(t,e,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var an,le;function hM(i){switch(i){case dt.OK:return Ft(64938);case dt.CANCELLED:case dt.UNKNOWN:case dt.DEADLINE_EXCEEDED:case dt.RESOURCE_EXHAUSTED:case dt.INTERNAL:case dt.UNAVAILABLE:case dt.UNAUTHENTICATED:return!1;case dt.INVALID_ARGUMENT:case dt.NOT_FOUND:case dt.ALREADY_EXISTS:case dt.PERMISSION_DENIED:case dt.FAILED_PRECONDITION:case dt.ABORTED:case dt.OUT_OF_RANGE:case dt.UNIMPLEMENTED:case dt.DATA_LOSS:return!0;default:return Ft(15467,{code:i})}}function Dw(i){if(i===void 0)return vs("GRPC error has no .code"),dt.UNKNOWN;switch(i){case an.OK:return dt.OK;case an.CANCELLED:return dt.CANCELLED;case an.UNKNOWN:return dt.UNKNOWN;case an.DEADLINE_EXCEEDED:return dt.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return dt.RESOURCE_EXHAUSTED;case an.INTERNAL:return dt.INTERNAL;case an.UNAVAILABLE:return dt.UNAVAILABLE;case an.UNAUTHENTICATED:return dt.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return dt.INVALID_ARGUMENT;case an.NOT_FOUND:return dt.NOT_FOUND;case an.ALREADY_EXISTS:return dt.ALREADY_EXISTS;case an.PERMISSION_DENIED:return dt.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return dt.FAILED_PRECONDITION;case an.ABORTED:return dt.ABORTED;case an.OUT_OF_RANGE:return dt.OUT_OF_RANGE;case an.UNIMPLEMENTED:return dt.UNIMPLEMENTED;case an.DATA_LOSS:return dt.DATA_LOSS;default:return Ft(39323,{code:i})}}(le=an||(an={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=new ha([4294967295,4294967295],0);function Kb(i){const t=fM().encode(i),e=new G1;return e.update(t),new Uint8Array(e.digest())}function Qb(i){const t=new DataView(i.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new ha([e,n],0),new ha([s,o],0)]}class jy{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new eu(`Invalid padding: ${e}`);if(n<0)throw new eu(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new eu(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new eu(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=ha.fromNumber(this.ge)}ye(t,e,n){let s=t.add(e.multiply(ha.fromNumber(n)));return s.compare(dM)===1&&(s=new ha([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Kb(t),[n,s]=Qb(e);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,s,o);if(!this.we(c))return!1}return!0}static create(t,e,n){const s=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),c=new jy(o,s,e);return n.forEach((h=>c.insert(h))),c}insert(t){if(this.ge===0)return;const e=Kb(t),[n,s]=Qb(e);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,s,o);this.Se(c)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class eu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(t,e,n,s,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,ju.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Hd(Gt.min(),s,new Ge(ie),_s(),se())}}class ju{constructor(t,e,n,s,o){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new ju(n,e,se(),se(),se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(t,e,n,s){this.be=t,this.removedTargetIds=e,this.key=n,this.De=s}}class Rw{constructor(t,e){this.targetId=t,this.Ce=e}}class Ow{constructor(t,e,n=In.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class $b{constructor(){this.ve=0,this.Fe=Zb(),this.Me=In.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=se(),e=se(),n=se();return this.Fe.forEach(((s,o)=>{switch(o){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:Ft(38017,{changeType:o})}})),new ju(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=Zb()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class gM{constructor(t){this.Ge=t,this.ze=new Map,this.je=_s(),this.Je=ff(),this.He=ff(),this.Ye=new Ge(ie)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:Ft(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,n=t.Ce.count,s=this.ot(e);if(s){const o=s.target;if(Hp(o))if(n===0){const c=new Nt(o.path);this.et(e,c,zn.newNoDocument(c,Gt.min()))}else ye(n===1,20013,{expectedCount:n});else{const c=this._t(e);if(c!==n){const h=this.ut(t),f=h?this.ct(h,t,c):1;if(f!==0){this.it(e);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,d)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:o=0}=e;let c,h;try{c=pa(n).toUint8Array()}catch(f){if(f instanceof ew)return El("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new jy(c,s,o)}catch(f){return El(f instanceof eu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let s=0;return n.forEach((o=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;t.mightContain(h)||(this.et(e,o,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((o,c)=>{const h=this.ot(c);if(h){if(o.current&&Hp(h.target)){const f=new Nt(h.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,zn.newNoDocument(f,t))}o.Be&&(e.set(c,o.ke()),o.qe())}}));let n=se();this.He.forEach(((o,c)=>{let h=!0;c.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(n=n.add(o))})),this.je.forEach(((o,c)=>c.setReadTime(t)));const s=new Hd(t,e,this.Ye,this.je,n);return this.je=_s(),this.Je=ff(),this.He=ff(),this.Ye=new Ge(ie),s}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new $b,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new dn(ie),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new dn(ie),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||bt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new $b),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function ff(){return new Ge(Nt.comparator)}function Zb(){return new Ge(Nt.comparator)}const mM={asc:"ASCENDING",desc:"DESCENDING"},pM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yM={and:"AND",or:"OR"};class vM{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Yp(i,t){return i.useProto3Json||Ld(t)?t:{value:t}}function gd(i,t){return i.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Mw(i,t){return i.useProto3Json?t.toBase64():t.toUint8Array()}function _M(i,t){return gd(i,t.toTimestamp())}function Ni(i){return ye(!!i,49232),Gt.fromTimestamp((function(e){const n=ma(e);return new Ve(n.seconds,n.nanos)})(i))}function By(i,t){return qp(i,t).canonicalString()}function qp(i,t){const e=(function(s){return new He(["projects",s.projectId,"databases",s.database])})(i).child("documents");return t===void 0?e:e.child(t)}function Pw(i){const t=He.fromString(i);return ye(Nw(t),10190,{key:t.toString()}),t}function Xp(i,t){return By(i.databaseId,t.path)}function fp(i,t){const e=Pw(t);if(e.get(1)!==i.databaseId.projectId)throw new Lt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+i.databaseId.projectId);if(e.get(3)!==i.databaseId.database)throw new Lt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+i.databaseId.database);return new Nt(kw(e))}function Iw(i,t){return By(i.databaseId,t)}function SM(i){const t=Pw(i);return t.length===4?He.emptyPath():kw(t)}function Wp(i){return new He(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function kw(i){return ye(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Jb(i,t,e){return{name:Xp(i,t),fields:e.value.mapValue.fields}}function bM(i,t){let e;if("targetChange"in t){t.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ft(39313,{state:d})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(ye(p===void 0||typeof p=="string",58123),In.fromBase64String(p||"")):(ye(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),In.fromUint8Array(p||new Uint8Array))})(i,t.targetChange.resumeToken),c=t.targetChange.cause,h=c&&(function(d){const p=d.code===void 0?dt.UNKNOWN:Dw(d.code);return new Lt(p,d.message||"")})(c);e=new Ow(n,s,o,h||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=fp(i,n.document.name),o=Ni(n.document.updateTime),c=n.document.createTime?Ni(n.document.createTime):Gt.min(),h=new zr({mapValue:{fields:n.document.fields}}),f=zn.newFoundDocument(s,o,c,h),d=n.targetIds||[],p=n.removedTargetIds||[];e=new Xf(d,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=fp(i,n.document),o=n.readTime?Ni(n.readTime):Gt.min(),c=zn.newNoDocument(s,o),h=n.removedTargetIds||[];e=new Xf([],h,c.key,c)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=fp(i,n.document),o=n.removedTargetIds||[];e=new Xf([],o,s,null)}else{if(!("filter"in t))return Ft(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:o}=n,c=new uM(s,o),h=n.targetId;e=new Rw(h,c)}}return e}function TM(i,t){let e;if(t instanceof Nu)e={update:Jb(i,t.key,t.value)};else if(t instanceof Aw)e={delete:Xp(i,t.key)};else if(t instanceof _o)e={update:Jb(i,t.key,t.data),updateMask:MM(t.fieldMask)};else{if(!(t instanceof oM))return Ft(16599,{Vt:t.type});e={verify:Xp(i,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((n=>(function(o,c){const h=c.transform;if(h instanceof Eu)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Cu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof xu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof dd)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw Ft(20930,{transform:c.transform})})(0,n)))),t.precondition.isNone||(e.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:_M(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ft(27497)})(i,t.precondition)),e}function wM(i,t){return i&&i.length>0?(ye(t!==void 0,14353),i.map((e=>(function(s,o){let c=s.updateTime?Ni(s.updateTime):Ni(o);return c.isEqual(Gt.min())&&(c=Ni(o)),new iM(c,s.transformResults||[])})(e,t)))):[]}function EM(i,t){return{documents:[Iw(i,t.path)]}}function CM(i,t){const e={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=Iw(i,s);const o=(function(d){if(d.length!==0)return Lw(zi.create(d,"and"))})(t.filters);o&&(e.structuredQuery.where=o);const c=(function(d){if(d.length!==0)return d.map((p=>(function(S){return{field:fl(S.field),direction:DM(S.dir)}})(p)))})(t.orderBy);c&&(e.structuredQuery.orderBy=c);const h=Yp(i,t.limit);return h!==null&&(e.structuredQuery.limit=h),t.startAt&&(e.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(t.endAt)),{ft:e,parent:s}}function xM(i){let t=SM(i.parent);const e=i.structuredQuery,n=e.from?e.from.length:0;let s=null;if(n>0){ye(n===1,65062);const p=e.from[0];p.allDescendants?s=p.collectionId:t=t.child(p.collectionId)}let o=[];e.where&&(o=(function(v){const S=Vw(v);return S instanceof zi&&hw(S)?S.getFilters():[S]})(e.where));let c=[];e.orderBy&&(c=(function(v){return v.map((S=>(function(E){return new fd(dl(E.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(S)))})(e.orderBy));let h=null;e.limit&&(h=(function(v){let S;return S=typeof v=="object"?v.value:v,Ld(S)?null:S})(e.limit));let f=null;e.startAt&&(f=(function(v){const S=!!v.before,b=v.values||[];return new hd(b,S)})(e.startAt));let d=null;return e.endAt&&(d=(function(v){const S=!v.before,b=v.values||[];return new hd(b,S)})(e.endAt)),HO(t,s,c,o,h,"F",f,d)}function AM(i,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ft(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function Vw(i){return i.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=dl(e.unaryFilter.field);return fn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=dl(e.unaryFilter.field);return fn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=dl(e.unaryFilter.field);return fn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=dl(e.unaryFilter.field);return fn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ft(61313);default:return Ft(60726)}})(i):i.fieldFilter!==void 0?(function(e){return fn.create(dl(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ft(58110);default:return Ft(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(e){return zi.create(e.compositeFilter.filters.map((n=>Vw(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ft(1026)}})(e.compositeFilter.op))})(i):Ft(30097,{filter:i})}function DM(i){return mM[i]}function RM(i){return pM[i]}function OM(i){return yM[i]}function fl(i){return{fieldPath:i.canonicalString()}}function dl(i){return Mn.fromServerFormat(i.fieldPath)}function Lw(i){return i instanceof fn?(function(e){if(e.op==="=="){if(Fb(e.value))return{unaryFilter:{field:fl(e.field),op:"IS_NAN"}};if(Bb(e.value))return{unaryFilter:{field:fl(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Fb(e.value))return{unaryFilter:{field:fl(e.field),op:"IS_NOT_NAN"}};if(Bb(e.value))return{unaryFilter:{field:fl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(e.field),op:RM(e.op),value:e.value}}})(i):i instanceof zi?(function(e){const n=e.getFilters().map((s=>Lw(s)));return n.length===1?n[0]:{compositeFilter:{op:OM(e.op),filters:n}}})(i):Ft(54877,{filter:i})}function MM(i){const t=[];return i.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Nw(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(t,e,n,s,o=Gt.min(),c=Gt.min(),h=In.EMPTY_BYTE_STRING,f=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(t){return new la(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(t){this.yt=t}}function IM(i){const t=xM({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Gp(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(){this.Cn=new VM}addToCollectionParentIndex(t,e){return this.Cn.add(e),ut.resolve()}getCollectionParents(t,e){return ut.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return ut.resolve()}deleteFieldIndex(t,e){return ut.resolve()}deleteAllFieldIndexes(t){return ut.resolve()}createTargetIndexes(t,e){return ut.resolve()}getDocumentsMatchingTarget(t,e){return ut.resolve(null)}getIndexType(t,e){return ut.resolve(0)}getFieldIndexes(t,e){return ut.resolve([])}getNextCollectionGroupToUpdate(t){return ut.resolve(null)}getMinOffset(t,e){return ut.resolve(ga.min())}getMinOffsetFromCollectionGroup(t,e){return ut.resolve(ga.min())}updateCollectionGroup(t,e,n){return ut.resolve()}updateIndexEntries(t,e){return ut.resolve()}}class VM{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new dn(He.comparator),o=!s.has(n);return this.index[e]=s.add(n),o}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new dn(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jw=41943040;class lr{static withCacheSize(t){return new lr(t,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lr.DEFAULT_COLLECTION_PERCENTILE=10,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lr.DEFAULT=new lr(jw,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lr.DISABLED=new lr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Dl(0)}static cr(){return new Dl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT="LruGarbageCollector",LM=1048576;function nT([i,t],[e,n]){const s=ie(i,e);return s===0?ie(t,n):s}class NM{constructor(t){this.Ir=t,this.buffer=new dn(nT),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();nT(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class jM{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){bt(eT,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Vl(e)?bt(eT,"Ignoring IndexedDB error during garbage collection: ",e):await kl(e)}await this.Vr(3e5)}))}}class BM{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return ut.resolve(Vd.ce);const n=new NM(e);return this.mr.forEachTarget(t,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),ut.resolve(tT)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tT):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,s,o,c,h,f,d;const p=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,c=Date.now(),this.nthSequenceNumber(t,s)))).next((v=>(n=v,h=Date.now(),this.removeTargets(t,n,e)))).next((v=>(o=v,f=Date.now(),this.removeOrphanedDocuments(t,n)))).next((v=>(d=Date.now(),ul()<=ce.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-p}ms
	Determined least recently used ${s} in `+(h-c)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${v} documents in `+(d-f)+`ms
Total Duration: ${d-p}ms`),ut.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:v}))))}}function FM(i,t){return new BM(i,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.changes=new vo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,zn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?ut.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(n!==null&&lu(n.mutation,s,mi.empty(),Ve.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,se()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=se()){const s=ao();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((o=>{let c=tu();return o.forEach(((h,f)=>{c=c.insert(h,f.overlayedDocument)})),c}))))}getOverlayedDocuments(t,e){const n=ao();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,se())))}populateOverlays(t,e,n){const s=[];return n.forEach((o=>{e.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(t,s).next((o=>{o.forEach(((c,h)=>{e.set(c,h)}))}))}computeViews(t,e,n,s){let o=_s();const c=ou(),h=(function(){return ou()})();return e.forEach(((f,d)=>{const p=n.get(d.key);s.has(d.key)&&(p===void 0||p.mutation instanceof _o)?o=o.insert(d.key,d):p!==void 0?(c.set(d.key,p.mutation.getFieldMask()),lu(p.mutation,d,p.mutation.getFieldMask(),Ve.now())):c.set(d.key,mi.empty())})),this.recalculateAndSaveOverlays(t,o).next((f=>(f.forEach(((d,p)=>c.set(d,p))),e.forEach(((d,p)=>h.set(d,new zM(p,c.get(d)??null)))),h)))}recalculateAndSaveOverlays(t,e){const n=ou();let s=new Ge(((c,h)=>c-h)),o=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((c=>{for(const h of c)h.keys().forEach((f=>{const d=e.get(f);if(d===null)return;let p=n.get(f)||mi.empty();p=h.applyToLocalView(d,p),n.set(f,p);const v=(s.get(h.batchId)||se()).add(f);s=s.insert(h.batchId,v)}))})).next((()=>{const c=[],h=s.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),d=f.key,p=f.value,v=_w();p.forEach((S=>{if(!o.has(S)){const b=Cw(e.get(S),n.get(S));b!==null&&v.set(S,b),o=o.add(S)}})),c.push(this.documentOverlayCache.saveOverlays(t,d,v))}return ut.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,s){return(function(c){return Nt.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):GO(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,s):this.getDocumentsMatchingCollectionQuery(t,e,n,s)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((o=>{const c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-o.size):ut.resolve(ao());let h=Su,f=o;return c.next((d=>ut.forEach(d,((p,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(p)?ut.resolve():this.remoteDocumentCache.getEntry(t,p).next((S=>{f=f.insert(p,S)}))))).next((()=>this.populateOverlays(t,d,o))).next((()=>this.computeViews(t,f,d,se()))).next((p=>({batchId:h,changes:vw(p)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Nt(e)).next((n=>{let s=tu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,s){const o=e.collectionGroup;let c=tu();return this.indexManager.getCollectionParents(t,o).next((h=>ut.forEach(h,(f=>{const d=(function(v,S){return new jd(S,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(e,f.child(o));return this.getDocumentsMatchingCollectionQuery(t,d,n,s).next((p=>{p.forEach(((v,S)=>{c=c.insert(v,S)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(t,e,n,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,o,s)))).next((c=>{o.forEach(((f,d)=>{const p=d.getKey();c.get(p)===null&&(c=c.insert(p,zn.newInvalidDocument(p)))}));let h=tu();return c.forEach(((f,d)=>{const p=o.get(f);p!==void 0&&lu(p.mutation,d,mi.empty(),Ve.now()),Fd(e,d)&&(h=h.insert(f,d))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return ut.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:Ni(s.createTime)}})(e)),ut.resolve()}getNamedQuery(t,e){return ut.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:IM(s.bundledQuery),readTime:Ni(s.readTime)}})(e)),ut.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.overlays=new Ge(Nt.comparator),this.qr=new Map}getOverlay(t,e){return ut.resolve(this.overlays.get(e))}getOverlays(t,e){const n=ao();return ut.forEach(e,(s=>this.getOverlay(t,s).next((o=>{o!==null&&n.set(s,o)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((s,o)=>{this.St(t,e,o)})),ut.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),ut.resolve()}getOverlaysForCollection(t,e,n){const s=ao(),o=e.length+1,c=new Nt(e.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const f=h.getNext().value,d=f.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===o&&f.largestBatchId>n&&s.set(f.getKey(),f)}return ut.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let o=new Ge(((d,p)=>d-p));const c=this.overlays.getIterator();for(;c.hasNext();){const d=c.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>n){let p=o.get(d.largestBatchId);p===null&&(p=ao(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const h=ao(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,p)=>h.set(d,p))),!(h.size()>=s)););return ut.resolve(h)}St(t,e,n){const s=this.overlays.get(n.key);if(s!==null){const c=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new cM(e,n));let o=this.qr.get(e);o===void 0&&(o=se(),this.qr.set(e,o)),this.qr.set(e,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(){this.sessionToken=In.EMPTY_BYTE_STRING}getSessionToken(t){return ut.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,ut.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(){this.Qr=new dn(Tn.$r),this.Ur=new dn(Tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new Tn(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new Tn(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new Nt(new He([])),n=new Tn(e,t),s=new Tn(e,t+1),o=[];return this.Ur.forEachInRange([n,s],(c=>{this.Gr(c),o.push(c.key)})),o}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new Nt(new He([])),n=new Tn(e,t),s=new Tn(e,t+1);let o=se();return this.Ur.forEachInRange([n,s],(c=>{o=o.add(c.key)})),o}containsKey(t){const e=new Tn(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class Tn{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return Nt.comparator(t.key,e.key)||ie(t.Yr,e.Yr)}static Kr(t,e){return ie(t.Yr,e.Yr)||Nt.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new dn(Tn.$r)}checkEmpty(t){return ut.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new lM(o,e,n,s);this.mutationQueue.push(c);for(const h of s)this.Zr=this.Zr.add(new Tn(h.key,o)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return ut.resolve(c)}lookupMutationBatch(t,e){return ut.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.ei(n),o=s<0?0:s;return ut.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ut.resolve(this.mutationQueue.length===0?Oy:this.tr-1)}getAllMutationBatches(t){return ut.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Tn(e,0),s=new Tn(e,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,s],(c=>{const h=this.Xr(c.Yr);o.push(h)})),ut.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new dn(ie);return e.forEach((s=>{const o=new Tn(s,0),c=new Tn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,c],(h=>{n=n.add(h.Yr)}))})),ut.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let o=n;Nt.isDocumentKey(o)||(o=o.child(""));const c=new Tn(new Nt(o),0);let h=new dn(ie);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(h=h.add(f.Yr)),!0)}),c),ut.resolve(this.ti(h))}ti(t){const e=[];return t.forEach((n=>{const s=this.Xr(n);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){ye(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ut.forEach(e.mutations,(s=>{const o=new Tn(s.key,e.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new Tn(e,0),s=this.Zr.firstAfterOrEqual(n);return ut.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ut.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(t){this.ri=t,this.docs=(function(){return new Ge(Nt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),o=s?s.size:0,c=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return ut.resolve(n?n.document.mutableCopy():zn.newInvalidDocument(e))}getEntries(t,e){let n=_s();return e.forEach((s=>{const o=this.docs.get(s);n=n.insert(s,o?o.document.mutableCopy():zn.newInvalidDocument(s))})),ut.resolve(n)}getDocumentsMatchingQuery(t,e,n,s){let o=_s();const c=e.path,h=new Nt(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:d,value:{document:p}}=f.getNext();if(!c.isPrefixOf(d.path))break;d.path.length>c.length+1||bO(SO(p),n)<=0||(s.has(p.key)||Fd(e,p))&&(o=o.insert(p.key,p.mutableCopy()))}return ut.resolve(o)}getAllFromCollectionGroup(t,e,n,s){Ft(9500)}ii(t,e){return ut.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new KM(this)}getSize(t){return ut.resolve(this.size)}}class KM extends UM{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(n)})),ut.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(t){this.persistence=t,this.si=new vo((e=>Iy(e)),ky),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.oi=0,this._i=new Fy,this.targetCount=0,this.ai=Dl.ur()}forEachTarget(t,e){return this.si.forEach(((n,s)=>e(s))),ut.resolve()}getLastRemoteSnapshotVersion(t){return ut.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ut.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),ut.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),ut.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Dl(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,ut.resolve()}updateTargetData(t,e){return this.Pr(e),ut.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,ut.resolve()}removeTargets(t,e,n){let s=0;const o=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=e&&n.get(h.targetId)===null&&(this.si.delete(c),o.push(this.removeMatchingKeysForTargetId(t,h.targetId)),s++)})),ut.waitFor(o).next((()=>s))}getTargetCount(t){return ut.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return ut.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),ut.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const s=this.persistence.referenceDelegate,o=[];return s&&e.forEach((c=>{o.push(s.markPotentiallyOrphaned(t,c))})),ut.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),ut.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return ut.resolve(n)}containsKey(t,e){return ut.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(t,e){this.ui={},this.overlays={},this.ci=new Vd(0),this.li=!1,this.li=!0,this.hi=new qM,this.referenceDelegate=t(this),this.Pi=new QM(this),this.indexManager=new kM,this.remoteDocumentCache=(function(s){return new WM(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new PM(e),this.Ii=new GM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new YM,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new XM(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){bt("MemoryPersistence","Starting transaction:",t);const s=new $M(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(t,e){return ut.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class $M extends wO{constructor(t){super(),this.currentSequenceNumber=t}}class Uy{constructor(t){this.persistence=t,this.Ri=new Fy,this.Vi=null}static mi(t){return new Uy(t)}get fi(){if(this.Vi)return this.Vi;throw Ft(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),ut.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),ut.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),ut.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ut.forEach(this.fi,(n=>{const s=Nt.fromPath(n);return this.gi(t,s).next((o=>{o||e.removeEntry(s,Gt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return ut.or([()=>ut.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class md{constructor(t,e){this.persistence=t,this.pi=new vo((n=>xO(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=FM(this,e)}static mi(t,e){return new md(t,e)}Ei(){}di(t){return ut.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((s=>n+s))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return ut.forEach(this.pi,((n,s)=>this.br(t,n,s).next((o=>o?ut.resolve():e(s)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(t,(c=>this.br(t,c,e).next((h=>{h||(n++,o.removeEntry(c,Gt.min()))})))).next((()=>o.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),ut.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),ut.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),ut.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),ut.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Gf(t.data.value)),e}br(t,e,n){return ut.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return ut.resolve(s!==void 0&&s>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=s}static As(t,e){let n=se(),s=se();for(const o of e.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new zy(t,e.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return HD()?8:EO(UD())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,s){const o={result:null};return this.ys(t,e).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.ws(t,e,s,n).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new ZM;return this.Ss(t,e,c).next((h=>{if(o.result=h,this.Vs)return this.bs(t,e,c,h.size)}))})).next((()=>o.result))}bs(t,e,n,s){return n.documentReadCount<this.fs?(ul()<=ce.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",hl(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ut.resolve()):(ul()<=ce.DEBUG&&bt("QueryEngine","Query:",hl(e),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(ul()<=ce.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",hl(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Li(e))):ut.resolve())}ys(t,e){if(Gb(e))return ut.resolve(null);let n=Li(e);return this.indexManager.getIndexType(t,n).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=Gp(e,null,"F"),n=Li(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((o=>{const c=se(...o);return this.ps.getDocuments(t,c).next((h=>this.indexManager.getMinOffset(t,n).next((f=>{const d=this.Ds(e,h);return this.Cs(e,d,c,f.readTime)?this.ys(t,Gp(e,null,"F")):this.vs(t,d,e,f)}))))})))))}ws(t,e,n,s){return Gb(e)||s.isEqual(Gt.min())?ut.resolve(null):this.ps.getDocuments(t,n).next((o=>{const c=this.Ds(e,o);return this.Cs(e,c,n,s)?ut.resolve(null):(ul()<=ce.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),hl(e)),this.vs(t,c,e,_O(s,Su)).next((h=>h)))}))}Ds(t,e){let n=new dn(pw(t));return e.forEach(((s,o)=>{Fd(t,o)&&(n=n.add(o))})),n}Cs(t,e,n,s){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(t,e,n){return ul()<=ce.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",hl(e)),this.ps.getDocumentsMatchingQuery(t,e,ga.min(),n)}vs(t,e,n,s){return this.ps.getDocumentsMatchingQuery(t,n,s).next((o=>(e.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="LocalStore",tP=3e8;class eP{constructor(t,e,n,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new Ge(ie),this.xs=new vo((o=>Iy(o)),ky),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new HM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function nP(i,t,e,n){return new eP(i,t,e,n)}async function Fw(i,t){const e=Xt(i);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return e.mutationQueue.getAllMutationBatches(n).next((o=>(s=o,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((o=>{const c=[],h=[];let f=se();for(const d of s){c.push(d.batchId);for(const p of d.mutations)f=f.add(p.key)}for(const d of o){h.push(d.batchId);for(const p of d.mutations)f=f.add(p.key)}return e.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:c,addedBatchIds:h})))}))}))}function rP(i,t){const e=Xt(i);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=t.batch.keys(),o=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,f,d,p){const v=d.batch,S=v.keys();let b=ut.resolve();return S.forEach((E=>{b=b.next((()=>p.getEntry(f,E))).next((O=>{const D=d.docVersions.get(E);ye(D!==null,48541),O.version.compareTo(D)<0&&(v.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))}))})),b.next((()=>h.mutationQueue.removeMutationBatch(f,v)))})(e,n,t,o).next((()=>o.apply(n))).next((()=>e.mutationQueue.performConsistencyCheck(n))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(h){let f=se();for(let d=0;d<h.mutationResults.length;++d)h.mutationResults[d].transformResults.length>0&&(f=f.add(h.batch.mutations[d].key));return f})(t)))).next((()=>e.localDocuments.getDocuments(n,s)))}))}function Uw(i){const t=Xt(i);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function iP(i,t){const e=Xt(i),n=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const h=[];t.targetChanges.forEach(((p,v)=>{const S=s.get(v);if(!S)return;h.push(e.Pi.removeMatchingKeys(o,p.removedDocuments,v).next((()=>e.Pi.addMatchingKeys(o,p.addedDocuments,v))));let b=S.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(v)!==null?b=b.withResumeToken(In.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,n)),s=s.insert(v,b),(function(O,D,j){return O.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=tP?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0})(S,b,p)&&h.push(e.Pi.updateTargetData(o,b))}));let f=_s(),d=se();if(t.documentUpdates.forEach((p=>{t.resolvedLimboDocuments.has(p)&&h.push(e.persistence.referenceDelegate.updateLimboDocument(o,p))})),h.push(sP(o,c,t.documentUpdates).next((p=>{f=p.ks,d=p.qs}))),!n.isEqual(Gt.min())){const p=e.Pi.getLastRemoteSnapshotVersion(o).next((v=>e.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));h.push(p)}return ut.waitFor(h).next((()=>c.apply(o))).next((()=>e.localDocuments.getLocalViewOfDocuments(o,f,d))).next((()=>f))})).then((o=>(e.Ms=s,o)))}function sP(i,t,e){let n=se(),s=se();return e.forEach((o=>n=n.add(o))),t.getEntries(i,n).next((o=>{let c=_s();return e.forEach(((h,f)=>{const d=o.get(h);f.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(h)),f.isNoDocument()&&f.version.isEqual(Gt.min())?(t.removeEntry(h,f.readTime),c=c.insert(h,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(f),c=c.insert(h,f)):bt(Hy,"Ignoring outdated watch update for ",h,". Current version:",d.version," Watch version:",f.version)})),{ks:c,qs:s}}))}function aP(i,t){const e=Xt(i);return e.persistence.runTransaction("Get next mutation batch","readonly",(n=>(t===void 0&&(t=Oy),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t))))}function oP(i,t){const e=Xt(i);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return e.Pi.getTargetData(n,t).next((o=>o?(s=o,ut.resolve(s)):e.Pi.allocateTargetId(n).next((c=>(s=new la(t,c,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=e.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function Kp(i,t,e){const n=Xt(i),s=n.Ms.get(t),o=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",o,(c=>n.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!Vl(c))throw c;bt(Hy,`Failed to update sequence numbers for target ${t}: ${c}`)}n.Ms=n.Ms.remove(t),n.xs.delete(s.target)}function rT(i,t,e){const n=Xt(i);let s=Gt.min(),o=se();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,d,p){const v=Xt(f),S=v.xs.get(p);return S!==void 0?ut.resolve(v.Ms.get(S)):v.Pi.getTargetData(d,p)})(n,c,Li(t)).next((h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(c,h.targetId).next((f=>{o=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(c,t,e?s:Gt.min(),e?o:se()))).next((h=>(lP(n,qO(t),h),{documents:h,Qs:o})))))}function lP(i,t,e){let n=i.Os.get(t)||Gt.min();e.forEach(((s,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),i.Os.set(t,n)}class iT{constructor(){this.activeTargetIds=ZO()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class cP{constructor(){this.Mo=new iT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new iT,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="ConnectivityMonitor";class aT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){bt(sT,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){bt(sT,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let df=null;function Qp(){return df===null?df=(function(){return 268435456+Math.round(2147483648*Math.random())})():df++,"0x"+df.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="RestConnection",hP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fP{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===cd?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(t,e,n,s,o){const c=Qp(),h=this.zo(t,e.toUriEncodedString());bt(dp,`Sending RPC '${t}' ${c}:`,h,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,o);const{host:d}=new URL(h),p=Cy(d);return this.Jo(t,h,f,n,p).then((v=>(bt(dp,`Received RPC '${t}' ${c}: `,v),v)),(v=>{throw El(dp,`RPC '${t}' ${c} failed with error: `,v,"url: ",h,"request:",n),v}))}Ho(t,e,n,s,o,c){return this.Go(t,e,n,s,o)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Il})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,o)=>t[o]=s)),n&&n.headers.forEach(((s,o)=>t[o]=s))}zo(t,e){const n=hP[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn="WebChannelConnection";class gP extends fP{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,s,o){const c=Qp();return new Promise(((h,f)=>{const d=new Y1;d.setWithCredentials(!0),d.listenOnce(q1.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Hf.NO_ERROR:const v=d.getResponseJson();bt(Fn,`XHR for RPC '${t}' ${c} received:`,JSON.stringify(v)),h(v);break;case Hf.TIMEOUT:bt(Fn,`RPC '${t}' ${c} timed out`),f(new Lt(dt.DEADLINE_EXCEEDED,"Request time out"));break;case Hf.HTTP_ERROR:const S=d.getStatus();if(bt(Fn,`RPC '${t}' ${c} failed with status:`,S,"response text:",d.getResponseText()),S>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const E=b?.error;if(E&&E.status&&E.message){const O=(function(j){const G=j.toLowerCase().replace(/_/g,"-");return Object.values(dt).indexOf(G)>=0?G:dt.UNKNOWN})(E.status);f(new Lt(O,E.message))}else f(new Lt(dt.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new Lt(dt.UNAVAILABLE,"Connection failed."));break;default:Ft(9055,{l_:t,streamId:c,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{bt(Fn,`RPC '${t}' ${c} completed.`)}}));const p=JSON.stringify(s);bt(Fn,`RPC '${t}' ${c} sending request:`,s),d.send(e,"POST",p,n,15)}))}T_(t,e,n){const s=Qp(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],c=K1(),h=W1(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,e,n),f.encodeInitMessageHeaders=!0;const p=o.join("");bt(Fn,`Creating RPC '${t}' stream ${s}: ${p}`,f);const v=c.createWebChannel(p,f);this.I_(v);let S=!1,b=!1;const E=new dP({Yo:D=>{b?bt(Fn,`Not sending because RPC '${t}' stream ${s} is closed:`,D):(S||(bt(Fn,`Opening RPC '${t}' stream ${s} transport.`),v.open(),S=!0),bt(Fn,`RPC '${t}' stream ${s} sending:`,D),v.send(D))},Zo:()=>v.close()}),O=(D,j,G)=>{D.listen(j,(Z=>{try{G(Z)}catch(q){setTimeout((()=>{throw q}),0)}}))};return O(v,Jc.EventType.OPEN,(()=>{b||(bt(Fn,`RPC '${t}' stream ${s} transport opened.`),E.o_())})),O(v,Jc.EventType.CLOSE,(()=>{b||(b=!0,bt(Fn,`RPC '${t}' stream ${s} transport closed`),E.a_(),this.E_(v))})),O(v,Jc.EventType.ERROR,(D=>{b||(b=!0,El(Fn,`RPC '${t}' stream ${s} transport errored. Name:`,D.name,"Message:",D.message),E.a_(new Lt(dt.UNAVAILABLE,"The operation could not be completed")))})),O(v,Jc.EventType.MESSAGE,(D=>{if(!b){const j=D.data[0];ye(!!j,16349);const G=j,Z=G?.error||G[0]?.error;if(Z){bt(Fn,`RPC '${t}' stream ${s} received error:`,Z);const q=Z.status;let B=(function(x){const R=an[x];if(R!==void 0)return Dw(R)})(q),I=Z.message;B===void 0&&(B=dt.INTERNAL,I="Unknown error status: "+q+" with message "+Z.message),b=!0,E.a_(new Lt(B,I)),v.close()}else bt(Fn,`RPC '${t}' stream ${s} received:`,j),E.u_(j)}})),O(h,X1.STAT_EVENT,(D=>{D.stat===jp.PROXY?bt(Fn,`RPC '${t}' stream ${s} detected buffering proxy`):D.stat===jp.NOPROXY&&bt(Fn,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{E.__()}),0),E}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function gp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(i){return new vM(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(t,e,n=1e3,s=1.5,o=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-n);s>0&&bt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="PersistentStream";class Hw{constructor(t,e,n,s,o,c,h,f){this.Mi=t,this.S_=n,this.b_=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zw(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===dt.RESOURCE_EXHAUSTED?(vs(e.toString()),vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===e&&this.G_(n,s)}),(n=>{t((()=>{const s=new Lt(dt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return bt(oT,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(bt(oT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class mP extends Hw{constructor(t,e,n,s,o,c){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,c),this.serializer=o}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=bM(this.serializer,t),n=(function(o){if(!("targetChange"in o))return Gt.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Gt.min():c.readTime?Ni(c.readTime):Gt.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=Wp(this.serializer),e.addTarget=(function(o,c){let h;const f=c.target;if(h=Hp(f)?{documents:EM(o,f)}:{query:CM(o,f).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=Mw(o,c.resumeToken);const d=Yp(o,c.expectedCount);d!==null&&(h.expectedCount=d)}else if(c.snapshotVersion.compareTo(Gt.min())>0){h.readTime=gd(o,c.snapshotVersion.toTimestamp());const d=Yp(o,c.expectedCount);d!==null&&(h.expectedCount=d)}return h})(this.serializer,t);const n=AM(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=Wp(this.serializer),e.removeTarget=t,this.q_(e)}}class pP extends Hw{constructor(t,e,n,s,o,c){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,c),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return ye(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ye(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ye(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=wM(t.writeResults,t.commitTime),n=Ni(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=Wp(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((n=>TM(this.serializer,n)))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{}class vP extends yP{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Lt(dt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Go(t,qp(e,n),s,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Lt(dt.UNKNOWN,o.toString())}))}Ho(t,e,n,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(t,qp(e,n),s,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Lt(dt.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _P{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vs(e),this.aa=!1):bt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="RemoteStore";class SP{constructor(t,e,n,s,o){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((c=>{n.enqueueAndForget((async()=>{So(this)&&(bt(go,"Restarting streams for network reachability change."),await(async function(f){const d=Xt(f);d.Ea.add(4),await Bu(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Yd(d)})(this))}))})),this.Ra=new _P(n,s)}}async function Yd(i){if(So(i))for(const t of i.da)await t(!0)}async function Bu(i){for(const t of i.da)await t(!1)}function Gw(i,t){const e=Xt(i);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Xy(e)?qy(e):Ll(e).O_()&&Yy(e,t))}function Gy(i,t){const e=Xt(i),n=Ll(e);e.Ia.delete(t),n.O_()&&Yw(e,t),e.Ia.size===0&&(n.O_()?n.L_():So(e)&&e.Ra.set("Unknown"))}function Yy(i,t){if(i.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Gt.min())>0){const e=i.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Ll(i).Y_(t)}function Yw(i,t){i.Va.Ue(t),Ll(i).Z_(t)}function qy(i){i.Va=new gM({getRemoteKeysForTarget:t=>i.remoteSyncer.getRemoteKeysForTarget(t),At:t=>i.Ia.get(t)||null,ht:()=>i.datastore.serializer.databaseId}),Ll(i).start(),i.Ra.ua()}function Xy(i){return So(i)&&!Ll(i).x_()&&i.Ia.size>0}function So(i){return Xt(i).Ea.size===0}function qw(i){i.Va=void 0}async function bP(i){i.Ra.set("Online")}async function TP(i){i.Ia.forEach(((t,e)=>{Yy(i,t)}))}async function wP(i,t){qw(i),Xy(i)?(i.Ra.ha(t),qy(i)):i.Ra.set("Unknown")}async function EP(i,t,e){if(i.Ra.set("Online"),t instanceof Ow&&t.state===2&&t.cause)try{await(async function(s,o){const c=o.cause;for(const h of o.targetIds)s.Ia.has(h)&&(await s.remoteSyncer.rejectListen(h,c),s.Ia.delete(h),s.Va.removeTarget(h))})(i,t)}catch(n){bt(go,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await pd(i,n)}else if(t instanceof Xf?i.Va.Ze(t):t instanceof Rw?i.Va.st(t):i.Va.tt(t),!e.isEqual(Gt.min()))try{const n=await Uw(i.localStore);e.compareTo(n)>=0&&await(function(o,c){const h=o.Va.Tt(c);return h.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(f.resumeToken,c))}})),h.targetMismatches.forEach(((f,d)=>{const p=o.Ia.get(f);if(!p)return;o.Ia.set(f,p.withResumeToken(In.EMPTY_BYTE_STRING,p.snapshotVersion)),Yw(o,f);const v=new la(p.target,f,d,p.sequenceNumber);Yy(o,v)})),o.remoteSyncer.applyRemoteEvent(h)})(i,e)}catch(n){bt(go,"Failed to raise snapshot:",n),await pd(i,n)}}async function pd(i,t,e){if(!Vl(t))throw t;i.Ea.add(1),await Bu(i),i.Ra.set("Offline"),e||(e=()=>Uw(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{bt(go,"Retrying IndexedDB access"),await e(),i.Ea.delete(1),await Yd(i)}))}function Xw(i,t){return t().catch((e=>pd(i,e,t)))}async function qd(i){const t=Xt(i),e=va(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Oy;for(;CP(t);)try{const s=await aP(t.localStore,n);if(s===null){t.Ta.length===0&&e.L_();break}n=s.batchId,xP(t,s)}catch(s){await pd(t,s)}Ww(t)&&Kw(t)}function CP(i){return So(i)&&i.Ta.length<10}function xP(i,t){i.Ta.push(t);const e=va(i);e.O_()&&e.X_&&e.ea(t.mutations)}function Ww(i){return So(i)&&!va(i).x_()&&i.Ta.length>0}function Kw(i){va(i).start()}async function AP(i){va(i).ra()}async function DP(i){const t=va(i);for(const e of i.Ta)t.ea(e.mutations)}async function RP(i,t,e){const n=i.Ta.shift(),s=Ny.from(n,t,e);await Xw(i,(()=>i.remoteSyncer.applySuccessfulWrite(s))),await qd(i)}async function OP(i,t){t&&va(i).X_&&await(async function(n,s){if((function(c){return hM(c)&&c!==dt.ABORTED})(s.code)){const o=n.Ta.shift();va(n).B_(),await Xw(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,s))),await qd(n)}})(i,t),Ww(i)&&Kw(i)}async function lT(i,t){const e=Xt(i);e.asyncQueue.verifyOperationInProgress(),bt(go,"RemoteStore received new credentials");const n=So(e);e.Ea.add(3),await Bu(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Yd(e)}async function MP(i,t){const e=Xt(i);t?(e.Ea.delete(2),await Yd(e)):t||(e.Ea.add(2),await Bu(e),e.Ra.set("Unknown"))}function Ll(i){return i.ma||(i.ma=(function(e,n,s){const o=Xt(e);return o.sa(),new mP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(i.datastore,i.asyncQueue,{Xo:bP.bind(null,i),t_:TP.bind(null,i),r_:wP.bind(null,i),H_:EP.bind(null,i)}),i.da.push((async t=>{t?(i.ma.B_(),Xy(i)?qy(i):i.Ra.set("Unknown")):(await i.ma.stop(),qw(i))}))),i.ma}function va(i){return i.fa||(i.fa=(function(e,n,s){const o=Xt(e);return o.sa(),new pP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:AP.bind(null,i),r_:OP.bind(null,i),ta:DP.bind(null,i),na:RP.bind(null,i)}),i.da.push((async t=>{t?(i.fa.B_(),await qd(i)):(await i.fa.stop(),i.Ta.length>0&&(bt(go,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(t,e,n,s,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=o,this.deferred=new fa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,s,o){const c=Date.now()+n,h=new Wy(t,e,c,s,o);return h.start(n),h}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Lt(dt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ky(i,t){if(vs("AsyncQueue",`${t}: ${i}`),Vl(i))return new Lt(dt.UNAVAILABLE,`${t}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{static emptySet(t){return new Sl(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||Nt.comparator(e.key,n.key):(e,n)=>Nt.comparator(e.key,n.key),this.keyedMap=tu(),this.sortedSet=new Ge(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Sl)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=n.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new Sl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.ga=new Ge(Nt.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Ft(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Rl{constructor(t,e,n,s,o,c,h,f,d){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(t,e,n,s,o){const c=[];return e.forEach((h=>{c.push({type:0,doc:h})})),new Rl(t,e,Sl.emptySet(e),c,n,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Bd(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==n[s].type||!e[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class IP{constructor(){this.queries=uT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const s=Xt(e),o=s.queries;s.queries=uT(),o.forEach(((c,h)=>{for(const f of h.Sa)f.onError(n)}))})(this,new Lt(dt.ABORTED,"Firestore shutting down"))}}function uT(){return new vo((i=>mw(i)),Bd)}async function kP(i,t){const e=Xt(i);let n=3;const s=t.query;let o=e.queries.get(s);o?!o.ba()&&t.Da()&&(n=2):(o=new PP,n=t.Da()?0:1);try{switch(n){case 0:o.wa=await e.onListen(s,!0);break;case 1:o.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(c){const h=Ky(c,`Initialization of query '${hl(t.query)}' failed`);return void t.onError(h)}e.queries.set(s,o),o.Sa.push(t),t.va(e.onlineState),o.wa&&t.Fa(o.wa)&&Qy(e)}async function VP(i,t){const e=Xt(i),n=t.query;let s=3;const o=e.queries.get(n);if(o){const c=o.Sa.indexOf(t);c>=0&&(o.Sa.splice(c,1),o.Sa.length===0?s=t.Da()?0:1:!o.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function LP(i,t){const e=Xt(i);let n=!1;for(const s of t){const o=s.query,c=e.queries.get(o);if(c){for(const h of c.Sa)h.Fa(s)&&(n=!0);c.wa=s}}n&&Qy(e)}function NP(i,t,e){const n=Xt(i),s=n.queries.get(t);if(s)for(const o of s.Sa)o.onError(e);n.queries.delete(t)}function Qy(i){i.Ca.forEach((t=>{t.next()}))}var $p,hT;(hT=$p||($p={})).Ma="default",hT.Cache="cache";class jP{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new Rl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Rl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==$p.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(t){this.key=t}}class $w{constructor(t){this.key=t}}class BP{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=se(),this.mutatedKeys=se(),this.eu=pw(t),this.tu=new Sl(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new cT,s=e?e.tu:this.tu;let o=e?e.mutatedKeys:this.mutatedKeys,c=s,h=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((p,v)=>{const S=s.get(p),b=Fd(this.query,v)?v:null,E=!!S&&this.mutatedKeys.has(S.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let D=!1;S&&b?S.data.isEqual(b.data)?E!==O&&(n.track({type:3,doc:b}),D=!0):this.su(S,b)||(n.track({type:2,doc:b}),D=!0,(f&&this.eu(b,f)>0||d&&this.eu(b,d)<0)&&(h=!0)):!S&&b?(n.track({type:0,doc:b}),D=!0):S&&!b&&(n.track({type:1,doc:S}),D=!0,(f||d)&&(h=!0)),D&&(b?(c=c.add(b),o=O?o.add(p):o.delete(p)):(c=c.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const p=this.query.limitType==="F"?c.last():c.first();c=c.delete(p.key),o=o.delete(p.key),n.track({type:1,doc:p})}return{tu:c,iu:n,Cs:h,mutatedKeys:o}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,s){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const c=t.iu.ya();c.sort(((p,v)=>(function(b,E){const O=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ft(20277,{Rt:D})}};return O(b)-O(E)})(p.type,v.type)||this.eu(p.doc,v.doc))),this.ou(n),s=s??!1;const h=e&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,d=f!==this.Za;return this.Za=f,c.length!==0||d?{snapshot:new Rl(this.query,t.tu,o,c,t.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new cT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=se(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new $w(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new Qw(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=se();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Rl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const $y="SyncEngine";class FP{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class UP{constructor(t){this.key=t,this.hu=!1}}class zP{constructor(t,e,n,s,o,c){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new vo((h=>mw(h)),Bd),this.Iu=new Map,this.Eu=new Set,this.du=new Ge(Nt.comparator),this.Au=new Map,this.Ru=new Fy,this.Vu={},this.mu=new Map,this.fu=Dl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HP(i,t,e=!0){const n=rE(i);let s;const o=n.Tu.get(t);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await Zw(n,t,e,!0),s}async function GP(i,t){const e=rE(i);await Zw(e,t,!0,!1)}async function Zw(i,t,e,n){const s=await oP(i.localStore,Li(t)),o=s.targetId,c=i.sharedClientState.addLocalQueryTarget(o,e);let h;return n&&(h=await YP(i,t,o,c==="current",s.resumeToken)),i.isPrimaryClient&&e&&Gw(i.remoteStore,s),h}async function YP(i,t,e,n,s){i.pu=(v,S,b)=>(async function(O,D,j,G){let Z=D.view.ru(j);Z.Cs&&(Z=await rT(O.localStore,D.query,!1).then((({documents:P})=>D.view.ru(P,Z))));const q=G&&G.targetChanges.get(D.targetId),B=G&&G.targetMismatches.get(D.targetId)!=null,I=D.view.applyChanges(Z,O.isPrimaryClient,q,B);return dT(O,D.targetId,I.au),I.snapshot})(i,v,S,b);const o=await rT(i.localStore,t,!0),c=new BP(t,o.Qs),h=c.ru(o.documents),f=ju.createSynthesizedTargetChangeForCurrentChange(e,n&&i.onlineState!=="Offline",s),d=c.applyChanges(h,i.isPrimaryClient,f);dT(i,e,d.au);const p=new FP(t,e,c);return i.Tu.set(t,p),i.Iu.has(e)?i.Iu.get(e).push(t):i.Iu.set(e,[t]),d.snapshot}async function qP(i,t,e){const n=Xt(i),s=n.Tu.get(t),o=n.Iu.get(s.targetId);if(o.length>1)return n.Iu.set(s.targetId,o.filter((c=>!Bd(c,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Kp(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),e&&Gy(n.remoteStore,s.targetId),Zp(n,s.targetId)})).catch(kl)):(Zp(n,s.targetId),await Kp(n.localStore,s.targetId,!0))}async function XP(i,t){const e=Xt(i),n=e.Tu.get(t),s=e.Iu.get(n.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),Gy(e.remoteStore,n.targetId))}async function WP(i,t,e){const n=eI(i);try{const s=await(function(c,h){const f=Xt(c),d=Ve.now(),p=h.reduce(((b,E)=>b.add(E.key)),se());let v,S;return f.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let E=_s(),O=se();return f.Ns.getEntries(b,p).next((D=>{E=D,E.forEach(((j,G)=>{G.isValidDocument()||(O=O.add(j))}))})).next((()=>f.localDocuments.getOverlayedDocuments(b,E))).next((D=>{v=D;const j=[];for(const G of h){const Z=aM(G,v.get(G.key).overlayedDocument);Z!=null&&j.push(new _o(G.key,Z,lw(Z.value.mapValue),ms.exists(!0)))}return f.mutationQueue.addMutationBatch(b,d,j,h)})).next((D=>{S=D;const j=D.applyToLocalDocumentSet(v,O);return f.documentOverlayCache.saveOverlays(b,D.batchId,j)}))})).then((()=>({batchId:S.batchId,changes:vw(v)})))})(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),(function(c,h,f){let d=c.Vu[c.currentUser.toKey()];d||(d=new Ge(ie)),d=d.insert(h,f),c.Vu[c.currentUser.toKey()]=d})(n,s.batchId,e),await Fu(n,s.changes),await qd(n.remoteStore)}catch(s){const o=Ky(s,"Failed to persist write");e.reject(o)}}async function Jw(i,t){const e=Xt(i);try{const n=await iP(e.localStore,t);t.targetChanges.forEach(((s,o)=>{const c=e.Au.get(o);c&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?c.hu=!0:s.modifiedDocuments.size>0?ye(c.hu,14607):s.removedDocuments.size>0&&(ye(c.hu,42227),c.hu=!1))})),await Fu(e,n,t)}catch(n){await kl(n)}}function fT(i,t,e){const n=Xt(i);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const s=[];n.Tu.forEach(((o,c)=>{const h=c.view.va(t);h.snapshot&&s.push(h.snapshot)})),(function(c,h){const f=Xt(c);f.onlineState=h;let d=!1;f.queries.forEach(((p,v)=>{for(const S of v.Sa)S.va(h)&&(d=!0)})),d&&Qy(f)})(n.eventManager,t),s.length&&n.Pu.H_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function KP(i,t,e){const n=Xt(i);n.sharedClientState.updateQueryState(t,"rejected",e);const s=n.Au.get(t),o=s&&s.key;if(o){let c=new Ge(Nt.comparator);c=c.insert(o,zn.newNoDocument(o,Gt.min()));const h=se().add(o),f=new Hd(Gt.min(),new Map,new Ge(ie),c,h);await Jw(n,f),n.du=n.du.remove(o),n.Au.delete(t),Zy(n)}else await Kp(n.localStore,t,!1).then((()=>Zp(n,t,e))).catch(kl)}async function QP(i,t){const e=Xt(i),n=t.batch.batchId;try{const s=await rP(e.localStore,t);eE(e,n,null),tE(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await Fu(e,s)}catch(s){await kl(s)}}async function $P(i,t,e){const n=Xt(i);try{const s=await(function(c,h){const f=Xt(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return f.mutationQueue.lookupMutationBatch(d,h).next((v=>(ye(v!==null,37113),p=v.keys(),f.mutationQueue.removeMutationBatch(d,v)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,p,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>f.localDocuments.getDocuments(d,p)))}))})(n.localStore,t);eE(n,t,e),tE(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),await Fu(n,s)}catch(s){await kl(s)}}function tE(i,t){(i.mu.get(t)||[]).forEach((e=>{e.resolve()})),i.mu.delete(t)}function eE(i,t,e){const n=Xt(i);let s=n.Vu[n.currentUser.toKey()];if(s){const o=s.get(t);o&&(e?o.reject(e):o.resolve(),s=s.remove(t)),n.Vu[n.currentUser.toKey()]=s}}function Zp(i,t,e=null){i.sharedClientState.removeLocalQueryTarget(t);for(const n of i.Iu.get(t))i.Tu.delete(n),e&&i.Pu.yu(n,e);i.Iu.delete(t),i.isPrimaryClient&&i.Ru.jr(t).forEach((n=>{i.Ru.containsKey(n)||nE(i,n)}))}function nE(i,t){i.Eu.delete(t.path.canonicalString());const e=i.du.get(t);e!==null&&(Gy(i.remoteStore,e),i.du=i.du.remove(t),i.Au.delete(e),Zy(i))}function dT(i,t,e){for(const n of e)n instanceof Qw?(i.Ru.addReference(n.key,t),ZP(i,n)):n instanceof $w?(bt($y,"Document no longer in limbo: "+n.key),i.Ru.removeReference(n.key,t),i.Ru.containsKey(n.key)||nE(i,n.key)):Ft(19791,{wu:n})}function ZP(i,t){const e=t.key,n=e.path.canonicalString();i.du.get(e)||i.Eu.has(n)||(bt($y,"New document in limbo: "+e),i.Eu.add(n),Zy(i))}function Zy(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const t=i.Eu.values().next().value;i.Eu.delete(t);const e=new Nt(He.fromString(t)),n=i.fu.next();i.Au.set(n,new UP(e)),i.du=i.du.insert(e,n),Gw(i.remoteStore,new la(Li(Vy(e.path)),n,"TargetPurposeLimboResolution",Vd.ce))}}async function Fu(i,t,e){const n=Xt(i),s=[],o=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((h,f)=>{c.push(n.pu(f,t,e).then((d=>{if((d||e)&&n.isPrimaryClient){const p=d?!d.fromCache:e?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,p?"current":"not-current")}if(d){s.push(d);const p=zy.As(f.targetId,d);o.push(p)}})))})),await Promise.all(c),n.Pu.H_(s),await(async function(f,d){const p=Xt(f);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ut.forEach(d,(S=>ut.forEach(S.Es,(b=>p.persistence.referenceDelegate.addReference(v,S.targetId,b))).next((()=>ut.forEach(S.ds,(b=>p.persistence.referenceDelegate.removeReference(v,S.targetId,b)))))))))}catch(v){if(!Vl(v))throw v;bt(Hy,"Failed to update sequence numbers: "+v)}for(const v of d){const S=v.targetId;if(!v.fromCache){const b=p.Ms.get(S),E=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(E);p.Ms=p.Ms.insert(S,O)}}})(n.localStore,o))}async function JP(i,t){const e=Xt(i);if(!e.currentUser.isEqual(t)){bt($y,"User change. New user:",t.toKey());const n=await Fw(e.localStore,t);e.currentUser=t,(function(o,c){o.mu.forEach((h=>{h.forEach((f=>{f.reject(new Lt(dt.CANCELLED,c))}))})),o.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Fu(e,n.Ls)}}function tI(i,t){const e=Xt(i),n=e.Au.get(t);if(n&&n.hu)return se().add(n.key);{let s=se();const o=e.Iu.get(t);if(!o)return s;for(const c of o){const h=e.Tu.get(c);s=s.unionWith(h.view.nu)}return s}}function rE(i){const t=Xt(i);return t.remoteStore.remoteSyncer.applyRemoteEvent=Jw.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=tI.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=KP.bind(null,t),t.Pu.H_=LP.bind(null,t.eventManager),t.Pu.yu=NP.bind(null,t.eventManager),t}function eI(i){const t=Xt(i);return t.remoteStore.remoteSyncer.applySuccessfulWrite=QP.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=$P.bind(null,t),t}class yd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Gd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return nP(this.persistence,new JM,t.initialUser,this.serializer)}Cu(t){return new Bw(Uy.mi,this.serializer)}Du(t){return new cP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yd.provider={build:()=>new yd};class nI extends yd{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){ye(this.persistence.referenceDelegate instanceof md,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new jM(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?lr.withCacheSize(this.cacheSizeBytes):lr.DEFAULT;return new Bw((n=>md.mi(n,e)),this.serializer)}}class Jp{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>fT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=JP.bind(null,this.syncEngine),await MP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new IP})()}createDatastore(t){const e=Gd(t.databaseInfo.databaseId),n=(function(o){return new gP(o)})(t.databaseInfo);return(function(o,c,h,f){return new vP(o,c,h,f)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,s,o,c,h){return new SP(n,s,o,c,h)})(this.localStore,this.datastore,t.asyncQueue,(e=>fT(this.syncEngine,e,0)),(function(){return aT.v()?new aT:new uP})())}createSyncEngine(t,e){return(function(s,o,c,h,f,d,p){const v=new zP(s,o,c,h,f,d);return p&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Xt(e);bt(go,"RemoteStore shutting down."),n.Ea.add(5),await Bu(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Jp.provider={build:()=>new Jp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):vs("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="FirestoreClient";class iI{constructor(t,e,n,s,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=Un.UNAUTHENTICATED,this.clientId=Dy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async c=>{bt(_a,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(bt(_a,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new fa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Ky(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function mp(i,t){i.asyncQueue.verifyOperationInProgress(),bt(_a,"Initializing OfflineComponentProvider");const e=i.configuration;await t.initialize(e);let n=e.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await Fw(t.localStore,s),n=s)})),t.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=t}async function gT(i,t){i.asyncQueue.verifyOperationInProgress();const e=await sI(i);bt(_a,"Initializing OnlineComponentProvider"),await t.initialize(e,i.configuration),i.setCredentialChangeListener((n=>lT(t.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>lT(t.remoteStore,s))),i._onlineComponents=t}async function sI(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){bt(_a,"Using user provided OfflineComponentProvider");try{await mp(i,i._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===dt.FAILED_PRECONDITION||s.code===dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;El("Error using user provided cache. Falling back to memory cache: "+e),await mp(i,new yd)}}else bt(_a,"Using default OfflineComponentProvider"),await mp(i,new nI(void 0));return i._offlineComponents}async function iE(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(bt(_a,"Using user provided OnlineComponentProvider"),await gT(i,i._uninitializedComponentsProvider._online)):(bt(_a,"Using default OnlineComponentProvider"),await gT(i,new Jp))),i._onlineComponents}function aI(i){return iE(i).then((t=>t.syncEngine))}async function oI(i){const t=await iE(i),e=t.eventManager;return e.onListen=HP.bind(null,t.syncEngine),e.onUnlisten=qP.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=GP.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=XP.bind(null,t.syncEngine),e}function lI(i,t,e={}){const n=new fa;return i.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,f,d){const p=new rI({next:S=>{p.Nu(),c.enqueueAndForget((()=>VP(o,v)));const b=S.docs.has(h);!b&&S.fromCache?d.reject(new Lt(dt.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&S.fromCache&&f&&f.source==="server"?d.reject(new Lt(dt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(S)},error:S=>d.reject(S)}),v=new jP(Vy(h.path),p,{includeMetadataChanges:!0,qa:!0});return kP(o,v)})(await oI(i),i.asyncQueue,t,e,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(i){const t={};return i.timeoutSeconds!==void 0&&(t.timeoutSeconds=i.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE="firestore.googleapis.com",pT=!0;class yT{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new Lt(dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aE,this.ssl=pT}else this.host=t.host,this.ssl=t.ssl??pT;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=jw;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<LM)throw new Lt(dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}vO("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sE(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Lt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Lt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Lt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Jy{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Lt(dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Lt(dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yT(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new oO;switch(n.type){case"firstParty":return new hO(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Lt(dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=mT.get(e);n&&(bt("ComponentProvider","Removing Datastore"),mT.delete(e),n.terminate())})(this),Promise.resolve()}}function cI(i,t,e,n={}){i=_u(i,Jy);const s=Cy(t),o=i._getSettings(),c={...o,emulatorOptions:i._getEmulatorOptions()},h=`${t}:${e}`;s&&(LD(`https://${h}`),FD("Firestore",!0)),o.host!==aE&&o.host!==h&&El("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:h,ssl:s,emulatorOptions:n};if(!id(f,c)&&(i._setSettings(f),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Un.MOCK_USER;else{d=ND(n.mockUserToken,i._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new Lt(dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Un(v)}i._authCredentials=new lO(new $1(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new tv(this.firestore,t,this._query)}}class wn{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Au(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new wn(this.firestore,t,this._key)}toJSON(){return{type:wn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(Lu(e,wn._jsonSchema))return new wn(t,n||null,new Nt(He.fromString(e.referencePath)))}}wn._jsonSchemaVersion="firestore/documentReference/1.0",wn._jsonSchema={type:ln("string",wn._jsonSchemaVersion),referencePath:ln("string")};class Au extends tv{constructor(t,e,n){super(t,e,Vy(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new wn(this.firestore,null,new Nt(t))}withConverter(t){return new Au(this.firestore,t,this._path)}}function oE(i,t,...e){if(i=sd(i),arguments.length===1&&(t=Dy.newId()),yO("doc","path",t),i instanceof Jy){const n=He.fromString(t,...e);return Mb(n),new wn(i,null,new Nt(n))}{if(!(i instanceof wn||i instanceof Au))throw new Lt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(He.fromString(t,...e));return Mb(n),new wn(i.firestore,i instanceof Au?i.converter:null,new Nt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="AsyncQueue";class _T{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zw(this,"async_queue_retry"),this._c=()=>{const n=gp();n&&bt(vT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=gp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=gp();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new fa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Vl(t))throw t;bt(vT,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,vs("INTERNAL UNHANDLED ERROR: ",ST(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=Wy.createAndSchedule(this,t,e,n,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&Ft(47125,{Pc:ST(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function ST(i){let t=i.message||"";return i.stack&&(t=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),t}class ev extends Jy{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new _T,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new _T(t),this._firestoreClient=void 0,await t}}}function uI(i,t){const e=typeof i=="object"?i:QR(),n=typeof i=="string"?i:cd,s=YR(e,"firestore").getImmediate({identifier:n});if(!s._initialized){const o=kD("firestore");o&&cI(s,...o)}return s}function lE(i){if(i._terminated)throw new Lt(dt.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||hI(i),i._firestoreClient}function hI(i){const t=i._freezeSettings(),e=(function(s,o,c,h){return new RO(s,o,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,sE(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,t);i._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),i._firestoreClient=new iI(i._authCredentials,i._appCheckCredentials,i._queue,e,i._componentsProvider&&(function(s){const o=s?._online.build();return{_offline:s?._offline.build(o),_online:o}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Hr(In.fromBase64String(t))}catch(e){throw new Lt(dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Hr(In.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Hr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Lu(t,Hr._jsonSchema))return Hr.fromBase64String(t.bytes)}}Hr._jsonSchemaVersion="firestore/bytes/1.0",Hr._jsonSchema={type:ln("string",Hr._jsonSchemaVersion),bytes:ln("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Lt(dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Lt(dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Lt(dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return ie(this._lat,t._lat)||ie(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ji._jsonSchemaVersion}}static fromJSON(t){if(Lu(t,ji._jsonSchema))return new ji(t.latitude,t.longitude)}}ji._jsonSchemaVersion="firestore/geoPoint/1.0",ji._jsonSchema={type:ln("string",ji._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,s){if(n.length!==s.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==s[o])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Bi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Lu(t,Bi._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Bi(t.vectorValues);throw new Lt(dt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Bi._jsonSchemaVersion="firestore/vectorValue/1.0",Bi._jsonSchema={type:ln("string",Bi._jsonSchemaVersion),vectorValues:ln("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=/^__.*__$/;class dI{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new _o(t,this.data,this.fieldMask,e,this.fieldTransforms):new Nu(t,this.data,e,this.fieldTransforms)}}function cE(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ft(40011,{Ac:i})}}class iv{constructor(t,e,n,s,o,c){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new iv({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.gc(t),n}yc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return vd(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(cE(this.Ac)&&fI.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class gI{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Gd(t)}Cc(t,e,n,s=!1){return new iv({Ac:t,methodName:e,Dc:n,path:Mn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mI(i){const t=i._freezeSettings(),e=Gd(i._databaseId);return new gI(i._databaseId,!!t.ignoreUndefinedProperties,e)}function pI(i,t,e,n,s,o={}){const c=i.Cc(o.merge||o.mergeFields?2:0,t,e,s);dE("Data must be an object, but it was:",c,n);const h=hE(n,c);let f,d;if(o.merge)f=new mi(c.fieldMask),d=c.fieldTransforms;else if(o.mergeFields){const p=[];for(const v of o.mergeFields){const S=yI(t,v,e);if(!c.contains(S))throw new Lt(dt.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);_I(p,S)||p.push(S)}f=new mi(p),d=c.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,d=c.fieldTransforms;return new dI(new zr(h),f,d)}class sv extends rv{_toFieldTransform(t){return new nM(t.path,new Eu)}isEqual(t){return t instanceof sv}}function uE(i,t){if(fE(i=sd(i)))return dE("Unsupported field value:",t,i),hE(i,t);if(i instanceof rv)return(function(n,s){if(!cE(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(i,t),null;if(i===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),i instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(n,s){const o=[];let c=0;for(const h of n){let f=uE(h,s.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),c++}return{arrayValue:{values:o}}})(i,t)}return(function(n,s){if((n=sd(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JO(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Ve.fromDate(n);return{timestampValue:gd(s.serializer,o)}}if(n instanceof Ve){const o=new Ve(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:gd(s.serializer,o)}}if(n instanceof ji)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Hr)return{bytesValue:Mw(s.serializer,n._byteString)};if(n instanceof wn){const o=s.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw s.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:By(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Bi)return(function(c,h){return{mapValue:{fields:{[aw]:{stringValue:ow},[ud]:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw h.Sc("VectorValues must only contain numeric values.");return Ly(h.serializer,d)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${Ry(n)}`)})(i,t)}function hE(i,t){const e={};return tw(i)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):yo(i,((n,s)=>{const o=uE(s,t.mc(n));o!=null&&(e[n]=o)})),{mapValue:{fields:e}}}function fE(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Ve||i instanceof ji||i instanceof Hr||i instanceof wn||i instanceof rv||i instanceof Bi)}function dE(i,t,e){if(!fE(e)||!Z1(e)){const n=Ry(e);throw n==="an object"?t.Sc(i+" a custom object"):t.Sc(i+" "+n)}}function yI(i,t,e){if((t=sd(t))instanceof nv)return t._internalPath;if(typeof t=="string")return gE(i,t);throw vd("Field path arguments must be of type string or ",i,!1,void 0,e)}const vI=new RegExp("[~\\*/\\[\\]]");function gE(i,t,e){if(t.search(vI)>=0)throw vd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,e);try{return new nv(...t.split("."))._internalPath}catch{throw vd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,e)}}function vd(i,t,e,n,s){const o=n&&!n.isEmpty(),c=s!==void 0;let h=`Function ${t}() called with invalid data`;e&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||c)&&(f+=" (found",o&&(f+=` in field ${n}`),c&&(f+=` in document ${s}`),f+=")"),new Lt(dt.INVALID_ARGUMENT,h+i+f)}function _I(i,t){return i.some((e=>e.isEqual(t)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(t,e,n,s,o){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new SI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(pE("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class SI extends mE{data(){return super.data()}}function pE(i,t){return typeof t=="string"?gE(i,t):t instanceof nv?t._internalPath:t._delegate._internalPath}class bI{convertValue(t,e="none"){switch(ya(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ze(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(pa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Ft(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return yo(t,((s,o)=>{n[s]=this.convertValue(o,e)})),n}convertVectorValue(t){const e=t.fields?.[ud].arrayValue?.values?.map((n=>Ze(n.doubleValue)));return new Bi(e)}convertGeoPoint(t){return new ji(Ze(t.latitude),Ze(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Nd(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(bu(t));default:return null}}convertTimestamp(t){const e=ma(t);return new Ve(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=He.fromString(t);ye(Nw(n),9688,{name:t});const s=new Tu(n.get(1),n.get(3)),o=new Nt(n.popFirst(5));return s.isEqual(e)||vs(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(i,t,e){let n;return n=i?e&&(e.merge||e.mergeFields)?i.toFirestore(t,e):i.toFirestore(t):t,n}class nu{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class uo extends mE{constructor(t,e,n,s,o,c){super(t,e,n,s,c),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Wf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(pE("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Lt(dt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=uo._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",uo._jsonSchema={type:ln("string",uo._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Wf extends uo{data(t={}){return super.data(t)}}class cu{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new nu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Wf(this._firestore,this._userDataWriter,n.key,n,new nu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Lt(dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((h=>{const f=new Wf(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const f=new Wf(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,p=-1;return h.type!==0&&(d=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),p=c.indexOf(h.doc.key)),{type:wI(h.type),doc:f,oldIndex:d,newIndex:p}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Lt(dt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=cu._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Dy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(e.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function wI(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ft(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(i){i=_u(i,wn);const t=_u(i.firestore,ev);return lI(lE(t),i._key).then((e=>DI(t,i,e)))}cu._jsonSchemaVersion="firestore/querySnapshot/1.0",cu._jsonSchema={type:ln("string",cu._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class CI extends bI{constructor(t){super(),this.firestore=t}convertBytes(t){return new Hr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new wn(this.firestore,null,e)}}function xI(i,t,e){i=_u(i,wn);const n=_u(i.firestore,ev),s=TI(i.converter,t,e);return AI(n,[pI(mI(n),"setDoc",i._key,s,i.converter!==null,e).toMutation(i._key,ms.none())])}function AI(i,t){return(function(n,s){const o=new fa;return n.asyncQueue.enqueueAndForget((async()=>WP(await aI(n),s,o))),o.promise})(lE(i),t)}function DI(i,t,e){const n=e.docs.get(t._key),s=new CI(i);return new uo(i,s,t._key,n,new nu(e.hasPendingWrites,e.fromCache),t.converter)}function RI(){return new sv("serverTimestamp")}(function(t,e=!0){(function(s){Il=s})(KR),od(new yu("firestore",((n,{instanceIdentifier:s,options:o})=>{const c=n.getProvider("app").getImmediate(),h=new ev(new cO(n.getProvider("auth-internal")),new fO(c,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Lt(dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tu(d.options.projectId,p)})(c,s),c);return o={useFetchStreams:e,...o},h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),_l(Ab,Db,t),_l(Ab,Db,"esm2020")})();var OI="firebase",MI="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_l(OI,MI,"app");const yE={apiKey:"AIzaSyCt4FbInqElcSwawikF4QXNpWnB90DqjRs",authDomain:"canvass-b12f8.firebaseapp.com",projectId:"canvass-b12f8",storageBucket:"canvass-b12f8.firebasestorage.app",messagingSenderId:"196695145929",appId:"1:196695145929:web:26fa8e77670e12cdac7c18"},PI=U1(yE),vE=uI(PI);console.info("[Firestore] Using real Firestore for project:",yE.projectId);const _E="scenes";async function II(i){try{const t=oE(vE,_E,i),e=await EI(t);return e.exists()?e.data():null}catch(t){console.warn("Failed to load scene:",t);const e=localStorage.getItem(`scene_${i}`);return e?JSON.parse(e):null}}async function kI(i,t){try{const e=oE(vE,_E,i),n={...t,updatedAt:RI()};await xI(e,n,{merge:!0})}catch(e){console.warn("Failed to save to Firestore, using localStorage:",e),localStorage.setItem(`scene_${i}`,JSON.stringify(t))}}function z(i,t,e){return(t=(function(n){var s=(function(o,c){if(typeof o!="object"||!o)return o;var h=o[Symbol.toPrimitive];if(h!==void 0){var f=h.call(o,c);if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(c==="string"?String:Number)(o)})(n,"string");return typeof s=="symbol"?s:s+""})(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function bT(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter((function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable}))),e.push.apply(e,n)}return e}function Y(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?bT(Object(e),!0).forEach((function(n){z(i,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):bT(Object(e)).forEach((function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(e,n))}))}return i}function je(i,t){if(i==null)return{};var e,n,s=(function(c,h){if(c==null)return{};var f={};for(var d in c)if({}.hasOwnProperty.call(c,d)){if(h.indexOf(d)>=0)continue;f[d]=c[d]}return f})(i,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(i,e)&&(s[e]=i[e])}return s}function Gi(i,t){return t||(t=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(t)}}))}class TT{constructor(){z(this,"browserShadowBlurConstant",1),z(this,"DPI",96),z(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),z(this,"perfLimitSizeTotal",2097152),z(this,"maxCacheSideLimit",4096),z(this,"minCacheSideLimit",256),z(this,"disableStyleCopyPaste",!1),z(this,"enableGLFiltering",!0),z(this,"textureSize",4096),z(this,"forceGLPutImageData",!1),z(this,"cachesBoundsOfCurve",!1),z(this,"fontPaths",{}),z(this,"NUM_FRACTION_DIGITS",4)}}const fe=new class extends TT{constructor(i){super(),this.configure(i)}configure(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,i)}addFonts(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=Y(Y({},this.fontPaths),i)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((i=>{delete this.fontPaths[i]}))}clearFonts(){this.fontPaths={}}restoreDefaults(i){const t=new TT,e=i?.reduce(((n,s)=>(n[s]=t[s],n)),{})||t;this.configure(e)}},Sa=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return console[i]("fabric",...e)};class Ii extends Error{constructor(t,e){super("fabric: ".concat(t),e)}}class VI extends Ii{constructor(t){super("".concat(t," 'options.signal' is in 'aborted' state"))}}class LI{}class NI extends LI{testPrecision(t,e){const n="precision ".concat(e,` float;
void main(){}`),s=t.createShader(t.FRAGMENT_SHADER);return!!s&&(t.shaderSource(s,n),t.compileShader(s),!!t.getShaderParameter(s,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((n=>this.testPrecision(e,n))),e.getExtension("WEBGL_lose_context").loseContext(),Sa("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const jI={};let wT;const Hi=()=>wT||(wT={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new NI,dispose(){},copyPasteData:jI}),Nl=()=>Hi().document,Xd=()=>Hi().window,SE=()=>{var i;return Math.max((i=fe.devicePixelRatio)!==null&&i!==void 0?i:Xd().devicePixelRatio,1)},uu=new class{constructor(){z(this,"charWidthsCache",{}),z(this,"boundsOfCurveCache",{})}getFontCache(i){let{fontFamily:t,fontStyle:e,fontWeight:n}=i;t=t.toLowerCase(),this.charWidthsCache[t]||(this.charWidthsCache[t]={});const s=this.charWidthsCache[t],o="".concat(e.toLowerCase(),"_").concat((n+"").toLowerCase());return s[o]||(s[o]={}),s[o]}clearFontCache(i){(i=(i||"").toLowerCase())?this.charWidthsCache[i]&&delete this.charWidthsCache[i]:this.charWidthsCache={}}limitDimsByArea(i){const{perfLimitSizeTotal:t}=fe,e=Math.sqrt(t*i);return[Math.floor(e),Math.floor(t/e)]}},ty="6.7.1";function Kf(){}const Uu=Math.PI/2,_d=2*Math.PI,av=Math.PI/180,Zn=Object.freeze([1,0,0,1,0,0]),ov=16,ra=.4477152502,Zt="center",pe="left",hr="top",ey="bottom",Je="right",fr="none",lv=/\r?\n/,bE="moving",Wd="scaling",TE="rotating",cv="rotate",wE="skewing",Du="resizing",BI="modifyPoly",FI="modifyPath",Sd="changed",Kd="scale",gr="scaleX",qr="scaleY",jl="skewX",Bl="skewY",gn="fill",dr="stroke",bd="modified",ol="json",pp="svg",wt=new class{constructor(){this[ol]=new Map,this[pp]=new Map}has(i){return this[ol].has(i)}getClass(i){const t=this[ol].get(i);if(!t)throw new Ii("No class registered for ".concat(i));return t}setClass(i,t){t?this[ol].set(t,i):(this[ol].set(i.type,i),this[ol].set(i.type.toLowerCase(),i))}getSVGClass(i){return this[pp].get(i)}setSVGClass(i,t){this[pp].set(t??i.type.toLowerCase(),i)}},Td=new class extends Array{remove(i){const t=this.indexOf(i);t>-1&&this.splice(t,1)}cancelAll(){const i=this.splice(0);return i.forEach((t=>t.abort())),i}cancelByCanvas(i){if(!i)return[];const t=this.filter((e=>{var n;return e.target===i||typeof e.target=="object"&&((n=e.target)===null||n===void 0?void 0:n.canvas)===i}));return t.forEach((e=>e.abort())),t}cancelByTarget(i){if(!i)return[];const t=this.filter((e=>e.target===i));return t.forEach((e=>e.abort())),t}};class UI{constructor(){z(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach((n=>{let[s,o]=n;this.on(s,o)})),()=>this.off(t);if(e){const n=t;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(e),()=>this.off(n,e)}return()=>!1}once(t,e){if(typeof t=="object"){const n=[];return Object.entries(t).forEach((s=>{let[o,c]=s;n.push(this.once(o,c))})),()=>n.forEach((s=>s()))}if(e){const n=this.on(t,(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];e.call(this,...o),n()}));return n}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const n=this.__eventListeners[t],s=n.indexOf(e);s>-1&&n.splice(s,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof t=="object"?Object.entries(t).forEach((n=>{let[s,o]=n;this._removeEventListener(s,o)})):this._removeEventListener(t,e)}fire(t,e){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[t])===null||n===void 0?void 0:n.concat();if(s)for(let o=0;o<s.length;o++)s[o].call(this,e||{})}}const gl=(i,t)=>{const e=i.indexOf(t);return e!==-1&&i.splice(e,1),i},Ss=i=>{if(i===0)return 1;switch(Math.abs(i)/Uu){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},bs=i=>{if(i===0)return 0;const t=i/Uu,e=Math.sign(i);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(i)};class nt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new nt(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new nt(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new nt(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new nt(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new nt(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new nt(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new nt(this.x/t.x,this.y/t.y)}scalarDivide(t){return new nt(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new nt(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}midPointFrom(t){return this.lerp(t)}min(t){return new nt(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new nt(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n}clone(){return new nt(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uv;const n=bs(t),s=Ss(t),o=this.subtract(e);return new nt(o.x*s-o.y*n,o.x*n+o.y*s).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new nt(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const uv=new nt(0,0),Qf=i=>!!i&&Array.isArray(i._objects);function EE(i){class t extends i{constructor(){super(...arguments),z(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];const c=this._objects.push(...s);return s.forEach((h=>this._onObjectAdded(h))),c}insertAt(n){for(var s=arguments.length,o=new Array(s>1?s-1:0),c=1;c<s;c++)o[c-1]=arguments[c];return this._objects.splice(n,0,...o),o.forEach((h=>this._onObjectAdded(h))),this._objects.length}remove(){const n=this._objects,s=[];for(var o=arguments.length,c=new Array(o),h=0;h<o;h++)c[h]=arguments[h];return c.forEach((f=>{const d=n.indexOf(f);d!==-1&&(n.splice(d,1),s.push(f),this._onObjectRemoved(f))})),s}forEachObject(n){this.getObjects().forEach(((s,o,c)=>n(s,o,c)))}getObjects(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return s.length===0?[...this._objects]:this._objects.filter((c=>c.isType(...s)))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some((o=>o instanceof t&&o.contains(n,!0)))}complexity(){return this._objects.reduce(((n,s)=>n+=s.complexity?s.complexity():0),0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(gl(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(gl(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const o=this._objects.indexOf(n);if(o!==0){const c=this.findNewLowerIndex(n,o,s);return gl(this._objects,n),this._objects.splice(c,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const o=this._objects.indexOf(n);if(o!==this._objects.length-1){const c=this.findNewUpperIndex(n,o,s);return gl(this._objects,n),this._objects.splice(c,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(gl(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,o){let c;if(o){c=s;for(let h=s-1;h>=0;--h)if(n.isOverlapping(this._objects[h])){c=h;break}}else c=s-1;return c}findNewUpperIndex(n,s,o){let c;if(o){c=s;for(let h=s+1;h<this._objects.length;++h)if(n.isOverlapping(this._objects[h])){c=h;break}}else c=s+1;return c}collectObjects(n){let{left:s,top:o,width:c,height:h}=n,{includeIntersecting:f=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],p=new nt(s,o),v=p.add(new nt(c,h));for(let S=this._objects.length-1;S>=0;S--){const b=this._objects[S];b.selectable&&b.visible&&(f&&b.intersectsWithRect(p,v)||b.isContainedWithinRect(p,v)||f&&b.containsPoint(p)||f&&b.containsPoint(v))&&d.push(b)}return d}}return t}class CE extends UI{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function $f(i){return Xd().requestAnimationFrame(i)}function zI(i){return Xd().cancelAnimationFrame(i)}let HI=0;const ba=()=>HI++,Ts=()=>{const i=Nl().createElement("canvas");if(!i||i.getContext===void 0)throw new Ii("Failed to create `canvas` element");return i},GI=()=>Nl().createElement("img"),Xr=i=>{const t=Ts();return t.width=i.width,t.height=i.height,t},xE=(i,t,e)=>i.toDataURL("image/".concat(t),e),AE=(i,t,e)=>new Promise(((n,s)=>{i.toBlob(n,"image/".concat(t),e)})),tn=i=>i*av,ws=i=>i/av,YI=i=>i.every(((t,e)=>t===Zn[e])),cr=(i,t,e)=>new nt(i).transform(t,e),pi=i=>{const t=1/(i[0]*i[3]-i[1]*i[2]),e=[t*i[3],-t*i[1],-t*i[2],t*i[0],0,0],{x:n,y:s}=new nt(i[4],i[5]).transform(e,!0);return e[4]=-n,e[5]=-s,e},Pn=(i,t,e)=>[i[0]*t[0]+i[2]*t[1],i[1]*t[0]+i[3]*t[1],i[0]*t[2]+i[2]*t[3],i[1]*t[2]+i[3]*t[3],e?0:i[0]*t[4]+i[2]*t[5]+i[4],e?0:i[1]*t[4]+i[3]*t[5]+i[5]],hv=(i,t)=>i.reduceRight(((e,n)=>n&&e?Pn(n,e,t):n||e),void 0)||Zn.concat(),DE=i=>{let[t,e]=i;return Math.atan2(e,t)},wd=i=>{const t=DE(i),e=Math.pow(i[0],2)+Math.pow(i[1],2),n=Math.sqrt(e),s=(i[0]*i[3]-i[2]*i[1])/n,o=Math.atan2(i[0]*i[2]+i[1]*i[3],e);return{angle:ws(t),scaleX:n,scaleY:s,skewX:ws(o),skewY:0,translateX:i[4]||0,translateY:i[5]||0}},zu=function(i){return[1,0,0,1,i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Fl(){let{angle:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=tn(i),s=Ss(n),o=bs(n);return[s,o,-o,s,t?t-(s*t-o*e):0,e?e-(o*t+s*e):0]}const fv=function(i){return[i,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,0,0]},RE=i=>Math.tan(tn(i)),OE=i=>[1,0,RE(i),1,0,0],ME=i=>[1,RE(i),0,1,0,0],Qd=i=>{let{scaleX:t=1,scaleY:e=1,flipX:n=!1,flipY:s=!1,skewX:o=0,skewY:c=0}=i,h=fv(n?-t:t,s?-e:e);return o&&(h=Pn(h,OE(o),!0)),c&&(h=Pn(h,ME(c),!0)),h},qI=i=>{const{translateX:t=0,translateY:e=0,angle:n=0}=i;let s=zu(t,e);n&&(s=Pn(s,Fl({angle:n})));const o=Qd(i);return YI(o)||(s=Pn(s,o)),s},Zf=function(i){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(n,s){if(t&&t.aborted)return s(new VI("loadImage"));const o=GI();let c;t&&(c=function(f){o.src="",s(f)},t.addEventListener("abort",c,{once:!0}));const h=function(){o.onload=o.onerror=null,c&&t?.removeEventListener("abort",c),n(o)};i?(o.onload=h,o.onerror=function(){c&&t?.removeEventListener("abort",c),s(new Ii("Error loading ".concat(o.src)))},e&&(o.crossOrigin=e),o.src=i):h()}))},Ru=function(i){let{signal:t,reviver:e=Kf}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((n,s)=>{const o=[];t&&t.addEventListener("abort",s,{once:!0}),Promise.all(i.map((c=>wt.getClass(c.type).fromObject(c,{signal:t}).then((h=>(e(c,h),o.push(h),h)))))).then(n).catch((c=>{o.forEach((h=>{h.dispose&&h.dispose()})),s(c)})).finally((()=>{t&&t.removeEventListener("abort",s)}))}))},$d=function(i){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((e,n)=>{const s=[];t&&t.addEventListener("abort",n,{once:!0});const o=Object.values(i).map((h=>h&&h.type&&wt.has(h.type)?Ru([h],{signal:t}).then((f=>{let[d]=f;return s.push(d),d})):h)),c=Object.keys(i);Promise.all(o).then((h=>h.reduce(((f,d,p)=>(f[c[p]]=d,f)),{}))).then(e).catch((h=>{s.forEach((f=>{f.dispose&&f.dispose()})),n(h)})).finally((()=>{t&&t.removeEventListener("abort",n)}))}))},Ul=function(i){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((t,e)=>(e in i&&(t[e]=i[e]),t)),{})},dv=(i,t)=>Object.keys(i).reduce(((e,n)=>(t(i[n],n,i)&&(e[n]=i[n]),e)),{}),Pe=(i,t)=>parseFloat(Number(i).toFixed(t)),Ou=i=>"matrix("+i.map((t=>Pe(t,fe.NUM_FRACTION_DIGITS))).join(" ")+")",Gr=i=>!!i&&i.toLive!==void 0,ET=i=>!!i&&typeof i.toObject=="function",CT=i=>!!i&&i.offsetX!==void 0&&"source"in i,ro=i=>!!i&&"multiSelectionStacking"in i;function PE(i){const t=i&&gi(i);let e=0,n=0;if(!i||!t)return{left:e,top:n};let s=i;const o=t.documentElement,c=t.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===t?(e=c.scrollLeft||o.scrollLeft||0,n=c.scrollTop||o.scrollTop||0):(e+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:e,top:n}}const gi=i=>i.ownerDocument||null,IE=i=>{var t;return((t=i.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},kE=function(i,t,e){let{width:n,height:s}=e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;i.width=n,i.height=s,o>1&&(i.setAttribute("width",(n*o).toString()),i.setAttribute("height",(s*o).toString()),t.scale(o,o))},ny=(i,t)=>{let{width:e,height:n}=t;e&&(i.style.width=typeof e=="number"?"".concat(e,"px"):e),n&&(i.style.height=typeof n=="number"?"".concat(n,"px"):n)};function xT(i){return i.onselectstart!==void 0&&(i.onselectstart=()=>!1),i.style.userSelect=fr,i}class VE{constructor(t){z(this,"_originalCanvasStyle",void 0),z(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(n=t)&&n.getContext!==void 0?t:t&&Nl().getElementById(t)||Ts();var n;if(e.hasAttribute("data-fabric"))throw new Ii("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:n}=t;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(e)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:n,ctx:s}=this.lower;kE(n,s,t,e)}setCSSDimensions(t){ny(this.lower.el,t)}calcOffset(){return(function(t){var e;const n=t&&gi(t),s={left:0,top:0};if(!n)return s;const o=((e=IE(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};s.left+=parseInt(o.borderLeftWidth,10)||0,s.top+=parseInt(o.borderTopWidth,10)||0,s.left+=parseInt(o.paddingLeft,10)||0,s.top+=parseInt(o.paddingTop,10)||0;let c={left:0,top:0};const h=n.documentElement;t.getBoundingClientRect!==void 0&&(c=t.getBoundingClientRect());const f=PE(t);return{left:c.left+f.left-(h.clientLeft||0)+s.left,top:c.top+f.top-(h.clientTop||0)+s.top}})(this.lower.el)}dispose(){Hi().dispose(this.lower.el),delete this.lower}}const XI={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Zn]};class Hu extends EE(CE){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return Hu.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new VE(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];const o=super.insertAt(t,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),o}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(Sa("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?SE():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(t,e){return this.setDimensions({width:t},e)}setHeight(t,e){return this.setDimensions({height:t},e)}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const s=Y({width:this.width,height:this.height},t);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const n=t,s=[...this.viewportTransform],o=cr(t,pi(s));s[0]=e,s[3]=e;const c=cr(o,s);s[4]+=n.x-c.x,s[5]+=n.y-c.y,this.setViewportTransform(s)}setZoom(t){this.zoomToPoint(new nt(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new nt(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=$f((()=>this.renderAndReset())))}calcViewportBoundaries(){const t=this.width,e=this.height,n=pi(this.viewportTransform),s=cr({x:0,y:0},n),o=cr({x:t,y:e},n),c=s.min(o),h=s.max(o);return this.vptCoords={tl:c,tr:new nt(h.x,c.y),bl:new nt(c.x,h.y),br:h}}cancelRequestedRender(){this.nextRenderHandle&&(zI(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality="best",this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,s)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const n=this.viewportTransform;t.save(),t.transform(...n),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let n=0,s=e.length;n<s;++n)e[n]&&e[n].render(t)}_renderBackgroundOrOverlay(t,e){const n=this["".concat(e,"Color")],s=this["".concat(e,"Image")],o=this.viewportTransform,c=this["".concat(e,"Vpt")];if(!n&&!s)return;const h=Gr(n);if(n){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=h?n.toLive(t):n,c&&t.transform(...o),h){t.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const f=n.gradientTransform||n.patternTransform;f&&t.transform(...f)}t.fill(),t.restore()}if(s){t.save();const{skipOffscreen:f}=this;this.skipOffscreen=c,c&&t.transform(...o),s.render(t),this.skipOffscreen=f,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new nt(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new nt(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new nt(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new nt(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new nt(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return cr(this.getCenterPoint(),pi(this.viewportTransform))}_centerObject(t,e){t.setXY(e,Zt,Zt),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,t,e):null;return Y(Y(Y({version:ty},Ul(this,e)),{},{objects:this._objects.filter((o=>!o.excludeFromExport)).map((o=>this._toObject(o,t,e)))},this.__serializeBgOverlay(t,e)),s?{clipPath:s}:null)}_toObject(t,e,n){let s;this.includeDefaultValues||(s=t.includeDefaultValues,t.includeDefaultValues=!1);const o=t[e](n);return this.includeDefaultValues||(t.includeDefaultValues=!!s),o}__serializeBgOverlay(t,e){const n={},s=this.backgroundImage,o=this.overlayImage,c=this.backgroundColor,h=this.overlayColor;return Gr(c)?c.excludeFromExport||(n.background=c.toObject(e)):c&&(n.background=c),Gr(h)?h.excludeFromExport||(n.overlay=h.toObject(e)):h&&(n.overlay=h),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,t,e)),o&&!o.excludeFromExport&&(n.overlayImage=this._toObject(o,t,e)),n}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const n=[];return this._setSVGPreamble(n,t),this._setSVGHeader(n,t),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",e),this._setSVGObjects(n,e),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",e),n.push("</svg>"),n.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const n=e.width||"".concat(this.width),s=e.height||"".concat(this.height),o=fe.NUM_FRACTION_DIGITS,c=e.viewBox;let h;if(c)h='viewBox="'.concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height,'" ');else if(this.svgViewportTransformation){const f=this.viewportTransform;h='viewBox="'.concat(Pe(-f[4]/f[0],o)," ").concat(Pe(-f[5]/f[3],o)," ").concat(Pe(this.width/f[0],o)," ").concat(Pe(this.height/f[3],o),'" ')}else h='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',h,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",ty,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId="CLIPPATH_".concat(ba()),'<clipPath id="'.concat(e.clipPathId,`" >
`).concat(e.toClipPathSVG(t.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((t=>{const e=this["".concat(t,"Color")];if(Gr(e)){const n=this["".concat(t,"Vpt")],s=this.viewportTransform,o={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return e.toSVG(o,{additionalTransform:n?Ou(s):""})}})).join("")}createSVGFontFacesMarkup(){const t=[],e={},n=fe.fontPaths;this._objects.forEach((function o(c){t.push(c),Qf(c)&&c._objects.forEach(o)})),t.forEach((o=>{if(!(c=o)||typeof c._renderText!="function")return;var c;const{styles:h,fontFamily:f}=o;!e[f]&&n[f]&&(e[f]=!0,h&&Object.values(h).forEach((d=>{Object.values(d).forEach((p=>{let{fontFamily:v=""}=p;!e[v]&&n[v]&&(e[v]=!0)}))})))}));const s=Object.keys(e).map((o=>`		@font-face {
			font-family: '`.concat(o,`';
			src: url('`).concat(n[o],`');
		}
`))).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(t,e){this.forEachObject((n=>{n.excludeFromExport||this._setSVGObject(t,n,e)}))}_setSVGObject(t,e,n){t.push(e.toSVG(n))}_setSVGBgOverlayImage(t,e,n){const s=this[e];s&&!s.excludeFromExport&&s.toSVG&&t.push(s.toSVG(n))}_setSVGBgOverlayColor(t,e){const n=this["".concat(e,"Color")];if(n)if(Gr(n)){const s=n.repeat||"",o=this.width,c=this.height,h=this["".concat(e,"Vpt")]?Ou(pi(this.viewportTransform)):"";t.push('<rect transform="'.concat(h," translate(").concat(o/2,",").concat(c/2,')" x="').concat(n.offsetX-o/2,'" y="').concat(n.offsetY-c/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!CT(n)?o:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!CT(n)?c:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new Ii("`json` is undefined"));const s=typeof t=="string"?JSON.parse(t):t,{objects:o=[],backgroundImage:c,background:h,overlayImage:f,overlay:d,clipPath:p}=s,v=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Ru(o,{reviver:e,signal:n}),$d({backgroundImage:c,backgroundColor:h,overlayImage:f,overlayColor:d,clipPath:p},{signal:n})]).then((S=>{let[b,E]=S;return this.clear(),this.add(...b),this.set(s),this.set(E),this.renderOnAddRemove=v,this}))}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Xr(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:n=1,multiplier:s=1,enableRetinaScaling:o=!1}=t,c=s*(o?this.getRetinaScaling():1);return xE(this.toCanvasElement(c,t),e,n)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:n=1,multiplier:s=1,enableRetinaScaling:o=!1}=t,c=s*(o?this.getRetinaScaling():1);return AE(this.toCanvasElement(c,t),e,n)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:n,left:s,top:o,filter:c}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=(e||this.width)*t,f=(n||this.height)*t,d=this.getZoom(),p=this.width,v=this.height,S=this.skipControlsDrawing,b=d*t,E=this.viewportTransform,O=[b,0,0,b,(E[4]-(s||0))*t,(E[5]-(o||0))*t],D=this.enableRetinaScaling,j=Xr({width:h,height:f}),G=c?this._objects.filter((Z=>c(Z))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=O,this.width=h,this.height=f,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(j.getContext("2d"),G),this.viewportTransform=E,this.width=p,this.height=v,this.calcViewportBoundaries(),this.enableRetinaScaling=D,this.skipControlsDrawing=S,j}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Td.cancelByCanvas(this),this.disposed=!0,new Promise(((t,e)=>{const n=()=>{this.destroy(),t(!0)};n.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=n:n()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((t=>t.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}z(Hu,"ownDefaults",XI);const WI=["touchstart","touchmove","touchend"],KI=i=>{const t=PE(i.target),e=(function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n})(i);return new nt(e.clientX+t.left,e.clientY+t.top)},ry=i=>WI.includes(i.type)||i.pointerType==="touch",AT=i=>{i.preventDefault(),i.stopPropagation()},ps=i=>{let t=0,e=0,n=0,s=0;for(let o=0,c=i.length;o<c;o++){const{x:h,y:f}=i[o];(h>n||!o)&&(n=h),(h<t||!o)&&(t=h),(f>s||!o)&&(s=f),(f<e||!o)&&(e=f)}return{left:t,top:e,width:n-t,height:s-e}},QI=["translateX","translateY","scaleX","scaleY"],$I=(i,t)=>Ed(i,Pn(t,i.calcOwnMatrix())),Ed=(i,t)=>{const e=wd(t),{translateX:n,translateY:s,scaleX:o,scaleY:c}=e,h=je(e,QI),f=new nt(n,s);i.flipX=!1,i.flipY=!1,Object.assign(i,h),i.set({scaleX:o,scaleY:c}),i.setPositionByOrigin(f,Zt,Zt)},ZI=i=>{i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},LE=i=>({scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}),gv=(i,t,e)=>{const n=i/2,s=t/2,o=[new nt(-n,-s),new nt(n,-s),new nt(-n,s),new nt(n,s)].map((h=>h.transform(e))),c=ps(o);return new nt(c.width,c.height)},Zd=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zn;return Pn(pi(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zn),i)},bl=function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zn,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zn;return i.transform(Zd(t,e))},JI=function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zn,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zn;return i.transform(Zd(t,e),!0)},t4=(i,t,e)=>{const n=Zd(t,e);return Ed(i,Pn(n,i.calcOwnMatrix())),n},NE=(i,t)=>{var e;const{transform:{target:n}}=t;(e=n.canvas)===null||e===void 0||e.fire("object:".concat(i),Y(Y({},t),{},{target:n})),n.fire(i,t)},e4={left:-.5,top:-.5,center:0,bottom:.5,right:.5},on=i=>typeof i=="string"?e4[i]:i-.5,Cd="not-allowed";function jE(i){return on(i.originX)===on(Zt)&&on(i.originY)===on(Zt)}function DT(i){return .5-on(i)}const vi=(i,t)=>i[t],BE=(i,t,e,n)=>({e:i,transform:t,pointer:new nt(e,n)});function FE(i,t){const e=i.getTotalAngle()+ws(Math.atan2(t.y,t.x))+360;return Math.round(e%360/45)}function mv(i,t,e,n,s){var o;let{target:c,corner:h}=i;const f=c.controls[h],d=((o=c.canvas)===null||o===void 0?void 0:o.getZoom())||1,p=c.padding/d,v=(function(S,b,E,O){const D=S.getRelativeCenterPoint(),j=E!==void 0&&O!==void 0?S.translateToGivenOrigin(D,Zt,Zt,E,O):new nt(S.left,S.top);return(S.angle?b.rotate(-tn(S.angle),D):b).subtract(j)})(c,new nt(n,s),t,e);return v.x>=p&&(v.x-=p),v.x<=-p&&(v.x+=p),v.y>=p&&(v.y-=p),v.y<=p&&(v.y+=p),v.x-=f.offsetX,v.y-=f.offsetY,v}const n4=(i,t,e,n)=>{const{target:s,offsetX:o,offsetY:c}=t,h=e-o,f=n-c,d=!vi(s,"lockMovementX")&&s.left!==h,p=!vi(s,"lockMovementY")&&s.top!==f;return d&&s.set(pe,h),p&&s.set(hr,f),(d||p)&&NE(bE,BE(i,t,e,n)),d||p},RT={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},yp=(i,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+6*(t-i)*e:e<.5?t:e<2/3?i+(t-i)*(2/3-e)*6:i),OT=(i,t,e,n)=>{i/=255,t/=255,e/=255;const s=Math.max(i,t,e),o=Math.min(i,t,e);let c,h;const f=(s+o)/2;if(s===o)c=h=0;else{const d=s-o;switch(h=f>.5?d/(2-s-o):d/(s+o),s){case i:c=(t-e)/d+(t<e?6:0);break;case t:c=(e-i)/d+2;break;case e:c=(i-t)/d+4}c/=6}return[Math.round(360*c),Math.round(100*h),Math.round(100*f),n]},MT=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(i)/(i.endsWith("%")?100:1)},gf=i=>Math.min(Math.round(i),255).toString(16).toUpperCase().padStart(2,"0"),PT=i=>{let[t,e,n,s=1]=i;const o=Math.round(.3*t+.59*e+.11*n);return[o,o,o,s]};class me{constructor(t){if(z(this,"isUnrecognised",!1),t)if(t instanceof me)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,n,s,o=1]=t;this.setSource([e,n,s,o])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in RT&&(t=RT[t]),t==="transparent"?[255,255,255,0]:me.sourceFromHex(t)||me.sourceFromRgb(t)||me.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,n]=this.getSource();return"rgb(".concat(t,",").concat(e,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[t,e,n]=OT(...this.getSource());return"hsl(".concat(t,",").concat(e,"%,").concat(n,"%)")}toHsla(){const[t,e,n,s]=OT(...this.getSource());return"hsla(".concat(t,",").concat(e,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,n,s]=this.getSource();return"".concat(gf(t)).concat(gf(e)).concat(gf(n)).concat(gf(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(PT(this.getSource())),this}toBlackWhite(t){const[e,,,n]=PT(this.getSource()),s=e<(t||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(t){t instanceof me||(t=new me(t));const e=this.getSource(),n=t.getSource(),[s,o,c]=e.map(((h,f)=>Math.round(.5*h+.5*n[f])));return this.setSource([s,o,c,e[3]]),this}static fromRgb(t){return me.fromRgba(t)}static fromRgba(t){return new me(me.sourceFromRgb(t))}static sourceFromRgb(t){const e=t.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(e){const[n,s,o]=e.slice(1,4).map((c=>{const h=parseFloat(c);return c.endsWith("%")?Math.round(2.55*h):h}));return[n,s,o,MT(e[4])]}}static fromHsl(t){return me.fromHsla(t)}static fromHsla(t){return new me(me.sourceFromHsl(t))}static sourceFromHsl(t){const e=t.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!e)return;const n=(me.parseAngletoDegrees(e[1])%360+360)%360/360,s=parseFloat(e[2])/100,o=parseFloat(e[3])/100;let c,h,f;if(s===0)c=h=f=o;else{const d=o<=.5?o*(s+1):o+s-o*s,p=2*o-d;c=yp(p,d,n+1/3),h=yp(p,d,n),f=yp(p,d,n-1/3)}return[Math.round(255*c),Math.round(255*h),Math.round(255*f),MT(e[4])]}static fromHex(t){return new me(me.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let n;n=e.length<=4?e.split("").map((f=>f+f)):e.match(/.{2}/g);const[s,o,c,h=255]=n.map((f=>parseInt(f,16)));return[s,o,c,h/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),n=parseFloat(e);return e.includes("rad")?ws(n):e.includes("turn")?360*n:n}}const Tl=function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ov;const e=/\D{0,2}$/.exec(i),n=parseFloat(i),s=fe.DPI;switch(e?.[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*t;default:return n}},r4=i=>{const[t,e]=i.trim().split(" "),[n,s]=(o=t)&&o!==fr?[o.slice(1,4),o.slice(5,8)]:o===fr?[o,o]:["Mid","Mid"];var o;return{meetOrSlice:e||"meet",alignX:n,alignY:s}},Mu=function(i,t){let e,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e="url(#SVGID_".concat(t.id,")");else{const o=new me(t),c=o.getAlpha();e=o.toRgb(),c!==1&&(n=c.toString())}else e="none";return s?"".concat(i,": ").concat(e,"; ").concat(n?"".concat(i,"-opacity: ").concat(n,"; "):""):"".concat(i,'="').concat(e,'" ').concat(n?"".concat(i,'-opacity="').concat(n,'" '):"")};class UE{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):fr,o=this.strokeDashOffset?this.strokeDashOffset:"0",c=this.strokeLineCap?this.strokeLineCap:"butt",h=this.strokeLineJoin?this.strokeLineJoin:"miter",f=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",p=this.visible?"":" visibility: hidden;",v=t?"":this.getSvgFilter(),S=Mu(gn,this.fill);return[Mu(dr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",c,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",h,"; ","stroke-miterlimit: ",f,"; ",S,"fill-rule: ",e,"; ","opacity: ",d,";",v,p].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=t?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(Ou(n));return"".concat(s).concat(e,'" ')}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),o=t.indexOf("COMMON_PARTS");return t[o]=s,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:n,withShadow:s,additionalTransform:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=e?"":'style="'.concat(this.getSvgStyles(),'" '),h=s?'style="'.concat(this.getSvgFilter(),'" '):"",f=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",p=f&&f.absolutePositioned,v=this.stroke,S=this.fill,b=this.shadow,E=[],O=t.indexOf("COMMON_PARTS");let D;f&&(f.clipPathId="CLIPPATH_".concat(ba()),D='<clipPath id="'.concat(f.clipPathId,`" >
`).concat(f.toClipPathSVG(n),`</clipPath>
`)),p&&E.push("<g ",h,this.getSvgCommons(),` >
`),E.push("<g ",this.getSvgTransform(!1),p?"":h+this.getSvgCommons(),` >
`);const j=[c,d,e?"":this.addPaintOrder()," ",o?'transform="'.concat(o,'" '):""].join("");return t[O]=j,Gr(S)&&E.push(S.toSVG(this)),Gr(v)&&E.push(v.toSVG(this)),b&&E.push(b.toSVG(this)),f&&E.push(D),E.push(t.join("")),E.push(`</g>
`),p&&E.push(`</g>
`),n?n(E.join("")):E.join("")}addPaintOrder(){return this.paintFirst!==gn?' paint-order="'.concat(this.paintFirst,'" '):""}}function Jd(i){return new RegExp("^("+i.join("|")+")\\b","i")}const mo="textDecorationThickness",zE=["fontSize","fontWeight","fontFamily","fontStyle"],HE=["underline","overline","linethrough"],GE=[...zE,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],YE=[...GE,...HE,"textBackgroundColor","direction",mo],i4=[...zE,...HE,dr,"strokeWidth",gn,"deltaY","textBackgroundColor",mo],s4={_reNewline:lv,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:pe,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:pe,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[mo]:66.667},Pi="justify",xd="justify-left",hu="justify-right",fu="justify-center";var IT,kT,VT;const yi=String.raw(IT||(IT=Gi(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),vp=String.raw(kT||(kT=Gi(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),a4=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+yi+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+yi+"))?\\s+(.*)"),o4={cx:pe,x:pe,r:"radius",cy:hr,y:hr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":mo},_p="font-size",Sp="clip-path";Jd(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);Jd(["symbol","image","marker","pattern","view","svg"]);const LT=Jd(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(VT||(VT=Gi(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),yi,vp,yi,vp,yi,vp,yi));const l4=new nt(1,0),qE=new nt,XE=(i,t)=>i.rotate(t),iy=(i,t)=>new nt(t).subtract(i),sy=i=>i.distanceFrom(qE),ay=(i,t)=>Math.atan2(du(i,t),u4(i,t)),c4=i=>ay(l4,i),pv=i=>i.eq(qE)?i:i.scalarDivide(sy(i)),WE=function(i){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return pv(new nt(-i.y,i.x).scalarMultiply(t?1:-1))},du=(i,t)=>i.x*t.y-i.y*t.x,u4=(i,t)=>i.x*t.x+i.y*t.y,NT=(i,t,e)=>{if(i.eq(t)||i.eq(e))return!0;const n=du(t,e),s=du(t,i),o=du(e,i);return n>=0?s>=0&&o<=0:!(s<=0&&o>=0)},jT="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",BT=new RegExp("(?:\\s|^)"+jT+jT+"("+yi+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Fi{constructor(t){const e=typeof t=="string"?Fi.parseShadow(t):t;Object.assign(this,Fi.ownDefaults,e),this.id=ba()}static parseShadow(t){const e=t.trim(),[,n=0,s=0,o=0]=(BT.exec(e)||[]).map((c=>parseFloat(c)||0));return{color:(e.replace(BT,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:o}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=XE(new nt(this.offsetX,this.offsetY),tn(-t.angle)),n=new me(this.color);let s=40,o=40;return t.width&&t.height&&(s=100*Pe((Math.abs(e.x)+this.blur)/t.width,fe.NUM_FRACTION_DIGITS)+20,o=100*Pe((Math.abs(e.y)+this.blur)/t.height,fe.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(o,'%" height="').concat(100+2*o,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Pe(this.blur?this.blur/2:0,fe.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Pe(e.x,fe.NUM_FRACTION_DIGITS),'" dy="').concat(Pe(e.y,fe.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=Fi.ownDefaults;return this.includeDefaultValues?t:dv(t,((n,s)=>n!==e[s]))}static async fromObject(t){return new this(t)}}z(Fi,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),z(Fi,"type","shadow"),wt.setClass(Fi,"shadow");const Ol=(i,t,e)=>Math.max(i,Math.min(t,e)),h4=[hr,pe,gr,qr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",jl,Bl],Es=[gn,dr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],f4={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:pe,originY:hr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:gn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},d4=(i,t,e,n)=>-e*Math.cos(i/n*Uu)+e+t,g4=()=>!1;class yv{constructor(t){let{startValue:e,byValue:n,duration:s=500,delay:o=0,easing:c=d4,onStart:h=Kf,onChange:f=Kf,onComplete:d=Kf,abort:p=g4,target:v}=t;z(this,"_state","pending"),z(this,"durationProgress",0),z(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=o,this.easing=c,this._onStart=h,this._onChange=f,this._onComplete=d,this._abort=p,this.target=v,this.startValue=e,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>$f(t)),this.delay):$f(t)}tick(t){const e=(t||+new Date)-this.startTime,n=Math.min(e,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:o}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=o,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),$f(this.tick)))}register(){Td.push(this)}unregister(){Td.remove(this)}abort(){this._state="aborted",this.unregister()}}const m4=["startValue","endValue"];class p4 extends yv{constructor(t){let{startValue:e=0,endValue:n=100}=t;super(Y(Y({},je(t,m4)),{},{startValue:e,byValue:n-e}))}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}const y4=["startValue","endValue"];class v4 extends yv{constructor(t){let{startValue:e=[0],endValue:n=[100]}=t;super(Y(Y({},je(t,y4)),{},{startValue:e,byValue:n.map(((s,o)=>s-e[o]))}))}calculate(t){const e=this.startValue.map(((n,s)=>this.easing(t,n,this.byValue[s],this.duration,s)));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const _4=["startValue","endValue","easing","onChange","onComplete","abort"],S4=(i,t,e,n)=>t+e*(1-Math.cos(i/n*Uu)),bp=i=>i&&((t,e,n)=>i(new me(t).toRgba(),e,n));class b4 extends yv{constructor(t){let{startValue:e,endValue:n,easing:s=S4,onChange:o,onComplete:c,abort:h}=t,f=je(t,_4);const d=new me(e).getSource(),p=new me(n).getSource();super(Y(Y({},f),{},{startValue:d,byValue:p.map(((v,S)=>v-d[S])),easing:s,onChange:bp(o),onComplete:bp(c),abort:bp(h)}))}calculate(t){const[e,n,s,o]=this.startValue.map(((h,f)=>this.easing(t,h,this.byValue[f],this.duration,f))),c=[...[e,n,s].map(Math.round),Ol(0,o,1)];return{value:c,valueProgress:c.map(((h,f)=>this.byValue[f]!==0?Math.abs((h-this.startValue[f])/this.byValue[f]):0)).find((h=>h!==0))||0}}}function KE(i){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(i)?new v4(i):new p4(i);return t.start(),t}function T4(i){const t=new b4(i);return t.start(),t}class ze{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some((e=>e.eq(t)))}append(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.points=this.points.concat(e.filter((s=>!this.includes(s)))),this}static isPointContained(t,e,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(n))return t.eq(e);if(e.x===n.x)return t.x===e.x&&(s||t.y>=Math.min(e.y,n.y)&&t.y<=Math.max(e.y,n.y));if(e.y===n.y)return t.y===e.y&&(s||t.x>=Math.min(e.x,n.x)&&t.x<=Math.max(e.x,n.x));{const o=iy(e,n),c=iy(e,t).divide(o);return s?Math.abs(c.x)===Math.abs(c.y):c.x===c.y&&c.x>=0&&c.x<=1}}static isPointInPolygon(t,e){const n=new nt(t).setX(Math.min(t.x-1,...e.map((o=>o.x))));let s=0;for(let o=0;o<e.length;o++){const c=this.intersectSegmentSegment(e[o],e[(o+1)%e.length],t,n);if(c.includes(t))return!0;s+=+(c.status==="Intersection")}return s%2==1}static intersectLineLine(t,e,n,s){let o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],c=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const h=e.x-t.x,f=e.y-t.y,d=s.x-n.x,p=s.y-n.y,v=t.x-n.x,S=t.y-n.y,b=d*S-p*v,E=h*S-f*v,O=p*h-d*f;if(O!==0){const D=b/O,j=E/O;return(o||0<=D&&D<=1)&&(c||0<=j&&j<=1)?new ze("Intersection").append(new nt(t.x+D*h,t.y+D*f)):new ze}if(b===0||E===0){const D=o||c||ze.isPointContained(t,n,s)||ze.isPointContained(e,n,s)||ze.isPointContained(n,t,e)||ze.isPointContained(s,t,e);return new ze(D?"Coincident":void 0)}return new ze("Parallel")}static intersectSegmentLine(t,e,n,s){return ze.intersectLineLine(t,e,n,s,!1,!0)}static intersectSegmentSegment(t,e,n,s){return ze.intersectLineLine(t,e,n,s,!1,!1)}static intersectLinePolygon(t,e,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const o=new ze,c=n.length;for(let h,f,d,p=0;p<c;p++){if(h=n[p],f=n[(p+1)%c],d=ze.intersectLineLine(t,e,h,f,s,!1),d.status==="Coincident")return d;o.append(...d.points)}return o.points.length>0&&(o.status="Intersection"),o}static intersectSegmentPolygon(t,e,n){return ze.intersectLinePolygon(t,e,n,!1)}static intersectPolygonPolygon(t,e){const n=new ze,s=t.length,o=[];for(let c=0;c<s;c++){const h=t[c],f=t[(c+1)%s],d=ze.intersectSegmentPolygon(h,f,e);d.status==="Coincident"?(o.push(d),n.append(h,f)):n.append(...d.points)}return o.length>0&&o.length===t.length?new ze("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(t,e,n){const s=e.min(n),o=e.max(n),c=new nt(o.x,s.y),h=new nt(s.x,o.y);return ze.intersectPolygonPolygon(t,[s,c,o,h])}}class w4 extends CE{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?cr(t,this.group.calcTransformMatrix()):t}setXY(t,e,n){this.group&&(t=cr(t,pi(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,n)}getRelativeXY(){return new nt(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),o=[t,e,n,s];if(this.group){const c=this.group.calcTransformMatrix();return o.map((h=>cr(h,c)))}return o}intersectsWithRect(t,e){return ze.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=ze.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every((e=>t.containsPoint(e)))}isContainedWithinRect(t,e){const{left:n,top:s,width:o,height:c}=this.getBoundingRect();return n>=t.x&&n+o<=e.x&&s>=t.y&&s+c<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return ze.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some((n=>n.x<=e.x&&n.x>=t.x&&n.y<=e.y&&n.y>=t.y))||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every((n=>(n.x>=e.x||n.x<=t.x)&&(n.y>=e.y||n.y<=t.y)))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return ps(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(gr,t),this._set(qr,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?ws(DE(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||Zn.concat()}calcACoords(){const t=Fl({angle:this.angle}),{x:e,y:n}=this.getRelativeCenterPoint(),s=zu(e,n),o=Pn(s,t),c=this._getTransformedDimensions(),h=c.x/2,f=c.y/2;return{tl:cr({x:-h,y:-f},o),tr:cr({x:h,y:-f},o),bl:cr({x:-h,y:f},o),br:cr({x:h,y:f},o)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,on(this.originX),on(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const n=this.transformMatrixKey(t),s=this.matrixCache;return s&&s.key.every(((o,c)=>o===n[c]))?s.value:(this.group&&(e=Pn(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:n,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key===t)return e.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},o=qI(s);return this.ownMatrixCache={key:t,value:o},o}_getNonTransformedDimensions(){return new nt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Y({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},t),n=e.strokeWidth;let s=n,o=0;this.strokeUniform&&(s=0,o=n);const c=e.width+s,h=e.height+s;let f;return f=e.skewX===0&&e.skewY===0?new nt(c*e.scaleX,h*e.scaleY):gv(c,h,Qd(e)),f.scalarAdd(o)}translateToGivenOrigin(t,e,n,s,o){let c=t.x,h=t.y;const f=on(s)-on(e),d=on(o)-on(n);if(f||d){const p=this._getTransformedDimensions();c+=f*p.x,h+=d*p.y}return new nt(c,h)}translateToCenterPoint(t,e,n){if(e===Zt&&n===Zt)return t;const s=this.translateToGivenOrigin(t,e,n,Zt,Zt);return this.angle?s.rotate(tn(this.angle),t):s}translateToOriginPoint(t,e,n){const s=this.translateToGivenOrigin(t,Zt,Zt,e,n);return this.angle?s.rotate(tn(this.angle),t):s}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?cr(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new nt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,n){const s=this.translateToCenterPoint(t,e,n),o=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:o.x,top:o.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),pe,hr)}}const E4=["type"],C4=["extraParam"];let fs=class Jf extends w4{static getDefaults(){return Jf.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){Sa("warn","Setting type has no effect",t)}constructor(t){super(),z(this,"_cacheContext",null),Object.assign(this,Jf.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=Ts(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,n=t.height,s=fe.maxCacheSideLimit,o=fe.minCacheSideLimit;if(e<=s&&n<=s&&e*n<=fe.perfLimitSizeTotal)return e<o&&(t.width=o),n<o&&(t.height=o),t;const c=e/n,[h,f]=uu.limitDimsByArea(c),d=Ol(o,h,s),p=Ol(o,f,s);return e>d&&(t.zoomX/=e/d,t.width=d,t.capped=!0),n>p&&(t.zoomY/=n/p,t.height=p,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),n=e.x*t.x/this.scaleX,s=e.y*t.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:t.x,zoomY:t.y,x:n,y:s}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:n,height:s,zoomX:o,zoomY:c,x:h,y:f}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=n!==t.width||s!==t.height,p=this.zoomX!==o||this.zoomY!==c;if(!t||!e)return!1;if(d||p){n!==t.width||s!==t.height?(t.width=n,t.height=s):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const v=h/2,S=f/2;return this.cacheTranslationX=Math.round(t.width/2-v)+v,this.cacheTranslationY=Math.round(t.height/2-S)+S,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(o,c),this.zoomX=o,this.zoomY=c,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,n=this.calcTransformMatrix(!e);t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new nt(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=wd(this.calcTransformMatrix());return new nt(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return t.scalarMultiply(e*n)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==gr&&t!==qr||(e=this._constrainScale(e)),t===gr&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof Fi||(e=new Fi(e));const n=this[t]!==e;return this[t]=e,n&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:n,cacheTranslationX:s,cacheTranslationY:o}=this,{width:c,height:h}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:n,cacheTranslationX:s,cacheTranslationY:o,width:c,height:h,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===dr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,n){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(n,0,0),t.restore()}drawObject(t,e,n){const s=this.fill,o=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,n),this.fill=s,this.stroke=o}createClipPathLayer(t,e){const n=Xr(e),s=n.getContext("2d");if(s.translate(e.cacheTranslationX,e.cacheTranslationY),s.scale(e.zoomX,e.zoomY),t._cacheCanvas=n,e.parentClipPaths.forEach((o=>{o.transform(s)})),e.parentClipPaths.push(t),t.absolutePositioned){const o=pi(this.calcTransformMatrix());s.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return t.transform(s),t.drawObject(s,!0,e),n}_drawClipPath(t,e,n){if(!e)return;e._transformDone=!0;const s=this.createClipPathLayer(e,n);this.drawClipPathOnCache(t,e,s)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,n=this._cacheContext;return!(!e||!n||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&n&&!t&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height),n.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const n=e.stroke;n&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,Gr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(t,n):(t.strokeStyle=n.toLive(t),this._applyPatternGradientTransform(t,n)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:n}=e;n&&(Gr(n)?(t.fillStyle=n.toLive(t),this._applyPatternGradientTransform(t,n)):t.fillStyle=n)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[o,,,c]=n?.viewportTransform||Zn,h=o*s,f=c*s,d=e.nonScaling?new nt(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*fe.browserShadowBlurConstant*(h+f)*(d.x+d.y)/4,t.shadowOffsetX=e.offsetX*h*d.x,t.shadowOffsetY=e.offsetY*f*d.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!Gr(e))return{offsetX:0,offsetY:0};const n=e.gradientTransform||e.patternTransform,s=-this.width/2+e.offsetX||0,o=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,s,o):t.transform(1,0,0,1,s,o),n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:o}}_renderPaintInOrder(t){this.paintFirst===dr?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),o=this.getCanvasRetinaScaling(),c=s.x/this.scaleX/o,h=s.y/this.scaleY/o,f=Xr({width:Math.ceil(c),height:Math.ceil(h)}),d=f.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(c,0),d.lineTo(c,h),d.lineTo(0,h),d.closePath(),d.translate(c/2,h/2),d.scale(s.zoomX/this.scaleX/o,s.zoomY/this.scaleY/o),this._applyPatternGradientTransform(d,e),d.fillStyle=e.toLive(t),d.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(o*this.scaleX/s.zoomX,o*this.scaleY/s.zoomY),t.strokeStyle=(n=d.createPattern(f,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new nt(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(wt.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=LE(this),n=this.group,s=this.shadow,o=Math.abs,c=t.enableRetinaScaling?SE():1,h=(t.multiplier||1)*c,f=t.canvasProvider||(G=>new Hu(G,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&ZI(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&t4(this,this.getViewportTransform()),this.setCoords();const d=Ts(),p=this.getBoundingRect(),v=this.shadow,S=new nt;if(v){const G=v.blur,Z=v.nonScaling?new nt(1,1):this.getObjectScaling();S.x=2*Math.round(o(v.offsetX)+G)*o(Z.x),S.y=2*Math.round(o(v.offsetY)+G)*o(Z.y)}const b=p.width+S.x,E=p.height+S.y;d.width=Math.ceil(b),d.height=Math.ceil(E);const O=f(d);t.format==="jpeg"&&(O.backgroundColor="#fff"),this.setPositionByOrigin(new nt(O.width/2,O.height/2),Zt,Zt);const D=this.canvas;O._objects=[this],this.set("canvas",O),this.setCoords();const j=O.toCanvasElement(h||1,t);return this.set("canvas",D),this.shadow=s,n&&(this.group=n),this.set(e),this.setCoords(),O._objects=[],O.destroy(),j}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return xE(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return AE(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:n,originY:s}=this;if(e){const{x:o,y:c}=this.getRelativeCenterPoint();this.originX=Zt,this.originY=Zt,this.left=o,this.top=c}if(this.set("angle",t),e){const{x:o,y:c}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=o,this.top=c,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Td.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Hi().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce(((n,s)=>{let[o,c]=s;return n[o]=this._animate(o,c,e),n}),{})}_animate(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=t.split("."),o=this.constructor.colorProperties.includes(s[s.length-1]),{abort:c,startValue:h,onChange:f,onComplete:d}=n,p=Y(Y({},n),{},{target:this,startValue:h??s.reduce(((v,S)=>v[S]),this),endValue:e,abort:c?.bind(this),onChange:(v,S,b)=>{s.reduce(((E,O,D)=>(D===s.length-1&&(E[O]=v),E[O])),this),f&&f(v,S,b)},onComplete:(v,S,b)=>{this.setCoords(),d&&d(v,S,b)}});return o?T4(p):KE(p)}isDescendantOf(t){const{parent:e,group:n}=this;return e===t||n===t||!!e&&e.isDescendantOf(t)||!!n&&n!==e&&n.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),n=t.getAncestors();if(e.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[t,...n.slice(0,n.length-1)],common:[this]};for(let s,o=0;o<e.length;o++){if(s=e[o],s===t)return{fork:[this,...e.slice(0,o)],otherFork:[],common:e.slice(o)};for(let c=0;c<n.length;c++){if(this===n[c])return{fork:[],otherFork:[t,...n.slice(0,c)],common:[this,...e]};if(s===n[c])return{fork:[this,...e.slice(0,o)],otherFork:[t,...n.slice(0,c)],common:e.slice(o)}}}return{fork:[this,...e],otherFork:[t,...n],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const n=e.common[0]||this.canvas;if(!n)return;const s=e.fork.pop(),o=e.otherFork.pop(),c=n._objects.indexOf(s),h=n._objects.indexOf(o);return c>-1&&c>h}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Jf.customProperties,this.constructor.customProperties||[]);let e;const n=fe.NUM_FRACTION_DIGITS,{clipPath:s,fill:o,stroke:c,shadow:h,strokeDashArray:f,left:d,top:p,originX:v,originY:S,width:b,height:E,strokeWidth:O,strokeLineCap:D,strokeDashOffset:j,strokeLineJoin:G,strokeUniform:Z,strokeMiterLimit:q,scaleX:B,scaleY:I,angle:P,flipX:x,flipY:R,opacity:L,visible:k,backgroundColor:F,fillRule:M,paintFirst:vt,globalCompositeOperation:Pt,skewX:W,skewY:ft}=this;s&&!s.excludeFromExport&&(e=s.toObject(t.concat("inverted","absolutePositioned")));const gt=N=>Pe(N,n),It=Y(Y({},Ul(this,t)),{},{type:this.constructor.type,version:ty,originX:v,originY:S,left:gt(d),top:gt(p),width:gt(b),height:gt(E),fill:ET(o)?o.toObject():o,stroke:ET(c)?c.toObject():c,strokeWidth:gt(O),strokeDashArray:f&&f.concat(),strokeLineCap:D,strokeDashOffset:j,strokeLineJoin:G,strokeUniform:Z,strokeMiterLimit:gt(q),scaleX:gt(B),scaleY:gt(I),angle:gt(P),flipX:x,flipY:R,opacity:gt(L),shadow:h&&h.toObject(),visible:k,backgroundColor:F,fillRule:M,paintFirst:vt,globalCompositeOperation:Pt,skewX:gt(W),skewY:gt(ft)},e?{clipPath:e}:null);return this.includeDefaultValues?It:this._removeDefaultValues(It)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),n=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return dv(t,((s,o)=>{if(o===pe||o===hr||o==="type")return!0;const c=n[o];return s!==c&&!(Array.isArray(s)&&Array.isArray(c)&&s.length===0&&c.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(t){let e=je(t,E4),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,o=je(n,C4);return $d(e,o).then((c=>s?(delete c[s],new this(e[s],c)):new this(c)))}static fromObject(t,e){return this._fromObject(t,e)}};z(fs,"stateProperties",h4),z(fs,"cacheProperties",Es),z(fs,"ownDefaults",f4),z(fs,"type","FabricObject"),z(fs,"colorProperties",[gn,dr,"backgroundColor"]),z(fs,"customProperties",[]),wt.setClass(fs),wt.setClass(fs,"object");const zl=(i,t,e)=>(n,s,o,c)=>{const h=t(n,s,o,c);return h&&NE(i,Y(Y({},BE(n,s,o,c)),e)),h};function Hl(i){return(t,e,n,s)=>{const{target:o,originX:c,originY:h}=e,f=o.getRelativeCenterPoint(),d=o.translateToOriginPoint(f,c,h),p=i(t,e,n,s);return o.setPositionByOrigin(d,e.originX,e.originY),p}}const FT=zl(Du,Hl(((i,t,e,n)=>{const s=mv(t,t.originX,t.originY,e,n);if(on(t.originX)===on(Zt)||on(t.originX)===on(Je)&&s.x<0||on(t.originX)===on(pe)&&s.x>0){const{target:o}=t,c=o.strokeWidth/(o.strokeUniform?o.scaleX:1),h=jE(t)?2:1,f=o.width,d=Math.abs(s.x*h/o.scaleX)-c;return o.set("width",Math.max(d,1)),f!==o.width}return!1})));function x4(i,t,e,n,s){n=n||{};const o=this.sizeX||n.cornerSize||s.cornerSize,c=this.sizeY||n.cornerSize||s.cornerSize,h=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,f=h?dr:gn,d=!h&&(n.cornerStrokeColor||s.cornerStrokeColor);let p,v=t,S=e;i.save(),i.fillStyle=n.cornerColor||s.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",o>c?(p=o,i.scale(1,c/o),S=e*o/c):c>o?(p=c,i.scale(o/c,1),v=t*c/o):p=o,i.beginPath(),i.arc(v,S,p/2,0,_d,!1),i[f](),d&&i.stroke(),i.restore()}function A4(i,t,e,n,s){n=n||{};const o=this.sizeX||n.cornerSize||s.cornerSize,c=this.sizeY||n.cornerSize||s.cornerSize,h=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,f=h?dr:gn,d=!h&&(n.cornerStrokeColor||s.cornerStrokeColor),p=o/2,v=c/2;i.save(),i.fillStyle=n.cornerColor||s.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i.translate(t,e);const S=s.getTotalAngle();i.rotate(tn(S)),i["".concat(f,"Rect")](-p,-v,o,c),d&&i.strokeRect(-p,-v,o,c),i.restore()}class hi{constructor(t){z(this,"visible",!0),z(this,"actionName",Kd),z(this,"angle",0),z(this,"x",0),z(this,"y",0),z(this,"offsetX",0),z(this,"offsetY",0),z(this,"sizeX",0),z(this,"sizeY",0),z(this,"touchSizeX",0),z(this,"touchSizeY",0),z(this,"cursorStyle","crosshair"),z(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,n,s){var o;let{tl:c,tr:h,br:f,bl:d}=s;return((o=e.canvas)===null||o===void 0?void 0:o.getActiveObject())===e&&e.isControlVisible(t)&&ze.isPointInPolygon(n,[c,h,f,d])}getActionHandler(t,e,n){return this.actionHandler}getMouseDownHandler(t,e,n){return this.mouseDownHandler}getMouseUpHandler(t,e,n){return this.mouseUpHandler}cursorStyleHandler(t,e,n){return e.cursorStyle}getActionName(t,e,n){return e.actionName}getVisibility(t,e){var n,s;return(n=(s=t._controlsVisibility)===null||s===void 0?void 0:s[e])!==null&&n!==void 0?n:this.visible}setVisibility(t,e,n){this.visible=t}positionHandler(t,e,n,s){return new nt(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,n,s,o,c){const h=hv([zu(n,s),Fl({angle:t}),fv((o?this.touchSizeX:this.sizeX)||e,(o?this.touchSizeY:this.sizeY)||e)]);return{tl:new nt(-.5,-.5).transform(h),tr:new nt(.5,-.5).transform(h),br:new nt(.5,.5).transform(h),bl:new nt(-.5,.5).transform(h)}}render(t,e,n,s,o){((s=s||{}).cornerStyle||o.cornerStyle)==="circle"?x4.call(this,t,e,n,s,o):A4.call(this,t,e,n,s,o)}}const D4=(i,t,e)=>e.lockRotation?Cd:t.cursorStyle,R4=zl(TE,Hl(((i,t,e,n)=>{let{target:s,ex:o,ey:c,theta:h,originX:f,originY:d}=t;const p=s.translateToOriginPoint(s.getRelativeCenterPoint(),f,d);if(vi(s,"lockRotation"))return!1;const v=Math.atan2(c-p.y,o-p.x),S=Math.atan2(n-p.y,e-p.x);let b=ws(S-v+h);if(s.snapAngle&&s.snapAngle>0){const O=s.snapAngle,D=s.snapThreshold||O,j=Math.ceil(b/O)*O,G=Math.floor(b/O)*O;Math.abs(b-G)<D?b=G:Math.abs(b-j)<D&&(b=j)}b<0&&(b=360+b),b%=360;const E=s.angle!==b;return s.angle=b,E})));function QE(i,t){const e=t.canvas,n=i[e.uniScaleKey];return e.uniformScaling&&!n||!e.uniformScaling&&n}function $E(i,t,e){const n=vi(i,"lockScalingX"),s=vi(i,"lockScalingY");if(n&&s||!t&&(n||s)&&e||n&&t==="x"||s&&t==="y")return!0;const{width:o,height:c,strokeWidth:h}=i;return o===0&&h===0&&t!=="y"||c===0&&h===0&&t!=="x"}const O4=["e","se","s","sw","w","nw","n","ne","e"],ru=(i,t,e)=>{const n=QE(i,e);if($E(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",n))return Cd;const s=FE(e,t);return"".concat(O4[s],"-resize")};function vv(i,t,e,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const o=t.target,c=s.by,h=QE(i,o);let f,d,p,v,S,b;if($E(o,c,h))return!1;if(t.gestureScale)d=t.scaleX*t.gestureScale,p=t.scaleY*t.gestureScale;else{if(f=mv(t,t.originX,t.originY,e,n),S=c!=="y"?Math.sign(f.x||t.signX||1):1,b=c!=="x"?Math.sign(f.y||t.signY||1):1,t.signX||(t.signX=S),t.signY||(t.signY=b),vi(o,"lockScalingFlip")&&(t.signX!==S||t.signY!==b))return!1;if(v=o._getTransformedDimensions(),h&&!c){const D=Math.abs(f.x)+Math.abs(f.y),{original:j}=t,G=D/(Math.abs(v.x*j.scaleX/o.scaleX)+Math.abs(v.y*j.scaleY/o.scaleY));d=j.scaleX*G,p=j.scaleY*G}else d=Math.abs(f.x*o.scaleX/v.x),p=Math.abs(f.y*o.scaleY/v.y);jE(t)&&(d*=2,p*=2),t.signX!==S&&c!=="y"&&(t.originX=DT(t.originX),d*=-1,t.signX=S),t.signY!==b&&c!=="x"&&(t.originY=DT(t.originY),p*=-1,t.signY=b)}const E=o.scaleX,O=o.scaleY;return c?(c==="x"&&o.set(gr,d),c==="y"&&o.set(qr,p)):(!vi(o,"lockScalingX")&&o.set(gr,d),!vi(o,"lockScalingY")&&o.set(qr,p)),E!==o.scaleX||O!==o.scaleY}const mf=zl(Wd,Hl(((i,t,e,n)=>vv(i,t,e,n)))),M4=zl(Wd,Hl(((i,t,e,n)=>vv(i,t,e,n,{by:"x"})))),P4=zl(Wd,Hl(((i,t,e,n)=>vv(i,t,e,n,{by:"y"})))),I4=["target","ex","ey","skewingSide"],Tp={x:{counterAxis:"y",scale:gr,skew:jl,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:qr,skew:Bl,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},k4=["ns","nesw","ew","nwse"],V4=(i,t,e)=>{if(t.x!==0&&vi(e,"lockSkewingY")||t.y!==0&&vi(e,"lockSkewingX"))return Cd;const n=FE(e,t)%4;return"".concat(k4[n],"-resize")};function ZE(i,t,e,n,s){const{target:o}=e,{counterAxis:c,origin:h,lockSkewing:f,skew:d,flip:p}=Tp[i];if(vi(o,f))return!1;const{origin:v,flip:S}=Tp[c],b=on(e[v])*(o[S]?-1:1),E=-Math.sign(b)*(o[p]?-1:1),O=.5*-((o[d]===0&&mv(e,Zt,Zt,n,s)[i]>0||o[d]>0?1:-1)*E)+.5;return zl(wE,Hl(((j,G,Z,q)=>(function(B,I,P){let{target:x,ex:R,ey:L,skewingSide:k}=I,F=je(I,I4);const{skew:M}=Tp[B],vt=P.subtract(new nt(R,L)).divide(new nt(x.scaleX,x.scaleY))[B],Pt=x[M],W=F[M],ft=Math.tan(tn(W)),gt=B==="y"?x._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:x._getTransformedDimensions({scaleX:1,scaleY:1}).y,It=2*vt*k/Math.max(gt,1)+ft,N=ws(Math.atan(It));x.set(M,N);const at=Pt!==x[M];if(at&&B==="y"){const{skewX:pt,scaleX:mt}=x,St=x._getTransformedDimensions({skewY:Pt}),Ut=x._getTransformedDimensions(),Et=pt!==0?St.x/Ut.x:1;Et!==1&&x.set(gr,Et*mt)}return at})(i,G,new nt(Z,q)))))(t,Y(Y({},e),{},{[h]:O,skewingSide:E}),n,s)}const L4=(i,t,e,n)=>ZE("x",i,t,e,n),N4=(i,t,e,n)=>ZE("y",i,t,e,n);function tg(i,t){return i[t.canvas.altActionKey]}const pf=(i,t,e)=>{const n=tg(i,e);return t.x===0?n?jl:qr:t.y===0?n?Bl:gr:""},ml=(i,t,e)=>tg(i,e)?V4(0,t,e):ru(i,t,e),UT=(i,t,e,n)=>tg(i,t.target)?N4(i,t,e,n):M4(i,t,e,n),zT=(i,t,e,n)=>tg(i,t.target)?L4(i,t,e,n):P4(i,t,e,n),JE=()=>({ml:new hi({x:-.5,y:0,cursorStyleHandler:ml,actionHandler:UT,getActionName:pf}),mr:new hi({x:.5,y:0,cursorStyleHandler:ml,actionHandler:UT,getActionName:pf}),mb:new hi({x:0,y:.5,cursorStyleHandler:ml,actionHandler:zT,getActionName:pf}),mt:new hi({x:0,y:-.5,cursorStyleHandler:ml,actionHandler:zT,getActionName:pf}),tl:new hi({x:-.5,y:-.5,cursorStyleHandler:ru,actionHandler:mf}),tr:new hi({x:.5,y:-.5,cursorStyleHandler:ru,actionHandler:mf}),bl:new hi({x:-.5,y:.5,cursorStyleHandler:ru,actionHandler:mf}),br:new hi({x:.5,y:.5,cursorStyleHandler:ru,actionHandler:mf}),mtr:new hi({x:0,y:-.5,actionHandler:R4,cursorStyleHandler:D4,offsetY:-40,withConnection:!0,actionName:cv})}),j4=()=>({mr:new hi({x:.5,y:0,actionHandler:FT,cursorStyleHandler:ml,actionName:Du}),ml:new hi({x:-.5,y:0,actionHandler:FT,cursorStyleHandler:ml,actionName:Du})}),B4=()=>Y(Y({},JE()),j4());class Pu extends fs{static getDefaults(){return Y(Y({},super.getDefaults()),Pu.ownDefaults)}constructor(t){super(),Object.assign(this,this.constructor.createControls(),Pu.ownDefaults),this.setOptions(t)}static createControls(){return{controls:JE()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,n=e.target,s=e.action;if(this===n&&s&&s.startsWith(Kd))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[o,c]=n[s],h=this.controls[o];if(h.shouldActivate(o,this,t,e?c.touchCorner:c.corner))return this.__corner=o,{key:o,control:h,coord:this.oCoords[o]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),n=zu(e.x,e.y),s=Fl({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),o=Pn(n,s),c=Pn(t,o),h=Pn(c,[1/t[0],0,0,1/t[3],0,0]),f=this.group?wd(this.calcTransformMatrix()):void 0;f&&(f.scaleX=Math.abs(f.scaleX),f.scaleY=Math.abs(f.scaleY));const d=this._calculateCurrentDimensions(f),p={};return this.forEachControl(((v,S)=>{const b=v.positionHandler(d,h,this,v);p[S]=Object.assign(b,this._calcCornerCoords(v,b))})),p}_calcCornerCoords(t,e){const n=this.getTotalAngle();return{corner:t.calcCornerCoords(n,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(n,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/s[0],1/s[3]),t.rotate(tn(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-n.x/2,-n.y/2,n.x,n.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=Y({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);t.save(),t.strokeStyle=s.borderColor,this._setLineDash(t,s.borderDashArray),this.strokeBorders(t,e),s.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,o=Y({hasBorders:n,hasControls:s},e),c=this.getViewportTransform(),h=o.hasBorders,f=o.hasControls,d=Pn(c,this.calcTransformMatrix()),p=wd(d);t.save(),t.translate(p.translateX,p.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),t.rotate(tn(this.group?p.angle:this.angle)),h&&this.drawBorders(t,p,e),f&&this.drawControls(t,e),t.restore()}drawBorders(t,e,n){let s;if(n&&n.forActiveSelection||this.group){const o=gv(this.width,this.height,Qd(e)),c=this.isStrokeAccountedForInDimensions()?uv:(this.strokeUniform?new nt().scalarAdd(this.canvas?this.canvas.getZoom():1):new nt(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);s=o.add(c).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,s,n)}drawControlsConnectingLines(t,e){let n=!1;t.beginPath(),this.forEachControl(((s,o)=>{s.withConnection&&s.getVisibility(this,o)&&(n=!0,t.moveTo(s.x*e.x,s.y*e.y),t.lineTo(s.x*e.x+s.offsetX,s.y*e.y+s.offsetY))})),n&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:o,cornerColor:c}=this,h=Y({cornerStrokeColor:s,cornerDashArray:o,cornerColor:c},e);t.setTransform(n,0,0,n,0,0),t.strokeStyle=t.fillStyle=h.cornerColor,this.transparentCorners||(t.strokeStyle=h.cornerStrokeColor),this._setLineDash(t,h.cornerDashArray),this.forEachControl(((f,d)=>{if(f.getVisibility(this,d)){const p=this.oCoords[d];f.render(t,p.x,p.y,h,this)}})),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach((e=>{let[n,s]=e;return this.setControlVisible(n,s)}))}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const n=this.canvas.viewportTransform;e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(e);const s=this.width+4,o=this.height+4;return e.clearRect(-s/2,-o/2,s,o),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function tC(i,t){return t.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((n=>{n!=="constructor"&&Object.defineProperty(i.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n)||Object.create(null))}))})),i}z(Pu,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Hn extends Pu{}tC(Hn,[UE]),wt.setClass(Hn),wt.setClass(Hn,"object");const F4=(i,t,e,n)=>{const s=2*(n=Math.round(n))+1,{data:o}=i.getImageData(t-n,e-n,s,s);for(let c=3;c<o.length;c+=4)if(o[c]>0)return!1;return!0};class eC{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new nt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new nt(1/this.options.scaleX,1/this.options.scaleY):new nt(1,1)}createSideVector(t,e){const n=iy(t,e);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(t,e,n){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new nt(t);return e.y+=e.x*Math.tan(tn(this.options.skewY)),e.x+=e.y*Math.tan(tn(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const U4=new nt;class wl extends eC{static getOrthogonalRotationFactor(t,e){const n=e?ay(t,e):c4(t);return Math.abs(n)<Uu?-1:1}constructor(t,e,n,s){super(s),z(this,"AB",void 0),z(this,"AC",void 0),z(this,"alpha",void 0),z(this,"bisector",void 0),this.A=new nt(t),this.B=new nt(e),this.C=new nt(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=ay(this.AB,this.AC),this.bisector=pv(XE(this.AB.eq(U4)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(t,e),o=WE(s),c=wl.getOrthogonalRotationFactor(o,this.bisector);return this.scaleUnitVector(o,n*c)}projectBevel(){const t=[];return(this.alpha%_d==0?[this.B]:[this.B,this.C]).forEach((e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))})),t}projectMiter(){const t=[],e=Math.abs(this.alpha),n=1/Math.sin(e/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),o=this.options.strokeUniform?sy(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return sy(s)/this.strokeProjectionMagnitude<=o&&t.push(this.applySkew(this.A.add(s))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const n=[],s=new nt(wl.getOrthogonalRotationFactor(this.bisector),wl.getOrthogonalRotationFactor(new nt(this.bisector.y,this.bisector.x)));return[new nt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new nt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach((o=>{NT(o,t,e)&&n.push(this.A.add(o))})),n}projectRoundWithSkew(t,e){const n=[],{skewX:s,skewY:o,scaleX:c,scaleY:h,strokeUniform:f}=this.options,d=new nt(Math.tan(tn(s)),Math.tan(tn(o))),p=this.strokeProjectionMagnitude,v=f?p/h/Math.sqrt(1/h**2+1/c**2*d.y**2):p/Math.sqrt(1+d.y**2),S=new nt(Math.sqrt(Math.max(p**2-v**2,0)),v),b=f?p/Math.sqrt(1+d.x**2*(1/h)**2/(1/c+1/c*d.x*d.y)**2):p/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),E=new nt(b,Math.sqrt(Math.max(p**2-b**2,0)));return[E,E.scalarMultiply(-1),S,S.scalarMultiply(-1)].map((O=>this.applySkew(f?O.multiply(this.strokeUniformScalar):O))).forEach((O=>{NT(O,t,e)&&n.push(this.applySkew(this.A).add(O))})),n}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%_d==0,n=this.applySkew(this.A),s=t[e?0:2].subtract(n),o=t[e?1:0].subtract(n),c=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),h=du(s,c)>0,f=h?s:o,d=h?o:s;return this.isSkewed()?t.push(...this.projectRoundWithSkew(f,d)):t.push(...this.projectRoundNoSkew(f,d)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector})))}}class HT extends eC{constructor(t,e,n){super(n),this.A=new nt(t),this.T=new nt(e)}calcOrthogonalProjection(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(t,e);return this.scaleUnitVector(WE(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new nt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new wl(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new nt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(pv(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);t.push(s.add(e),s.subtract(e))}return t.map((e=>this.applySkew(e)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t})))}}const z4=function(i,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(i.length===0)return n;const s=i.reduce(((o,c)=>(o[o.length-1].eq(c)||o.push(new nt(c)),o)),[new nt(i[0])]);if(s.length===1)e=!0;else if(!e){const o=s[0],c=((h,f)=>{for(let d=h.length-1;d>=0;d--)if(f(h[d],d,h))return d;return-1})(s,(h=>!h.eq(o)));s.splice(c+1)}return s.forEach(((o,c,h)=>{let f,d;c===0?(d=h[1],f=e?o:h[h.length-1]):c===h.length-1?(f=h[c-1],d=e?o:h[0]):(f=h[c-1],d=h[c+1]),e&&h.length===1?n.push(...new HT(o,o,t).project()):!e||c!==0&&c!==h.length-1?n.push(...new wl(o,f,d,t).project()):n.push(...new HT(o,c===0?d:f,t).project())})),n},_v=i=>{const t={};return Object.keys(i).forEach((e=>{t[e]={},Object.keys(i[e]).forEach((n=>{t[e][n]=Y({},i[e][n])}))})),t},H4=i=>i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Qc;const Sv=i=>{if(Qc||Qc||(Qc="Intl"in Xd()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Qc){const t=Qc.segment(i);return Array.from(t).map((e=>{let{segment:n}=e;return n}))}return G4(i)},G4=i=>{const t=[];for(let e,n=0;n<i.length;n++)(e=Y4(i,n))!==!1&&t.push(e);return t},Y4=(i,t)=>{const e=i.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return i.charAt(t);if(55296<=e&&e<=56319){if(i.length<=t+1)throw"High surrogate without following low surrogate";const s=i.charCodeAt(t+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return i.charAt(t)+i.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const n=i.charCodeAt(t-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},bv=function(i,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return i.fill!==t.fill||i.stroke!==t.stroke||i.strokeWidth!==t.strokeWidth||i.fontSize!==t.fontSize||i.fontFamily!==t.fontFamily||i.fontWeight!==t.fontWeight||i.fontStyle!==t.fontStyle||i.textDecorationThickness!==t.textDecorationThickness||i.textBackgroundColor!==t.textBackgroundColor||i.deltaY!==t.deltaY||e&&(i.overline!==t.overline||i.underline!==t.underline||i.linethrough!==t.linethrough)},q4=(i,t)=>{const e=t.split(`
`),n=[];let s=-1,o={};i=_v(i);for(let c=0;c<e.length;c++){const h=Sv(e[c]);if(i[c])for(let f=0;f<h.length;f++){s++;const d=i[c][f];d&&Object.keys(d).length>0&&(bv(o,d,!0)?n.push({start:s,end:s+1,style:d}):n[n.length-1].end++),o=d||{}}else s+=h.length,o={}}return n},X4=(i,t)=>{if(!Array.isArray(i))return _v(i);const e=t.split(lv),n={};let s=-1,o=0;for(let c=0;c<e.length;c++){const h=Sv(e[c]);for(let f=0;f<h.length;f++)s++,i[o]&&i[o].start<=s&&s<i[o].end&&(n[c]=n[c]||{},n[c][f]=Y({},i[o].style),s===i[o].end-1&&o++)}return n},Ea=["display","transform",gn,"fill-opacity","fill-rule","opacity",dr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function GT(i,t){const e=i.nodeName,n=i.getAttribute("class"),s=i.getAttribute("id"),o="(?![a-zA-Z\\-]+)";let c;if(c=new RegExp("^"+e,"i"),t=t.replace(c,""),s&&t.length&&(c=new RegExp("#"+s+o,"i"),t=t.replace(c,"")),n&&t.length){const h=n.split(" ");for(let f=h.length;f--;)c=new RegExp("\\."+h[f]+o,"i"),t=t.replace(c,"")}return t.length===0}function W4(i,t){let e=!0;const n=GT(i,t.pop());return n&&t.length&&(e=(function(s,o){let c,h=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&o.length;)h&&(c=o.pop()),h=GT(s=s.parentElement,c);return o.length===0})(i,t)),n&&e&&t.length===0}const K4=i=>{var t;return(t=o4[i])!==null&&t!==void 0?t:i},Q4=new RegExp("(".concat(yi,")"),"gi"),$4=i=>i.replace(Q4," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var YT,qT,XT,WT,KT,QT,$T;const $n="(".concat(yi,")"),Z4=String.raw(YT||(YT=Gi(["(skewX)(",")"],["(skewX)\\(","\\)"])),$n),J4=String.raw(qT||(qT=Gi(["(skewY)(",")"],["(skewY)\\(","\\)"])),$n),tk=String.raw(XT||(XT=Gi(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),$n,$n,$n),ek=String.raw(WT||(WT=Gi(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),$n,$n),nk=String.raw(KT||(KT=Gi(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),$n,$n),rk=String.raw(QT||(QT=Gi(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),$n,$n,$n,$n,$n,$n),Tv="(?:".concat(rk,"|").concat(nk,"|").concat(tk,"|").concat(ek,"|").concat(Z4,"|").concat(J4,")"),ik="(?:".concat(Tv,"*)"),sk=String.raw($T||($T=Gi(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),ik),ak=new RegExp(sk),ok=new RegExp(Tv),lk=new RegExp(Tv,"g");function oy(i){const t=[];if(!(i=$4(i).replace(/\s*([()])\s*/gi,"$1"))||i&&!ak.test(i))return[...Zn];for(const e of i.matchAll(lk)){const n=ok.exec(e[0]);if(!n)continue;let s=Zn;const o=n.filter((E=>!!E)),[,c,...h]=o,[f,d,p,v,S,b]=h.map((E=>parseFloat(E)));switch(c){case"translate":s=zu(f,d);break;case cv:s=Fl({angle:f},{x:d,y:p});break;case Kd:s=fv(f,d);break;case jl:s=OE(f);break;case Bl:s=ME(f);break;case"matrix":s=[f,d,p,v,S,b]}t.push(s)}return hv(t)}function ck(i,t,e,n){const s=Array.isArray(t);let o,c=t;if(i!==gn&&i!==dr||t!==fr){if(i==="strokeUniform")return t==="non-scaling-stroke";if(i==="strokeDashArray")c=t===fr?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(i==="transformMatrix")c=e&&e.transformMatrix?Pn(e.transformMatrix,oy(t)):oy(t);else if(i==="visible")c=t!==fr&&t!=="hidden",e&&e.visible===!1&&(c=!1);else if(i==="opacity")c=parseFloat(t),e&&e.opacity!==void 0&&(c*=e.opacity);else if(i==="textAnchor")c=t==="start"?pe:t==="end"?Je:Zt;else if(i==="charSpacing"||i===mo)o=Tl(t,n)/n*1e3;else if(i==="paintFirst"){const h=t.indexOf(gn),f=t.indexOf(dr);c=gn,(h>-1&&f>-1&&f<h||h===-1&&f>-1)&&(c=dr)}else{if(i==="href"||i==="xlink:href"||i==="font"||i==="id")return t;if(i==="imageSmoothing")return t==="optimizeQuality";o=s?t.map(Tl):Tl(t,n)}}else c="";return!s&&isNaN(o)?c:o}function uk(i,t){const e=i.match(a4);if(!e)return;const n=e[1],s=e[3],o=e[4],c=e[5],h=e[6];n&&(t.fontStyle=n),s&&(t.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),o&&(t.fontSize=Tl(o)),h&&(t.fontFamily=h),c&&(t.lineHeight=c==="normal"?1:c)}function hk(i,t){i.replace(/;\s*$/,"").split(";").forEach((e=>{if(!e)return;const[n,s]=e.split(":");t[n.trim().toLowerCase()]=s.trim()}))}function fk(i){const t={},e=i.getAttribute("style");return e&&(typeof e=="string"?hk(e,t):(function(n,s){Object.entries(n).forEach((o=>{let[c,h]=o;h!==void 0&&(s[c.toLowerCase()]=h)}))})(e,t)),t}const dk={stroke:"strokeOpacity",fill:"fillOpacity"};function Cs(i,t,e){if(!i)return{};let n,s={},o=ov;i.parentNode&&LT.test(i.parentNode.nodeName)&&(s=Cs(i.parentElement,t,e),s.fontSize&&(n=o=Tl(s.fontSize)));const c=Y(Y(Y({},t.reduce(((d,p)=>{const v=i.getAttribute(p);return v&&(d[p]=v),d}),{})),(function(d){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v={};for(const S in p)W4(d,S.split(" "))&&(v=Y(Y({},v),p[S]));return v})(i,e)),fk(i));c[Sp]&&i.setAttribute(Sp,c[Sp]),c[_p]&&(n=Tl(c[_p],o),c[_p]="".concat(n));const h={};for(const d in c){const p=K4(d),v=ck(p,c[d],s,n);h[p]=v}h&&h.font&&uk(h.font,h);const f=Y(Y({},s),h);return LT.test(i.nodeName)?f:(function(d){const p=Hn.getDefaults();return Object.entries(dk).forEach((v=>{let[S,b]=v;if(d[b]===void 0||d[S]==="")return;if(d[S]===void 0){if(!p[S])return;d[S]=p[S]}if(d[S].indexOf("url(")===0)return;const E=new me(d[S]);d[S]=E.setAlpha(Pe(E.getAlpha()*d[b],2)).toRgba()})),d})(f)}const gk=["left","top","width","height","visible"],nC=["rx","ry"];class di extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),di.ownDefaults)}constructor(t){super(),Object.assign(this,di.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:n}=this,s=-e/2,o=-n/2,c=this.rx?Math.min(this.rx,e/2):0,h=this.ry?Math.min(this.ry,n/2):0,f=c!==0||h!==0;t.beginPath(),t.moveTo(s+c,o),t.lineTo(s+e-c,o),f&&t.bezierCurveTo(s+e-ra*c,o,s+e,o+ra*h,s+e,o+h),t.lineTo(s+e,o+n-h),f&&t.bezierCurveTo(s+e,o+n-ra*h,s+e-ra*c,o+n,s+e-c,o+n),t.lineTo(s+c,o+n),f&&t.bezierCurveTo(s+ra*c,o+n,s,o+n-ra*h,s,o+n-h),t.lineTo(s,o+h),f&&t.bezierCurveTo(s,o+ra*h,s+ra*c,o,s+c,o),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...nC,...t])}_toSVG(){const{width:t,height:e,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-t/2,'" y="').concat(-e/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(t,'" height="').concat(e,`" />
`)]}static async fromElement(t,e,n){const s=Cs(t,this.ATTRIBUTE_NAMES,n),{left:o=0,top:c=0,width:h=0,height:f=0,visible:d=!0}=s,p=je(s,gk);return new this(Y(Y(Y({},e),p),{},{left:o,top:c,width:h,height:f,visible:!!(d&&h&&f)}))}}z(di,"type","Rect"),z(di,"cacheProperties",[...Es,...nC]),z(di,"ownDefaults",{rx:0,ry:0}),z(di,"ATTRIBUTE_NAMES",[...Ea,"x","y","rx","ry","width","height"]),wt.setClass(di),wt.setSVGClass(di);const gs="initialization",Ad="added",wv="removed",Dd="imperative",rC=(i,t)=>{const{strokeUniform:e,strokeWidth:n,width:s,height:o,group:c}=t,h=c&&c!==i?Zd(c.calcTransformMatrix(),i.calcTransformMatrix()):null,f=h?t.getRelativeCenterPoint().transform(h):t.getRelativeCenterPoint(),d=!t.isStrokeAccountedForInDimensions(),p=e&&d?JI(new nt(n,n),void 0,i.calcTransformMatrix()):uv,v=!e&&d?n:0,S=gv(s+v,o+v,hv([h,t.calcOwnMatrix()],!0)).add(p).scalarDivide(2);return[f.subtract(S),f.add(S)]};class eg{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:n,strategy:s}=t;return e===gs||e===Dd||!!n&&s!==n}shouldLayoutClipPath(t){let{type:e,target:{clipPath:n}}=t;return e!==gs&&n&&!n.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:n,target:s}=e;if(n===Dd&&e.overrides)return e.overrides;if(t.length===0)return;const{left:o,top:c,width:h,height:f}=ps(t.map((v=>rC(s,v))).reduce(((v,S)=>v.concat(S)),[])),d=new nt(h,f),p=new nt(o,c).add(d.scalarDivide(2));if(n===gs){const v=this.getInitialSize(e,{size:d,center:p});return{center:p,relativeCorrection:new nt(0,0),size:v}}return{center:p.transform(s.calcOwnMatrix()),size:d}}}z(eg,"type","strategy");class ly extends eg{shouldPerformLayout(t){return!0}}z(ly,"type","fit-content"),wt.setClass(ly);const mk=["strategy"],pk=["target","strategy","bubbles","prevStrategy"],iC="layoutManager";class Iu{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new ly;z(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e=Y(Y({bubbles:!0,strategy:this.strategy},t),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(e);const n=this.getLayoutResult(e);n&&this.commitLayout(e,n),this.onAfterLayout(e,n),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:n}=e;return[bd,bE,Du,TE,Wd,wE,Sd,BI,FI].map((s=>t.on(s,(o=>this.performLayout(s===bd?{type:"object_modified",trigger:s,e:o,target:n}:{type:"object_modifying",trigger:s,e:o,target:n})))))}subscribe(t,e){this.unsubscribe(t,e);const n=this.attachHandlers(t,e);this._subscriptions.set(t,n)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach((n=>n())),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach((e=>this.unsubscribe(e,t)))}subscribeTargets(t){t.targets.forEach((e=>this.subscribe(e,t)))}onBeforeLayout(t){const{target:e,type:n}=t,{canvas:s}=e;if(n===gs||n===Ad?this.subscribeTargets(t):n===wv&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),s&&s.fire("object:layout:before",{target:e,context:t}),n===Dd&&t.deep){const o=je(t,mk);e.forEachObject((c=>c.layoutManager&&c.layoutManager.performLayout(Y(Y({},o),{},{bubbles:!1,target:c}))))}}getLayoutResult(t){const{target:e,strategy:n,type:s}=t,o=n.calcLayoutResult(t,e.getObjects());if(!o)return;const c=s===gs?new nt:e.getRelativeCenterPoint(),{center:h,correction:f=new nt,relativeCorrection:d=new nt}=o,p=c.subtract(h).add(f).transform(s===gs?Zn:pi(e.calcOwnMatrix()),!0).add(d);return{result:o,prevCenter:c,nextCenter:h,offset:p}}commitLayout(t,e){const{target:n}=t,{result:{size:s},nextCenter:o}=e;var c,h;n.set({width:s.x,height:s.y}),this.layoutObjects(t,e),t.type===gs?n.set({left:(c=t.x)!==null&&c!==void 0?c:o.x+s.x*on(n.originX),top:(h=t.y)!==null&&h!==void 0?h:o.y+s.y*on(n.originY)}):(n.setPositionByOrigin(o,Zt,Zt),n.setCoords(),n.set("dirty",!0))}layoutObjects(t,e){const{target:n}=t;n.forEachObject((s=>{s.group===n&&this.layoutObject(t,e,s)})),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,n.clipPath)}layoutObject(t,e,n){let{offset:s}=e;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(t,e){const{target:n,strategy:s,bubbles:o,prevStrategy:c}=t,h=je(t,pk),{canvas:f}=n;n.fire("layout:after",{context:t,result:e}),f&&f.fire("object:layout:after",{context:t,result:e,target:n});const d=n.parent;o&&d!=null&&d.layoutManager&&((h.path||(h.path=[])).push(n),d.layoutManager.performLayout(Y(Y({},h),{},{target:d}))),n.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach((e=>e.forEach((n=>n())))),t.clear()}toObject(){return{type:iC,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}wt.setClass(Iu,iC);const yk=["type","objects","layoutManager"];class vk extends Iu{performLayout(){}}class ho extends EE(Hn){static getDefaults(){return Y(Y({},super.getDefaults()),ho.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),z(this,"_activeObjects",[]),z(this,"__objectSelectionTracker",void 0),z(this,"__objectSelectionDisposer",void 0),Object.assign(this,ho.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var n;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((s=>{this.enterGroup(s,!1)})),this.layoutManager=(n=e.layoutManager)!==null&&n!==void 0?n:new Iu,this.layoutManager.performLayout({type:gs,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(Sa("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(Sa("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter(((e,n,s)=>this.canEnterGroup(e)&&s.indexOf(e)===n))}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(e),o=super.add(...s);return this._onAfterObjectsChange(Ad,s),o}insertAt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];const o=this._filterObjectsBeforeEnteringGroup(n),c=super.insertAt(t,...o);return this._onAfterObjectsChange(Ad,o),c}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(wv,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const n=this[t];return super._set(t,e),t==="canvas"&&n!==e&&(this._objects||[]).forEach((s=>{s._set(t,e)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:n}=e;const s=this._activeObjects;if(t)s.push(n),this._set("dirty",!0);else if(s.length>0){const o=s.indexOf(n);o>-1&&(s.splice(o,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&Ed(t,Pn(pi(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===t||t.isDescendantOf(n))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(Ed(t,Pn(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const n=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const t=Hn.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,n){this._renderBackground(t);for(let o=0;o<this._objects.length;o++){var s;const c=this._objects[o];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&c.group!==this?(t.save(),t.transform(...pi(this.calcTransformMatrix())),c.render(t),t.restore()):c.group===this&&c.render(t)}this._drawClipPath(t,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((t=>t.setCoords()))}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(Y({target:this,type:Dd},t))}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const n=this.includeDefaultValues;return this._objects.filter((function(s){return!s.excludeFromExport})).map((function(s){const o=s.includeDefaultValues;s.includeDefaultValues=n;const c=s[t||"toObject"](e);return s.includeDefaultValues=o,c}))}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return Y(Y(Y({},super.toObject(["subTargetCheck","interactive",...t])),e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{}),{},{objects:this.__serializeObjects("toObject",t)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((t=>{this._watchObject(!1,t),t.dispose()})),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=di.prototype._toSVG.call(this),n=e.indexOf("COMMON_PARTS");e[n]='for="group" ';const s=e.join("");return t?t(s):s}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(t);n&&e.push("		",n);for(let s=0;s<this._objects.length;s++)e.push("		",this._objects[s].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],n=this._createSVGBgRect(t);n&&e.push("	",n);for(let s=0;s<this._objects.length;s++)e.push("	",this._objects[s].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:n,objects:s=[],layoutManager:o}=t,c=je(t,yk);return Promise.all([Ru(s,e),$d(c,e)]).then((h=>{let[f,d]=h;const p=new this(f,Y(Y(Y({},c),d),{},{layoutManager:new vk}));if(o){const v=wt.getClass(o.type),S=wt.getClass(o.strategy);p.layoutManager=new v(new S)}else p.layoutManager=new Iu;return p.layoutManager.subscribeTargets({type:gs,target:p,targets:p.getObjects()}),p.setCoords(),p}))}}z(ho,"type","Group"),z(ho,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),wt.setClass(ho);const _k=(i,t)=>Math.min(t.width/i.width,t.height/i.height),Sk=(i,t)=>Math.max(t.width/i.width,t.height/i.height),cy="\\s*,?\\s*",$c="".concat(cy,"(").concat(yi,")"),bk="".concat($c).concat($c).concat($c).concat(cy,"([01])").concat(cy,"([01])").concat($c).concat($c),Tk={m:"l",M:"L"},wk=(i,t,e,n,s,o,c,h,f,d,p)=>{const v=Ss(i),S=bs(i),b=Ss(t),E=bs(t),O=e*s*b-n*o*E+c,D=n*s*b+e*o*E+h;return["C",d+f*(-e*s*S-n*o*v),p+f*(-n*s*S+e*o*v),O+f*(e*s*E+n*o*b),D+f*(n*s*E-e*o*b),O,D]},ZT=(i,t,e,n)=>{const s=Math.atan2(t,i),o=Math.atan2(n,e);return o>=s?o-s:2*Math.PI-(s-o)};function JT(i,t,e,n,s,o,c,h){let f;if(fe.cachesBoundsOfCurve&&(f=[...arguments].join(),uu.boundsOfCurveCache[f]))return uu.boundsOfCurveCache[f];const d=Math.sqrt,p=Math.abs,v=[],S=[[0,0],[0,0]];let b=6*i-12*e+6*s,E=-3*i+9*e-9*s+3*c,O=3*e-3*i;for(let q=0;q<2;++q){if(q>0&&(b=6*t-12*n+6*o,E=-3*t+9*n-9*o+3*h,O=3*n-3*t),p(E)<1e-12){if(p(b)<1e-12)continue;const R=-O/b;0<R&&R<1&&v.push(R);continue}const B=b*b-4*O*E;if(B<0)continue;const I=d(B),P=(-b+I)/(2*E);0<P&&P<1&&v.push(P);const x=(-b-I)/(2*E);0<x&&x<1&&v.push(x)}let D=v.length;const j=D,G=sC(i,t,e,n,s,o,c,h);for(;D--;){const{x:q,y:B}=G(v[D]);S[0][D]=q,S[1][D]=B}S[0][j]=i,S[1][j]=t,S[0][j+1]=c,S[1][j+1]=h;const Z=[new nt(Math.min(...S[0]),Math.min(...S[1])),new nt(Math.max(...S[0]),Math.max(...S[1]))];return fe.cachesBoundsOfCurve&&(uu.boundsOfCurveCache[f]=Z),Z}const Ek=(i,t,e)=>{let[n,s,o,c,h,f,d,p]=e;const v=((S,b,E,O,D,j,G)=>{if(E===0||O===0)return[];let Z=0,q=0,B=0;const I=Math.PI,P=G*av,x=bs(P),R=Ss(P),L=.5*(-R*S-x*b),k=.5*(-R*b+x*S),F=E**2,M=O**2,vt=k**2,Pt=L**2,W=F*M-F*vt-M*Pt;let ft=Math.abs(E),gt=Math.abs(O);if(W<0){const ae=Math.sqrt(1-W/(F*M));ft*=ae,gt*=ae}else B=(D===j?-1:1)*Math.sqrt(W/(F*vt+M*Pt));const It=B*ft*k/gt,N=-B*gt*L/ft,at=R*It-x*N+.5*S,pt=x*It+R*N+.5*b;let mt=ZT(1,0,(L-It)/ft,(k-N)/gt),St=ZT((L-It)/ft,(k-N)/gt,(-L-It)/ft,(-k-N)/gt);j===0&&St>0?St-=2*I:j===1&&St<0&&(St+=2*I);const Ut=Math.ceil(Math.abs(St/I*2)),Et=[],Ht=St/Ut,Wt=8/3*Math.sin(Ht/4)*Math.sin(Ht/4)/Math.sin(Ht/2);let Be=mt+Ht;for(let ae=0;ae<Ut;ae++)Et[ae]=wk(mt,Be,R,x,ft,gt,at,pt,Wt,Z,q),Z=Et[ae][5],q=Et[ae][6],mt=Be,Be+=Ht;return Et})(d-i,p-t,s,o,h,f,c);for(let S=0,b=v.length;S<b;S++)v[S][1]+=i,v[S][2]+=t,v[S][3]+=i,v[S][4]+=t,v[S][5]+=i,v[S][6]+=t;return v},Ck=i=>{let t=0,e=0,n=0,s=0;const o=[];let c,h=0,f=0;for(const d of i){const p=[...d];let v;switch(p[0]){case"l":p[1]+=t,p[2]+=e;case"L":t=p[1],e=p[2],v=["L",t,e];break;case"h":p[1]+=t;case"H":t=p[1],v=["L",t,e];break;case"v":p[1]+=e;case"V":e=p[1],v=["L",t,e];break;case"m":p[1]+=t,p[2]+=e;case"M":t=p[1],e=p[2],n=p[1],s=p[2],v=["M",t,e];break;case"c":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e,p[5]+=t,p[6]+=e;case"C":h=p[3],f=p[4],t=p[5],e=p[6],v=["C",p[1],p[2],h,f,t,e];break;case"s":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e;case"S":c==="C"?(h=2*t-h,f=2*e-f):(h=t,f=e),t=p[3],e=p[4],v=["C",h,f,p[1],p[2],t,e],h=v[3],f=v[4];break;case"q":p[1]+=t,p[2]+=e,p[3]+=t,p[4]+=e;case"Q":h=p[1],f=p[2],t=p[3],e=p[4],v=["Q",h,f,t,e];break;case"t":p[1]+=t,p[2]+=e;case"T":c==="Q"?(h=2*t-h,f=2*e-f):(h=t,f=e),t=p[1],e=p[2],v=["Q",h,f,t,e];break;case"a":p[6]+=t,p[7]+=e;case"A":Ek(t,e,p).forEach((S=>o.push(S))),t=p[6],e=p[7];break;case"z":case"Z":t=n,e=s,v=["Z"]}v?(o.push(v),c=v[0]):c=""}return o},Rd=(i,t,e,n)=>Math.sqrt((e-i)**2+(n-t)**2),sC=(i,t,e,n,s,o,c,h)=>f=>{const d=f**3,p=(b=>3*b**2*(1-b))(f),v=(b=>3*b*(1-b)**2)(f),S=(b=>(1-b)**3)(f);return new nt(c*d+s*p+e*v+i*S,h*d+o*p+n*v+t*S)},aC=i=>i**2,oC=i=>2*i*(1-i),lC=i=>(1-i)**2,xk=(i,t,e,n,s,o,c,h)=>f=>{const d=aC(f),p=oC(f),v=lC(f),S=3*(v*(e-i)+p*(s-e)+d*(c-s)),b=3*(v*(n-t)+p*(o-n)+d*(h-o));return Math.atan2(b,S)},Ak=(i,t,e,n,s,o)=>c=>{const h=aC(c),f=oC(c),d=lC(c);return new nt(s*h+e*f+i*d,o*h+n*f+t*d)},Dk=(i,t,e,n,s,o)=>c=>{const h=1-c,f=2*(h*(e-i)+c*(s-e)),d=2*(h*(n-t)+c*(o-n));return Math.atan2(d,f)},t1=(i,t,e)=>{let n=new nt(t,e),s=0;for(let o=1;o<=100;o+=1){const c=i(o/100);s+=Rd(n.x,n.y,c.x,c.y),n=c}return s},Rk=(i,t)=>{let e,n=0,s=0,o={x:i.x,y:i.y},c=Y({},o),h=.01,f=0;const d=i.iterator,p=i.angleFinder;for(;s<t&&h>1e-4;)c=d(n),f=n,e=Rd(o.x,o.y,c.x,c.y),e+s>t?(n-=h,h/=2):(o=c,n+=h,s+=e);return Y(Y({},c),{},{angle:p(f)})},cC=i=>{let t,e,n=0,s=0,o=0,c=0,h=0;const f=[];for(const d of i){const p={x:s,y:o,command:d[0],length:0};switch(d[0]){case"M":e=p,e.x=c=s=d[1],e.y=h=o=d[2];break;case"L":e=p,e.length=Rd(s,o,d[1],d[2]),s=d[1],o=d[2];break;case"C":t=sC(s,o,d[1],d[2],d[3],d[4],d[5],d[6]),e=p,e.iterator=t,e.angleFinder=xk(s,o,d[1],d[2],d[3],d[4],d[5],d[6]),e.length=t1(t,s,o),s=d[5],o=d[6];break;case"Q":t=Ak(s,o,d[1],d[2],d[3],d[4]),e=p,e.iterator=t,e.angleFinder=Dk(s,o,d[1],d[2],d[3],d[4]),e.length=t1(t,s,o),s=d[3],o=d[4];break;case"Z":e=p,e.destX=c,e.destY=h,e.length=Rd(s,o,c,h),s=c,o=h}n+=e.length,f.push(e)}return f.push({length:n,x:s,y:o}),f},Ok=function(i,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cC(i),n=0;for(;t-e[n].length>0&&n<e.length-2;)t-=e[n].length,n++;const s=e[n],o=t/s.length,c=i[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return Y(Y({},new nt(s.x,s.y).lerp(new nt(s.destX,s.destY),o)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return Y(Y({},new nt(s.x,s.y).lerp(new nt(c[1],c[2]),o)),{},{angle:Math.atan2(c[2]-s.y,c[1]-s.x)});case"C":case"Q":return Rk(s,t)}},Mk=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),e1=new RegExp(bk,"g"),Pk=new RegExp(yi,"gi"),Ik={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},kk=i=>{var t;const e=[],n=(t=i.match(Mk))!==null&&t!==void 0?t:[];for(const s of n){const o=s[0];if(o==="z"||o==="Z"){e.push([o]);continue}const c=Ik[o.toLowerCase()];let h=[];if(o==="a"||o==="A"){e1.lastIndex=0;for(let f=null;f=e1.exec(s);)h.push(...f.slice(1))}else h=s.match(Pk)||[];for(let f=0;f<h.length;f+=c){const d=new Array(c),p=Tk[o];d[0]=f>0&&p?p:o;for(let v=0;v<c;v++)d[v+1]=parseFloat(h[f+v]);e.push(d)}}return e},Vk=function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new nt(i[0]),n=new nt(i[1]),s=1,o=0;const c=[],h=i.length,f=h>2;let d;for(f&&(s=i[2].x<n.x?-1:i[2].x===n.x?0:1,o=i[2].y<n.y?-1:i[2].y===n.y?0:1),c.push(["M",e.x-s*t,e.y-o*t]),d=1;d<h;d++){if(!e.eq(n)){const p=e.midPointFrom(n);c.push(["Q",e.x,e.y,p.x,p.y])}e=i[d],d+1<i.length&&(n=i[d+1])}return f&&(s=e.x>i[d-2].x?1:e.x===i[d-2].x?0:-1,o=e.y>i[d-2].y?1:e.y===i[d-2].y?0:-1),c.push(["L",e.x+s*t,e.y+o*t]),c},uC=(i,t)=>i.map((e=>e.map(((n,s)=>s===0||t===void 0?n:Pe(n,t))).join(" "))).join(" ");function uy(i,t){const e=i.style;e&&t&&(typeof t=="string"?e.cssText+=";"+t:Object.entries(t).forEach((n=>{let[s,o]=n;return e.setProperty(s,o)})))}class Lk extends VE{constructor(t){let{allowTouchScrolling:e=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),z(this,"upper",void 0),z(this,"container",void 0);const{el:s}=this.lower,o=this.createUpperCanvas();this.upper={el:o,ctx:o.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:e}),this.applyCanvasStyle(o,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const c=this.createContainerElement();c.classList.add(n),s.parentNode&&s.parentNode.replaceChild(c,s),c.append(s,o),this.container=c}createUpperCanvas(){const{el:t}=this.lower,e=Ts();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=Nl().createElement("div");return t.setAttribute("data-fabric","wrapper"),uy(t,{position:"relative"}),xT(t),t}applyCanvasStyle(t,e){const{styles:n,allowTouchScrolling:s}=e;uy(t,Y(Y({},n),{},{"touch-action":s?"manipulation":fr})),xT(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:n,ctx:s}=this.upper;kE(n,s,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),ny(this.upper.el,t),ny(this.container,t)}cleanupDOM(t){const e=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(t),e.removeChild(s),e.removeChild(n),e.parentNode&&e.parentNode.replaceChild(n,e)}dispose(){super.dispose(),Hi().dispose(this.upper.el),delete this.upper,delete this.container}}class ng extends Hu{constructor(){super(...arguments),z(this,"targets",[]),z(this,"_hoveredTargets",[]),z(this,"_objectsToRender",void 0),z(this,"_currentTransform",null),z(this,"_groupSelector",null),z(this,"contextTopDirty",!1)}static getDefaults(){return Y(Y({},super.getDefaults()),ng.ownDefaults)}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new Lk(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter((e=>!e.group&&e!==t)).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),n=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,n){const s=this.targetFindTolerance,o=this.pixelFindContext;this.clearContext(o),o.save(),o.translate(-e+s,-n+s),o.transform(...this.viewportTransform);const c=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(o),t.selectionBackgroundColor=c,o.restore();const h=Math.round(s*this.getRetinaScaling());return F4(o,h,h,h)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find((n=>!!n&&t[n]===!0)):t[e])}_shouldClearSelection(t,e){const n=this.getActiveObjects(),s=this._activeObject;return!!(!e||e&&s&&n.length>1&&n.indexOf(e)===-1&&s!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&s&&s!==e)}_shouldCenterTransform(t,e,n){if(!t)return;let s;return e===Kd||e===gr||e===qr||e===Du?s=this.centeredScaling||t.centeredScaling:e===cv&&(s=this.centeredRotation||t.centeredRotation),s?!n:n}_getOriginFromCorner(t,e){const n={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?n.x=Je:["mr","tr","br"].includes(e)&&(n.x=pe),["tl","mt","tr"].includes(e)?n.y=ey:["bl","mb","br"].includes(e)&&(n.y=hr)),n}_setupCurrentTransform(t,e,n){var s;const o=e.group?bl(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:c="",control:h}=e.getActiveControl()||{},f=n&&h?(s=h.getActionHandler(t,e,h))===null||s===void 0?void 0:s.bind(h):n4,d=((b,E,O,D)=>{if(!E||!b)return"drag";const j=D.controls[E];return j.getActionName(O,j,D)})(n,c,t,e),p=t[this.centeredKey],v=this._shouldCenterTransform(e,d,p)?{x:Zt,y:Zt}:this._getOriginFromCorner(e,c),S={target:e,action:d,actionHandler:f,actionPerformed:!1,corner:c,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:o.x-e.left,offsetY:o.y-e.top,originX:v.x,originY:v.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:tn(e.angle),width:e.width,height:e.height,shiftKey:t.shiftKey,altKey:p,original:Y(Y({},LE(e)),{},{originX:v.x,originY:v.y})};this._currentTransform=S,this.fire("before:transform",{e:t,transform:S})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:n,deltaX:s,deltaY:o}=this._groupSelector,c=new nt(e,n).transform(this.viewportTransform),h=new nt(e+s,n+o).transform(this.viewportTransform),f=this.selectionLineWidth/2;let d=Math.min(c.x,h.x),p=Math.min(c.y,h.y),v=Math.max(c.x,h.x),S=Math.max(c.y,h.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(d,p,v-d,S-p)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,d+=f,p+=f,v-=f,S-=f,Hn.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(d,p,v-d,S-p))}findTarget(t){if(this.skipTargetFind)return;const e=this.getViewportPoint(t),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(e,ry(t))||s.length>1&&this.searchPossibleTargets([n],e))return n;if(n===this.searchPossibleTargets([n],e)){if(this.preserveObjectStacking){const o=this.targets;this.targets=[];const c=this.searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&c&&c!==n?(this.targets=o,n):c}return n}}return this.searchPossibleTargets(this._objects,e)}_pointIsInObjectSelectionArea(t,e){let n=t.getCoords();const s=this.getZoom(),o=t.padding/s;if(o){const[c,h,f,d]=n,p=Math.atan2(h.y-c.y,h.x-c.x),v=Ss(p)*o,S=bs(p)*o,b=v+S,E=v-S;n=[new nt(c.x-E,c.y-b),new nt(h.x+b,h.y-E),new nt(f.x+E,f.y+b),new nt(d.x-b,d.y+E)]}return ze.isPointInPolygon(e,n)}_checkTarget(t,e){return!!(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,bl(e,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing||!this.isTargetTransparent(t,e.x,e.y)))}_searchPossibleTargets(t,e){let n=t.length;for(;n--;){const s=t[n];if(this._checkTarget(s,e)){if(Qf(s)&&s.subTargetCheck){const o=this._searchPossibleTargets(s._objects,e);o&&this.targets.push(o)}return s}}}searchPossibleTargets(t,e){const n=this._searchPossibleTargets(t,e);if(n&&Qf(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let o=s.length-1;o>0;o--){const c=s[o];if(!Qf(c)||!c.interactive)return c}return s[0]}return n}getViewportPoint(t){return this._pointer?this._pointer:this.getPointer(t,!0)}getScenePoint(t){return this._absolutePointer?this._absolutePointer:this.getPointer(t)}getPointer(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let o=KI(t),c=s.width||0,h=s.height||0;c&&h||(hr in s&&ey in s&&(h=Math.abs(s.top-s.bottom)),Je in s&&pe in s&&(c=Math.abs(s.right-s.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,e||(o=bl(o,void 0,this.viewportTransform));const f=this.getRetinaScaling();f!==1&&(o.x/=f,o.y/=f);const d=c===0||h===0?new nt(1,1):new nt(n.width/c,n.height/h);return o.multiply(d)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Ts(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return ro(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let n=!1,s=!1;const o=this.getActiveObjects(),c=[],h=[];t.forEach((f=>{o.includes(f)||(n=!0,f.fire("deselected",{e,target:f}),h.push(f))})),o.forEach((f=>{t.includes(f)||(n=!0,f.fire("selected",{e,target:f}),c.push(f))})),t.length>0&&o.length>0?(s=!0,n&&this.fire("selection:updated",{e,selected:c,deselected:h})):o.length>0?(s=!0,this.fire("selection:created",{e,selected:c})):t.length>0&&(s=!0,this.fire("selection:cleared",{e,deselected:h})),s&&(this._objectsToRender=void 0)}setActiveObject(t,e){const n=this.getActiveObjects(),s=this._setActiveObject(t,e);return this._fireSelectionEvents(n,e),s}_setActiveObject(t,e){const n=this._activeObject;return n!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,ro(t)&&n!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const n=this._activeObject;return!!n&&!n.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(t),ro(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),n=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[n]});const s=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),s}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,n=e.target,s={e:t,target:n,transform:e,action:e.action};n._scaling&&(n._scaling=!1),n.setCoords(),e.actionPerformed&&(this.fire("object:modified",s),n.fire(bd,s))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;ro(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,n){const s=this._realizeGroupTransformOnObject(t),o=super._toObject(t,e,n);return t.set(s),o}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&ro(e)&&this._activeObject===e){const n=Ul(t,["angle","flipX","flipY",pe,gr,qr,jl,Bl,hr]);return $I(t,e.calcOwnMatrix()),n}return{}}_setSVGObject(t,e,n){const s=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,n),e.set(s)}}z(ng,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Nk{constructor(t){z(this,"targets",[]),z(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:s}=t.getActiveObject()||{};s&&s.focus()},n=t.upperCanvasEl;n.addEventListener("click",e),this.__disposer=()=>n.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach((t=>{t.isEditing&&t.exitEditing()}))}add(t){this.targets.push(t)}remove(t){this.unregister(t),gl(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const jk=["target","oldTarget","fireCanvas","e"],xr={passive:!1},ll=(i,t)=>{const e=i.getViewportPoint(t),n=i.getScenePoint(t);return{viewportPoint:e,scenePoint:n,pointer:e,absolutePointer:n}},ia=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return i.addEventListener(...e)},Br=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return i.removeEventListener(...e)},Bk={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class hy extends ng{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),z(this,"_isClick",void 0),z(this,"textEditingManager",new Nk(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((e=>{this[e]=this[e].bind(this)})),this.addOrRemove(ia,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t,e){const n=this.upperCanvasEl,s=this._getEventPrefix();t(IE(n),"resize",this._onResize),t(n,s+"down",this._onMouseDown),t(n,"".concat(s,"move"),this._onMouseMove,xr),t(n,"".concat(s,"out"),this._onMouseOut),t(n,"".concat(s,"enter"),this._onMouseEnter),t(n,"wheel",this._onMouseWheel),t(n,"contextmenu",this._onContextMenu),t(n,"click",this._onClick),t(n,"dblclick",this._onClick),t(n,"dragstart",this._onDragStart),t(n,"dragend",this._onDragEnd),t(n,"dragover",this._onDragOver),t(n,"dragenter",this._onDragEnter),t(n,"dragleave",this._onDragLeave),t(n,"drop",this._onDrop),this.enablePointerEvents||t(n,"touchstart",this._onTouchStart,xr)}removeListeners(){this.addOrRemove(Br,"remove");const t=this._getEventPrefix(),e=gi(this.upperCanvasEl);Br(e,"".concat(t,"up"),this._onMouseUp),Br(e,"touchend",this._onTouchEnd,xr),Br(e,"".concat(t,"move"),this._onMouseMove,xr),Br(e,"touchmove",this._onMouseMove,xr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this.__onMouseWheel(t)}_onMouseOut(t){const e=this._hoveredTarget,n=Y({e:t},ll(this,t));this.fire("mouse:out",Y(Y({},n),{},{target:e})),this._hoveredTarget=void 0,e&&e.fire("mouseout",Y({},n)),this._hoveredTargets.forEach((s=>{this.fire("mouse:out",Y(Y({},n),{},{target:s})),s&&s.fire("mouseout",Y({},n))})),this._hoveredTargets=[]}_onMouseEnter(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",Y({e:t},ll(this,t))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const n={e:t,target:e};return this.fire("dragstart",n),e.fire("dragstart",n),void ia(this.upperCanvasEl,"drag",this._onDragProgress)}AT(t)}_renderDragEffects(t,e,n){let s=!1;const o=this._dropTarget;o&&o!==e&&o!==n&&(o.clearContextTop(),s=!0),e?.clearContextTop(),n!==e&&n?.clearContextTop();const c=this.contextTop;c.save(),c.transform(...this.viewportTransform),e&&(c.save(),e.transform(c),e.renderDragSourceEffect(t),c.restore(),s=!0),n&&(c.save(),n.transform(c),n.renderDropTargetEffect(t),c.restore(),s=!0),c.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(t){const e=!!t.dataTransfer&&t.dataTransfer.dropEffect!==fr,n=e?this._activeObject:void 0,s={e:t,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:e,dropTarget:n};Br(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}findDragTargets(t){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(t)),targets:[...this.targets]}}_onDragOver(t){const e="dragover",{target:n,targets:s}=this.findDragTargets(t),o=this._dragSource,c={e:t,target:n,subTargets:s,dragSource:o,canDrop:!1,dropTarget:void 0};let h;this.fire(e,c),this._fireEnterLeaveEvents(n,c),n&&(n.canDrop(t)&&(h=n),n.fire(e,c));for(let f=0;f<s.length;f++){const d=s[f];d.canDrop(t)&&(h=d),d.fire(e,c)}this._renderDragEffects(t,o,h),this._dropTarget=h}_onDragEnter(t){const{target:e,targets:n}=this.findDragTargets(t),s={e:t,target:e,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(e,s)}_onDragLeave(t){const e={e:t,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",e),this._fireEnterLeaveEvents(void 0,e),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(t){const{target:e,targets:n}=this.findDragTargets(t),s=this._basicEventHandler("drop:before",Y({e:t,target:e,subTargets:n,dragSource:this._dragSource},ll(this,t)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(t){const e=this.findTarget(t),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:n});return this.stopContextMenu&&AT(t),this._basicEventHandler("contextmenu",s),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){let e=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),(this.isDrawingMode||n&&this._target===n)&&(e=!0),e&&t.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,o=this._getEventPrefix(),c=gi(s);ia(c,"touchend",this._onTouchEnd,xr),e&&ia(c,"touchmove",this._onMouseMove,xr),Br(s,"".concat(o,"down"),this._onMouseDown)}_onMouseDown(t){this.__onMouseDown(t),this._resetTransformEventData();const e=this.upperCanvasEl,n=this._getEventPrefix();Br(e,"".concat(n,"move"),this._onMouseMove,xr);const s=gi(e);ia(s,"".concat(n,"up"),this._onMouseUp),ia(s,"".concat(n,"move"),this._onMouseMove,xr)}_onTouchEnd(t){if(t.touches.length>0)return;this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),n=gi(this.upperCanvasEl);Br(n,"touchend",this._onTouchEnd,xr),Br(n,"touchmove",this._onMouseMove,xr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{ia(this.upperCanvasEl,"".concat(e,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(t){this.__onMouseUp(t),this._resetTransformEventData();const e=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(t)){const s=gi(this.upperCanvasEl);Br(s,"".concat(n,"up"),this._onMouseUp),Br(s,"".concat(n,"move"),this._onMouseMove,xr),ia(e,"".concat(n,"move"),this._onMouseMove,xr)}}_onMouseMove(t){const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._cacheTransformEventData(t),this._handleEvent(t,"up:before");const n=this._currentTransform,s=this._isClick,o=this._target,{button:c}=t;if(c)return(this.fireMiddleClick&&c===1||this.fireRightClick&&c===2)&&this._handleEvent(t,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let h,f,d=!1;if(n&&(this._finalizeCurrentTransform(t),d=n.actionPerformed),!s){const p=o===this._activeObject;this.handleSelection(t),d||(d=this._shouldRender(o)||!p&&o===this._activeObject)}if(o){const p=o.findControl(this.getViewportPoint(t),ry(t)),{key:v,control:S}=p||{};if(f=v,o.selectable&&o!==this._activeObject&&o.activeOn==="up")this.setActiveObject(o,t),d=!0;else if(S){const b=S.getMouseUpHandler(t,o,S);b&&(h=this.getScenePoint(t),b.call(S,t,n,h.x,h.y))}o.isMoving=!1}if(n&&(n.target!==o||n.corner!==f)){const p=n.target&&n.target.controls[n.corner],v=p&&p.getMouseUpHandler(t,n.target,p);h=h||this.getScenePoint(t),v&&v.call(p,t,n,h.x,h.y)}this._setCursorFromEvent(t,o),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),d?this.requestRenderAll():s||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:n,subTargets:s=[]}=e;this.fire(t,e),n&&n.fire(t,e);for(let o=0;o<s.length;o++)s[o]!==n&&s[o].fire(t,e);return e}_handleEvent(t,e,n){const s=this._target,o=this.targets||[],c=Y(Y(Y({e:t,target:s,subTargets:o},ll(this,t)),{},{transform:this._currentTransform},e==="up:before"||e==="up"?{isClick:this._isClick,currentTarget:this.findTarget(t),currentSubTargets:this.targets}:{}),e==="down:before"||e==="down"?n:{});this.fire("mouse:".concat(e),c),s&&s.fire("mouse".concat(e),c);for(let h=0;h<o.length;h++)o[h]!==s&&o[h].fire("mouse".concat(e),c)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._cacheTransformEventData(t),this._handleEvent(t,"down:before");let e=this._target,n=!!e&&e===this._activeObject;const{button:s}=t;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(t,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let o=this._shouldRender(e),c=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,c=!0,o=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const h=this.getScenePoint(t);this._groupSelector={x:h.x,y:h.y,deltaY:0,deltaX:0}}if(n=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const h=e.findControl(this.getViewportPoint(t),ry(t));if(e===this._activeObject&&(h||!c)){this._setupCurrentTransform(t,e,n);const f=h?h.control:void 0,d=this.getScenePoint(t),p=f&&f.getMouseDownHandler(t,e,f);p&&p.call(f,t,this._currentTransform,d.x,d.y)}}o&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:n}),o&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._pointer=this.getViewportPoint(t),this._absolutePointer=bl(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)}__onMouseMove(t){if(this._isClick=!1,this._cacheTransformEventData(t),this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const n=this.getScenePoint(t);e.deltaX=n.x-e.x,e.deltaY=n.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const n=this.findTarget(t);this._setCursorFromEvent(t,n),this._fireOverOutEvents(t,n)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move"),this._resetTransformEventData()}_fireOverOutEvents(t,e){const n=this._hoveredTarget,s=this._hoveredTargets,o=this.targets,c=Math.max(s.length,o.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:n,fireCanvas:!0});for(let h=0;h<c;h++)this.fireSyntheticInOutEvents("mouse",{e:t,target:o[h],oldTarget:s[h]});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(t,e){const n=this._draggedoverTarget,s=this._hoveredTargets,o=this.targets,c=Math.max(s.length,o.length);this.fireSyntheticInOutEvents("drag",Y(Y({},e),{},{target:t,oldTarget:n,fireCanvas:!0}));for(let h=0;h<c;h++)this.fireSyntheticInOutEvents("drag",Y(Y({},e),{},{target:o[h],oldTarget:s[h]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(t,e){let{target:n,oldTarget:s,fireCanvas:o,e:c}=e,h=je(e,jk);const{targetIn:f,targetOut:d,canvasIn:p,canvasOut:v}=Bk[t],S=s!==n;if(s&&S){const b=Y(Y({},h),{},{e:c,target:s,nextTarget:n},ll(this,c));o&&this.fire(v,b),s.fire(d,b)}if(n&&S){const b=Y(Y({},h),{},{e:c,target:n,previousTarget:s},ll(this,c));o&&this.fire(p,b),n.fire(f,b)}}__onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_transformObject(t){const e=this.getScenePoint(t),n=this._currentTransform,s=n.target,o=s.group?bl(e,void 0,s.group.calcTransformMatrix()):e;n.shiftKey=t.shiftKey,n.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,n,o),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,n){const{action:s,actionHandler:o,target:c}=e,h=!!o&&o(t,e,n.x,n.y);h&&c.setCoords(),s==="drag"&&h&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||h}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let n=e.hoverCursor||this.hoverCursor;const s=ro(this._activeObject)?this._activeObject:null,o=(!s||e.group!==s)&&e.findControl(this.getViewportPoint(t));if(o){const c=o.control;this.setCursor(c.cursorStyleHandler(t,c,e))}else e.subTargetCheck&&this.targets.concat().reverse().map((c=>{n=c.hoverCursor||n})),this.setCursor(n)}handleMultiSelection(t,e){const n=this._activeObject,s=ro(n);if(n&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(n!==e||s)&&(s||!e.isDescendantOf(n)&&!n.isDescendantOf(e))&&!e.onSelect({e:t})&&!n.getActiveControl()){if(s){const o=n.getObjects();if(e===n){const c=this.getViewportPoint(t);if(!(e=this.searchPossibleTargets(o,c)||this.searchPossibleTargets(this._objects,c))||!e.selectable)return!1}e.group===n?(n.remove(e),this._hoveredTarget=e,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),t)):(n.multiSelectAdd(e),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(o,t)}else{n.isEditing&&n.exitEditing();const o=new(wt.getClass("ActiveSelection"))([],{canvas:this});o.multiSelectAdd(n,e),this._hoveredTarget=o,this._setActiveObject(o,t),this._fireSelectionEvents([n],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:n,deltaX:s,deltaY:o}=this._groupSelector,c=new nt(e,n),h=c.add(new nt(s,o)),f=c.min(h),d=c.max(h).subtract(f),p=this.collectObjects({left:f.x,top:f.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),v=c.eq(h)?p[0]?[p[0]]:[]:p.length>1?p.filter((S=>!S.onSelect({e:t}))).reverse():p;if(v.length===1)this.setActiveObject(v[0],t);else if(v.length>1){const S=wt.getClass("ActiveSelection");this.setActiveObject(new S(v,{canvas:this}),t)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const hC={x1:0,y1:0,x2:0,y2:0},Fk=Y(Y({},hC),{},{r1:0,r2:0}),pl=(i,t)=>isNaN(i)&&typeof t=="number"?t:i,Uk=/^(\d+\.\d+)%|(\d+)%$/;function fC(i){return i&&Uk.test(i)}function dC(i,t){const e=typeof i=="number"?i:typeof i=="string"?parseFloat(i)/(fC(i)?100:1):NaN;return Ol(0,pl(e,t),1)}const zk=/\s*;\s*/,Hk=/\s*:\s*/;function Gk(i,t){let e,n;const s=i.getAttribute("style");if(s){const c=s.split(zk);c[c.length-1]===""&&c.pop();for(let h=c.length;h--;){const[f,d]=c[h].split(Hk).map((p=>p.trim()));f==="stop-color"?e=d:f==="stop-opacity"&&(n=d)}}const o=new me(e||i.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:dC(i.getAttribute("offset"),0),color:o.toRgb(),opacity:pl(parseFloat(n||i.getAttribute("stop-opacity")||""),1)*o.getAlpha()*t}}function Yk(i,t){const e=[],n=i.getElementsByTagName("stop"),s=dC(t,1);for(let o=n.length;o--;)e.push(Gk(n[o],s));return e}function gC(i){return i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?"linear":"radial"}function mC(i){return i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function ui(i,t){return i.getAttribute(t)}function qk(i,t){return(function(e,n){let s,{width:o,height:c,gradientUnits:h}=n;return Object.keys(e).reduce(((f,d)=>{const p=e[d];return p==="Infinity"?s=1:p==="-Infinity"?s=0:(s=typeof p=="string"?parseFloat(p):p,typeof p=="string"&&fC(p)&&(s*=.01,h==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(s*=o),d!=="y1"&&d!=="y2"||(s*=c)))),f[d]=s,f}),{})})(gC(i)==="linear"?(function(e){return{x1:ui(e,"x1")||0,y1:ui(e,"y1")||0,x2:ui(e,"x2")||"100%",y2:ui(e,"y2")||0}})(i):(function(e){return{x1:ui(e,"fx")||ui(e,"cx")||"50%",y1:ui(e,"fy")||ui(e,"cy")||"50%",r1:0,x2:ui(e,"cx")||"50%",y2:ui(e,"cy")||"50%",r2:ui(e,"r")||"50%"}})(i),Y(Y({},t),{},{gradientUnits:mC(i)}))}class yf{constructor(t){const{type:e="linear",gradientUnits:n="pixels",coords:s={},colorStops:o=[],offsetX:c=0,offsetY:h=0,gradientTransform:f,id:d}=t||{};Object.assign(this,{type:e,gradientUnits:n,coords:Y(Y({},e==="radial"?Fk:hC),s),colorStops:o,offsetX:c,offsetY:h,gradientTransform:f,id:d?"".concat(d,"_").concat(ba()):ba()})}addColorStop(t){for(const e in t){const n=new me(t[e]);this.colorStops.push({offset:parseFloat(e),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(t){return Y(Y({},Ul(this,t)),{},{type:this.type,coords:Y({},this.coords),colorStops:this.colorStops.map((e=>Y({},e))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():Zn.concat(),o=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",c=this.colorStops.map((v=>Y({},v))).sort(((v,S)=>v.offset-S.offset));let h=-this.offsetX,f=-this.offsetY;var d;o==="objectBoundingBox"?(h/=t.width,f/=t.height):(h+=t.width/2,f+=t.height/2),(d=t)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(h-=t.pathOffset.x,f-=t.pathOffset.y),s[4]-=h,s[5]-=f;const p=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(o,'"'),'gradientTransform="'.concat(e?e+" ":"").concat(Ou(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:v,y1:S,x2:b,y2:E}=this.coords;n.push("<linearGradient ",p,' x1="',v,'" y1="',S,'" x2="',b,'" y2="',E,`">
`)}else if(this.type==="radial"){const{x1:v,y1:S,x2:b,y2:E,r1:O,r2:D}=this.coords,j=O>D;n.push("<radialGradient ",p,' cx="',j?v:b,'" cy="',j?S:E,'" r="',j?O:D,'" fx="',j?b:v,'" fy="',j?E:S,`">
`),j&&(c.reverse(),c.forEach((Z=>{Z.offset=1-Z.offset})));const G=Math.min(O,D);if(G>0){const Z=G/Math.max(O,D);c.forEach((q=>{q.offset+=Z*(1-q.offset)}))}}return c.forEach((v=>{let{color:S,offset:b,opacity:E}=v;n.push("<stop ",'offset="',100*b+"%",'" style="stop-color:',S,E!==void 0?";stop-opacity: "+E:";",`"/>
`)})),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(t){const{x1:e,y1:n,x2:s,y2:o,r1:c,r2:h}=this.coords,f=this.type==="linear"?t.createLinearGradient(e,n,s,o):t.createRadialGradient(e,n,c,s,o,h);return this.colorStops.forEach((d=>{let{color:p,opacity:v,offset:S}=d;f.addColorStop(S,v!==void 0?new me(p).setAlpha(v).toRgba():p)})),f}static async fromObject(t){const{colorStops:e,gradientTransform:n}=t;return new this(Y(Y({},t),{},{colorStops:e?e.map((s=>Y({},s))):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(t,e,n){const s=mC(t),o=e._findCenterFromElement();return new this(Y({id:t.getAttribute("id")||void 0,type:gC(t),coords:qk(t,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:Yk(t,n.opacity),gradientUnits:s,gradientTransform:oy(t.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:e.width/2-o.x,offsetY:e.height/2-o.y}:{offsetX:0,offsetY:0}))}}z(yf,"type","Gradient"),wt.setClass(yf,"gradient"),wt.setClass(yf,"linear"),wt.setClass(yf,"radial");const Xk=["type","source","patternTransform"];class wp{get type(){return"pattern"}set type(t){Sa("warn","Setting type has no effect",t)}constructor(t){z(this,"repeat","repeat"),z(this,"offsetX",0),z(this,"offsetY",0),z(this,"crossOrigin",""),this.id=ba(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:n}=this;return Y(Y({},Ul(this,t)),{},{type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:n,offsetX:Pe(this.offsetX,fe.NUM_FRACTION_DIGITS),offsetY:Pe(this.offsetY,fe.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(t){let{width:e,height:n}=t;const{source:s,repeat:o,id:c}=this,h=pl(this.offsetX/e,0),f=pl(this.offsetY/n,0),d=o==="repeat-y"||o==="no-repeat"?1+Math.abs(h||0):pl(s.width/e,0),p=o==="repeat-x"||o==="no-repeat"?1+Math.abs(f||0):pl(s.height/n,0);return['<pattern id="SVGID_'.concat(c,'" x="').concat(h,'" y="').concat(f,'" width="').concat(d,'" height="').concat(p,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:n,source:s,patternTransform:o}=t,c=je(t,Xk);const h=await Zf(s,Y(Y({},e),{},{crossOrigin:c.crossOrigin}));return new this(Y(Y({},c),{},{patternTransform:o&&o.slice(0),source:h}))}}z(wp,"type","Pattern"),wt.setClass(wp),wt.setClass(wp,"pattern");class Wk{constructor(t){z(this,"color","rgb(0, 0, 0)"),z(this,"width",1),z(this,"shadow",null),z(this,"strokeLineCap","round"),z(this,"strokeLineJoin","round"),z(this,"strokeMiterLimit",10),z(this,"strokeDashArray",null),z(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new me(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,n=t.contextTop,s=t.getZoom()*t.getRetinaScaling();n.shadowColor=e.color,n.shadowBlur=e.blur*s,n.shadowOffsetX=e.offsetX*s,n.shadowOffsetY=e.offsetY*s}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}const Kk=["path","left","top"],Qk=["d"];class oa extends Hn{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:o}=e,c=je(e,Kk);super(),Object.assign(this,oa.ownDefaults),this.setOptions(c),this._setPath(t||[],!0),typeof s=="number"&&this.set(pe,s),typeof o=="number"&&this.set(hr,o)}_setPath(t,e){this.path=Ck(Array.isArray(t)?t:kk(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new nt(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,n=-this.pathOffset.y;t.beginPath();for(const s of this.path)switch(s[0]){case"L":t.lineTo(s[1]+e,s[2]+n);break;case"M":t.moveTo(s[1]+e,s[2]+n);break;case"C":t.bezierCurveTo(s[1]+e,s[2]+n,s[3]+e,s[4]+n,s[5]+e,s[6]+n);break;case"Q":t.quadraticCurveTo(s[1]+e,s[2]+n,s[3]+e,s[4]+n);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Y(Y({},super.toObject(t)),{},{path:this.path.map((e=>e.slice()))})}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){const t=uC(this.path,fe.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(t,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const t=fe.NUM_FRACTION_DIGITS;return" translate(".concat(Pe(-this.pathOffset.x,t),", ").concat(Pe(-this.pathOffset.y,t),")")}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:n,pathOffset:s}=this._calcDimensions();this.set({width:e,height:n,pathOffset:s}),t&&this.setPositionByOrigin(s,Zt,Zt)}_calcBoundsFromPath(){const t=[];let e=0,n=0,s=0,o=0;for(const c of this.path)switch(c[0]){case"L":s=c[1],o=c[2],t.push({x:e,y:n},{x:s,y:o});break;case"M":s=c[1],o=c[2],e=s,n=o;break;case"C":t.push(...JT(s,o,c[1],c[2],c[3],c[4],c[5],c[6])),s=c[5],o=c[6];break;case"Q":t.push(...JT(s,o,c[1],c[2],c[1],c[2],c[3],c[4])),s=c[3],o=c[4];break;case"Z":s=e,o=n}return ps(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return Y(Y({},t),{},{pathOffset:new nt(t.left+t.width/2,t.top+t.height/2)})}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,n){const s=Cs(t,this.ATTRIBUTE_NAMES,n),{d:o}=s;return new this(o,Y(Y(Y({},je(s,Qk)),e),{},{left:void 0,top:void 0}))}}z(oa,"type","Path"),z(oa,"cacheProperties",[...Es,"path","fillRule"]),z(oa,"ATTRIBUTE_NAMES",[...Ea,"d"]),wt.setClass(oa),wt.setSVGClass(oa);class Od extends Wk{constructor(t){super(t),z(this,"decimate",.4),z(this,"drawStraightLine",!1),z(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,n){const s=e.midPointFrom(n);return t.quadraticCurveTo(e.x,e.y,s.x,s.y),s}onMouseDown(t,e){let{e:n}=e;this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:n}=e;if(this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const s=this._points,o=s.length,c=this.canvas.contextTop;this._saveAndTransform(c),this.oldEnd&&(c.beginPath(),c.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Od.drawSegment(c,s[o-2],s[o-1]),c.stroke(),c.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],n=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===n.x&&e.y===n.y){const s=this.width/1e3;e.x-=s,n.x+=s}t.moveTo(e.x,e.y);for(let s=1;s<this._points.length;s++)Od.drawSegment(t,e,n),e=this._points[s],n=this._points[s+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return Vk(t,e)}createPath(t){const e=new oa(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new Fi(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let n,s=t[0];const o=this.canvas.getZoom(),c=Math.pow(e/o,2),h=t.length-1,f=[s];for(let d=1;d<h-1;d++)n=Math.pow(s.x-t[d].x,2)+Math.pow(s.y-t[d].y,2),n>=c&&(s=t[d],f.push(s));return f.push(t[h]),f}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(n){return uC(n)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const $k=["left","top","radius"],pC=["radius","startAngle","endAngle","counterClockwise"];class Mi extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),Mi.ownDefaults)}constructor(t){super(),Object.assign(this,Mi.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,tn(this.startAngle),tn(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(gr)}getRadiusY(){return this.get("radius")*this.get(qr)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...pC,...t])}_toSVG(){const t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:e}=this,n=tn(this.startAngle),s=tn(this.endAngle),o=Ss(n)*e,c=bs(n)*e,h=Ss(s)*e,f=bs(s)*e,d=t>180?1:0,p=this.counterClockwise?0:1;return['<path d="M '.concat(o," ").concat(c," A ").concat(e," ").concat(e," 0 ").concat(d," ").concat(p," ").concat(h," ").concat(f,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(t,e,n){const s=Cs(t,this.ATTRIBUTE_NAMES,n),{left:o=0,top:c=0,radius:h=0}=s;return new this(Y(Y({},je(s,$k)),{},{radius:h,left:o-h,top:c-h}))}static fromObject(t){return super._fromObject(t)}}z(Mi,"type","Circle"),z(Mi,"cacheProperties",[...Es,...pC]),z(Mi,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),z(Mi,"ATTRIBUTE_NAMES",["cx","cy","r",...Ea]),wt.setClass(Mi),wt.setSVGClass(Mi);const Zk=["x1","y1","x2","y2"],Jk=["x1","y1","x2","y2"],fy=["x1","x2","y1","y2"];class io extends Hn{constructor(){let[t,e,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,io.ownDefaults),this.setOptions(o),this.x1=t,this.x2=n,this.y1=e,this.y2=s,this._setWidthHeight();const{left:c,top:h}=o;typeof c=="number"&&this.set(pe,c),typeof h=="number"&&this.set(hr,h)}_setWidthHeight(){const{x1:t,y1:e,x2:n,y2:s}=this;this.width=Math.abs(n-t),this.height=Math.abs(s-e);const{left:o,top:c,width:h,height:f}=ps([{x:t,y:e},{x:n,y:s}]),d=new nt(o+h/2,c+f/2);this.setPositionByOrigin(d,Zt,Zt)}_set(t,e){return super._set(t,e),fy.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const n=t.strokeStyle;var s;Gr(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n}_findCenterFromElement(){return new nt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Y(Y({},super.toObject(t)),this.calcLinePoints())}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:n,y2:s,width:o,height:c}=this,h=t<=e?-1:1,f=n<=s?-1:1;return{x1:h*o/2,x2:h*-o/2,y1:f*c/2,y2:f*-c/2}}_toSVG(){const{x1:t,x2:e,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(t,'" y1="').concat(n,'" x2="').concat(e,'" y2="').concat(s,`" />
`)]}static async fromElement(t,e,n){const s=Cs(t,this.ATTRIBUTE_NAMES,n),{x1:o=0,y1:c=0,x2:h=0,y2:f=0}=s;return new this([o,c,h,f],je(s,Zk))}static fromObject(t){let{x1:e,y1:n,x2:s,y2:o}=t,c=je(t,Jk);return this._fromObject(Y(Y({},c),{},{points:[e,n,s,o]}),{extraParam:"points"})}}z(io,"type","Line"),z(io,"cacheProperties",[...Es,...fy]),z(io,"ATTRIBUTE_NAMES",Ea.concat(fy)),wt.setClass(io),wt.setSVGClass(io);class oo extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),oo.ownDefaults)}constructor(t){super(),Object.assign(this,oo.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,n),t.lineTo(0,-n),t.lineTo(e,n),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-t," ").concat(e,",0 ").concat(-e,",").concat(t," ").concat(e),'" />']}}z(oo,"type","Triangle"),z(oo,"ownDefaults",{width:100,height:100}),wt.setClass(oo),wt.setSVGClass(oo);const yC=["rx","ry"];class ds extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),ds.ownDefaults)}constructor(t){super(),Object.assign(this,ds.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(gr)}getRy(){return this.get("ry")*this.get(qr)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...yC,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,_d,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,n){const s=Cs(t,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function tV(i){if(!i)return[];const t=i.replace(/,/g," ").trim().split(/\s+/),e=[];for(let n=0;n<t.length;n+=2)e.push({x:parseFloat(t[n]),y:parseFloat(t[n+1])});return e}z(ds,"type","Ellipse"),z(ds,"cacheProperties",[...Es,...yC]),z(ds,"ownDefaults",{rx:0,ry:0}),z(ds,"ATTRIBUTE_NAMES",[...Ea,"cx","cy","rx","ry"]),wt.setClass(ds),wt.setSVGClass(ds);const eV=["left","top"],vC={exactBoundingBox:!1};class fi extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),fi.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),z(this,"strokeDiff",void 0),Object.assign(this,fi.ownDefaults),this.setOptions(e),this.points=t;const{left:n,top:s}=e;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(pe,n),typeof s=="number"&&this.set(hr,s)}isOpen(){return!0}_projectStrokeOnPoints(t){return z4(this.points,t,this.isOpen())}_calcDimensions(t){t=Y({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},t||{});const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map((d=>d.projectedPoint)):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new nt,strokeOffset:new nt,strokeDiff:new nt};const n=ps(e),s=Qd(Y(Y({},t),{},{scaleX:1,scaleY:1})),o=ps(this.points.map((d=>cr(d,s,!0)))),c=new nt(this.scaleX,this.scaleY);let h=n.left+n.width/2,f=n.top+n.height/2;return this.exactBoundingBox&&(h-=f*Math.tan(tn(this.skewX)),f-=h*Math.tan(tn(this.skewY))),Y(Y({},n),{},{pathOffset:new nt(h,f),strokeOffset:new nt(o.left,o.top).subtract(new nt(n.left,n.top)).multiply(c),strokeDiff:new nt(n.width,n.height).subtract(new nt(o.width,o.height)).multiply(c)})}_findCenterFromElement(){const t=ps(this.points);return new nt(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:n,width:s,height:o,pathOffset:c,strokeOffset:h,strokeDiff:f}=this._calcDimensions();this.set({width:s,height:o,pathOffset:c,strokeOffset:h,strokeDiff:f}),t&&this.setPositionByOrigin(new nt(e+s/2,n+o/2),Zt,Zt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new nt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let c;if(Object.keys(t).some((h=>this.strokeUniform||this.constructor.layoutProperties.includes(h)))){var e,n;const{width:h,height:f}=this._calcDimensions(t);c=new nt((e=t.width)!==null&&e!==void 0?e:h,(n=t.height)!==null&&n!==void 0?n:f)}else{var s,o;c=new nt((s=t.width)!==null&&s!==void 0?s:this.width,(o=t.height)!==null&&o!==void 0?o:this.height)}return c.multiply(new nt(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const n=this.initialized&&this[t]!==e,s=super._set(t,e);return this.exactBoundingBox&&n&&((t===gr||t===qr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),s}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Y(Y({},super.toObject(t)),{},{points:this.points.map((e=>{let{x:n,y:s}=e;return{x:n,y:s}}))})}_toSVG(){const t=[],e=this.pathOffset.x,n=this.pathOffset.y,s=fe.NUM_FRACTION_DIGITS;for(let o=0,c=this.points.length;o<c;o++)t.push(Pe(this.points[o].x-e,s),",",Pe(this.points[o].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(t.join(""),`" />
`)]}_render(t){const e=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-n,this.points[0].y-s);for(let o=0;o<e;o++){const c=this.points[o];t.lineTo(c.x-n,c.y-s)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,n){return new this(tV(t.getAttribute("points")),Y(Y({},je(Cs(t,this.ATTRIBUTE_NAMES,n),eV)),e))}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}z(fi,"ownDefaults",vC),z(fi,"type","Polyline"),z(fi,"layoutProperties",[jl,Bl,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),z(fi,"cacheProperties",[...Es,"points"]),z(fi,"ATTRIBUTE_NAMES",[...Ea]),wt.setClass(fi),wt.setSVGClass(fi);class vf extends fi{isOpen(){return!1}}z(vf,"ownDefaults",vC),z(vf,"type","Polygon"),wt.setClass(vf),wt.setSVGClass(vf);class _C extends Hn{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const n in e)for(const s in e[n])for(const o in e[n][s])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const n=e===void 0?this.styles:{0:this.styles[e]};for(const s in n)for(const o in n[s])if(n[s][o][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let n,s,o=0,c=!0,h=0;for(const f in e){n=0;for(const d in e[f]){const p=e[f][d]||{};o++,p[t]!==void 0?(s?p[t]!==s&&(c=!1):s=p[t],p[t]===this[t]&&delete p[t]):c=!1,Object.keys(p).length!==0?n++:delete e[f][d]}n===0&&delete e[f]}for(let f=0;f<this._textLines.length;f++)h+=this._textLines[f].length;c&&o===h&&(this[t]=s,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let n,s,o;for(s in e){for(o in n=e[s],n)delete n[o][t],Object.keys(n[o]).length===0&&delete n[o];Object.keys(n).length===0&&delete e[s]}}_extendStyles(t,e){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(t);this._getLineStyle(n)||this._setLineStyle(n);const o=dv(Y(Y({},this._getStyleDeclaration(n,s)),e),(c=>c!==void 0));this._setStyleDeclaration(n,s,o)}getSelectionStyles(t,e,n){const s=[];for(let o=t;o<(e||t);o++)s.push(this.getStyleAtPosition(o,n));return s}getStyleAtPosition(t,e){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(t,e,n){for(let s=e;s<(n||e);s++)this._extendStyles(s,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var n;const s=this.styles&&this.styles[t];return s&&(n=s[e])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(t,e){return Y(Y({},Ul(this,this.constructor._styleProperties)),this._getStyleDeclaration(t,e))}_setStyleDeclaration(t,e,n){this.styles[t][e]=n}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}z(_C,"_styleProperties",i4);const nV=/  +/g,rV=/"/g;function Ep(i,t,e,n,s){return"		".concat((function(o,c){let{left:h,top:f,width:d,height:p}=c,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fe.NUM_FRACTION_DIGITS;const S=Mu(gn,o,!1),[b,E,O,D]=[h,f,d,p].map((j=>Pe(j,v)));return"<rect ".concat(S,' x="').concat(b,'" y="').concat(E,'" width="').concat(O,'" height="').concat(D,'"></rect>')})(i,{left:t,top:e,width:n,height:s}),`
`)}const iV=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Cp;class Qn extends _C{static getDefaults(){return Y(Y({},super.getDefaults()),Qn.ownDefaults)}constructor(t,e){super(),z(this,"__charBounds",[]),Object.assign(this,Qn.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=cC(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Pi)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,n,s,o,c,h;for(let f=0,d=this._textLines.length;f<d;f++)if((this.textAlign===Pi||f!==d-1&&!this.isEndOfWrapping(f))&&(s=0,o=this._textLines[f],e=this.getLineWidth(f),e<this.width&&(h=this.textLines[f].match(this._reSpacesAndTabs)))){n=h.length,t=(this.width-e)/n;for(let p=0;p<=o.length;p++)c=this.__charBounds[f][p],this._reSpaceAndTab.test(o[p])?(c.width+=t,c.kernedWidth+=t,c.left+=s,s+=t):c.left+=s}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const n=e?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(t<=n[s].length)return{lineIndex:s,charIndex:t};t-=n[s].length+this.missingNewlineOffset(s,e)}return{lineIndex:s-1,charIndex:n[s-1].length<t?n[s-1].length:t}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===dr?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,n){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Zt:t.textBaseline="middle";break;case"ascender":t.textBaseline=hr;break;case"descender":t.textBaseline=ey}t.font=this._getFontDeclaration(e,n)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,n=this._textLines.length;e<n;e++){const s=this.getLineWidth(e);s>t&&(t=s)}return t}_renderTextLine(t,e,n,s,o,c){this._renderChars(t,e,n,s,o,c)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let o=0,c=this._textLines.length;o<c;o++){const h=this.getHeightOfLine(o);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",o)){s+=h;continue}const f=this._textLines[o].length,d=this._getLineLeftOffset(o);let p,v,S=0,b=0,E=this.getValueOfPropertyAt(o,0,"textBackgroundColor");for(let O=0;O<f;O++){const D=this.__charBounds[o][O];v=this.getValueOfPropertyAt(o,O,"textBackgroundColor"),this.path?(t.save(),t.translate(D.renderLeft,D.renderTop),t.rotate(D.angle),t.fillStyle=v,v&&t.fillRect(-D.width/2,-h/this.lineHeight*(1-this._fontSizeFraction),D.width,h/this.lineHeight),t.restore()):v!==E?(p=n+d+b,this.direction==="rtl"&&(p=this.width-p-S),t.fillStyle=E,E&&t.fillRect(p,s,S,h/this.lineHeight),b=D.left,S=D.width,E=v):S+=D.kernedWidth}v&&!this.path&&(p=n+d+b,this.direction==="rtl"&&(p=this.width-p-S),t.fillStyle=v,t.fillRect(p,s,S,h/this.lineHeight)),s+=h}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,n,s){const o=uu.getFontCache(e),c=this._getFontDeclaration(e),h=n+t,f=n&&c===this._getFontDeclaration(s),d=e.fontSize/this.CACHE_FONT_SIZE;let p,v,S,b;if(n&&o[n]!==void 0&&(S=o[n]),o[t]!==void 0&&(b=p=o[t]),f&&o[h]!==void 0&&(v=o[h],b=v-S),p===void 0||S===void 0||v===void 0){const E=(function(){return Cp||(Cp=Xr({width:0,height:0}).getContext("2d")),Cp})();this._setTextStyles(E,e,!0),p===void 0&&(b=p=E.measureText(t).width,o[t]=p),S===void 0&&f&&n&&(S=E.measureText(n).width,o[n]=S),f&&v===void 0&&(v=E.measureText(h).width,o[h]=v,b=v-S)}return{width:p*d,kernedWidth:b*d}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,n,s=0;const o=this.pathSide===Je,c=this.path,h=this._textLines[t],f=h.length,d=new Array(f);this.__charBounds[t]=d;for(let p=0;p<f;p++){const v=h[p];n=this._getGraphemeBox(v,t,p,e),d[p]=n,s+=n.kernedWidth,e=v}if(d[f]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},c&&c.segmentsInfo){let p=0;const v=c.segmentsInfo[c.segmentsInfo.length-1].length;switch(this.textAlign){case pe:p=o?v-s:0;break;case Zt:p=(v-s)/2;break;case Je:p=o?0:v-s}p+=this.pathStartOffset*(o?-1:1);for(let S=o?f-1:0;o?S>=0:S<f;o?S--:S++)n=d[S],p>v?p%=v:p<0&&(p+=v),this._setGraphemeOnPath(p,n),p+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(t,e){const n=t+e.kernedWidth/2,s=this.path,o=Ok(s.path,n,s.segmentsInfo);e.renderLeft=o.x-s.pathOffset.x,e.renderTop=o.y-s.pathOffset.y,e.angle=o.angle+(this.pathSide===Je?Math.PI:0)}_getGraphemeBox(t,e,n,s,o){const c=this.getCompleteStyleDeclaration(e,n),h=s?this.getCompleteStyleDeclaration(e,n-1):{},f=this._measureChar(t,c,s,h);let d,p=f.kernedWidth,v=f.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),v+=d,p+=d);const S={width:v,left:0,height:c.fontSize,kernedWidth:p,deltaY:c.deltaY};if(n>0&&!o){const b=this.__charBounds[e][n-1];S.left=b.left+b.width+f.kernedWidth-f.width}return S}getHeightOfLine(t){if(this.__lineHeights[t])return this.__lineHeights[t];let e=this.getHeightOfChar(t,0);for(let n=1,s=this._textLines[t].length;n<s;n++)e=Math.max(this.getHeightOfChar(t,n),e);return this.__lineHeights[t]=e*this.lineHeight*this._fontSizeMult}calcTextHeight(){let t,e=0;for(let n=0,s=this._textLines.length;n<s;n++)t=this.getHeightOfLine(n),e+=n===s-1?t/this.lineHeight:t;return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let n=0;const s=this._getLeftOffset(),o=this._getTopOffset();for(let c=0,h=this._textLines.length;c<h;c++){const f=this.getHeightOfLine(c),d=f/this.lineHeight,p=this._getLineLeftOffset(c);this._renderTextLine(e,t,this._textLines[c],s+p,o+n+d,c),n+=f}t.restore()}_renderTextFill(t){(this.fill||this.styleHas(gn))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,n,s,o,c){const h=this.getHeightOfLine(c),f=this.textAlign.includes(Pi),d=this.path,p=!f&&this.charSpacing===0&&this.isEmptyStyles(c)&&!d,v=this.direction==="ltr",S=this.direction==="ltr"?1:-1,b=e.direction;let E,O,D,j,G,Z="",q=0;if(e.save(),b!==this.direction&&(e.canvas.setAttribute("dir",v?"ltr":"rtl"),e.direction=v?"ltr":"rtl",e.textAlign=v?pe:Je),o-=h*this._fontSizeFraction/this.lineHeight,p)return this._renderChar(t,e,c,0,n.join(""),s,o),void e.restore();for(let B=0,I=n.length-1;B<=I;B++)j=B===I||this.charSpacing||d,Z+=n[B],D=this.__charBounds[c][B],q===0?(s+=S*(D.kernedWidth-D.width),q+=D.width):q+=D.kernedWidth,f&&!j&&this._reSpaceAndTab.test(n[B])&&(j=!0),j||(E=E||this.getCompleteStyleDeclaration(c,B),O=this.getCompleteStyleDeclaration(c,B+1),j=bv(E,O,!1)),j&&(d?(e.save(),e.translate(D.renderLeft,D.renderTop),e.rotate(D.angle),this._renderChar(t,e,c,B,Z,-q/2,0),e.restore()):(G=s,this._renderChar(t,e,c,B,Z,G,o)),Z="",E=O,s+=S*q,q=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=Xr({width:e,height:n}),o=s.getContext("2d");return s.width=e,s.height=n,o.beginPath(),o.moveTo(0,0),o.lineTo(e,0),o.lineTo(e,n),o.lineTo(0,n),o.closePath(),o.translate(e/2,n/2),o.fillStyle=t.toLive(o),this._applyPatternGradientTransform(o,t),o.fill(),o.createPattern(s,"no-repeat")}handleFiller(t,e,n){let s,o;return Gr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,o=-this.height/2,t.translate(s,o),t[e]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:o}):(t[e]=n.toLive(t),this._applyPatternGradientTransform(t,n)):(t[e]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:n,strokeWidth:s}=e;return t.lineWidth=s,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",n)}_setFillStyles(t,e){let{fill:n}=e;return this.handleFiller(t,"fillStyle",n)}_renderChar(t,e,n,s,o,c,h){const f=this._getStyleDeclaration(n,s),d=this.getCompleteStyleDeclaration(n,s),p=t==="fillText"&&d.fill,v=t==="strokeText"&&d.stroke&&d.strokeWidth;if(v||p){if(e.save(),e.font=this._getFontDeclaration(d),f.textBackgroundColor&&this._removeShadow(e),f.deltaY&&(h+=f.deltaY),p){const S=this._setFillStyles(e,d);e.fillText(o,c-S.offsetX,h-S.offsetY)}if(v){const S=this._setStrokeStyles(e,d);e.strokeText(o,c-S.offsetX,h-S.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,n){const s=this.get2DCursorLocation(t,!0),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),c=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),h={fontSize:o*n.size,deltaY:c+o*n.baseline};this.setSelectionStyles(h,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),n=this.width-e,s=this.textAlign,o=this.direction,c=this.isEndOfWrapping(t);let h=0;return s===Pi||s===fu&&!c||s===hu&&!c||s===xd&&!c?0:(s===Zt&&(h=n/2),s===Je&&(h=n),s===fu&&(h=n/2),s===hu&&(h=n),o==="rtl"&&(s===Je||s===Pi||s===hu?h=0:s===pe||s===xd?h=-n:s!==Zt&&s!==fu||(h=-n/2)),h)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,n){var s;return(s=this._getStyleDeclaration(t,e)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let n=this._getTopOffset();const s=this._getLeftOffset(),o=this.path,c=this._getWidthOfCharSpacing(),h=e==="linethrough"?.5:e==="overline"?1:0,f=this.offsets[e];for(let d=0,p=this._textLines.length;d<p;d++){const v=this.getHeightOfLine(d);if(!this[e]&&!this.styleHas(e,d)){n+=v;continue}const S=this._textLines[d],b=v/this.lineHeight,E=this._getLineLeftOffset(d);let O=0,D=0,j=this.getValueOfPropertyAt(d,0,e),G=this.getValueOfPropertyAt(d,0,gn),Z=this.getValueOfPropertyAt(d,0,mo),q=j,B=G,I=Z;const P=n+b*(1-this._fontSizeFraction);let x=this.getHeightOfChar(d,0),R=this.getValueOfPropertyAt(d,0,"deltaY");for(let F=0,M=S.length;F<M;F++){const vt=this.__charBounds[d][F];q=this.getValueOfPropertyAt(d,F,e),B=this.getValueOfPropertyAt(d,F,gn),I=this.getValueOfPropertyAt(d,F,mo);const Pt=this.getHeightOfChar(d,F),W=this.getValueOfPropertyAt(d,F,"deltaY");if(o&&q&&B){const ft=this.fontSize*I/1e3;t.save(),t.fillStyle=G,t.translate(vt.renderLeft,vt.renderTop),t.rotate(vt.angle),t.fillRect(-vt.kernedWidth/2,f*Pt+W-h*ft,vt.kernedWidth,ft),t.restore()}else if((q!==j||B!==G||Pt!==x||I!==Z||W!==R)&&D>0){const ft=this.fontSize*Z/1e3;let gt=s+E+O;this.direction==="rtl"&&(gt=this.width-gt-D),j&&G&&Z&&(t.fillStyle=G,t.fillRect(gt,P+f*x+R-h*ft,D,ft)),O=vt.left,D=vt.width,j=q,Z=I,G=B,x=Pt,R=W}else D+=vt.kernedWidth}let L=s+E+O;this.direction==="rtl"&&(L=this.width-L-D),t.fillStyle=B;const k=this.fontSize*I/1e3;q&&B&&I&&t.fillRect(L,P+f*x+R-h*k,D-c,k),n+=v}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;const c=t.includes("'")||t.includes('"')||t.includes(",")||Qn.genericFonts.includes(t.toLowerCase())?t:'"'.concat(t,'"');return[e,n,"".concat(o?this.CACHE_FONT_SIZE:s,"px"),c].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return Sv(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),n=new Array(e.length),s=[`
`];let o=[];for(let c=0;c<e.length;c++)n[c]=this.graphemeSplit(e[c]),o=o.concat(n[c],s);return o.pop(),{_unwrappedLines:n,lines:e,graphemeText:o,graphemeLines:n}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Y(Y({},super.toObject([...YE,...t])),{},{styles:q4(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(t,e){const{textLayoutProperties:n}=this.constructor;super.set(t,e);let s=!1,o=!1;if(typeof t=="object")for(const c in t)c==="path"&&this.setPathInfo(),s=s||n.includes(c),o=o||c==="path";else s=n.includes(t),o=t==="path";return o&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,n){const s=Cs(t,Qn.ATTRIBUTE_NAMES,n),o=Y(Y({},e),s),{textAnchor:c=pe,textDecoration:h="",dx:f=0,dy:d=0,top:p=0,left:v=0,fontSize:S=ov,strokeWidth:b=1}=o,E=je(o,iV),O=new this((t.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),Y({left:v+f,top:p+d,underline:h.includes("underline"),overline:h.includes("overline"),linethrough:h.includes("line-through"),strokeWidth:0,fontSize:S},E)),D=O.getScaledHeight()/O.height,j=((O.height+O.strokeWidth)*O.lineHeight-O.height)*D,G=O.getScaledHeight()+j;let Z=0;return c===Zt&&(Z=O.getScaledWidth()/2),c===Je&&(Z=O.getScaledWidth()),O.set({left:O.left-Z,top:O.top-(G-O.fontSize*(.07+O._fontSizeFraction))/O.lineHeight,strokeWidth:b}),O}static fromObject(t){return this._fromObject(Y(Y({},t),{},{styles:X4(t.styles||{},t.text)}),{extraParam:"text"})}}z(Qn,"textLayoutProperties",GE),z(Qn,"cacheProperties",[...Es,...YE]),z(Qn,"ownDefaults",s4),z(Qn,"type","Text"),z(Qn,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),z(Qn,"ATTRIBUTE_NAMES",Ea.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),tC(Qn,[class extends UE{_toSVG(){const i=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(i){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:i,withShadow:!0,additionalTransform:Ou(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(i){let{textBgRects:t,textSpans:e}=i;const n=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(rV,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(i,t){const e=[],n=[];let s,o=i;this.backgroundColor&&n.push(...Ep(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let c=0,h=this._textLines.length;c<h;c++)s=this._getLineLeftOffset(c),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",c))&&this._setSVGTextLineBg(n,c,t+s,o),this._setSVGTextLineText(e,c,t+s,o),o+=this.getHeightOfLine(c);return{textSpans:e,textBgRects:n}}_createTextCharSpan(i,t,e,n,s){const o=fe.NUM_FRACTION_DIGITS,c=this.getSvgSpanStyles(t,i!==i.trim()||!!i.match(nV)),h=c?'style="'.concat(c,'"'):"",f=t.deltaY,d=f?' dy="'.concat(Pe(f,o),'" '):"",{angle:p,renderLeft:v,renderTop:S,width:b}=s;let E="";if(v!==void 0){const O=b/2;p&&(E=' rotate="'.concat(Pe(ws(p),o),'"'));const D=Fl({angle:ws(p)});D[4]=v,D[5]=S;const j=new nt(-O,0).transform(D);e=j.x,n=j.y}return'<tspan x="'.concat(Pe(e,o),'" y="').concat(Pe(n,o),'" ').concat(d).concat(E).concat(h,">").concat(H4(i),"</tspan>")}_setSVGTextLineText(i,t,e,n){const s=this.getHeightOfLine(t),o=this.textAlign.includes(Pi),c=this._textLines[t];let h,f,d,p,v,S="",b=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let E=0,O=c.length-1;E<=O;E++)v=E===O||this.charSpacing||this.path,S+=c[E],d=this.__charBounds[t][E],b===0?(e+=d.kernedWidth-d.width,b+=d.width):b+=d.kernedWidth,o&&!v&&this._reSpaceAndTab.test(c[E])&&(v=!0),v||(h=h||this.getCompleteStyleDeclaration(t,E),f=this.getCompleteStyleDeclaration(t,E+1),v=bv(h,f,!0)),v&&(p=this._getStyleDeclaration(t,E),i.push(this._createTextCharSpan(S,p,e,n,d)),S="",h=f,this.direction==="rtl"?e-=b:e+=b,b=0)}_setSVGTextLineBg(i,t,e,n){const s=this._textLines[t],o=this.getHeightOfLine(t)/this.lineHeight;let c,h=0,f=0,d=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let p=0;p<s.length;p++){const{left:v,width:S,kernedWidth:b}=this.__charBounds[t][p];c=this.getValueOfPropertyAt(t,p,"textBackgroundColor"),c!==d?(d&&i.push(...Ep(d,e+f,n,h,o)),f=v,h=S,d=c):h+=b}c&&i.push(...Ep(d,e+f,n,h,o))}_getSVGLineTopOffset(i){let t,e=0;for(t=0;t<i;t++)e+=this.getHeightOfLine(t);const n=this.getHeightOfLine(t);return{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(i){return"".concat(super.getSvgStyles(i)," text-decoration-thickness: ").concat(Pe(this.textDecorationThickness*this.getObjectScaling().y/10,fe.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(i,t){const{fontFamily:e,strokeWidth:n,stroke:s,fill:o,fontSize:c,fontStyle:h,fontWeight:f,deltaY:d,textDecorationThickness:p,linethrough:v,overline:S,underline:b}=i,E=this.getSvgTextDecoration({underline:b??this.underline,overline:S??this.overline,linethrough:v??this.linethrough}),O=p||this.textDecorationThickness;return[s?Mu(dr,s):"",n?"stroke-width: ".concat(n,"; "):"",e?"font-family: ".concat(e.includes("'")||e.includes('"')?e:"'".concat(e,"'"),"; "):"",c?"font-size: ".concat(c,"px; "):"",h?"font-style: ".concat(h,"; "):"",f?"font-weight: ".concat(f,"; "):"",E?"text-decoration: ".concat(E,"; text-decoration-thickness: ").concat(Pe(O*this.getObjectScaling().y/10,fe.NUM_FRACTION_DIGITS),"%; "):"",o?Mu(gn,o):"",d?"baseline-shift: ".concat(-d,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(i){return["overline","underline","line-through"].filter((t=>i[t.replace("-","")])).join(" ")}}]),wt.setClass(Qn),wt.setSVGClass(Qn);class sV{constructor(t){z(this,"target",void 0),z(this,"__mouseDownInPlace",!1),z(this,"__dragStartFired",!1),z(this,"__isDraggingOver",!1),z(this,"__dragStartSelection",void 0),z(this,"__dragImageDisposer",void 0),z(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach((n=>n())),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,n=e.getSelectionStartFromPointer(t);return e.isEditing&&n>=e.selectionStart&&n<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var n;let{selectionStart:s,selectionEnd:o}=e;const c=this.target,h=c.canvas,f=new nt(c.flipX?-1:1,c.flipY?-1:1),d=c._getCursorBoundaries(s),p=new nt(d.left+d.leftOffset,d.top+d.topOffset).multiply(f).transform(c.calcTransformMatrix()),v=h.getScenePoint(t).subtract(p),S=c.getCanvasRetinaScaling(),b=c.getBoundingRect(),E=p.subtract(new nt(b.left,b.top)),O=h.viewportTransform,D=E.add(v).transform(O,!0),j=c.backgroundColor,G=_v(c.styles);c.backgroundColor="";const Z={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};c.setSelectionStyles(Z,0,s),c.setSelectionStyles(Z,o,c.text.length),c.dirty=!0;const q=c.toCanvasElement({enableRetinaScaling:h.enableRetinaScaling,viewportTransform:!0});c.backgroundColor=j,c.styles=G,c.dirty=!0,uy(q,{position:"fixed",left:"".concat(-q.width,"px"),border:fr,width:"".concat(q.width/S,"px"),height:"".concat(q.height/S,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{q.remove()},gi(t.target||this.target.hiddenTextarea).body.appendChild(q),(n=t.dataTransfer)===null||n===void 0||n.setDragImage(q,D.x,D.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,n=this.isActive();if(n&&t.dataTransfer){const s=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},o=e._text.slice(s.selectionStart,s.selectionEnd).join(""),c=Y({text:e.text,value:o},s);t.dataTransfer.setData("text/plain",o),t.dataTransfer.setData("application/fabric",JSON.stringify({value:o,styles:e.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,c)}return e.abortCursorAnimation(),n}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),n=this.__dragStartSelection;return e<n.selectionStart||e>n.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const n=this.targetCanDrop(e);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,n=this.targetCanDrop(e);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:n}=t,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let o=(e=n.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(o&&!s){const c=this.target,h=c.canvas;let f=c.getSelectionStartFromPointer(n);const{styles:d}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},p=o[Math.max(0,o.length-1)],v=0;if(this.__dragStartSelection){const S=this.__dragStartSelection.selectionStart,b=this.__dragStartSelection.selectionEnd;f>S&&f<=b?f=S:f>b&&(f-=b-S),c.removeChars(S,b),delete this.__dragStartSelection}c._reNewline.test(p)&&(c._reNewline.test(c._text[f])||f===c._text.length)&&(o=o.trimEnd()),t.didDrop=!0,t.dropTarget=c,c.insertChars(o,d,f),h.setActiveObject(c),c.enterEditing(n),c.selectionStart=Math.min(f+v,c._text.length),c.selectionEnd=Math.min(c.selectionStart+o.length,c._text.length),c.hiddenTextarea.value=c.text,c._updateTextarea(),c.hiddenTextarea.focus(),c.fire(Sd,{index:f+v,action:"drop"}),h.fire("text:changed",{target:c}),h.contextTopDirty=!0,h.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,o=this.target.canvas,{selectionStart:c,selectionEnd:h}=this.__dragStartSelection,f=((n=e.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||fr;f===fr?(s.selectionStart=c,s.selectionEnd=h,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),f==="move"&&(s.removeChars(c,h),s.selectionStart=s.selectionEnd=c,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Sd,{index:c,action:"dragend"}),o.fire("text:changed",{target:s}),o.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const n1=/[ \n\.,;!\?\-]/;class aV extends Qn{constructor(){super(...arguments),z(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:n,delay:s,onComplete:o}=t;return KE({startValue:this._currentCursorOpacity,endValue:e,duration:n,delay:s,onComplete:o,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:c=>{this._currentCursorOpacity=c,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach((e=>{e&&!e.isDone()&&(t=!0,e.abort())})),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((t=>!t||t.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,n=t-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n--;for(;/\S/.test(this._text[n])&&n>-1;)e++,n--;return t-e}findWordBoundaryRight(t){let e=0,n=t;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)e++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e}findLineBoundaryLeft(t){let e=0,n=t-1;for(;!/\n/.test(this._text[n])&&n>-1;)e++,n--;return t-e}findLineBoundaryRight(t){let e=0,n=t;for(;!/\n/.test(this._text[n])&&n<this._text.length;)e++,n++;return t+e}searchWordBoundary(t,e){const n=this._text;let s=t>0&&this._reSpace.test(n[t])&&(e===-1||!lv.test(n[t-1]))?t-1:t,o=n[s];for(;s>0&&s<n.length&&!n1.test(o);)s+=e,o=n[s];return e===-1&&n1.test(o)&&s++,s}selectWord(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const n=this.searchWordBoundary(t,-1),s=Math.max(n,this.searchWordBoundary(t,1));this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const n=this.findLineBoundaryLeft(t),s=this.findLineBoundaryRight(t);this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;gi(e).activeElement!==e&&e.focus();const n=this.getSelectionStartFromPointer(t),s=this.selectionStart,o=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==o||s!==n&&o!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===o||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,n){const s=n.slice(0,t),o=this.graphemeSplit(s).length;if(t===e)return{selectionStart:o,selectionEnd:o};const c=n.slice(t,e);return{selectionStart:o,selectionEnd:o+this.graphemeSplit(c).length}}fromGraphemeToStringSelection(t,e,n){const s=n.slice(0,t).join("").length;return t===e?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const t=this.hiddenTextarea;this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const e=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),n=this.get2DCursorLocation(t),s=n.lineIndex,o=n.charIndex,c=this.getValueOfPropertyAt(s,o,"fontSize")*this.lineHeight,h=e.leftOffset,f=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,p=d.width/f,v=d.height/f,S=p-c,b=v-c,E=new nt(e.left+h,e.top+e.topOffset+c).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new nt(d.clientWidth/p,d.clientHeight/v));return E.x<0&&(E.x=0),E.x>S&&(E.x=S),E.y<0&&(E.y=0),E.y>b&&(E.y=b),E.x+=this.canvas._offset.left,E.y+=this.canvas._offset.top,{left:"".concat(E.x,"px"),top:"".concat(E.y,"px"),fontSize:"".concat(c,"px"),charHeight:c}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(bd),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(t,!0),{lineIndex:o,charIndex:c}=this.get2DCursorLocation(e,!0);if(n!==o){if(this.styles[n])for(let h=s;h<this._unwrappedTextLines[n].length;h++)delete this.styles[n][h];if(this.styles[o])for(let h=c;h<this._unwrappedTextLines[o].length;h++){const f=this.styles[o][h];f&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+h-c]=f)}for(let h=n+1;h<=o;h++)delete this.styles[h];this.shiftLineStyles(o,n-o)}else if(this.styles[n]){const h=this.styles[n],f=c-s;for(let d=s;d<c;d++)delete h[d];for(const d in this.styles[n]){const p=parseInt(d,10);p>=c&&(h[p-f]=h[d],delete h[d])}}}shiftLineStyles(t,e){const n=Object.assign({},this.styles);for(const s in this.styles){const o=parseInt(s,10);o>t&&(this.styles[o+e]=n[o],n[o-e]||delete this.styles[o])}}insertNewlineStyleObject(t,e,n,s){const o={},c=this._unwrappedTextLines[t].length,h=c===e;let f=!1;n||(n=1),this.shiftLineStyles(t,n);const d=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const v in this.styles[t]){const S=parseInt(v,10);S>=e&&(f=!0,o[S-e]=this.styles[t][v],h&&e===0||delete this.styles[t][v])}let p=!1;for(f&&!h&&(this.styles[t+n]=o,p=!0),(p||c>e)&&n--;n>0;)s&&s[n-1]?this.styles[t+n]={0:Y({},s[n-1])}:d?this.styles[t+n]={0:Y({},d)}:delete this.styles[t+n],n--;this._forceClearCache=!0}insertCharStyleObject(t,e,n,s){this.styles||(this.styles={});const o=this.styles[t],c=o?Y({},o):{};n||(n=1);for(const f in c){const d=parseInt(f,10);d>=e&&(o[d+n]=c[d],c[d-n]||delete o[d])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+n]=Y({},s[n]));return}if(!o)return;const h=o[e?e-1:1];for(;h&&n--;)this.styles[t][e+n]=Y({},h)}insertNewStyleBlock(t,e,n){const s=this.get2DCursorLocation(e,!0),o=[0];let c,h=0;for(let f=0;f<t.length;f++)t[f]===`
`?(h++,o[h]=0):o[h]++;for(o[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,o[0],n),n=n&&n.slice(o[0]+1)),h&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+o[0],h),c=1;c<h;c++)o[c]>0?this.insertCharStyleObject(s.lineIndex+c,0,o[c],n):n&&this.styles[s.lineIndex+c]&&n[0]&&(this.styles[s.lineIndex+c][0]=n[0]),n=n&&n.slice(o[c]+1);o[c]>0&&this.insertCharStyleObject(s.lineIndex+c,0,o[c],n)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const o=this.graphemeSplit(t);this.insertNewStyleBlock(o,n,e),this._text=[...this._text.slice(0,n),...o,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,n){n<=t?(e===t?this._selectionDirection=pe:this._selectionDirection===Je&&(this._selectionDirection=pe,this.selectionEnd=t),this.selectionStart=n):n>t&&n<e?this._selectionDirection===Je?this.selectionEnd=n:this.selectionStart=n:(e===t?this._selectionDirection=Je:this._selectionDirection===pe&&(this._selectionDirection=Je,this.selectionStart=e),this.selectionEnd=n)}}class oV extends aV{initHiddenTextarea(){const t=this.canvas&&gi(this.canvas.getElement())||Nl(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map((c=>{let[h,f]=c;return e.setAttribute(h,f)}));const{top:n,left:s,fontSize:o}=this._calcTextareaPosition();e.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(o,";"),(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((c=>{let[h,f]=c;return e.addEventListener(h,this[f].bind(this))})),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:n,selectionStart:s,selectionEnd:o}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const c=()=>{this.updateFromTextArea(),this.fire(Sd),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void c();const h=this._splitTextIntoLines(n).graphemeText,f=this._text.length,d=h.length,p=this.selectionStart,v=this.selectionEnd,S=p!==v;let b,E,O,D,j=d-f;const G=this.fromStringToGraphemeSelection(s,o,n),Z=p>G.selectionStart;S?(E=this._text.slice(p,v),j+=v-p):d<f&&(E=Z?this._text.slice(v+j,v):this._text.slice(p,p-j));const q=h.slice(G.selectionEnd-j,G.selectionEnd);if(E&&E.length&&(q.length&&(b=this.getSelectionStyles(p,p+1,!1),b=q.map((()=>b[0]))),S?(O=p,D=v):Z?(O=v-E.length,D=v):(O=v,D=v+E.length),this.removeStyleFromTo(O,D)),q.length){const{copyPasteData:B}=Hi();e&&q.join("")===B.copiedText&&!fe.disableStyleCopyPaste&&(b=B.copiedTextStyle),this.insertNewStyleBlock(q,p,b)}c()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:n,selectionEnd:s}=e;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=Hi();t.copiedText=this.getSelectedText(),fe.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let n,s=this._getLineLeftOffset(t);return e>0&&(n=this.__charBounds[t][e-1],s+=n.left+n.width),s}getDownCursorOffset(t,e){const n=this._getSelectionForOffset(t,e),s=this.get2DCursorLocation(n),o=s.lineIndex;if(o===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-n;const c=s.charIndex,h=this._getWidthBeforeCursor(o,c),f=this._getIndexOnLine(o+1,h);return this._textLines[o].slice(c).length+f+1+this.missingNewlineOffset(o)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const n=this._getSelectionForOffset(t,e),s=this.get2DCursorLocation(n),o=s.lineIndex;if(o===0||t.metaKey||t.keyCode===33)return-n;const c=s.charIndex,h=this._getWidthBeforeCursor(o,c),f=this._getIndexOnLine(o-1,h),d=this._textLines[o].slice(0,c),p=this.missingNewlineOffset(o-1);return-this._textLines[o-1].length+f-d.length+(1-p)}_getIndexOnLine(t,e){const n=this._textLines[t];let s,o,c=this._getLineLeftOffset(t),h=0;for(let f=0,d=n.length;f<d;f++)if(s=this.__charBounds[t][f].width,c+=s,c>e){o=!0;const p=c-s,v=c,S=Math.abs(p-e);h=Math.abs(v-e)<S?f:f-1;break}return o||(h=n.length-1),h}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const n=this["get".concat(t,"CursorOffset")](e,this._selectionDirection===Je);if(e.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=Ol(0,this.selectionStart,s),this.selectionEnd=Ol(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===pe?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,n){let s;if(t.altKey)s=this["findWordBoundary".concat(n)](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[e])}return s!==void 0&&this[e]!==s&&(this[e]=s,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=pe,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===Je&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=pe,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const n="moveCursor".concat(t).concat(e.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===pe&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Je,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=Je,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const r1=i=>!!i.button;class lV extends oV{constructor(){super(...arguments),z(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new sV(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:n}=t;this.canvas&&this.editable&&!r1(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(t){let{e,transform:n}=t;const s=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const o=this.canvas._activeObject;if(o&&o!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||r1(e)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),n=this.selectionStart,s=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,s,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(pi(this.calcTransformMatrix())).add(new nt(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,o=0;for(let d=0;d<this._textLines.length&&n<=e.y;d++)n+=this.getHeightOfLine(d),o=d,d>0&&(s+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let c=Math.abs(this._getLineLeftOffset(o));const h=this._textLines[o].length,f=this.__charBounds[o];for(let d=0;d<h;d++){const p=c+f[d].kernedWidth;if(e.x<=p){Math.abs(e.x-p)<=Math.abs(e.x-c)&&s++;break}c=p,s++}return Math.min(this.flipX?h-s:s,this._text.length)}}const _f="moveCursorUp",Sf="moveCursorDown",bf="moveCursorLeft",Tf="moveCursorRight",wf="exitEditing",i1=(i,t)=>{const e=t.getRetinaScaling();i.setTransform(e,0,0,e,0,0);const n=t.viewportTransform;i.transform(n[0],n[1],n[2],n[3],n[4],n[5])},cV=Y({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:wf,27:wf,33:_f,34:Sf,35:Tf,36:bf,37:bf,38:_f,39:Tf,40:Sf},keysMapRtl:{9:wf,27:wf,33:_f,34:Sf,35:bf,36:Tf,37:Tf,38:_f,39:bf,40:Sf},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class ki extends lV{static getDefaults(){return Y(Y({},super.getDefaults()),ki.ownDefaults)}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,Y(Y({},ki.ownDefaults),e)),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof hy&&this.canvas.textEditingManager.remove(this),e instanceof hy&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,n)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,n)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(t);return this.isEditing=e,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),s=n.length>0;let o,c=t;if(s){o=Xr(t.canvas),c=o.getContext("2d"),i1(c,this.canvas);const h=this.calcTransformMatrix();c.transform(h[0],h[1],h[2],h[3],h[4],h[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(c,e):this.renderCursor(c,e),s)for(const h of n){const f=h.clipPath,d=Xr(t.canvas),p=d.getContext("2d");if(i1(p,this.canvas),!f.absolutePositioned){const v=h.calcTransformMatrix();p.transform(v[0],v[1],v[2],v[3],v[4],v[5])}f.transform(p),f.drawObject(p,!0,{}),this.drawClipPathOnCache(c,f,d)}s&&(t.setTransform(1,0,0,1,0,0),t.drawImage(o,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),o=this._getCursorBoundariesOffsets(t,e);return{left:n,top:s,leftOffset:o.left,topOffset:o.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,n=0;const{charIndex:s,lineIndex:o}=this.get2DCursorLocation(t);for(let d=0;d<o;d++)e+=this.getHeightOfLine(d);const c=this._getLineLeftOffset(o),h=this.__charBounds[o][s];h&&(n=h.left),this.charSpacing!==0&&s===this._textLines[o].length&&(n-=this._getWidthOfCharSpacing());const f={top:e,left:c+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Je||this.textAlign===Pi||this.textAlign===hu?f.left*=-1:this.textAlign===pe||this.textAlign===xd?f.left=c-(n>0?n:0):this.textAlign!==Zt&&this.textAlign!==fu||(f.left=c-(n>0?n:0))),f}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const n=this.get2DCursorLocation(t),s=n.lineIndex,o=n.charIndex>0?n.charIndex-1:0,c=this.getValueOfPropertyAt(s,o,"fontSize"),h=this.getObjectScaling().x*this.canvas.getZoom(),f=this.cursorWidth/h,d=this.getValueOfPropertyAt(s,o,"deltaY"),p=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-c*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,o,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-f/2,top:p+e.top+d,width:f,height:c}}_renderCursor(t,e,n){const{color:s,opacity:o,left:c,top:h,width:f,height:d}=this.getCursorRenderingData(n,e);t.fillStyle=s,t.globalAlpha=o,t.fillRect(c,h,f,d)}renderSelection(t,e){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,n,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,n){const s=e.selectionStart,o=e.selectionEnd,c=this.textAlign.includes(Pi),h=this.get2DCursorLocation(s),f=this.get2DCursorLocation(o),d=h.lineIndex,p=f.lineIndex,v=h.charIndex<0?0:h.charIndex,S=f.charIndex<0?0:f.charIndex;for(let b=d;b<=p;b++){const E=this._getLineLeftOffset(b)||0;let O=this.getHeightOfLine(b),D=0,j=0,G=0;if(b===d&&(j=this.__charBounds[d][v].left),b>=d&&b<p)G=c&&!this.isEndOfWrapping(b)?this.width:this.getLineWidth(b)||5;else if(b===p)if(S===0)G=this.__charBounds[p][S].left;else{const P=this._getWidthOfCharSpacing();G=this.__charBounds[p][S-1].left+this.__charBounds[p][S-1].width-P}D=O,(this.lineHeight<1||b===p&&this.lineHeight>1)&&(O/=this.lineHeight);let Z=n.left+E+j,q=O,B=0;const I=G-j;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",q=1,B=O):t.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Je||this.textAlign===Pi||this.textAlign===hu?Z=this.width-Z-I:this.textAlign===pe||this.textAlign===xd?Z=n.left+E-G:this.textAlign!==Zt&&this.textAlign!==fu||(Z=n.left+E-G)),t.fillRect(Z,n.top+n.topOffset+B,I,q),n.topOffset+=D}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,gn)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}z(ki,"ownDefaults",cV),z(ki,"type","IText"),wt.setClass(ki),wt.setClass(ki,"i-text");class lo extends ki{static getDefaults(){return Y(Y({},super.getDefaults()),lo.ownDefaults)}constructor(t,e){super(t,Y(Y({},lo.ownDefaults),e))}static createControls(){return{controls:B4()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Pi)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,n=0,s=0;const o={};for(let c=0;c<t.graphemeLines.length;c++)t.graphemeText[s]===`
`&&c>0?(n=0,s++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[s])&&c>0&&(n++,s++),o[c]={line:e,offset:n},s+=t.graphemeLines[c].length,n+=t.graphemeLines[c].length;return o}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];n&&(e=n.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,n=0,s=t+1,o=!1;const c=this._styleMap[t],h=this._styleMap[t+1];c&&(t=c.line,n=c.offset),h&&(s=h.line,o=s===t,e=h.offset);const f=t===void 0?this.styles:{line:this.styles[t]};for(const d in f)for(const p in f[d]){const v=parseInt(p,10);if(v>=n&&(!o||v<e))for(const S in f[d][p])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];if(!n)return{};t=n.line,e=n.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,n){const s=this._styleMap[t];super._setStyleDeclaration(s.line,s.offset+e,n)}_deleteStyleDeclaration(t,e){const n=this._styleMap[t];super._deleteStyleDeclaration(n.line,n.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const n=this.getGraphemeDataForRender(t),s=[];for(let o=0;o<n.wordsData.length;o++)s.push(...this._wrapLine(o,e,n));return this.isWrapping=!1,s}getGraphemeDataForRender(t){const e=this.splitByGrapheme,n=e?"":" ";let s=0;return{wordsData:t.map(((o,c)=>{let h=0;const f=e?this.graphemeSplit(o):this.wordSplit(o);return f.length===0?[{word:[],width:0}]:f.map((d=>{const p=e?[d]:this.graphemeSplit(d),v=this._measureWord(p,c,h);return s=Math.max(v,s),h+=p.length+n.length,{word:p,width:v}}))})),largestWordWidth:s}}_measureWord(t,e){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=0;for(let c=0,h=t.length;c<h;c++)o+=this._getGraphemeBox(t[c],e,c+s,n,!0).kernedWidth,n=t[c];return o}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,n){let{largestWordWidth:s,wordsData:o}=n,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const h=this._getWidthOfCharSpacing(),f=this.splitByGrapheme,d=[],p=f?"":" ";let v=0,S=[],b=0,E=0,O=!0;e-=c;const D=Math.max(e,s,this.dynamicMinWidth),j=o[t];let G;for(b=0,G=0;G<j.length;G++){const{word:Z,width:q}=j[G];b+=Z.length,v+=E+q-h,v>D&&!O?(d.push(S),S=[],v=q,O=!0):v+=h,O||f||S.push(p),S=S.concat(Z),E=f?0:this._measureWord([p],t,b),b++,O=!1}return G&&d.push(S),s+c>this.dynamicMinWidth&&(this.dynamicMinWidth=s-h+c),d}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),n=this._wrapText(e.lines,this.width),s=new Array(n.length);for(let o=0;o<n.length;o++)s[o]=n[o].join("");return e.lines=s,e.graphemeLines=n,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const n=parseInt(e,10);if(this._textLines[n]){const s=this._styleMap[e].line;t.set("".concat(s),!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}z(lo,"type","Textbox"),z(lo,"textLayoutProperties",[...ki.textLayoutProperties,"width"]),z(lo,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),wt.setClass(lo);class s1 extends eg{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:n}=t,{clipPath:s,group:o}=n;if(!s||!this.shouldPerformLayout(t))return;const{width:c,height:h}=ps(rC(n,s)),f=new nt(c,h);if(s.absolutePositioned)return{center:bl(s.getRelativeCenterPoint(),void 0,o?o.calcTransformMatrix():void 0),size:f};{const d=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:p=new nt,correction:v=new nt}=this.calcBoundingBox(e,t)||{};return{center:p.add(d),correction:v.subtract(d),size:f}}return{center:n.getRelativeCenterPoint().add(d),size:f}}}}z(s1,"type","clip-path"),wt.setClass(s1);class a1 extends eg{getInitialSize(t,e){let{target:n}=t,{size:s}=e;return new nt(n.width||s.x,n.height||s.y)}}z(a1,"type","fixed"),wt.setClass(a1);class uV extends Iu{subscribeTargets(t){const e=t.target;t.targets.reduce(((n,s)=>(s.parent&&n.add(s.parent),n)),new Set).forEach((n=>{n.layoutManager.subscribeTargets({target:n,targets:[e]})}))}unsubscribeTargets(t){const e=t.target,n=e.getObjects();t.targets.reduce(((s,o)=>(o.parent&&s.add(o.parent),s)),new Set).forEach((s=>{!n.some((o=>o.parent===s))&&s.layoutManager.unsubscribeTargets({target:s,targets:[e]})}))}}class co extends ho{static getDefaults(){return Y(Y({},super.getDefaults()),co.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,co.ownDefaults),this.setOptions(e);const{left:n,top:s,layoutManager:o}=e;this.groupInit(t,{left:n,top:s,layoutManager:o??new uV})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach((s=>{const o=this._objects.findIndex((h=>h.isInFrontOf(s))),c=o===-1?this.size():o;this.insertAt(c,s)}))}canEnterGroup(t){return this.getObjects().some((e=>e.isDescendantOf(t)||t.isDescendantOf(e)))?(Sa("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const n=new Set;e.forEach((s=>{const{parent:o}=s;o&&n.add(o)})),t===wv?n.forEach((s=>{s._onAfterObjectsChange(Ad,e)})):n.forEach((s=>{s._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,n){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=Y(Y({hasControls:!1},n),{},{forActiveSelection:!0});for(let o=0;o<this._objects.length;o++)this._objects[o]._renderControls(t,s);super._renderControls(t,e),t.restore()}}z(co,"type","ActiveSelection"),z(co,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),wt.setClass(co),wt.setClass(co,"activeSelection");class hV{constructor(){z(this,"resources",{})}applyFilters(t,e,n,s,o){const c=o.getContext("2d");if(!c)return;c.drawImage(e,0,0,n,s);const h={sourceWidth:n,sourceHeight:s,imageData:c.getImageData(0,0,n,s),originalEl:e,originalImageData:c.getImageData(0,0,n,s),canvasEl:o,ctx:c,filterBackend:this};t.forEach((d=>{d.applyTo(h)}));const{imageData:f}=h;return f.width===n&&f.height===s||(o.width=f.width,o.height=f.height),c.putImageData(f,0,0),h}}class SC{constructor(){let{tileSize:t=fe.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),z(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const n=Xr({width:t,height:e}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(t,e,n,s,o,c){const h=this.gl,f=o.getContext("2d");if(!h||!f)return;let d;c&&(d=this.getCachedTexture(c,e));const p={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:h,sourceTexture:this.createTexture(h,n,s,d?void 0:e),targetTexture:this.createTexture(h,n,s),originalTexture:d||this.createTexture(h,n,s,d?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},v=h.createFramebuffer();return h.bindFramebuffer(h.FRAMEBUFFER,v),t.forEach((S=>{S&&S.applyTo(p)})),(function(S){const b=S.targetCanvas,E=b.width,O=b.height,D=S.destinationWidth,j=S.destinationHeight;E===D&&O===j||(b.width=D,b.height=j)})(p),this.copyGLTo2D(h,p),h.bindTexture(h.TEXTURE_2D,null),h.deleteTexture(p.sourceTexture),h.deleteTexture(p.targetTexture),h.deleteFramebuffer(v),f.setTransform(1,0,0,1,0,0),p}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,n,s,o){const{NEAREST:c,TEXTURE_2D:h,RGBA:f,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:p,TEXTURE_MAG_FILTER:v,TEXTURE_MIN_FILTER:S,TEXTURE_WRAP_S:b,TEXTURE_WRAP_T:E}=t,O=t.createTexture();return t.bindTexture(h,O),t.texParameteri(h,v,o||c),t.texParameteri(h,S,o||c),t.texParameteri(h,b,p),t.texParameteri(h,E,p),s?t.texImage2D(h,0,f,f,d,s):t.texImage2D(h,0,f,e,n,0,f,d,null),O}getCachedTexture(t,e,n){const{textureCache:s}=this;if(s[t])return s[t];{const o=this.createTexture(this.gl,e.width,e.height,e,n);return o&&(s[t]=o),o}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const n=t.canvas,s=e.targetCanvas,o=s.getContext("2d");if(!o)return;o.translate(0,s.height),o.scale(1,-1);const c=n.height-s.height;o.drawImage(n,0,c,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(t,e){const n=e.targetCanvas.getContext("2d"),s=e.destinationWidth,o=e.destinationHeight,c=s*o*4;if(!n)return;const h=new Uint8Array(this.imageBuffer,0,c),f=new Uint8ClampedArray(this.imageBuffer,0,c);t.readPixels(0,0,s,o,t.RGBA,t.UNSIGNED_BYTE,h);const d=new ImageData(f,s,o);n.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const n=t.getExtension("WEBGL_debug_renderer_info");if(n){const s=t.getParameter(n.UNMASKED_RENDERER_WEBGL),o=t.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(e.renderer=s.toLowerCase()),o&&(e.vendor=o.toLowerCase())}return this.gpuInfo=e,e}}let xp;function fV(){const{WebGLProbe:i}=Hi();return i.queryWebGL(Ts()),fe.enableGLFiltering&&i.isSupported(fe.textureSize)?new SC({tileSize:fe.textureSize}):new hV}function Ap(){return!xp&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(xp=fV()),xp}const dV=["filters","resizeFilter","src","crossOrigin","type"],bC=["cropX","cropY"];class Ur extends Hn{static getDefaults(){return Y(Y({},super.getDefaults()),Ur.ownDefaults)}constructor(t,e){super(),z(this,"_lastScaleX",1),z(this,"_lastScaleY",1),z(this,"_filterScalingX",1),z(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Ur.ownDefaults),this.setOptions(e),this.cacheKey="texture".concat(ba()),this.setElement(typeof t=="string"?(this.canvas&&gi(this.canvas.getElement())||Nl()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){var e;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=t,this._originalElement=t,this._setWidthHeight(n),(e=t.classList)===null||e===void 0||e.add(Ur.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=Ap(!1);e instanceof SC&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((t=>{const e=this[t];e&&Hi().dispose(e),this[t]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,n=this.height/2;t.beginPath(),t.moveTo(-e,-n),t.lineTo(e,-n),t.lineTo(e,n),t.lineTo(-e,n),t.lineTo(-e,-n),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach((n=>{n&&e.push(n.toObject())})),Y(Y({},super.toObject([...bC,...t])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,n=-this.width/2,s=-this.height/2;let o=[],c=[],h="",f="";if(!e)return[];if(this.hasCrop()){const d=ba();o.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),h=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(f=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(e.width||e.naturalWidth,'" height="').concat(e.height||e.naturalHeight,'"').concat(f).concat(h,`></image>
`)),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,c=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=d}return o=this.paintFirst!==gn?o.concat(c,t):o.concat(t,c),o}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Zf(t,{crossOrigin:e,signal:n}).then((s=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(s)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,o=n.y,c=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||s>e&&o>e)return this._element=c,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=o);const h=Xr(c),{width:f,height:d}=c;this._element=h,this._lastScaleX=t.scaleX=s,this._lastScaleY=t.scaleY=o,Ap().applyFilters([t],c,f,d,this._element),this._filterScalingX=h.width/this._originalElement.width,this._filterScalingY=h.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter((o=>o&&!o.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,n=e.naturalWidth||e.width,s=e.naturalHeight||e.height;if(this._element===this._originalElement){const o=Xr({width:n,height:s});this._element=o,this._filteredEl=o}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);Ap().applyFilters(t,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const n=this._filterScalingX,s=this._filterScalingY,o=this.width,c=this.height,h=Math.max(this.cropX,0),f=Math.max(this.cropY,0),d=e.naturalWidth||e.width,p=e.naturalHeight||e.height,v=h*n,S=f*s,b=Math.min(o*n,d-v),E=Math.min(c*s,p-S),O=-o/2,D=-c/2,j=Math.min(o,d/n-h),G=Math.min(c,p/s-f);e&&t.drawImage(e,v,S,b,E,O,D,j,G)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=t||n.width,this.height=e||n.height}parsePreserveAspectRatioAttribute(){const t=r4(this.preserveAspectRatio||""),e=this.width,n=this.height,s={width:e,height:n};let o,c=this._element.width,h=this._element.height,f=1,d=1,p=0,v=0,S=0,b=0;return!t||t.alignX===fr&&t.alignY===fr?(f=e/c,d=n/h):(t.meetOrSlice==="meet"&&(f=d=_k(this._element,s),o=(e-c*f)/2,t.alignX==="Min"&&(p=-o),t.alignX==="Max"&&(p=o),o=(n-h*d)/2,t.alignY==="Min"&&(v=-o),t.alignY==="Max"&&(v=o)),t.meetOrSlice==="slice"&&(f=d=Sk(this._element,s),o=c-e/f,t.alignX==="Mid"&&(S=o/2),t.alignX==="Max"&&(S=o),o=h-n/d,t.alignY==="Mid"&&(b=o/2),t.alignY==="Max"&&(b=o),c=e/f,h=n/d)),{width:c,height:h,scaleX:f,scaleY:d,offsetLeft:p,offsetTop:v,cropX:S,cropY:b}}static fromObject(t,e){let{filters:n,resizeFilter:s,src:o,crossOrigin:c,type:h}=t,f=je(t,dV);return Promise.all([Zf(o,Y(Y({},e),{},{crossOrigin:c})),n&&Ru(n,e),s&&Ru([s],e),$d(f,e)]).then((d=>{let[p,v=[],[S]=[],b={}]=d;return new this(p,Y(Y({},f),{},{src:o,filters:v,resizeFilter:S},b))}))}static fromURL(t){let{crossOrigin:e=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Zf(t,{crossOrigin:e,signal:n}).then((o=>new this(o,s)))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=Cs(t,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"]||s.href,e,s).catch((o=>(Sa("log","Unable to parse Image",o),null)))}}z(Ur,"type","Image"),z(Ur,"cacheProperties",[...Es,...bC]),z(Ur,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),z(Ur,"CSS_CANVAS","canvas-img"),z(Ur,"ATTRIBUTE_NAMES",[...Ea,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),wt.setClass(Ur),wt.setSVGClass(Ur);Jd(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const rg=i=>i.webgl!==void 0,Ev="precision highp float",gV=`
    `.concat(Ev,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),mV=["type"],pV=["type"],yV=new RegExp(Ev,"g");class mn{get type(){return this.constructor.type}constructor(){let t=je(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},mV);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return gV}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Hi();s!=="highp"&&(e=e.replace(yV,Ev.replace("highp",s)));const o=t.createShader(t.VERTEX_SHADER),c=t.createShader(t.FRAGMENT_SHADER),h=t.createProgram();if(!o||!c||!h)throw new Ii("Vertex, fragment shader or program creation error");if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Ii("Vertex shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(o)));if(t.shaderSource(c,e),t.compileShader(c),!t.getShaderParameter(c,t.COMPILE_STATUS))throw new Ii("Fragment shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(c)));if(t.attachShader(h,o),t.attachShader(h,c),t.linkProgram(h),!t.getProgramParameter(h,t.LINK_STATUS))throw new Ii('Shader link error for "'.concat(this.type,'" ').concat(t.getProgramInfoLog(h)));const f=this.getUniformLocations(t,h)||{};return f.uStepW=t.getUniformLocation(h,"uStepW"),f.uStepH=t.getUniformLocation(h,"uStepH"),{program:h,attributeLocations:this.getAttributeLocations(t,h),uniformLocations:f}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const n=this.constructor.uniformLocations,s={};for(let o=0;o<n.length;o++)s[n[o]]=t.getUniformLocation(e,n[o]);return s}sendAttributeData(t,e,n){const s=e.aPosition,o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const n=t.destinationWidth,s=t.destinationHeight;t.sourceWidth===n&&t.sourceHeight===s||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,n,s)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){rg(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,n=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:n}=t,s=Xr({width:e,height:n});t.helpLayer=s}}toObject(){const t=Object.keys(this.constructor.defaults||{});return Y({type:this.type},t.reduce(((e,n)=>(e[n]=this[n],e)),{}))}toJSON(){return this.toObject()}static async fromObject(t,e){return new this(je(t,pV))}}z(mn,"type","BaseFilter"),z(mn,"uniformLocations",[]);const vV={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Ef extends mn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(vV[this.mode],`
        }
      }
      `)}applyTo2d(t){let{imageData:{data:e}}=t;const n=new me(this.color).getSource(),s=this.alpha,o=n[0]*s,c=n[1]*s,h=n[2]*s,f=1-s;for(let d=0;d<e.length;d+=4){const p=e[d],v=e[d+1],S=e[d+2];let b,E,O;switch(this.mode){case"multiply":b=p*o/255,E=v*c/255,O=S*h/255;break;case"screen":b=255-(255-p)*(255-o)/255,E=255-(255-v)*(255-c)/255,O=255-(255-S)*(255-h)/255;break;case"add":b=p+o,E=v+c,O=S+h;break;case"difference":b=Math.abs(p-o),E=Math.abs(v-c),O=Math.abs(S-h);break;case"subtract":b=p-o,E=v-c,O=S-h;break;case"darken":b=Math.min(p,o),E=Math.min(v,c),O=Math.min(S,h);break;case"lighten":b=Math.max(p,o),E=Math.max(v,c),O=Math.max(S,h);break;case"overlay":b=o<128?2*p*o/255:255-2*(255-p)*(255-o)/255,E=c<128?2*v*c/255:255-2*(255-v)*(255-c)/255,O=h<128?2*S*h/255:255-2*(255-S)*(255-h)/255;break;case"exclusion":b=o+p-2*o*p/255,E=c+v-2*c*v/255,O=h+S-2*h*S/255;break;case"tint":b=o+p*f,E=c+v*f,O=h+S*f}e[d]=b,e[d+1]=E,e[d+2]=O}}sendUniformData(t,e){const n=new me(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,t.uniform4fv(e.uColor,n)}}z(Ef,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),z(Ef,"type","BlendColor"),z(Ef,"uniformLocations",["uColor"]),wt.setClass(Ef);const _V={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},SV=["type","image"];class Cf extends mn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return _V[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,n=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,n,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:n}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/n,1]}applyTo2d(t){let{imageData:{data:e,width:n,height:s},filterBackend:{resources:o}}=t;const c=this.image;o.blendImage||(o.blendImage=Ts());const h=o.blendImage,f=h.getContext("2d");h.width!==n||h.height!==s?(h.width=n,h.height=s):f.clearRect(0,0,n,s),f.setTransform(c.scaleX,0,0,c.scaleY,c.left,c.top),f.drawImage(c.getElement(),0,0,n,s);const d=f.getImageData(0,0,n,s).data;for(let p=0;p<e.length;p+=4){const v=e[p],S=e[p+1],b=e[p+2],E=e[p+3],O=d[p],D=d[p+1],j=d[p+2],G=d[p+3];switch(this.mode){case"multiply":e[p]=v*O/255,e[p+1]=S*D/255,e[p+2]=b*j/255,e[p+3]=E*G/255;break;case"mask":e[p+3]=G}}}sendUniformData(t,e){const n=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,n)}toObject(){return Y(Y({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(t,e){let{type:n,image:s}=t,o=je(t,SV);return Ur.fromObject(s,e).then((c=>new this(Y(Y({},o),{},{image:c}))))}}z(Cf,"type","BlendImage"),z(Cf,"defaults",{mode:"multiply",alpha:1}),z(Cf,"uniformLocations",["uTransformMatrix","uImage"]),wt.setClass(Cf);class xf extends mn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){rg(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:n,height:s}}=t;this.aspectRatio=n/s,this.horizontal=!0;let o=this.getBlurValue()*n;const c=new Uint8ClampedArray(e),h=15,f=4*n;for(let d=0;d<e.length;d+=4){let p=0,v=0,S=0,b=0,E=0;const O=d-d%f,D=O+f;for(let j=-14;j<h;j++){const G=j/h,Z=4*Math.floor(o*G),q=1-Math.abs(G);let B=d+Z;B<O?B=O:B>D&&(B=D);const I=e[B+3]*q;p+=e[B]*I,v+=e[B+1]*I,S+=e[B+2]*I,b+=I,E+=q}c[d]=p/b,c[d+1]=v/b,c[d+2]=S/b,c[d+3]=b/E}this.horizontal=!1,o=this.getBlurValue()*s;for(let d=0;d<c.length;d+=4){let p=0,v=0,S=0,b=0,E=0;const O=d%f,D=c.length-f+O;for(let j=-14;j<h;j++){const G=j/h,Z=Math.floor(o*G)*f,q=1-Math.abs(G);let B=d+Z;B<O?B=O:B>D&&(B=D);const I=c[B+3]*q;p+=c[B]*I,v+=c[B+1]*I,S+=c[B+2]*I,b+=I,E+=q}e[d]=p/b,e[d+1]=v/b,e[d+2]=S/b,e[d+3]=b/E}}sendUniformData(t,e){const n=this.chooseRightDelta();t.uniform2fv(e.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:n}=this;return e?n>1&&(t=1/n):n<1&&(t=n),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}z(xf,"type","Blur"),z(xf,"defaults",{blur:0}),z(xf,"uniformLocations",["uDelta"]),wt.setClass(xf);class Af extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const n=Math.round(255*this.brightness);for(let s=0;s<e.length;s+=4)e[s]+=n,e[s+1]+=n,e[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}z(Af,"type","Brightness"),z(Af,"defaults",{brightness:0}),z(Af,"uniformLocations",["uBrightness"]),wt.setClass(Af);const TC={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class yl extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,n=this.matrix,s=this.colorsOnly;for(let o=0;o<e.length;o+=4){const c=e[o],h=e[o+1],f=e[o+2];if(e[o]=c*n[0]+h*n[1]+f*n[2]+255*n[4],e[o+1]=c*n[5]+h*n[6]+f*n[7]+255*n[9],e[o+2]=c*n[10]+h*n[11]+f*n[12]+255*n[14],!s){const d=e[o+3];e[o]+=d*n[3],e[o+1]+=d*n[8],e[o+2]+=d*n[13],e[o+3]=c*n[15]+h*n[16]+f*n[17]+d*n[18]+255*n[19]}}}sendUniformData(t,e){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],o=[n[4],n[9],n[14],n[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,s),t.uniform4fv(e.uConstants,o)}toObject(){return Y(Y({},super.toObject()),{},{matrix:[...this.matrix]})}}function bo(i,t){var e;const n=(z(e=class extends yl{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",i),z(e,"defaults",{colorsOnly:!1,matrix:t}),e);return wt.setClass(n,i),n}z(yl,"type","ColorMatrix"),z(yl,"defaults",TC),z(yl,"uniformLocations",["uColorMatrix","uConstants"]),wt.setClass(yl);bo("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);bo("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);bo("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);bo("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);bo("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);bo("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);bo("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class o1 extends mn{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){rg(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach((e=>{e.applyTo(t)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((t=>t.toObject()))}}isNeutralState(){return!this.subFilters.some((t=>!t.isNeutralState()))}static fromObject(t,e){return Promise.all((t.subFilters||[]).map((n=>wt.getClass(n.type).fromObject(n,e)))).then((n=>new this({subFilters:n})))}}z(o1,"type","Composed"),wt.setClass(o1);class Df extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let o=0;o<e.length;o+=4)e[o]=s*(e[o]-128)+128,e[o+1]=s*(e[o+1]-128)+128,e[o+2]=s*(e[o+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}z(Df,"type","Contrast"),z(Df,"defaults",{contrast:0}),z(Df,"uniformLocations",["uContrast"]),wt.setClass(Df);const bV={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Rf extends mn{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return bV[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,n=e.data,s=this.matrix,o=Math.round(Math.sqrt(s.length)),c=Math.floor(o/2),h=e.width,f=e.height,d=t.ctx.createImageData(h,f),p=d.data,v=this.opaque?1:0;let S,b,E,O,D,j,G,Z,q,B,I,P,x;for(I=0;I<f;I++)for(B=0;B<h;B++){for(D=4*(I*h+B),S=0,b=0,E=0,O=0,x=0;x<o;x++)for(P=0;P<o;P++)G=I+x-c,j=B+P-c,G<0||G>=f||j<0||j>=h||(Z=4*(G*h+j),q=s[x*o+P],S+=n[Z]*q,b+=n[Z+1]*q,E+=n[Z+2]*q,v||(O+=n[Z+3]*q));p[D]=S,p[D+1]=b,p[D+2]=E,p[D+3]=v?n[D+3]:O}t.imageData=d}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return Y(Y({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}z(Rf,"type","Convolute"),z(Rf,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),z(Rf,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),wt.setClass(Rf);const wC="Gamma";class Of extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const n=this.gamma,s=1/n[0],o=1/n[1],c=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const h=this.rgbValues;for(let f=0;f<256;f++)h.r[f]=255*Math.pow(f/255,s),h.g[f]=255*Math.pow(f/255,o),h.b[f]=255*Math.pow(f/255,c);for(let f=0;f<e.length;f+=4)e[f]=h.r[e[f]],e[f+1]=h.g[e[f+1]],e[f+2]=h.b[e[f+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:wC,gamma:this.gamma.concat()}}}z(Of,"type",wC),z(Of,"defaults",{gamma:[1,1,1]}),z(Of,"uniformLocations",["uGamma"]),wt.setClass(Of);const TV={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Mf extends mn{applyTo2d(t){let{imageData:{data:e}}=t;for(let n,s=0;s<e.length;s+=4){const o=e[s],c=e[s+1],h=e[s+2];switch(this.mode){case"average":n=(o+c+h)/3;break;case"lightness":n=(Math.min(o,c,h)+Math.max(o,c,h))/2;break;case"luminosity":n=.21*o+.72*c+.07*h}e[s+2]=e[s+1]=e[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return TV[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}z(Mf,"type","Grayscale"),z(Mf,"defaults",{mode:"average"}),z(Mf,"uniformLocations",["uMode"]),wt.setClass(Mf);const wV=Y(Y({},TC),{},{rotation:0});class Dp extends yl{calculateMatrix(){const t=this.rotation*Math.PI,e=Ss(t),n=bs(t),s=1/3,o=Math.sqrt(s)*n,c=1-e;this.matrix=[e+c/3,s*c-o,s*c+o,0,0,s*c+o,e+s*c,s*c-o,0,0,s*c-o,s*c+o,e+s*c,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}z(Dp,"type","HueRotation"),z(Dp,"defaults",wV),wt.setClass(Dp);class Pf extends mn{applyTo2d(t){let{imageData:{data:e}}=t;for(let n=0;n<e.length;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2],this.alpha&&(e[n+3]=255-e[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}z(Pf,"type","Invert"),z(Pf,"defaults",{alpha:!1,invert:!0}),z(Pf,"uniformLocations",["uInvert","uAlpha"]),wt.setClass(Pf);class If extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const n=this.noise;for(let s=0;s<e.length;s+=4){const o=(.5-Math.random())*n;e[s]+=o,e[s+1]+=o,e[s+2]+=o}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}z(If,"type","Noise"),z(If,"defaults",{noise:0}),z(If,"uniformLocations",["uNoise","uSeed"]),wt.setClass(If);class kf extends mn{applyTo2d(t){let{imageData:{data:e,width:n,height:s}}=t;for(let o=0;o<s;o+=this.blocksize)for(let c=0;c<n;c+=this.blocksize){const h=4*o*n+4*c,f=e[h],d=e[h+1],p=e[h+2],v=e[h+3];for(let S=o;S<Math.min(o+this.blocksize,s);S++)for(let b=c;b<Math.min(c+this.blocksize,n);b++){const E=4*S*n+4*b;e[E]=f,e[E+1]=d,e[E+2]=p,e[E+3]=v}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}z(kf,"type","Pixelate"),z(kf,"defaults",{blocksize:4}),z(kf,"uniformLocations",["uBlocksize"]),wt.setClass(kf);class Vf extends mn{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const n=255*this.distance,s=new me(this.color).getSource(),o=[s[0]-n,s[1]-n,s[2]-n],c=[s[0]+n,s[1]+n,s[2]+n];for(let h=0;h<e.length;h+=4){const f=e[h],d=e[h+1],p=e[h+2];f>o[0]&&d>o[1]&&p>o[2]&&f<c[0]&&d<c[1]&&p<c[2]&&(e[h+3]=0)}}sendUniformData(t,e){const n=new me(this.color).getSource(),s=this.distance,o=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],c=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];t.uniform4fv(e.uLow,o),t.uniform4fv(e.uHigh,c)}}z(Vf,"type","RemoveColor"),z(Vf,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),z(Vf,"uniformLocations",["uLow","uHigh"]),wt.setClass(Vf);class Lf extends mn{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return"".concat(this.type,"_").concat(t)}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let o=1;o<=n;o++)s[o-1]=t(o*e);return s}generateShader(t){const e=new Array(t);for(let n=1;n<=t;n++)e[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(t,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(e.map(((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){rg(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const n=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(n)/n}}applyTo2d(t){const e=t.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const o=e.width,c=e.height,h=Math.round(o*n),f=Math.round(c*s);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(t,o,c,h,f):this.resizeType==="hermite"?this.hermiteFastResize(t,o,c,h,f):this.resizeType==="bilinear"?this.bilinearFiltering(t,o,c,h,f):this.resizeType==="lanczos"?this.lanczosResize(t,o,c,h,f):new ImageData(h,f),t.imageData=d}sliceByTwo(t,e,n,s,o){const c=t.imageData,h=.5;let f=!1,d=!1,p=e*h,v=n*h;const S=t.filterBackend.resources;let b=0,E=0;const O=e;let D=0;S.sliceByTwo||(S.sliceByTwo=Ts());const j=S.sliceByTwo;(j.width<1.5*e||j.height<n)&&(j.width=1.5*e,j.height=n);const G=j.getContext("2d");for(G.clearRect(0,0,1.5*e,n),G.putImageData(c,0,0),s=Math.floor(s),o=Math.floor(o);!f||!d;)e=p,n=v,s<Math.floor(p*h)?p=Math.floor(p*h):(p=s,f=!0),o<Math.floor(v*h)?v=Math.floor(v*h):(v=o,d=!0),G.drawImage(j,b,E,e,n,O,D,p,v),b=O,E=D,D+=v;return G.getImageData(b,E,s,o)}lanczosResize(t,e,n,s,o){const c=t.imageData.data,h=t.ctx.createImageData(s,o),f=h.data,d=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,v=this.rcpScaleY,S=2/this.rcpScaleX,b=2/this.rcpScaleY,E=Math.ceil(p*this.lanczosLobes/2),O=Math.ceil(v*this.lanczosLobes/2),D={},j={x:0,y:0},G={x:0,y:0};return(function Z(q){let B,I,P,x,R,L,k,F,M,vt,Pt;for(j.x=(q+.5)*p,G.x=Math.floor(j.x),B=0;B<o;B++){for(j.y=(B+.5)*v,G.y=Math.floor(j.y),R=0,L=0,k=0,F=0,M=0,I=G.x-E;I<=G.x+E;I++)if(!(I<0||I>=e)){vt=Math.floor(1e3*Math.abs(I-j.x)),D[vt]||(D[vt]={});for(let W=G.y-O;W<=G.y+O;W++)W<0||W>=n||(Pt=Math.floor(1e3*Math.abs(W-j.y)),D[vt][Pt]||(D[vt][Pt]=d(Math.sqrt(Math.pow(vt*S,2)+Math.pow(Pt*b,2))/1e3)),P=D[vt][Pt],P>0&&(x=4*(W*e+I),R+=P,L+=P*c[x],k+=P*c[x+1],F+=P*c[x+2],M+=P*c[x+3]))}x=4*(B*s+q),f[x]=L/R,f[x+1]=k/R,f[x+2]=F/R,f[x+3]=M/R}return++q<s?Z(q):h})(0)}bilinearFiltering(t,e,n,s,o){let c,h,f,d,p,v,S,b,E,O,D,j,G,Z=0;const q=this.rcpScaleX,B=this.rcpScaleY,I=4*(e-1),P=t.imageData.data,x=t.ctx.createImageData(s,o),R=x.data;for(S=0;S<o;S++)for(b=0;b<s;b++)for(p=Math.floor(q*b),v=Math.floor(B*S),E=q*b-p,O=B*S-v,G=4*(v*e+p),D=0;D<4;D++)c=P[G+D],h=P[G+4+D],f=P[G+I+D],d=P[G+I+4+D],j=c*(1-E)*(1-O)+h*E*(1-O)+f*O*(1-E)+d*E*O,R[Z++]=j;return x}hermiteFastResize(t,e,n,s,o){const c=this.rcpScaleX,h=this.rcpScaleY,f=Math.ceil(c/2),d=Math.ceil(h/2),p=t.imageData.data,v=t.ctx.createImageData(s,o),S=v.data;for(let b=0;b<o;b++)for(let E=0;E<s;E++){const O=4*(E+b*s);let D=0,j=0,G=0,Z=0,q=0,B=0,I=0;const P=(b+.5)*h;for(let x=Math.floor(b*h);x<(b+1)*h;x++){const R=Math.abs(P-(x+.5))/d,L=(E+.5)*c,k=R*R;for(let F=Math.floor(E*c);F<(E+1)*c;F++){let M=Math.abs(L-(F+.5))/f;const vt=Math.sqrt(k+M*M);vt>1&&vt<-1||(D=2*vt*vt*vt-3*vt*vt+1,D>0&&(M=4*(F+x*e),I+=D*p[M+3],G+=D,p[M+3]<255&&(D=D*p[M+3]/250),Z+=D*p[M],q+=D*p[M+1],B+=D*p[M+2],j+=D))}}S[O]=Z/j,S[O+1]=q/j,S[O+2]=B/j,S[O+3]=I/G}return v}}z(Lf,"type","Resize"),z(Lf,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),z(Lf,"uniformLocations",["uDelta","uTaps"]),wt.setClass(Lf);class Nf extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const n=-this.saturation;for(let s=0;s<e.length;s+=4){const o=e[s],c=e[s+1],h=e[s+2],f=Math.max(o,c,h);e[s]+=f!==o?(f-o)*n:0,e[s+1]+=f!==c?(f-c)*n:0,e[s+2]+=f!==h?(f-h)*n:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}z(Nf,"type","Saturation"),z(Nf,"defaults",{saturation:0}),z(Nf,"uniformLocations",["uSaturation"]),wt.setClass(Nf);class jf extends mn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const n=-this.vibrance;for(let s=0;s<e.length;s+=4){const o=e[s],c=e[s+1],h=e[s+2],f=Math.max(o,c,h),d=(o+c+h)/3,p=2*Math.abs(f-d)/255*n;e[s]+=f!==o?(f-o)*p:0,e[s+1]+=f!==c?(f-c)*p:0,e[s+2]+=f!==h?(f-h)*p:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}z(jf,"type","Vibrance"),z(jf,"defaults",{vibrance:0}),z(jf,"uniformLocations",["uVibrance"]),wt.setClass(jf);function EV(){const{id:i}=p2(),t=it.useRef(null),e=it.useRef(null),[n,s]=it.useState("select"),o=it.useCallback(async()=>{const q=e.current;if(!q||!i)return;const B=q.toJSON(["selectable"]);await kI(i,{json:B})},[i]),c=it.useRef(wD(o,500)).current;it.useEffect(()=>{const q=new hy("fabric-canvas",{selection:!0,preserveObjectStacking:!0});e.current=q;const B=()=>{if(!t.current)return;const x=t.current.getBoundingClientRect();q.setWidth(x.width),q.setHeight(x.height),q.renderAll()};B(),window.addEventListener("resize",B);let I;"ResizeObserver"in window&&t.current&&(I=new ResizeObserver(()=>B()),I.observe(t.current));const P=()=>c();return q.on("object:added",P),q.on("object:modified",P),q.on("object:removed",P),q.on("path:created",P),(async()=>{try{const x=await II(i);x?.json&&q.loadFromJSON(x.json,()=>{q.renderAll()})}catch{}})(),()=>{window.removeEventListener("resize",B),I&&I.disconnect(),q.dispose()}},[i,c]);const h=()=>{const q=e.current;if(!q)return;const B=new di({left:100,top:100,width:120,height:80,fill:"#60a5fa"});q.add(B),q.setActiveObject(B)},f=()=>{const q=e.current;if(!q)return;const B=new Mi({left:150,top:150,radius:50,fill:"#f87171"});q.add(B),q.setActiveObject(B)},d=()=>{const q=e.current;if(!q)return;const B=new ki("Double-click to edit",{left:120,top:120,fill:"#111827",fontSize:24});q.add(B),q.setActiveObject(B)},p=()=>{const q=e.current;q&&(s("pen"),q.isDrawingMode=!0,q.freeDrawingBrush=new Od(q),q.freeDrawingBrush.width=3,q.freeDrawingBrush.color="#111827")},v=()=>{const q=e.current;q&&(s("select"),q.isDrawingMode=!1)},S=()=>{const q=e.current;if(!q)return;q.getActiveObjects().forEach(I=>q.remove(I)),q.discardActiveObject(),q.requestRenderAll()},[b,E]=it.useState("#111827"),[O,D]=it.useState(""),j=q=>{const B=e.current;if(!B)return;const I=B.getActiveObject();I&&("set"in I&&I.set("fill",q),B.requestRenderAll(),c())};it.useEffect(()=>{const q=e.current;if(!q)return;const B=()=>{const I=q.getActiveObject();if(I){const P=I.fill||"#111827";E(typeof P=="string"?P:"#111827"),I.type==="i-text"?D(I.text||""):D("")}else D("")};return q.on("selection:created",B),q.on("selection:updated",B),q.on("selection:cleared",B),()=>{q.off("selection:created",B),q.off("selection:updated",B),q.off("selection:cleared",B)}},[]);const G=()=>{const q=e.current;if(!q)return;const B=q.getActiveObject();B&&B.type==="i-text"&&(B.text=O,q.requestRenderAll(),c())},Z=async()=>{try{await o()}catch{}const q=window.location.href;try{await navigator.clipboard.writeText(q),alert("Link copied to clipboard!")}catch{prompt("Copy this link:",q)}};return Ot.jsxs("div",{className:"h-screen flex flex-col",children:[Ot.jsxs("header",{className:"flex items-center justify-between p-3 border-b bg-white",children:[Ot.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ot.jsx("button",{className:`px-3 py-1 rounded ${n==="select"?"bg-indigo-600 text-white":"bg-gray-100"}`,onClick:v,children:"Select"}),Ot.jsx("button",{className:"px-3 py-1 rounded bg-gray-100",onClick:h,children:"Rectangle"}),Ot.jsx("button",{className:"px-3 py-1 rounded bg-gray-100",onClick:f,children:"Circle"}),Ot.jsx("button",{className:"px-3 py-1 rounded bg-gray-100",onClick:d,children:"Text"}),Ot.jsx("button",{className:`px-3 py-1 rounded ${n==="pen"?"bg-indigo-600 text-white":"bg-gray-100"}`,onClick:p,children:"Pen"}),Ot.jsx("button",{className:"px-3 py-1 rounded bg-gray-100",onClick:S,children:"Delete"}),Ot.jsxs("label",{className:"ml-2 text-sm text-gray-600",children:["Fill",Ot.jsx("input",{className:"ml-2 align-middle",type:"color",value:b,onChange:q=>{E(q.target.value),j(q.target.value)}})]}),O!==""||e.current?.getActiveObject()?.type==="i-text"?Ot.jsxs("span",{className:"flex items-center gap-1 ml-2",children:[Ot.jsx("input",{className:"border px-2 py-1 rounded text-sm",placeholder:"Edit text",value:O,onChange:q=>D(q.target.value)}),Ot.jsx("button",{className:"px-2 py-1 rounded bg-gray-100",onClick:G,children:"Apply"})]}):null]}),Ot.jsxs("div",{className:"flex items-center gap-3",children:[Ot.jsx("button",{className:"px-3 py-1 rounded bg-indigo-600 text-white",onClick:Z,children:"Share Canvas"}),Ot.jsxs("div",{className:"text-xs text-gray-500",children:["Scene: ",i]})]})]}),Ot.jsx("div",{className:"flex-1 relative bg-gray-50",children:Ot.jsx("div",{ref:t,className:"absolute inset-0",children:Ot.jsx("canvas",{id:"fabric-canvas",className:"block"})})})]})}function CV(){return Ot.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-100 flex items-center justify-center p-6",children:Ot.jsxs("div",{className:"relative w-full max-w-5xl",children:[Ot.jsx("div",{className:"absolute -inset-1 rounded-3xl bg-gradient-to-r from-indigo-500/30 via-fuchsia-500/30 to-emerald-500/30 blur-2xl"}),Ot.jsxs("div",{className:"relative rounded-3xl border border-white/10 bg-white/5 backdrop-blur-xl p-10",children:[Ot.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-8",children:[Ot.jsxs("div",{className:"max-w-2xl",children:[Ot.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/10 px-3 py-1 text-xs uppercase tracking-wider",children:[Ot.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400 animate-pulse"}),"Live Demo Ready"]}),Ot.jsx("h1",{className:"mt-4 text-4xl md:text-5xl font-black leading-tight",children:"Stateless 2D Editor — Mini Canva with Shareable Links"}),Ot.jsx("p",{className:"mt-4 text-slate-300 text-base md:text-lg leading-relaxed",children:"Built with React, Fabric.js, and Firebase Firestore. Create shapes, draw with a pen, edit colors and text, auto-save to scene URLs, and share instantly—no login required."}),Ot.jsxs("ul",{className:"mt-6 grid sm:grid-cols-2 gap-3 text-sm",children:[Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"Canvas tools: Rectangle, Circle, Text, Pen, Delete"]}),Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400"}),"Edit selected: Fill color, text content"]}),Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-indigo-400"}),"Stateless routing: /canvas/:id with auto-generate on /"]}),Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-indigo-400"}),"Firestore autosave + load with debounce"]}),Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-fuchsia-400"}),"Share button copies live URL"]}),Ot.jsxs("li",{className:"flex items-center gap-2",children:[Ot.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-fuchsia-400"}),"Full-viewport canvas with smooth resize"]})]})]}),Ot.jsx("div",{className:"w-full md:w-80 shrink-0",children:Ot.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6",children:[Ot.jsx("div",{className:"text-sm text-slate-300",children:"Quick Actions"}),Ot.jsxs("div",{className:"mt-4 grid gap-3",children:[Ot.jsx("a",{href:"/",className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2.5 font-medium transition",children:"New Canvas"}),Ot.jsx("a",{href:"http://localhost:5175/",target:"_blank",rel:"noreferrer",className:"inline-flex items-center justify-center rounded-xl bg-white/10 hover:bg-white/20 text-white px-4 py-2.5 font-medium transition",children:"View Live Demo"}),Ot.jsxs("div",{className:"text-xs text-slate-400 mt-4",children:[Ot.jsx("strong",{children:"Note:"})," For cross-device sharing, deploy Firestore rules in Firebase Console → Firestore → Rules:",Ot.jsx("pre",{className:"mt-2 p-2 bg-black/20 rounded text-xs overflow-x-auto",children:`rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /scenes/{sceneId} {
      allow read, write: if true;
    }
  }
}`})]})]})]})})]}),Ot.jsxs("div",{className:"mt-8 flex flex-wrap items-center gap-2 text-xs text-slate-400",children:[Ot.jsx("span",{className:"rounded-full bg-white/5 border border-white/10 px-3 py-1",children:"React"}),Ot.jsx("span",{className:"rounded-full bg-white/5 border border-white/10 px-3 py-1",children:"Fabric.js"}),Ot.jsx("span",{className:"rounded-full bg-white/5 border border-white/10 px-3 py-1",children:"Firebase Firestore"}),Ot.jsx("span",{className:"rounded-full bg-white/5 border border-white/10 px-3 py-1",children:"Tailwind CSS"})]})]})]})})}const xV=[{path:"/",element:Ot.jsx(SD,{})},{path:"/canvas/:id",element:Ot.jsx(EV,{})},{path:"/done",element:Ot.jsx(CV,{})},{path:"*",element:Ot.jsx(V2,{to:"/",replace:!0})}],AV=sD(xV);aA.createRoot(document.getElementById("root")).render(Ot.jsx(it.StrictMode,{children:Ot.jsx(vD,{router:AV})}));
